/*! 26.0.1.0 */
/*! VersionVI: 01F260101d   */
function abstract(){}function IWDConstante(){}function Align(){}function IWDChartConstant(){}function eGRAPHEINFOXY_COORD(){}function ETimeScale(){}function eDESSINVALEURNULLE(){}function ETypeCategorieWaterfall(){}function _clone(n,t){return clWDUtil.isObject(n)&&clWDUtil.isObject(t)?$.extend(!0,t,n):JSON.parse(JSON.stringify(n))}function sGetFunctionName(n){var t=n.name;if(!t){var i=n.toString(),r=i.indexOf(" ")+1,u=i.indexOf("(");t=i.substr(r,u-r).trim()}return t}function bCompareFonctions(n,t){return n==t?!0:sGetFunctionName(n)==sGetFunctionName(t)?!0:!1}function stPath(n,t){arguments.length&&this.set(n.m_nLeft+WDRect.getWidth(n)/2,n.m_nTop+WDRect.getHeight(n)/2,WDRect.getWidth(n)/2,WDRect.getHeight(n)/2,t)}function EPointStyle(){}function JSONPOO(n){arguments.length&&$.extend(!0,this,n)}function ERepereGrapheOrthonorme(){}function eGRAPHEAXE(){}function WDGraphe(n,t,i,r,u){if(arguments.length){WDChampParametresHote.prototype.constructor.apply(this,arguments);var f=u[6],e=u[7],o=u[8];this.m_tabEtat=f;this.m_tabEtat.ZOV=this.m_oParametres.m_bZoomY;this.m_tabEtat.ZOH=this.m_oParametres.m_bZoomX;this.m_sURLBase=e;this.m_bInteractif=o;this.m_bRetireOptionsNonSupporteesEnInteractif=window._PU_&&window._PU_.indexOf(".php")>-1;this.m_oVue=new WDChartView(this);this.m_oModele=undefined;this.m_oBarreAutomatique=WDBarreOutilsGraphe.s_pclCreate(this,arguments)}}function WDChartParameters(n,t){var i,r;arguments.length&&(JSONPOO.prototype.constructor.apply(this,[t]),this.m_bAnimationGraphe===!1&&(this.m_nDureeAnimation=0),this.m_sClasseBulle||this.m_oPoliceBulle||(i=WDPaintCSS.oGetInfoCSS(this.m_sClasseLibelle,"0",["fontFamily","fontWeight","fontStyle","textDecoration","fontSize","color"],"color:black"),this.m_oPoliceBulle={m_sNom:i.fontFamily,m_nGras:i.fontWeight,m_bItalique:i.fontStyle=="italic",m_bSouligne:(i.textDecoration||"").indexOf("underline")>-1?1:0,m_bBarre:(i.textDecoration||"").indexOf("line-through")>-1?1:0,m_sTaille:i.fontSize,m_sCouleur:i.color}),r=this,clWDUtil.bForEachIn(["Titre","Axe","Legende","Libelle","Valeur","Bulle"],function(t,i){return r["m_oPolice"+i]&&(r["m_sClasse"+i]=WDChartParameters.__sCreeClasseDepuisPolice(n,r["m_oPolice"+i],i)),!0}),this.m_sClasseValeur&&this.m_sClasseValeur!=""||(this.m_sClasseValeur=this.m_sClasseLibelle))}function WDChartSeries(n,t,i){if(arguments.length){JSONPOO.prototype.constructor.apply(this,[t]);i&&(this.m_tabValeur=i);this.m_oGraphe=n;this.m_dMinValue=Number.POSITIVE_INFINITY;this.m_dMaxValue=Number.NEGATIVE_INFINITY;this.m_bContainDecimalValues=!1;this.m_tabValeur||(this.m_tabValeur=[]);for(var r=0;r<this.m_tabValeur.length;++r)this.onValueAddedOrChanged(this.m_tabValeur[r]);this.m_dataSampler=undefined;this.m_nEpaisseur==undefined&&(this.m_nEpaisseur=2)}}function WDChartView(){arguments.length&&(this.m_oRenderer=undefined,this.m_oPicture=undefined,this.m_oModeleInitialSeries=undefined,this.m_tabSeriesMasquees=[],this.m_oModelePrecedent=undefined)}function WDChartUtils(){}function ESerieCouleur(){}function ESerieCouleur(){}function WDMathUtils(){}function WDRect(n,t,i,r){this.set(n,t,i,r)}function EAxisType(){}function EAxisOrientation(){}function WDChartAxis(n,t,i){var r,u,f;if(arguments.length){for(this.m_type=n,this.m_lstData=t,this.m_dOriginValue=0,this.m_dMinValue=Number.NEGATIVE_INFINITY,this.m_dMaxValue=Number.POSITIVE_INFINITY,this.m_oModele=i,this.m_dOriginValue=0,r=this.isXAxis(),this.m_oModele.m_oParametres.m_bAxeXHorizontal||(r=!r),this.m_orientation=r?EAxisOrientation.HORIZONTAL:this.m_type==EAxisType.Z?undefined:EAxisOrientation.VERTICAL,u=0;u<this.m_lstData.length;++u)f=this.m_lstData[u],f.m_axis=this;this.update(this.m_oModele.m_oParametres)}}function WDChartAxisContinu(){arguments.length&&WDChartAxis.prototype.constructor.apply(this,arguments)}function WDChartCategories(n,t){arguments.length&&(JSONPOO.prototype.constructor.apply(this,[t]),this.m_axis=undefined,this.m_oModele=n,this.m_bEchelleTemporelleReguliere=!1,this.bEchelleTemporelle()&&this.CalculeEchelleTemporelleReguliere())}function WDChartModel(n){if(arguments.length){this.m_oGraphe=n;JSONPOO.prototype.constructor.apply(this,[n.m_oDonnees]);this.m_tabSeriesCountByChartType={};this.m_oParametres=new WDChartParameters(n,n.m_oParametres);this.m_oCategories=new WDChartCategories(this,this.m_oCategories);this.m_lstAxis=undefined;for(var t=0;this.m_tabSeries&&t<this.m_tabSeries.length;++t)this.m_tabSeries[t]=new WDChartSeries(n,this.m_tabSeries[t]),this.m_tabSeriesCountByChartType[this.m_tabSeries[t].getChartType()]=1+(this.m_tabSeriesCountByChartType[this.m_tabSeries[t].getChartType()]||0)}}function EAlgoGestionAltitude(){}function CCouleurAltitude(n){arguments.length&&(JSONPOO.prototype.constructor.apply(this,[{m_tabCouleurAltitude:n.m_tabCouleurAltitude||{},m_eAlgoPalier:n.m_eAlgoPalier||EAlgoGestionAltitude.eagaDegradeLineaire}]),this.m_tabKeysTriees=[],this.Trie())}function WDChartDataSampler(n,t,i,r){arguments.length&&(this.m_oSeries=n,this.m_nSeriesIndex=i,this.m_tabCategoryIndexes=undefined,this.m_nFirstCategoryIndex=-1,this.m_nLastCategoryIndex=-1,this.m_nSampleValuesCount=0,this.m_dYOriginValue=t,this.m_bSeriesOnSecondaryAxis=r)}function Bucket(){this.m_nFirstCategoryIndex=0;this.m_nLastCategoryIndex=0}function WDChartAnimation(n,t){arguments.length&&(this.duration=400,this.easing="swing",this.m_oAnimator=undefined,this.m_oPicture=t,this.m_domEtatInitial=undefined,this.m_oGraphe=n,this.m_dNow=0,this.m_dProgress=0,this.m_dRemainingMS=this.duration,this.queue="fx",this.m_domBaliseAnim=$("<p/>"),this.oStyleCssAnimation={content:1},this.m_bToujoursAvecLibelles=!1)}function WDChartAnimationValeur(n){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.m_oModelePrecedent=n.m_oVue.m_oModelePrecedent===undefined?undefined:n.m_oVue.m_oModelePrecedent,this.duration=600,this.easing="swing")}function WDChartAnimationNoDraw(){arguments.length&&WDChartAnimation.prototype.constructor.apply(this,arguments)}function WDChartAnimator(n){arguments.length&&(this.m_tabAnimations=[],this.m_oGraphe=n,this.m_bDessinComplet=!0)}function WDChartListener(n,t){arguments.length&&(this.m_oVue=n.m_oVue,this.m_oGraphe=n,this.m_chartRenderer=n.m_oVue.m_oRenderer,this.m_domBalise=t)}function WDChartZoom(n,t){(this.m_oRenderer=n,n)&&(n.__bInitZoom(),this.m_oPicture=n.m_oGraphe.m_oVue.m_oPicture,this.m_params=n.m_params,n.bAutoriseZoom())&&(this.m_axisRendererX=n.getAxisRendererForType(EAxisType.X),this.m_axisRendererY=n.getAxisRendererForType(EAxisType.Y),this.m_axisRendererY2=n.getAxisRendererForType(EAxisType.Y2),this.m_dOrigineMinX=undefined,this.m_dOrigineMaxX=undefined,this.m_dUniteMireX=undefined,this.m_dOrigineMinY=undefined,this.m_dOrigineMaxY=undefined,this.m_dUniteMireY=undefined,this.m_dOrigineMinY2=undefined,this.m_dOrigineMaxY2=undefined,this.m_dUniteMireY2=undefined,this.m_bDepuisGrZoom=!1,n.m_oZoom?$.extend(this,n.m_oZoom):t&&this.reset(!0))}function WDPaintCSS(n){this.m_oStyle={};this.m_stRadialGradient=undefined;this.m_stLinearGradient=undefined;this.m_sClasse=undefined;JSONPOO.prototype.constructor.apply(this,[n])}function Path(){this.d=""}function WDPictureSVG(n){arguments.length&&(this.m_Id=n.m_oHoteImage.id,this.m_domBaliseSVG=undefined,this.m_domDefsSVG=undefined,this.m_tabClipActif=[],this.m_bDessinDirectementDansLaPage=!1,this.m_b3DActive=!1,this.m_b3DInnerOuterDansPartEffet=!1,this.m_oGraphe=undefined,this.m_tabCache=[],this.m_bAncrageLargeur=!1,this.m_bAncrageHauteur=!1,this.m_tabId={})}function WDSvgAnimation(n,t,i,r,u,f){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.m_domBalise=i,this.m_oAttributsAvant=r,this.m_oAttributs=u,this.m_oPicture=t,this.duration=100,this.easing="linear",this.queue=sGetFunctionName(this.constructor),this.m_domBaliseAnim=this.m_domBalise,this.ArreteEtVideAnimations(this.m_domBaliseAnim),this.m_fFinAnimation=undefined,f&&(this.oStyleCssAnimation=f))}function WDSvgAnimationGridLine(n){arguments.length&&(WDSvgAnimation.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation,WDSvgAnimationGridLine.ms_bActiveAnimation!==!0&&(this.duration=0))}function WDSvgAnimationBulle(n,t){if(arguments.length){WDSvgAnimation.prototype.constructor.apply(this,arguments);this.duration=WDSvgAnimationBulle.gbEase==!0?200:150;var i=(n||t.m_oGraphe).m_oModele.m_oParametres.getType();(i==WDChartParameters.kSecteur||i==WDChartParameters.kDonut||i==WDChartParameters.kHemicycle)&&(this.duration=200);this.easing=WDSvgAnimationBulle.gbEase==!0?"easeOutExpo":"linear"}}function WDSvgAnimationLegende(){arguments.length&&(WDSvgAnimation.prototype.constructor.apply(this,arguments),this.duration=600,this.easing="easeOutExpo")}function WDChartRenderer(){arguments.length&&(this.m_oPaint=undefined,this.m_oGraphe=undefined,this.m_rectChart=undefined,this.m_rectChartInitial=undefined,this.m_dInitialStartAngle=0,this.m_domGroupeSeries=undefined,this.m_domGroupeLegendeEtTitre=undefined,this.m_domBulle=undefined)}function WDChartXYAnimationValeur(){arguments.length&&(WDChartAnimationValeur.prototype.constructor.apply(this,arguments),this.m_bDejaRelativise=!1)}function WDXYChartAnimator(){arguments.length&&WDChartAnimator.prototype.constructor.apply(this,arguments)}function WDHeatmapChartAnimator(){arguments.length&&WDXYChartAnimator.prototype.constructor.apply(this,arguments)}function WDChartAnimationValeurHeatMap(){arguments.length&&WDChartAnimationValeur.prototype.constructor.apply(this,arguments)}function WDPieChartAnimator(){arguments.length&&WDChartAnimator.prototype.constructor.apply(this,arguments)}function WDPieChartZoomAnimation(n,t,i,r){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.duration=200,this.easing="easeInOutQuint",this.m_bIn=i,this.m_dZoom=1+(this.m_bIn?1:-1)*.1*(r||1))}function WDPieChartAnimationSurbrillancePartNoDraw(n,t,i,r){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.m_domPartEnSurbrillance=r,this.m_bEtat=i,this.m_nEcart=10,this.m_nEcartInitial=r.parent().wbData("wbGrfAnimSurbrillanceEcart")||0,this.duration=200,this.easing="swing")}function WDPieChartAnimationSelectionLegende(n,t,i){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.m_domPartSelectionne=i,this.m_nIndiceValeurDansSerie=WDPieChartRenderer.nGetIndicePart(t,this.m_domPartSelectionne),this.m_bAffiche=!this.m_oGraphe.m_oVue.toggleSerieMasquee(this.m_nIndiceValeurDansSerie),this.duration=1e3,this.easing="easeOutExpo")}function WDPieChartAnimationSurbrillancePart(n,t,i,r){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.m_domPartEnSurbrillance=r,this.m_bEtat=i,this.duration=this.m_bEtat?1:1,this.easing="swing")}function WDPieChartAnimation1erAffichageBase(n){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation>0?n.m_oModele.m_oParametres.m_nDureeAnimation:1500,this.easing="easeOutExpo")}function WDPieChartAnimation1erAffichageArretDuVinyle(){arguments.length&&(WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments),this.m_dPourcentRotation=.2)}function WDPieChartAnimationSelectionPart(n,t,i){if(arguments.length){WDChartAnimation.prototype.constructor.apply(this,arguments);this.m_dAngleAffichage=90;this.m_dAngleInitial=n.m_oVue.m_oRenderer.getInitialStartAngle(n.m_oVue.m_oRenderer.m_params);var r=i.wbData("wbGrfDrawPath");for(this.m_dAngleFinal=(this.m_dAngleAffichage-(r.options.startAngle-r.options.firstAngle+r.options.sweep/2))%360;(this.m_dAngleInitial>this.m_dAngleFinal?this.m_dAngleInitial-this.m_dAngleFinal:this.m_dAngleFinal-this.m_dAngleInitial)>180;)this.m_dAngleInitial>this.m_dAngleFinal?this.m_dAngleFinal+=360:this.m_dAngleInitial+=360}}function WDPieChartAnimation1erAffichageWindevLike(){arguments.length&&(WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments),this.m_dPourcentRotation=0,this.easing="swing")}function WDPieChartAnimation1erAffichageClipPath(){arguments.length&&WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments)}function WDPieChartAnimation1erAffichageAngleFinCroissant(n){arguments.length&&(WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments),this.duration=1e3,this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",n.m_oVue.m_oRenderer.m_rectChart))}function WDPieChartAnimationTourneNoDraw(n,t,i){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.m_nAngle=i)}function WDRadarChartAnimator(n){if(arguments.length){WDXYChartAnimator.prototype.constructor.apply(this,arguments);var i=n.m_oVue.m_oPicture,t=i.m_Id;n.m_oVue.m_oRenderer.m_domStyle=$(('<style class="wbGrfRadarChartAnimator'+t+'">#-groupe-series > g, #-groupe-series > g text{    transition:opacity 300ms; }/*#-groupe-series:hover > g,*/#-groupe-series.wbGrfHover > g{    opacity:0.2;        transition-delay:150ms;}/*#-groupe-series:hover > g text,*/#-groupe-series.wbGrfHover > g text{    opacity:0;        transition-delay:150ms;}/*#-groupe-series:hover > g:hover, */#-groupe-series.wbGrfHover > g.wbGrfHover{    opacity:1;    transition-delay:0;    }/*#-groupe-series:hover > g:hover text, */#-groupe-series.wbGrfHover > g.wbGrfHover text {    opacity:1;        transition-delay:0;    }<\/style>').replace(/\#/g,"#"+t));$("head").append(n.m_oVue.m_oRenderer.m_domStyle)}}function WDSunburstChartAnimator(){arguments.length&&WDPieChartAnimator.prototype.constructor.apply(this,arguments)}function WDSunburstChartAnimation1erAffichage(n){arguments.length&&(WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments),this.duration=600,this.easing="linear",this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",n.m_oVue.m_oRenderer.m_rectChart))}function WDSunburstChartAnimation1erAffichageEventailNoDraw(n){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation>0?n.m_oModele.m_oParametres.m_nDureeAnimation:600,this.easing="swing")}function WDSunburstChartAnimationSurbrillancePartNoDraw(n,t,i,r){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.m_domPartEnSurbrillance=r,this.m_bEtat=i,this.m_nEcart=.975,this.m_nEcartInitial=r.parent().wbData("wbGrfAnimSurbrillanceEcart")||1,this.duration=200,this.easing="swing",this.svgTexte=r.wbData("wbGrfNode").svgTexte)}function WDChartMireListener(n,t,i){if(arguments.length){WDChartListener.prototype.constructor.apply(this,arguments);this.m_domBulle=i;var r=this;$(window).keyup(function(){r.keyup.apply(r.m_domBalise,arguments)});n.m_oVue.m_oPicture.m_domBaliseSVG.swipe({pinchIn:r.pinchIn,pinchOut:r.pinchOut,pinchStatus:r.pinchStatus,doubleTap:r.dblclick,tap:function(){},swipeStatus:r.swipeStatus,pinchThreshold:0,preventDefaultEvents:!1})}}function WDPieChartSelectionnePartListenerBase(){arguments.length&&WDChartListener.prototype.constructor.apply(this,arguments)}function WDPieChartPartListener(){arguments.length&&(WDPieChartSelectionnePartListenerBase.prototype.constructor.apply(this,arguments),this.m_domLegende=undefined)}function WDPieChartLegendListener(){arguments.length&&(WDPieChartSelectionnePartListenerBase.prototype.constructor.apply(this,arguments),this.m_domPart=undefined)}function WDSunburstChartPartListener(){arguments.length&&WDPieChartPartListener.prototype.constructor.apply(this,arguments)}function WDXYChartLegendListener(n,t,i,r){arguments.length&&(WDChartListener.prototype.constructor.apply(this,arguments),this.m_domLegende=t,this.m_domGroupeSerie=i,this.m_nIndexSerie=r)}function WDHeatmapChartLegendListener(n,t,i,r){arguments.length&&(WDXYChartLegendListener.prototype.constructor.apply(this,arguments),this.m_domLegende=t,this.m_domGroupeSerie=i,this.m_nIndexSerie=r)}function WDRadarChartLegendListener(n,t,i,r){arguments.length&&(WDXYChartLegendListener.prototype.constructor.apply(this,arguments),this.m_domLegende=t,this.m_domGroupeSerie=i,this.m_nIndexSerie=r)}function WDBarreBoutonOnOffGraphe(n,t,i){arguments.length&&WDBarreBoutonOnOff.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i]])}function WDBarreBoutonGraphe(n,t,i){arguments.length&&WDBarreBouton.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i]])}function WDBarreOutilsGraphe(n,t){arguments.length&&(WDBarre.prototype.constructor.apply(this,t),this.m_oGraphe=n,this.m_tabDescBarre=[{nType:0,sSuf:"GDH",sCom:"GDH"},{nType:0,sSuf:"GDV",sCom:"GDV"},{nType:0,sSuf:"SMO",sCom:"SMO"},{nType:0,sSuf:"GRA",sCom:"GRA"},{nType:0,sSuf:"RAI",sCom:"RAI"},{nType:0,sSuf:"ANT",sCom:"ANT"},{nType:0,sSuf:"TRA",sCom:"TRA"},{nType:2,sSuf:"SAV",sCom:"OnSave",tabP:[]},{nType:2,sSuf:"PRI",sCom:"OnPrint",tabP:[]},{nType:5,sSuf:"PIE",sCom:"OnOption",tabP:["P","H","D","E"]},{nType:5,sSuf:"COL",sCom:"OnOption",tabP:["C","S","HC","HS","W"]},{nType:5,sSuf:"CUR",sCom:"OnOption",tabP:["C","S","A","R","B","H"]},{nType:5,sSuf:"STO",sCom:"OnOption",tabP:["C","B","M"]},{nType:4,sSuf:"LEG",sCom:"OnOption",tabP:["S","D","G","H","B"]},{nType:0,sSuf:"ANI",sCom:"ANI"},{nType:0,sSuf:"INT",sCom:"INT"},{nType:5,sSuf:"MIR",sCom:"OnOption",tabP:["MUL","MIR","BUL"]}],this.m_tabConversionCom={PIE:"TYP",COL:"TYP",CUR:"TYP",STO:"TYP",LEG:"LEG",MIR:"MIR"},this.m_tabConversionVal={PIE:[0,26,23,33,36],COL:[1,9,27,28,35],CUR:[2,5,24,25,32,37],STO:[6,7,8],LEG:[0,1,2,3,4],MIR:[0,1,2]})}function WDBurger(n){arguments.length&&(WDBarreOutilsGraphe.prototype.constructor.apply(this,arguments),this.m_jqUlMenu=undefined,this.m_jqDivPositionBurger=undefined,this.m_jqBurger=undefined,this.jqZoomHorizontalSaisie=undefined,this.jqZoomVerticalSaisie=undefined,this.m_bAvecTitreDeplacable=!bTouch,this.bAvecHistorique=bTouch&&window.onpopstate!==undefined&&window.history&&window.history.pushState,this.bAvecHistorique&&window.history.pushState({trigger:"trigger.wb.grf.burger.ferme"},document.title),this.m_bRetireOptionsNonSupporteesEnInteractif=n.m_bRetireOptionsNonSupporteesEnInteractif)}function WDChartAxisRenderer(n){arguments.length&&(this.m_axis=undefined,this.m_tabGraduationLabels=[],this.m_dStep=0,this.m_dLeftOverflow=0,this.m_dRightOverflow=0,this.m_dTopOverflow=0,this.m_dBottomOverflow=0,this.m_nNbPositiveGraduations=0,this.m_nNbNegativeGraduations=0,this.m_bVerticalOrientationLabel=!1,this.m_chartRenderer=n)}function WDFunnelChartRenderer(n){arguments.length&&(WDChartRenderer.prototype.constructor.apply(this,arguments),n.m_oVue.m_oModelePrecedent=undefined,this.m_nHauteurEmbout=0,this.m_nLargeurEmbout=0,this.m_nAireTotaleUtile=0,this.m_dSommeValeurs=0,this.m_clRectCalcul=this.m_rectChart,this.m_clTabPortions=[],this.m_ProtoLegendListener=WDPieChartPartListener)}function WDFunnelChartAnimator(){arguments.length&&WDChartAnimator.prototype.constructor.apply(this,arguments)}function WDFunnelChartAnimationSurbrillancePartNoDraw(n,t,i,r){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.m_domPartEnSurbrillance=r,this.m_bEtat=i,this.m_nEchelle=n.m_oVue.m_oRenderer.m_params.m_nEspacement,this.m_nEchelleInitiale=r.wbData("wbGrfAnimSurbrillanceEcart")||0,this.duration=200,this.easing="swing")}function WDFunnelChartAnimation1erAffichageCoulissantNoDraw(n){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation>0?n.m_oModele.m_oParametres.m_nDureeAnimation:1500,this.easing="swing")}function WDFunnelChartAnimationValeur(n){arguments.length&&(WDChartAnimationValeur.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation>0?n.m_oModele.m_oParametres.m_nDureeAnimation:1500,this.easing="easeOutExpo",this.duration=1e3,this.easing="swing")}function WDPieChartRenderer(){arguments.length&&(WDChartRenderer.prototype.constructor.apply(this,arguments),this.m_nCenterX=0,this.m_nCenterY=0,this.m_nRadius=0,this.m_dTotalValue=0,this.tabLabelRenderers=undefined,this.m_ProtoLegendListener=WDPieChartPartListener)}function WDLabelRenderer(n,t,i,r){arguments.length&&(this.m_oRenderer=n,this.m_strValueLabel=undefined,this.m_bValueLabel=!1,this.m_strCategoryLabel=undefined,this.m_bCategoryLabel=!1,this.m_strPercentLabel=undefined,this.m_bPercentLabel=!1,this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT,this.m_dAngleR=0,this.m_dWidth=0,this.m_nIndice=r,this.setAngle(t,i))}function WDXYChartRenderer(){arguments.length&&(WDChartRenderer.prototype.constructor.apply(this,arguments),this.m_tabAxisRenderer=[],this.m_rectAxis=new WDRect,this.m_nXOrigin=0,this.m_nYOrigin=0,this.m_nX2Origin=0,this.m_nY2Origin=0,this.m_dXPixelsPerUnit=0,this.m_dX2PixelsPerUnit=0,this.m_dYPixelsPerUnit=0,this.m_dY2PixelsPerUnit=0,this.m_timeScale=ETimeScale.NONE,this.m_mapSeriesRenderer={},this.m_dRayonMaxBulle=0,this.m_dValeurMaxZ=0)}function WDXYChartAxisRenderer(){arguments.length&&WDChartAxisRenderer.prototype.constructor.apply(this,arguments)}function WDXYChartSeriesRenderer(n,t,i){arguments.length&&(JSONPOO.prototype.constructor.apply(this,[{}]),this.m_chartRenderer=t,this.m_model=i,this.m_ProtoLegendListener=WDXYChartLegendListener)}function WDSunburstChartRenderer(){arguments.length&&(WDPieChartRenderer.prototype.constructor.apply(this,arguments),this.m_ProtoLegendListener=WDSunburstChartPartListener,this.bAvecTween=!1)}function WDSunburstLabelRenderer(){arguments.length&&(WDLabelRenderer.prototype.constructor.apply(this,arguments),this.tabLongueurLibelles=[],this.m_oNode=undefined,this.nLineHeight=0)}function WDBarChartSeriesRenderer(){arguments.length&&(WDXYChartSeriesRenderer.prototype.constructor.apply(this,arguments),this.m_tabCumulatedValues=undefined,this.m_nBarWidth=0,this.m_nBarSpacing=0,this.m_barRect=new WDRect)}function WDCandleStickChartSeriesRenderer(){arguments.length&&WDBarChartSeriesRenderer.prototype.constructor.apply(this,arguments)}function WDWaterfallChartSeriesRenderer(){arguments.length&&WDBarChartSeriesRenderer.prototype.constructor.apply(this,arguments)}function ELineStyle(){}function WDLineChartSeriesRenderer(){arguments.length&&WDXYChartSeriesRenderer.prototype.constructor.apply(this,arguments)}function WDAreaChartSeriesRenderer(){arguments.length&&WDLineChartSeriesRenderer.prototype.constructor.apply(this,arguments)}function WDRadarChartRenderer(n){arguments.length&&(WDXYChartRenderer.prototype.constructor.apply(this,arguments),n.m_oVue.m_oModelePrecedent=undefined,this.m_nRayon=0,this.m_dAngleDelta=0,this.m_nNombreCategories=0,this.m_clCentreRadar={x:0,y:0},this.m_dValeurMin=0,this.m_dValeurMax=0,this.m_dFacteurEchelle=0,this.m_dPas=0,this.m_nGradMin=0,this.m_nGradMax=0)}function WDRadarChartSeriesRenderer(){arguments.length&&(WDAreaChartSeriesRenderer.prototype.constructor.apply(this,arguments),this.m_ProtoLegendListener=WDRadarChartLegendListener)}function WDScatterChartSeriesRenderer(){arguments.length&&WDLineChartSeriesRenderer.prototype.constructor.apply(this,arguments)}function WDBubbleChartSeriesRenderer(){arguments.length&&WDScatterChartSeriesRenderer.prototype.constructor.apply(this,arguments)}function WDHeatmapChartRenderer(){arguments.length&&(WDXYChartRenderer.prototype.constructor.apply(this,arguments),this.m_dValeurMinZ=0,this.m_dValeurMaxZ=0,this.m_clCouleurAltitudeHeatMap=undefined)}function WDHeatmapChartSeriesRenderer(){arguments.length&&(WDScatterChartSeriesRenderer.prototype.constructor.apply(this,arguments),this.m_ProtoLegendListener=WDHeatmapChartLegendListener)}function WDHeatMapChartAxisRenderer(){arguments.length&&WDXYChartAxisRenderer.prototype.constructor.apply(this,arguments)}var VALEUR_EPSILON;IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE=0;IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE=1;IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT=2;IWDConstante.ALIGNEMENT_HORIZONTAL_JUSTIFIE=3;IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE_PICTO_GAUCHE=4;IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE_PICTO_DROITE=5;IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE_PICTO_GAUCHE=6;IWDConstante.ALIGNEMENT_HORIZONTAL_DROITE_PICTO_DROITE=7;Align.LEFT=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE;Align.CENTER=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE;Align.RIGHT=IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT;IWDConstante.ALIGNEMENT_VERTICAL_HAUT=0;IWDConstante.ALIGNEMENT_VERTICAL_CENTRE=1;IWDConstante.ALIGNEMENT_VERTICAL_BAS=2;IWDChartConstant.DEFAULT_VALUE=-2e9;IWDChartConstant.SPECIAL_VALUE=-Math.pow(2,31);IWDChartConstant.NULL_VALUE=undefined;IWDChartConstant.FLAG_LEGEND_POSITION_NONE=0;IWDChartConstant.FLAG_LEGEND_POSITION_LEFT=1;IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT=2;IWDChartConstant.FLAG_LEGEND_POSITION_TOP=4;IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM=8;IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL=16;IWDChartConstant.FLAG_LEGEND_POSITION_MASK=31;IWDChartConstant.FLAG_LEGEND_LABEL_IN_ROW=32;IWDChartConstant.FLAG_LEGEND_ADAPT_SIZE=64;IWDChartConstant.FLAG_LEGEND_ROUNDED_BORDER=128;IWDChartConstant.FLAG_TITLE_POSITION_NONE=0;IWDChartConstant.FLAG_TITLE_POSITION_TOP=256;IWDChartConstant.FLAG_TITLE_POSITION_BOTTOM=512;IWDChartConstant.FLAG_TITLE_POSITION_MANUAL=1024;IWDChartConstant.FLAG_TITLE_POSITION_MASK=1792;IWDChartConstant.FLAG_AXIS_LABEL_ORIENTATION_AUTO=0;IWDChartConstant.FLAG_X_AXIS_LABEL_ORIENTATION_VERTICAL=4096;IWDChartConstant.FLAG_X_AXIS_LABEL_ORIENTATION_HORIZONAL=8192;IWDChartConstant.FLAG_X_AXIS_LABEL_ORIENTATION_MASK=12288;IWDChartConstant.FLAG_Y_AXIS_LABEL_ORIENTATION_VERTICAL=16384;IWDChartConstant.FLAG_Y_AXIS_LABEL_ORIENTATION_HORIZONAL=32768;IWDChartConstant.FLAG_Y_AXIS_LABEL_ORIENTATION_MASK=49152;IWDChartConstant.FLAG_VERTICAL_GRID=65536;IWDChartConstant.FLAG_HORIZONTAL_GRID=131072;IWDChartConstant.FLAG_ANTIALIASING=262144;IWDChartConstant.FLAG_BORDER_COLOR_AUTO=524288;IWDChartConstant.FLAG_NO_GRADIENT=0;IWDChartConstant.FLAG_VERTICAL_GRADIENT=1048576;IWDChartConstant.FLAG_HORIZONTAL_GRADIENT=2097152;IWDChartConstant.FLAG_GRADIENT_MASK=3145728;IWDChartConstant.FLAG_NULL_VALUES_NOT_DRAWN=0;IWDChartConstant.FLAG_NULL_VALUES_IGNORED=4194304;IWDChartConstant.FLAG_NULL_VALUES_BACK_TO_ZERO=8388608;IWDChartConstant.FLAG_NULL_VALUES_MASK=12582912;IWDChartConstant.FLAG_ZOOM_NONE=0;IWDChartConstant.FLAG_ZOOM_HORIZONTAL=16777216;IWDChartConstant.FLAG_ZOOM_VERTICAL=33554432;IWDChartConstant.FLAG_ZOOM_MASK=50331648;IWDChartConstant.FLAG_LINE_SMOOTING=67108864;IWDChartConstant.FLAG_SHOW_VALUES_LABEL=134217728;IWDChartConstant.FLAG_BAR_CHART_STACKED=268435456;IWDChartConstant.FLAG_SHOW_CATEGORIES_LABEL=536870912;IWDChartConstant.FLAG_SHOW_PERCENTAGE=1073741824;IWDChartConstant.FLAG_HIDE_NULL_VALUES=2147483648;IWDChartConstant.FLAG_X_AXIS_TIME_SCALE=4294967296;IWDChartConstant.ReInitModeCompact=function(n){IWDChartConstant.DESSIN_COMPACT=n;IWDChartConstant.MARGIN_BORDER=7;IWDChartConstant.MARGIN_AXIS_TITLE_SECONDARY=IWDChartConstant.DESSIN_COMPACT?3:5;IWDChartConstant.MARGIN_AXIS_TITLE=8+IWDChartConstant.MARGIN_AXIS_TITLE_SECONDARY;IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL=4;IWDChartConstant.MARGIN_HORIZONTAL_GRADUATION_LABEL=4;IWDChartConstant.MARGIN_TITLE_GRAPH=IWDChartConstant.DESSIN_COMPACT?4:10;IWDChartConstant.MARGIN_LEGEND_BORDER=IWDChartConstant.DESSIN_COMPACT?4:10;IWDChartConstant.MARGIN_LEGEND_ELEMENTS=IWDChartConstant.DESSIN_COMPACT?4:10;IWDChartConstant.MARGIN_PIE=IWDChartConstant.DESSIN_COMPACT?3:5;IWDChartConstant.MARGIN_LABEL_PIE=IWDChartConstant.DESSIN_COMPACT?8:10;IWDChartConstant.MARGIN_LABEL=5;IWDChartConstant.MARGIN_LABEL_HORIZ=IWDChartConstant.MARGIN_LABEL;IWDChartConstant.LEGEND_SQUARE_SIZE=IWDChartConstant.DESSIN_COMPACT?4:10};IWDChartConstant.ReInitModeCompact(!1);IWDChartConstant.GRADUATION_MIN_SIZE_Y=25;IWDChartConstant.GRADUATION_MIN_SIZE_X_HORIZONTAL=20;IWDChartConstant.GRADUATION_MIN_SIZE_X_VERTICAL=10;IWDChartConstant.GRADUATION_TICK_SIZE=3;IWDChartConstant.BAR_MIN_WIDTH=5;IWDChartConstant.BAR_MIN_SPACING=1;IWDChartConstant.GR_COULEUR_AXE=0;IWDChartConstant.GR_COULEUR_AXE_RELIEF=1;IWDChartConstant.GR_COULEUR_QUADRILLAGE=2;IWDChartConstant.GR_COULEUR_QUADRILLAGE_RELIEF=3;IWDChartConstant.GR_COULEUR_LEGENDE=4;IWDChartConstant.GR_COULEUR_LEGENDE_FOND=5;IWDChartConstant.GR_COULEUR_BORDURE=6;IWDChartConstant.GR_COULEUR_CHANDELIER_HAUSSIER=7;IWDChartConstant.GR_TOUTES_SERIES=0;IWDChartConstant.GR_ORDONNEE=0;IWDChartConstant.GR_ABSCISSE=1;IWDChartConstant.GR_ORDONNEE_SECONDAIRE=2;IWDChartConstant.GR_SANS=0;IWDChartConstant.GR_DROITE=1;IWDChartConstant.GR_GAUCHE=2;IWDChartConstant.GR_HAUT=3;IWDChartConstant.GR_BAS=4;IWDChartConstant.GR_AFFICHE_VALEUR=0;IWDChartConstant.GR_AFFICHE_POURCENTAGE=1;IWDChartConstant.GR_AFFICHE_ETIQUETTE=2;IWDChartConstant.GR_AFFICHE_VALEUR_SI_NULLE=3;IWDChartConstant.GR_MASQUE_VALEUR=0;IWDChartConstant.GR_MASQUE_POURCENTAGE=1;IWDChartConstant.GR_MASQUE_AXE=2;IWDChartConstant.GR_PROGRAMMATION=0;IWDChartConstant.GR_FONCTION=1;IWDChartConstant.GR_RUBRIQUE=2;IWDChartConstant.GR_TABLEAU=3;IWDChartConstant.GR_LISTE=4;IWDChartConstant.GR_DONNEES=-1;IWDChartConstant.GR_DONNEES_ET_STYLE=-2;IWDChartConstant.GR_SECTEUR=0;IWDChartConstant.GR_HISTO=1;IWDChartConstant.GR_COURBE=2;IWDChartConstant.GR_HISTO_EMPILE=9;IWDChartConstant.GR_DONUT=23;IWDChartConstant.GR_AIRE=24;IWDChartConstant.GR_MIN=-20001;IWDChartConstant.GR_MAX=-20002;IWDChartConstant.GR_AXE_X=-10001;IWDChartConstant.GR_AXE_Y=-10002;IWDChartConstant.GR_SERIE=0;IWDChartConstant.GR_CATEGORIE=1;IWDChartConstant.GR_VALEUR=2;IWDChartConstant.GR_VALEUR_MIN=IWDChartConstant.GR_VALEUR;IWDChartConstant.GR_VALEUR_MAX=3;IWDChartConstant.GR_VALEUR_DEBUT=4;IWDChartConstant.GR_VALEUR_FIN=5;IWDChartConstant.GR_CHEMIN=6;IWDChartConstant.GR_VALEUR_X=IWDChartConstant.GR_VALEUR_MIN;IWDChartConstant.GR_VALEUR_Y=IWDChartConstant.GR_VALEUR_MAX;eGRAPHEINFOXY_COORD.eGRCOORDX=-1;eGRAPHEINFOXY_COORD.eGRCOORDY=-2;eGRAPHEINFOXY_COORD.eGRCOORDY2=-3;ETimeScale.DATE=0;ETimeScale.TIME=1;ETimeScale.DATETIME=2;ETimeScale.DUREE=3;ETimeScale.NONE=4;eDESSINVALEURNULLE.eValeurNulleNonDessinee=0;eDESSINVALEURNULLE.eValeurNulleIgnoree=1;eDESSINVALEURNULLE.eValeurNulleAZero=2;ETypeCategorieWaterfall.eWaterfallDefaut=0;ETypeCategorieWaterfall.eWaterfallTotal=1;ETypeCategorieWaterfall.eWaterfallSousTotal=2;ETypeCategorieWaterfall.eWaterfallPositif=3;ETypeCategorieWaterfall.eWaterfallNegatif=4;typeof Number.prototype.toRad=="undefined"&&(Number.prototype.toRad=function(n){return(n?this%360:this)*Math.PI/180},Number.prototype.toDeg=function(n){return(n?this%360:this)*(180/Math.PI)});stPath.prototype.constructor=stPath();stPath.prototype.set=function(n,t,i,r,u){this.x=n;this.y=t;this.width=i;this.height=r;this.options=u};EPointStyle.NONDEFINI=-2;EPointStyle.NONE=-1;EPointStyle.CIRCLE=0;EPointStyle.DIAMOND=1;EPointStyle.TRIANGLE=2;EPointStyle.SQUARE=3;EPointStyle.CROSS=4;ERepereGrapheOrthonorme.ergNonOrthonorme=0;ERepereGrapheOrthonorme.ergXYPrimaireOrthonorme=1;ERepereGrapheOrthonorme.ergXYSecondaireOrthonorme=2;eGRAPHEAXE.kOrdonnee=0;eGRAPHEAXE.kAbscisse=1;eGRAPHEAXE.kOrdonneeSecondaire=2;eGRAPHEAXE.kAltitude=3;VALEUR_EPSILON=1e-6;WDGraphe.prototype=new WDChampParametresHote;WDGraphe.prototype.constructor=WDGraphe;WDGraphe.prototype.OnDisplay=function(n,t){WDChampParametresHote.prototype.OnDisplay.apply(this,arguments);var i=this.m_oHoteImage&&clWDUtil.bEstFils(this.m_oHoteImage,n);if((i&&t&&this._InitBarreAutomatique(),this.m_oBarreAutomatique.bDejaInitialisee&&WDBarre.prototype.OnDisplay.apply(this.m_oBarreAutomatique,arguments),t)&&this.m_bInteractif&&(this.m_oParametres.m_bInteractif||this.m_tabEtat.INT)){if(!this.m_oHoteImage){$(window).trigger("trigger.wb.grf.1erAffichage");return}this.m_oVue.m_oPicture&&i&&this.m_oVue.m_oPicture.Init(this)&&(this.m_oVue.m_oPicture.m_domBaliseSVG.wbData("wbGrf1erDrawFait",!1),this.m_oVue.m_oAnimator&&(this.m_oVue.m_oAnimator.m_bDessinComplet=!0),this.relanceInitialisation(WDChartView.ms_nDessin1erAffichage))}};WDGraphe.prototype.dGetAxeXMin=function(){if(!this.m_oVue.bEstInteractif())return 0;var n=this.m_oModele.getAxisByType(EAxisType.X);return n?n.m_dMinValue:0};WDGraphe.prototype.dGetAxeXMax=function(){if(!this.m_oVue.bEstInteractif())return 0;var n=this.m_oModele.getAxisByType(EAxisType.X);return n?n.m_dMaxValue:0};WDGraphe.prototype.dGetAxeYMin=function(){if(!this.m_oVue.bEstInteractif())return 0;var n=this.m_oModele.getAxisByType(EAxisType.Y);return n?n.m_dMinValue:0};WDGraphe.prototype.dGetAxeYMax=function(){if(!this.m_oVue.bEstInteractif())return 0;var n=this.m_oModele.getAxisByType(EAxisType.Y);return n?n.m_dMaxValue:0};WDGraphe.prototype.SetTitre=function(n){this.m_oParametres&&(this.m_oParametres.m_sTitre=n,this.relanceInitialisation())};WDGraphe.prototype.sGetTitre=function(){return this.m_oParametres?this.m_oParametres.m_sTitre:""};WDGraphe.prototype.SetDureeAnimation=function(n){this.m_oParametres&&(this.m_oParametres.m_nDureeAnimation=n,this.relanceInitialisation())};WDGraphe.prototype.nGetDureeAnimation=function(){return this.m_oParametres?this.m_oParametres.m_nDureeAnimation:0};WDGraphe.prototype.GetProp=function(n){switch(n){case this.XML_CHAMP_PROP_NUM_OPACITE:return this.m_oVue.bEstInteractif()?this.m_oModele.m_oParametres.byGetAlpha()/2.55:clWDUtil.nGetOpacite(undefined,this.m_oHoteImage);default:return WDChampParametresHote.prototype.GetProp.apply(this,arguments)}};WDGraphe.prototype.SetProp=function(n,t,i){switch(n){case this.XML_CHAMP_PROP_NUM_ETAT:return this.m_oVue.bEstInteractif()&&(this.m_oParametres.m_eEtat=i,this.relanceInitialisation()),WDChampParametresHote.prototype.SetProp.apply(this,arguments);case this.XML_CHAMP_PROP_NUM_COULEURFOND:return this.m_oVue.bEstInteractif()&&(this.m_oParametres.m_sCouleurFond=i,this.relanceInitialisation()),WDChampParametresHote.prototype.SetProp.apply(this,arguments);case this.XML_CHAMP_PROP_NUM_OPACITE:return this.m_oVue.bEstInteractif()?(this.m_oParametres.m_bInterditAlpha=!1,this.m_oParametres.m_byAlpha=i*2.55,this.relanceInitialisation(),1):clWDUtil.nSetOpacite(i,this.m_oHoteImage);default:return WDChampParametresHote.prototype.SetProp.apply(this,arguments)}};WDGraphe.prototype.Init=function(){function u(){n.m_oVue.Init(n);var t=clWDUtil.bEstDisplay(n.m_oHoteImage.parentNode,document);if(t){$(window).on("trigger.wb.ancrage.ie.debut",function(){n.m_oVue&&n.m_oVue.m_oPicture&&n.m_oVue.m_oPicture.OnRecalculAncrageIE(n)});n._InitBarreAutomatique();n.RafBarre(null)}}var t,i,n,r;WDChampParametresHote.prototype.Init.apply(this,arguments);
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
if("document"in self&&(bIEAvec11&&function(n){"use strict";var f;if("Element"in n){var e="classList",t="prototype",o=n.Element[t],r=Object,a=String[t].trim||function(){return this.replace(/^\s+|\s+$/g,"")},v=Array[t].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1},s=function(n,t){this.name=n;this.code=DOMException[n];this.message=t},u=function(n,t){if(t==="")throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return v.call(n,t)},h=function(n){for(var i=a.call(n.getAttribute("class")||""),r=i?i.split(/\s+/):[],t=0,u=r.length;t<u;t++)this.push(r[t]);this._updateClassName=function(){n.setAttribute("class",this.toString())}},i=h[t]=[],c=function(){return new h(this)};if(s[t]=Error[t],i.item=function(n){return this[n]||null},i.contains=function(n){return n+="",u(this,n)!==-1},i.add=function(){var t=arguments,i=0,f=t.length,n,r=!1;do n=t[i]+"",u(this,n)===-1&&(this.push(n),r=!0);while(++i<f);r&&this._updateClassName()},i.remove=function(){var i=arguments,r=0,e=i.length,t,f=!1,n;do for(t=i[r]+"",n=u(this,t);n!==-1;)this.splice(n,1),f=!0,n=u(this,t);while(++r<e);f&&this._updateClassName()},i.toggle=function(n,t){n+="";var i=this.contains(n),r=i?t!==!0&&"remove":t!==!1&&"add";return r&&this[r](n),t===!0||t===!1?t:!i},i.toString=function(){return this.join(" ")},r.defineProperty){f={get:c,enumerable:!0,configurable:!0};try{r.defineProperty(o,e,f)}catch(l){(l.number===undefined||l.number===-2146823252)&&(f.enumerable=!1,r.defineProperty(o,e,f))}}else r[t].__defineGetter__&&o.__defineGetter__(e,c)}}(self),function(){"use strict";var n=document.createElement("_"),t,i;n.classList.add("c1","c2");n.classList.contains("c2")||(t=function(n){var t=DOMTokenList.prototype[n];DOMTokenList.prototype[n]=function(n){for(var r=arguments.length,i=0;i<r;i++)n=arguments[i],t.call(this,n)}},t("add"),t("remove"));n.classList.toggle("c3",!1);n.classList.contains("c3")&&(i=DOMTokenList.prototype.toggle,DOMTokenList.prototype.toggle=function(n,t){return 1 in arguments&&!this.contains(n)==!t?t:i.call(this,n)});n=null}()),jQuery.Tween.propHooks.content={get:function(){return 0},set:function(){}},jQuery.Tween.propHooks.opacity={get:function(n){return n.elem.wbOpacity||1},set:function(n){n.elem.style.opacity=n.elem.wbOpacity=n.now}},t={},$.cssHooks.width||($.cssHooks.width={}),t.width=$.cssHooks.width,$.cssHooks.width={get:function(n){return(n instanceof SVGElement)?n.getBoundingClientRect().width:t.width.get?t.width.get.apply(this,arguments):n.offsetWidth},set:$.cssHooks.width.set},$.cssHooks.height||($.cssHooks.height={}),t.height=$.cssHooks.height,$.cssHooks.height={get:function(n){return(n instanceof SVGElement)?n.getBoundingClientRect().height:t.height.get?t.height.get.apply(this,arguments):n.offsetHeight},set:$.cssHooks.height.set},$.cssHooks.opacity||($.cssHooks.opacity={}),t.opacity=$.cssHooks.opacity,$.cssHooks.opacity={get:function(n,t){if(t){var i=n.wbOpacity!==undefined?n.wbOpacity:n.style.opacity;return n.wbOpacity=i===""?"1":i,n.wbOpacity}},set:function(n,t){n.wbOpacity=n.style.opacity=t}},i=jQuery.camelCase,jQuery.camelCase=function(n){return n.indexOf("-")===-1?n:i(n)},$.fn.wbRemoveData=$.fn.removeData,$.fn.wbData=$.fn.data,$.fn.wbDataObj=$.fn.data,n=this,r=this.m_oHoteImage&&this.m_oHoteImage.parentNode,!r){$(window).one("trigger.wb.grf.1erAffichage",function(){n.Init()});return}if($(".wbAndrageIEChargement1erAffichage").length){$(window).one("trigger.wb.ancrage.ie.1erAffichageApresAncrage",u);return}u()};WDGraphe.prototype._vLiaisonHTML=function(n,t){n="";t="";WDChampParametresHote.prototype._vLiaisonHTML.apply(this,[n,t]);
//! arguments car les params ont \u00e9t\u00e9 modifi\u00e9s
this.m_oHoteImage=this.m_oHote;WDBarre.prototype._vLiaisonHTML.apply(this.m_oBarreAutomatique,[n,t]);
//! arguments car les params ont \u00e9t\u00e9 modifi\u00e9s	
};WDGraphe.prototype._InitBarreAutomatique=function(){this.m_oBarreAutomatique.bDejaInitialisee||this.m_oBarreAutomatique.Init(this);this.m_oBarreAutomatique.bDejaInitialisee=!0};WDGraphe.prototype._voNewBoutonOnOff=function(n,t){return this.m_oBarreAutomatique._voNewBoutonOnOff(n,t)};WDGraphe.prototype._voNewBoutonAction=function(n,t){return this.m_oBarreAutomatique._voNewBoutonAction(n,t)};WDGraphe.prototype._voNewBoutonMenu=function(n,t){this.m_oBarreAutomatique._voNewBoutonMenu(n,t)};WDGraphe.prototype._voNewBoutonMenuS=function(n,t){return this.m_oBarreAutomatique._voNewBoutonMenu(n,t)};WDGraphe.prototype.RafBarre=function(n,t,i){this.m_oBarreAutomatique.RafBarre(n,t,i)};WDGraphe.prototype.RafBarreMMove=function(n){this.m_oBarreAutomatique.RafBarreMMove(n)};WDGraphe.prototype.bActif=function(n){return this.m_tabEtat[n[0]]};WDGraphe.prototype.ExecuteCommande=function(n,t){this.m_tabEtat[t[0]]=this.m_tabEtat[t[0]]?0:1;this.m_oVue.ExecuteCommande(this);this.RafBarre(n,!0,!0)};WDGraphe.prototype.OnOption=function(n,t){var r=!1,i;if(clWDUtil.isArray(t[0]))for(i=0;i<t.length;++i)t[i][0][0]==="Z"&&(r=!0),this.m_tabEtat[t[i][0]]=t[i][1];else t[0][0]==="Z"&&(r=!0),this.m_tabEtat[t[0]]=t[1];this.m_oVue.OnOption(this,r);this.RafBarre(n,!0,!0)};WDGraphe.prototype.bActifOption=function(n,t){return this.m_tabEtat[t[0]]==t[1]};WDGraphe.prototype.OnSave=function(){this.m_oVue.OnSave(this)};WDGraphe.prototype.OnPrint=function(){this.m_oVue.OnPrint(this)};WDGraphe.prototype.sGetRequete=function(n){function h(n){var t=n.split("&");clWDUtil.bForEach(t,function(n){return tabComposantes=n.split("="),i(tabComposantes[0],tabComposantes.splice(1).join("=")),!0})}function i(n,t,i){var r=s[n];if(undefined!==r){if(!i)return}else r=o.length,s[n]=r;o[r]=n+(t?"="+t:"")}var e,o=[],s={},r=this.m_sURLBase,t=r.indexOf("?"),u,f;return-1==t?e=r:(e=r.substr(0,t),h(r.substr(t+1),!0)),this.m_oBarreAutomatique.m_oBarre&&(i("WD_ACTION_",n?"GRAPHESAUVE":"GRAPHEPARAM",!0),i("WD_BUTTON_CLICK_",this.m_sAliasChamp,!0)),i("WD_PARAM_",this._vsConstruitParam(),!0),i(this.m_sAliasChamp,(new Date).getTime(),!0),u=this.m_oHoteImage,u&&(f=String(u.src||u.getAttribute("data-src")),f&&(t=f.indexOf("?"),-1!=t&&h(f.substr(t+1),!1))),e+"?"+o.join("&")};WDGraphe.prototype._vsConstruitParam=function(){var n=[],t=WDChamp.prototype._vsConstruitParam.apply(this,arguments);return t.length>0&&n.push(t),n.push(this.m_tabEtat.TYP),n.push(this.m_tabEtat.GDH),n.push(this.m_tabEtat.GDV),n.push(this.m_tabEtat.SMO),n.push(this.m_tabEtat.GRA),n.push(this.m_tabEtat.RAI),n.push(this.m_tabEtat.ANT),n.push(this.m_tabEtat.TRA),n.push(this.m_tabEtat.LEG),n.push(this.m_tabEtat.MIR),n.push(this.m_tabEtat.ANI),n.push(this.m_tabEtat.INT),n.push(this.m_tabEtat.ZOV),n.push(this.m_tabEtat.ZOH),n.push(this.m_tabEtat.ZHN),n.push(this.m_tabEtat.ZHX),n.push(this.m_tabEtat.ZVN),n.push(this.m_tabEtat.ZVX),n.join(",")};WDGraphe.prototype.DeduitParamBarre=function(n){this.m_tabEtat=clWDUtil.isObject(n)?n:clWDUtil.oEvalJSON(n)};WDGraphe.prototype.sGetAltText=function(n){return CHART_TOOLBAR.ALTTEXT[n]};WDGraphe.prototype._vAppliqueParametres=function(){WDChampParametresHote.prototype._vAppliqueParametres.apply(this,arguments);this.relanceInitialisation();this.ConstruitParam()};WDGraphe.prototype.grZoom=function(n,t,i){var r,u;if(this.m_oVue&&this.m_oVue.m_oPicture&&this.m_oVue.m_oRenderer&&this.m_oVue.m_oRenderer.m_rectAxis&&(r=this.m_oVue.m_oRenderer.m_oZoom,r||(r=new WDChartZoom(this.m_oVue.m_oRenderer),r.reset(!0)),u=new WDRect(this.m_oVue.m_oRenderer.m_rectAxis),t===undefined||!(t-n<2))){i===undefined&&(i=eGRAPHEAXE.kAbscisse);switch(i){case eGRAPHEAXE.kAbscisse:r.m_dOrigineMinX=n;t!==undefined&&(r.m_dOrigineMaxX=t);break;case eGRAPHEAXE.kOrdonnee:r.m_dOrigineMinY=n;t!==undefined&&(r.m_dOrigineMaxY=t);break;case eGRAPHEAXE.kOrdonneeSecondaire:if(!r.m_axisRendererY2)return;r.m_dOrigineMinY2=n;t!==undefined&&(r.m_dOrigineMaxY2=t);break;default:return}r.m_bDepuisGrZoom=!0;this.m_oVue.m_oRenderer.drawZoom(r)}};WDGraphe.prototype.grInfoPoint=function(n,t,i){return!this.m_oVue||!this.m_oVue.m_oRenderer?0:this.m_oVue.m_oRenderer.grInfoPoint(n,t,i)};WDGraphe.prototype.grSMNPortionRacine=function(n){if(n===undefined)return this.m_oParametres.m_sPortionRacine;this.m_oParametres.m_sPortionRacine=n;this.relanceInitialisation()};WDGraphe.prototype.grBulle=function(n,t,i){var r;if(i===undefined){if(typeof n!="number")return"";switch(n){case 0:return t!==undefined&&(this.m_oParametres.m_bBulleActive=t,this.relanceInitialisation()),this.m_oParametres.m_bBulleActive;case 1:return t!==undefined&&(this.m_oParametres.m_sBulle=String(t),this.relanceInitialisation()),this.m_oParametres.m_sBulle;case 2:return t!==undefined&&(this.m_oParametres.m_sBulleSecteur=String(t),this.relanceInitialisation()),this.m_oParametres.m_sBulleSecteur;case 3:return t!==undefined&&(this.m_oParametres.m_sBulleBoursier=String(t),this.relanceInitialisation()),this.m_oParametres.m_sBulleBoursier;case 4:return t!==undefined&&(this.m_oParametres.m_sBulleNuage=String(t),this.relanceInitialisation()),this.m_oParametres.m_sBulleNuage;case 5:return t!==undefined&&(this.m_oParametres.m_sBulleBulle=String(t),this.relanceInitialisation()),this.m_oParametres.m_sBulleBulle;case 6:return t!==undefined&&(this.m_oParametres.m_sBulleEnteteMire=String(t),this.relanceInitialisation()),this.m_oParametres.m_sBulleEnteteMire;case 14:return t!==undefined&&(this.m_oParametres.m_sBulleHeatmap=String(t),this.relanceInitialisation()),this.m_oParametres.m_sBulleHeatmap}return""}r=parseInt(String(n),10)-1;r>=0&&r<m_oModele.m_tabSeries.length&&(this.m_oModele.m_tabSeries[r].SetBullePoint(parseInt(String(t),10)-1,String(i)),this.m_oVue&&this.m_oVue.Redessine(this,WDChartView.ms_nDessinParDefaut))};WDGraphe.prototype.grCouleurBarre=function(n,t,i){var r=parseInt(String(n),10)-1;r>=0&&r<m_oModele.m_tabSeries.length&&(this.m_oModele.m_tabSeries[r].SetCouleurPoint(parseInt(String(t),10)-1,parseInt(String(i),10)),this.m_oVue&&this.m_oVue.Redessine(this,WDChartView.ms_nDessinParDefaut))};WDGraphe.prototype.grCouleurCategorie=function(n,t){grCouleurBarre(1,n,t)};WDGraphe.prototype.grCouleurPoint=function(n,t,i,r){var u=parseInt(String(n),10)-1,f;u>=0&&u<m_oModele.m_tabSeries.length&&(f=parseInt(String(t),10)-1,this.m_oModele.m_tabSeries[u].SetCouleurPoint(f,parseInt(String(i),10)),this.m_oModele.m_tabSeries[u].SetCouleurBordurePoint(f,parseInt(String(r),10)),this.m_oVue&&this.m_oVue.Redessine(this,WDChartView.ms_nDessinParDefaut))};WDGraphe.prototype.grCouleurSerie=function(n,t){this.m_oModele.setSeriesColor(n-1,t);this.m_oVue&&this.m_oVue.Redessine(this,WDChartView.ms_nDessinParDefaut)};WDGraphe.prototype.grSecteurAngleDepart=function(n){var t=n*Math.PI/180;this.m_oParametres.m_dAngle=t;this.relanceInitialisation()};WDGraphe.prototype.grEtiquetteCategorie=function(n){return this.m_oModele.getCategoryLabelAt(n-1)};WDGraphe.prototype.grInfoXY=function(n,t,i,r){var e,s,f,l,u,a,h,o,c;if(t===undefined&&(t=this.m_grInfoX),i===undefined&&(i=this.m_grInfoY),this.m_grInfoX=t,this.m_grInfoX=i,this.m_oVue&&this.m_oVue.m_oPicture&&this.m_oVue.m_oPicture.m_domBaliseSVG){switch(n){case eGRAPHEINFOXY_COORD.eGRCOORDX:return this.m_oVue.m_oRenderer.m_rectAxis?(t-this.m_oVue.m_oRenderer.m_nXOrigin)/this.m_oVue.m_oRenderer.m_dXPixelsPerUnit:-1;case eGRAPHEINFOXY_COORD.eGRCOORDY:return this.m_oVue.m_oRenderer.m_rectAxis?(this.m_oVue.m_oRenderer.m_nYOrigin-i)/this.m_oVue.m_oRenderer.m_dYPixelsPerUnit:-1;case eGRAPHEINFOXY_COORD.eGRCOORDY2:return!this.m_oVue.m_oRenderer.m_rectAxis||!this.m_oVue.m_oRenderer.m_dY2PixelsPerUnit?-1:(this.m_oVue.m_oRenderer.m_nY2Origin-i)/this.m_oVue.m_oRenderer.m_dY2PixelsPerUnit}for(s=this.m_oVue.m_oPicture.m_domBaliseSVG[0],f=s.createSVGRect(),f.x=t,f.y=i,f.width=f.height=1,l=s.getIntersectionList?s.getIntersectionList(f,null):[],h=l.length-1;h>-1;--h)(o=$(l[h]),c=r?o.wbData(r):o.wbData("wbGrfGrInfoXY"),c!==undefined&&c[n]!=undefined)&&(u===undefined||o.is(":hover"))&&(u=c,a=o);if(r)return u;u||(u=this.m_oVue.m_oRenderer.drawMire(this.m_oVue.m_oPicture,this.m_oVue.m_oAnimator,this.m_oVue.m_oRenderer.m_domBulle,undefined,t,i));u&&(e=clWDUtil.isFunction(u[n])?u[n].apply(this,[a,f.x,f.y]):u[n])}switch(n){case IWDChartConstant.GR_SERIE:case IWDChartConstant.GR_CATEGORIE:return e===undefined?-1:typeof e=="string"?e:e+1;case IWDChartConstant.GR_CHEMIN:return"";case IWDChartConstant.GR_VALEUR_MAX:case IWDChartConstant.GR_VALEUR_DEBUT:case IWDChartConstant.GR_VALEUR_FIN:case IWDChartConstant.GR_VALEUR:default:return e!==undefined?e:0}};WDGraphe.prototype.relanceInitialisation=function(n){this.m_oVue.m_bInteractif&&(this.m_oModele&&(this.m_oModele=undefined,delete this.m_oModele),this.m_oModele=new WDChartModel(this),n=this.m_oVue.RecreerRenderer(this,n),n!==!1)&&(this.m_oVue.Redessine(this,n),requestIdleCallback(function(){var n,i,t,u,r;if(this.m_oVue.m_oPicture&&this.m_oVue.m_oPicture.m_domBaliseSVG)for(this.m_oVue.m_oPicture.m_domBaliseSVG.find("desc").remove(),n=0;n<this.m_oModele.m_tabSeries.length;++n){for(i=this.m_oModele.m_tabSeries[n].m_sLibelle,t=0;t<this.m_oModele.m_tabSeries[n].m_tabValeur.length;++t)(u=this.m_oModele.getCategoryLabelAt(t),r=this.m_oModele.m_tabSeries[n].getValueAtWithNull(t),r!==IWDChartConstant.NULL_VALUE)&&(i+="\t"+u+"="+r);this.m_oVue.m_oPicture.tag(this.m_oVue.m_oPicture.m_domBaliseSVG,"desc-"+n,"desc").html(i)}}.bind(this)))};WDChartParameters.__sCreeClasseDepuisPolice=function(n,t,i){var u="wbGrf"+n.m_sAliasChamp+"-police-"+i,r;return $("style."+u).remove(),r="",t.m_bBarre||t.m_bSouligne?(t.m_bBarre&&(r+=" line-through"),t.m_bSouligne&&(r+=" underline")):r="none",$("head").append($('<style class="'+u+'">.'+u+" { font-family:"+t.m_sNom+";font-weight:"+t.m_nGras+";font-style:"+(t.m_bItalique?"italic":"normal")+";text-decoration:"+r+";font-size:"+t.m_sTaille+";color:"+t.m_sCouleur+";}<\/style>")),u};WDChartParameters.prototype=new JSONPOO;WDChartParameters.prototype.constructor=WDChartParameters;WDChartParameters.prototype.isDisplayValuesLabel=function(){return!!this.m_bAfficheValeur&&this.m_eType!==WDChartParameters.kNuage};WDChartParameters.prototype.isDisplayCategoriesLabel=function(){return!!this.m_bAfficheLibelle};WDChartParameters.prototype.isDisplayPercentage=function(){return!!this.m_bAffichePourcentage};WDChartParameters.prototype.isBorderColorAuto=function(){return!!this.m_bCouleurBordureAuto};WDChartParameters.prototype.getGradientType=function(){return this.m_bDegrade?this.m_bDegradeHorizontal?this.m_bAxeXHorizontal?IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:IWDChartConstant.FLAG_VERTICAL_GRADIENT:this.m_bAxeXHorizontal?IWDChartConstant.FLAG_VERTICAL_GRADIENT:IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:IWDChartConstant.FLAG_NO_GRADIENT};WDChartParameters.prototype.getDonutHoleSize=function(){return this.m_nPourcentageTrou||0};WDChartParameters.prototype.getType=function(){return this.m_eType};WDChartParameters.prototype.getTitlePosition=function(){if(this.m_ePosTitre==WDChartParameters.kSans)return IWDChartConstant.FLAG_TITLE_POSITION_NONE;if(this.m_oPositionnementManuel!=undefined)return IWDChartConstant.FLAG_TITLE_POSITION_MANUAL;switch(this.m_ePosTitre){case WDChartParameters.kDroite:case WDChartParameters.kGauche:case WDChartParameters.kSans:return IWDChartConstant.FLAG_TITLE_POSITION_NONE;case WDChartParameters.kHaut:return IWDChartConstant.FLAG_TITLE_POSITION_TOP;case WDChartParameters.kBas:return IWDChartConstant.FLAG_TITLE_POSITION_BOTTOM}};WDChartParameters.prototype.getLegendPosition=function(){if(this.m_ePosLegende==WDChartParameters.kSans)return IWDChartConstant.FLAG_LEGEND_POSITION_NONE;if(this.m_oPositionnementManuel!=undefined)return IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL;switch(this.m_ePosLegende){case WDChartParameters.kDroite:return IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT;case WDChartParameters.kGauche:return IWDChartConstant.FLAG_LEGEND_POSITION_LEFT;case WDChartParameters.kSans:return IWDChartConstant.FLAG_LEGEND_POSITION_NONE;case WDChartParameters.kHaut:return IWDChartConstant.FLAG_LEGEND_POSITION_TOP;case WDChartParameters.kBas:return IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM}};WDChartParameters.prototype.isLegendLabelInRow=function(){return this.m_ePosLegende==WDChartParameters.kHaut||this.m_ePosLegende==WDChartParameters.kBas};WDChartParameters.prototype.isLegendAdaptSizeToContent=function(){return this.getLegendPosition()!==IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL?!1:this.m_oPositionnementManuel.m_oLegende.m_nBottom==undefined?!0:!1};WDChartParameters.prototype.byGetAlpha=function(){if(this.m_bInterditAlpha)return 255;var n=this.m_byAlpha;return n===undefined?255:n};WDChartParameters.prototype.indiceWLangageToFmk=function(n){return n>=1?n-1:n};WDChartParameters.prototype.getXAxisMin=function(){return this.m_oAxeX.m_bOrigineMin?this.indiceWLangageToFmk(this.m_oAxeX.m_dOrigineMin):IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getXAxisMax=function(){return this.m_oAxeX.m_bOrigineMax?this.indiceWLangageToFmk(this.m_oAxeX.m_dOrigineMax):IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getYAxisMin=function(){return this.m_oAxeY.m_bOrigineMin?this.m_oAxeY.m_dOrigineMin:IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getYAxisMax=function(){return this.m_oAxeY.m_bOrigineMax?this.m_oAxeY.m_dOrigineMax:IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getY2AxisMin=function(){return this.m_oAxeYSecondaire.m_bOrigineMin?this.m_oAxeYSecondaire.m_dOrigineMin:IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getY2AxisMax=function(){return this.m_oAxeYSecondaire.m_bOrigineMax?this.m_oAxeYSecondaire.m_dOrigineMax:IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getAxisTitle=function(n){switch(n.m_type){default:case EAxisType.X:return this.m_sTitreAxeX;case EAxisType.X2:return"";case EAxisType.Y:return this.m_sTitreAxeY;case EAxisType.Y2:return this.m_sTitreAxeY2;case EAxisType.Z:return""}};WDChartParameters.prototype.getAxisLabelOrientation=function(n){var t;switch(n.m_type){default:case EAxisType.Z:t=WDChartParameters.eOrientationDefaut;break;case EAxisType.X:case EAxisType.X2:t=this.m_oAxeX.m_eOrientationGraduations;break;case EAxisType.Y:t=this.m_oAxeY.m_eOrientationGraduations;break;case EAxisType.Y2:t=this.m_oAxeYSecondaire.m_eOrientationGraduations}return(t<WDChartParameters.eOrientationDefaut||t>WDChartParameters.eOrientationVerticale)&&(t=WDChartParameters.eOrientationDefaut),t};WDChartParameters.prototype.getAxisStep=function(n){var t;switch(n.m_type){case EAxisType.X:case EAxisType.X2:t=this.m_oAxeX.m_dPas;break;case EAxisType.Y:t=this.m_oAxeY.m_dPas;break;case EAxisType.Y2:t=this.m_oAxeYSecondaire.m_dPas;break;default:t=0}return t<=0&&(t=IWDChartConstant.DEFAULT_VALUE),t};WDChartParameters.prototype.isAxisVisible=function(n){switch(n.m_type){case EAxisType.X:case EAxisType.X2:return this.m_oAxeX.m_eAffichageAxe===undefined&&this.m_oAxeX.m_bVisible!==undefined?this.m_oAxeX.m_bVisible:!!this.m_oAxeX.m_eAffichageAxe;case EAxisType.Y:return this.m_oAxeY.m_eAffichageAxe===undefined&&this.m_oAxeY.m_bVisible!==undefined?this.m_oAxeY.m_bVisible:!!this.m_oAxeY.m_eAffichageAxe;case EAxisType.Y2:return this.m_oAxeYSecondaire.m_eAffichageAxe===undefined&&this.m_oAxeYSecondaire.m_bVisible!==undefined?this.m_oAxeYSecondaire.m_bVisible:!!this.m_oAxeYSecondaire.m_eAffichageAxe}return!1};WDChartParameters.prototype.isVerticalGridShown=function(){var n=this.m_bAxeXHorizontal?this.m_oAxeX:this.m_oAxeY;return n.m_bQuadrillage};WDChartParameters.prototype.isHorizontalGridShown=function(){var n=this.m_bAxeXHorizontal?this.m_oAxeY:this.m_oAxeX;return n.m_bQuadrillage};WDChartParameters.prototype.getVerticalGridStyle=function(n){var n=this.m_bAxeXHorizontal?this.m_oAxeX:this.m_oAxeY;return n.m_eTypeStyloQuadrillage};WDChartParameters.prototype.getHorizontalGridStyle=function(n){var n=this.m_bAxeXHorizontal?this.m_oAxeY:this.m_oAxeX;return n.m_eTypeStyloQuadrillage};WDChartParameters.prototype.isStackedBarChart=function(){return this.getType()==WDChartParameters.kHistoEmpile||this.getType()==WDChartParameters.kHistoEmpileHorizontal};WDChartParameters.prototype.isBoursierChart=function(){return WDChartParameters.s_isBoursierChart(this.getType())};WDChartParameters.s_isBoursierChart=function(n){return n==WDChartParameters.kBarCharts||n==WDChartParameters.kMinMax||n==WDChartParameters.kChandelier};WDChartParameters.prototype.isHorizontalZoomEnabled=function(){return this.m_bZoomX};WDChartParameters.prototype.isVerticalZoomEnabled=function(){return this.m_bZoomY};WDChartParameters.prototype.setHorizontalZoomEnabled=function(n){return this.m_bZoomX=n};WDChartParameters.prototype.setVerticalZoomEnabled=function(n){return this.m_bZoomY=n};WDChartParameters.kSecteur=0;WDChartParameters.kHisto=1;WDChartParameters.kCourbe=2;WDChartParameters.kNuage=5;WDChartParameters.kChandelier=6;WDChartParameters.kBarCharts=7;WDChartParameters.kMinMax=8;WDChartParameters.kHistoEmpile=9;WDChartParameters.kDonut=23;WDChartParameters.kAire=24;WDChartParameters.kRadar=25;WDChartParameters.kHemicycle=26;WDChartParameters.kHistoHorizontal=27;WDChartParameters.kHistoEmpileHorizontal=28;WDChartParameters.kBulle=32;WDChartParameters.kEntonnoir=33;WDChartParameters.kWaterfall=35;WDChartParameters.kSecteurMultiniveau=36;WDChartParameters.kHeatMap=37;WDChartParameters.kSans=0;WDChartParameters.kDroite=1;WDChartParameters.kGauche=2;WDChartParameters.kHaut=3;WDChartParameters.kBas=4;WDChartParameters.eOrientationDefaut=0;WDChartParameters.eOrientationHorizontale=1;WDChartParameters.eOrientationVerticale=2;WDChartSeries.prototype=new JSONPOO;WDChartSeries.prototype.constructor=WDChartSeries;WDChartSeries.prototype.eGetTypePoint=function(n){return n!==undefined&&this.m_oInformationsPoints&&this.m_oInformationsPoints[n+1]&&this.m_oInformationsPoints[n+1].m_eTypePoint!=undefined&&this.m_oInformationsPoints[n+1].m_eTypePoint!=EPointStyle.NONDEFINI?this.m_oInformationsPoints[n+1].m_eTypePoint:this.m_eTypePoint==EPointStyle.NONDEFINI?this.m_eType==WDChartParameters.kNuage?EPointStyle.CIRCLE:EPointStyle.NONE:this.m_eTypePoint};WDChartSeries.prototype.nGetTaillePoint=function(n){return n!==undefined&&this.m_oInformationsPoints&&this.m_oInformationsPoints[n+1]&&this.m_oInformationsPoints[n+1].m_nTaillePoint!=undefined?this.m_oInformationsPoints[n+1].m_nTaillePoint:this.m_nTaillePoint};WDChartSeries.prototype.crGetCouleurPoint=function(n){return n!==undefined&&this.m_oInformationsPoints&&this.m_oInformationsPoints[n+1]&&this.m_oInformationsPoints[n+1].m_crCouleurPoint!=undefined?this.m_oInformationsPoints[n+1].m_crCouleurPoint:undefined};WDChartSeries.prototype.SetCouleurPoint=function(n,t){n!==undefined&&this.m_oInformationsPoints&&this.m_oInformationsPoints[n+1]&&this.m_oInformationsPoints[n+1].m_crCouleurPoint!=undefined&&(this.m_oInformationsPoints[n+1].m_crCouleurPoint=t)};WDChartSeries.prototype.crGetCouleurBordurePoint=function(n){return n!==undefined&&this.m_oInformationsPoints&&this.m_oInformationsPoints[n+1]&&this.m_oInformationsPoints[n+1].m_crCouleurBordurePoint!=undefined?this.m_oInformationsPoints[n+1].m_crCouleurBordurePoint:undefined};WDChartSeries.prototype.SetCouleurBordurePoint=function(n,t){n!==undefined&&this.m_oInformationsPoints&&this.m_oInformationsPoints[n+1]&&this.m_oInformationsPoints[n+1].m_crCouleurBordurePoint!=undefined&&(this.m_oInformationsPoints[n+1].m_crCouleurBordurePoint=t)};WDChartSeries.prototype.sGetBullePoint=function(n){return n!==undefined&&this.m_oInformationsPoints&&this.m_oInformationsPoints[n+1]&&this.m_oInformationsPoints[n+1].m_pszBulle!=undefined?this.m_oInformationsPoints[n+1].m_pszBulle:undefined};WDChartSeries.prototype.SetBullePoint=function(n,t){n!==undefined&&this.m_oInformationsPoints&&this.m_oInformationsPoints[n+1]&&this.m_oInformationsPoints[n+1].m_pszBulle!=undefined&&(this.m_oInformationsPoints[n+1].m_pszBulle=t)};WDChartSeries.prototype.getChartType=function(){var n=!1,t=this.m_oGraphe.m_oModele?this.m_oGraphe.m_oModele.m_oParametres.getType():this.m_oGraphe.m_oParametres.m_eType;switch(t){default:case WDChartParameters.kSecteur:case WDChartParameters.kDonut:case WDChartParameters.kHemicycle:case WDChartParameters.kEntonnoir:n=!1;break;case WDChartParameters.kCourbe:case WDChartParameters.kAire:case WDChartParameters.kHistoHorizontal:case WDChartParameters.kHistoEmpileHorizontal:case WDChartParameters.kHisto:case WDChartParameters.kHistoEmpile:case WDChartParameters.kWaterfall:case WDChartParameters.kBulle:case WDChartParameters.kNuage:case WDChartParameters.kChandelier:case WDChartParameters.kBarCharts:case WDChartParameters.kMinMax:n=!0;break;case WDChartParameters.kRadar:case WDChartParameters.kHeatMap:n=!1}return!n||this.m_eType==-1?t:this.m_eType};WDChartSeries.prototype.isStacked=function(){return this.getChartType()==WDChartParameters.kHistoEmpile||this.getChartType()==WDChartParameters.kHistoEmpileHorizontal};WDChartSeries.prototype.isOnSecondaryAxis=function(){return this.m_bAxeSecondaire&&!(this.getChartType()==WDChartParameters.kHistoEmpile||this.getChartType()==WDChartParameters.kHistoEmpileHorizontal)};WDChartSeries.prototype.getMinValue=function(){return this.getNbValues()>0?this.m_dMinValue:0};WDChartSeries.prototype.getMaxValue=function(){return this.getNbValues()>0?this.m_dMaxValue:0};WDChartSeries.prototype.getNbValues=function(){return this.m_tabValeur?this.m_tabValeur.length+Math.max(this.m_nOffset-1,0):0};WDChartSeries.prototype.getValueAt=function(n){var t=this.getValueAtWithNull(n);return t==IWDChartConstant.NULL_VALUE&&(t=0),t};WDChartSeries.prototype.getValueAtWithNull=function(n){return this.m_tabValeur.length===0?IWDChartConstant.NULL_VALUE:n<this.m_nOffset-1?IWDChartConstant.NULL_VALUE:this.m_tabValeur[n-(this.m_nOffset-1)]};WDChartSeries.prototype.isContainDecimalValues=function(){return this.m_bContainDecimalValues};WDChartSeries.prototype.onValueAddedOrChanged=function(n){n<this.m_dMinValue&&(this.m_dMinValue=n);n>this.m_dMaxValue&&(this.m_dMaxValue=n);this.m_bContainDecimalValues||(this.m_bContainDecimalValues=n-parseInt10(n)>0)};WDChartSeries.prototype.bNuageReliePoint=function(){return this.getChartType()!==WDChartParameters.kNuage?!0:this.m_eReliePoint==2?!1:!1===this.m_oGraphe.m_oModele.m_oParametres.m_bLigne&&!this.m_eReliePoint?!1:!0};WDChartView.prototype.constructor=WDChartView;WDChartView.ms_nDessinImpossible=-1;WDChartView.ms_nDessinParDefaut=0;WDChartView.ms_nDessin1erAffichage=1;WDChartView.ms_nDessinModifTypeGraphe=2;WDChartView.ms_nDessinAnimation=4;WDChartView.ms_nDessinNouvellesDonnees=5;WDChartView.DELAI_1ERAFFICHAGE=400;WDChartView.prototype.updateModeleReference=function(n,t){this.m_oModelePrecedent=this._updateModele(n);t&&!this.m_oModeleInitialSeries&&(this.m_oModeleInitialSeries=this._updateModele(n))};WDChartView.prototype._updateModele=function(n){for(var r,e,f,u,i={m_tabSeries:[]},t=0;t<n.m_oModele.m_tabSeries.length;++t){for(r=n.m_oModele.m_tabSeries[t],e=r.getChartType(),i.m_tabSeries[t]={m_tabValeur:[],getChartType:function(){return e}},f=1;f<r.m_nOffset;++f)i.m_tabSeries[t].m_tabValeur.push(0);i.m_tabSeries[t].m_tabValeur=i.m_tabSeries[t].m_tabValeur.concat([].concat(r.m_tabValeur));u=n.m_oModele.getAxisByType(r.isOnSecondaryAxis()?EAxisType.Y2:EAxisType.Y);u&&(i.m_tabSeries[t].m_oAxis={m_dMinValue:u.m_dMinValue,m_dMaxValue:u.m_dMaxValue,m_dOriginValue:u.m_dOriginValue})}return i};WDChartView.prototype.toggleSerieMasquee=function(n){return this.setSerieMasquee(n,!this.bEstSerieMasquee(n))};WDChartView.prototype.setSerieMasquee=function(n,t){return this.m_tabSeriesMasquees[n]=t,this.m_tabSeriesMasquees[n]};WDChartView.prototype.bEstSerieMasquee=function(n){return this.m_tabSeriesMasquees[n]===undefined||this.m_tabSeriesMasquees[n]===!1?!1:!0};WDChartView.prototype.RecreerRenderer=function(n,t){var i=WDChartView.ms_nDessinImpossible,r,u;if(this.m_bInteractif&&WDPictureSVG.bDessinPossible()){if(i=WDChartView.ms_nDessinParDefaut,this.m_oPicture===undefined){if(this.m_oPicture=new WDPictureSVG(n),!this.m_oPicture.Init(n))return!1;i=WDChartView.ms_nDessin1erAffichage}else this.m_oRenderer&&n.m_oModele.bDonneesDejaDessinnees()?i=this.nGetTypeAffichage(n,this.m_oRenderer):(this.m_oRenderer||this.m_oPicture.Raz(),i=WDChartView.ms_nDessinNouvellesDonnees);i=t&&i===WDChartView.ms_nDessinParDefaut?t:i;n.m_oModele.m_oParametres.m_bAxeXHorizontal=!0;r=undefined;u=WDChartAnimator;switch(n.m_oModele.m_oParametres.getType()){case WDChartParameters.kSecteur:case WDChartParameters.kDonut:case WDChartParameters.kHemicycle:r=WDPieChartRenderer;u=WDPieChartAnimator;break;case WDChartParameters.kSecteurMultiniveau:r=WDSunburstChartRenderer;u=WDSunburstChartAnimator;break;case WDChartParameters.kEntonnoir:r=WDFunnelChartRenderer;u=WDFunnelChartAnimator;break;case WDChartParameters.kRadar:r=WDRadarChartRenderer;u=WDRadarChartAnimator;break;case WDChartParameters.kHeatMap:r=WDHeatmapChartRenderer;u=WDHeatmapChartAnimator;break;case WDChartParameters.kHistoHorizontal:case WDChartParameters.kHistoEmpileHorizontal:n.m_oModele.m_oParametres.m_bAxeXHorizontal=!1;case WDChartParameters.kWaterfall:case WDChartParameters.kBulle:case WDChartParameters.kNuage:case WDChartParameters.kCourbe:case WDChartParameters.kAire:case WDChartParameters.kHisto:case WDChartParameters.kHistoEmpile:case WDChartParameters.kChandelier:case WDChartParameters.kBarCharts:case WDChartParameters.kMinMax:r=WDXYChartRenderer;u=WDXYChartAnimator;break;default:this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i);this.m_oRenderer=undefined}}return r&&(r.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==r.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new r(n),this.m_params&&this.m_oRenderer.RecreerRenderer(this.m_oPicture,i),this.m_oAnimator=new u(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined)),this.m_oRenderer!==undefined?(this.m_oPicture.m_domBaliseSVG[0].id=this.m_sIdHoteImageOrig,n.m_oHoteImage.name=this.m_sIdHoteImageOrig,n.m_oHoteImage.id="",n.m_oHote=this.m_oPicture.m_domBaliseSVG.parent()[0]):(this.m_oPicture&&this.m_oPicture.m_domBaliseSVG&&(this.m_oPicture.m_domBaliseSVG[0].id=""),n.m_oHoteImage.id=this.m_sIdHoteImageOrig,n.m_oHote=n.m_oHoteImage),i};WDChartView.prototype.bEstInteractif=function(){return this.m_bInteractif&&this.m_oRenderer!==undefined};WDChartView.prototype.Redessine=function(n,t){var i=$(n.m_oHoteImage),r;if(this.m_oRenderer===undefined)this.m_oPicture&&this.m_oPicture.m_domBaliseSVG&&this.m_oPicture.m_domBaliseSVG.css("display","none"),i.css("display","block"),r=i.attr("src")||"",(r==""||r.indexOf("vide.gif")==r.length-8)&&i.attr("data-src")!==undefined&&(i.attr("src",i.attr("data-src")),i.attr("data-src",undefined));else{i.css("display","none");this.m_oPicture&&this.m_oPicture.m_domBaliseSVG&&this.m_oPicture.m_domBaliseSVG.css("display","block");this.onDraw(n,t);this.m_oRenderer.m_oGraphe.m_oBarreAutomatique&&this.m_oRenderer.m_oGraphe.m_oBarreAutomatique.m_jqBurger&&this.m_oRenderer.m_oGraphe.m_oBarreAutomatique.m_jqBurger.find("input").trigger("trigger.wb.grf.burger.maj")}};WDChartView.prototype.Init=function(n){if(this.m_sIdHoteImageOrig=n.m_oHoteImage.id,this.m_bInteractif=n.m_bInteractif,n.m_oBarreAutomatique.m_oBarre!==undefined&&this.m_bInteractif&&$(n.m_oBarreAutomatique.m_oBarre).css("opacity",0),this.m_bInteractif){if(n.relanceInitialisation(),this.m_oPicture!==undefined&&this.m_oPicture.m_domBaliseSVG){clWDUtil.AttacheDetacheEvent(!0,this.m_oPicture.m_domBaliseSVG[0],"mouseover",n.m_fRafBarreTrue);clWDUtil.AttacheDetacheEvent(!0,this.m_oPicture.m_domBaliseSVG[0],"mouseout",n.m_fRafBarreFalse);clWDUtil.AttacheDetacheEvent(!0,this.m_oPicture.m_domBaliseSVG[0],"mousemove",n.m_fRafBarreTrueMMove);var t=$(n.m_oHoteImage),i=t.prop("attributes");$(i).each(function(){var t=this.name.toLowerCase();t.substr(0,2)=="on"&&t!="onload"&&n.m_oVue.m_oPicture.m_domBaliseSVG.attr(this.name,(this.value||"").replace("event","arguments[0]"))});n.m_oHoteImage&&n.m_oHoteImage.onload&&n.m_oHoteImage.onload()}}else this.Redessine(n);n.m_oBarreAutomatique.m_oBarre!==undefined&&this.m_bInteractif&&$(n.m_oBarreAutomatique.m_oBarre).find("[data-src]").each(function(){$(this).attr("src",$(this).attr("data-src")).bind("load",function(){$(this).removeAttr("data-src");var n=$(this).closest("table");n.find("[data-src]").length===0&&n.css("opacity",1)})})};WDChartView.prototype.nGetTypeAffichage=function(n,t){var r=n.m_oParametres,u=t.m_params,i=WDChartView.ms_nDessinParDefaut;return r.m_eType!=u.m_eType&&(i=WDChartView.ms_nDessinModifTypeGraphe),i};WDChartView.prototype.updateDepuisBarreOutils=function(n,t){var i=n.m_oParametres,u=this.m_oRenderer,r=n.m_tabEtat,l=WDChartView.ms_nDessinParDefaut,f,o,s,h,c,e;if(i.m_eType!=r.TYP){for(l=WDChartView.ms_nDessinModifTypeGraphe,i.m_eType=parseInt10(r.TYP),f=0;f<n.m_oDonnees.m_tabSeries.length;f++)o=n.m_oDonnees.m_tabSeries[f],o.m_eType!==i.m_eType&&(o.m_eType=i.m_eType);u&&(u.m_oOrigineSansZoom=undefined)}return i.m_bAxeXHorizontal=!(i.m_eType==WDChartParameters.kHistoHorizontal||i.m_eType==WDChartParameters.kHistoEmpileHorizontal),i.m_ePosLegende=parseInt10(r.LEG),s=i.m_bAxeXHorizontal?i.m_oAxeX:i.m_oAxeY,s&&(s.m_bQuadrillage=r.GDV),h=i.m_bAxeXHorizontal?i.m_oAxeY:i.m_oAxeX,h&&(h.m_bQuadrillage=r.GDH),i.m_bSpline=r.SMO,i.m_bDegrade=r.GRA,i.m_bDegrade&&(i.m_bDegradeHorizontal=i.m_eType!=WDChartParameters.kAire),i.m_bInterdit3D=!r.RAI,i.m_bInterdit3D||(i.m_nProfondeur=10,i.m_nPourcentageBiseau=10),i.m_bAntiAliasing=r.ANT,c=parseInt10(r.TRA),isNaN(c)||c<2?(i.m_bInterditAlpha=!r.TRA,i.m_byAlpha=i.m_bInterditAlpha?255:127):(i.m_byAlpha=255*(r.TRA/100),i.m_bInterditAlpha=i.m_byAlpha==255),i.m_nDureeAnimation=r.ANI?600:0,i.m_bInteractif=r.INT==0?!1:!0,i.m_bMireMultiple=r.MIR==0,i.m_bMire=i.m_bMireMultiple||r.MIR==1,i.m_bBulleActive=r.MIR!=-1,i.m_bHorizontalZoom=!!r.ZOH,i.m_bVerticalZoom=!!r.ZOV,u&&t&&(i.m_bHorizontalZoom||i.m_bVerticalZoom||u.m_oZoom)&&(e=new WDChartZoom(u),e.reset(!0),e.setCoeffMinMax(i.m_bHorizontalZoom?r.ZHN:"",i.m_bHorizontalZoom?r.ZHX:"",i.m_bVerticalZoom?r.ZVN:"",i.m_bVerticalZoom?r.ZVX:""),u.setZoom(e,i.m_oAxeX,i.m_oAxeY,i.m_oAxeYSecondaire)),l},function(n,t){typeof define=="function"&&define.amd?define([],t):typeof exports=="object"?module.exports=t():n.download=t()}(this,function(){return function n(t,i,r){function d(n){var i=n.split(/[:;,]/),e=i[1],s=n.indexOf("charset")>0?3:2,h=i[s]=="base64"?atob:decodeURIComponent,r=h(i.pop()),u=r.length,t=0,f=new Uint8Array(u);for(t;t<u;++t)f[t]=r.charCodeAt(t);return new o([f],{type:e})}function p(n,t){if("download"in f)return f.href=n,f.setAttribute("download",v),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",f.addEventListener("click",function(n){n.stopPropagation();this.removeEventListener("click",arguments.callee)}),document.body.appendChild(f),setTimeout(function(){f.click();document.body.removeChild(f);t===!0&&setTimeout(function(){e.URL.revokeObjectURL(f.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(n)&&(n="data:"+n.replace(/^data:([\w\/\-\+]+)/,a)),window.open(n)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=n),!0;var i=document.createElement("iframe");document.body.appendChild(i);!t&&/^data:/.test(n)&&(n="data:"+n.replace(/^data:([\w\/\-\+]+)/,a));i.src=n;setTimeout(function(){document.body.removeChild(i)},333)}var e=window,a="application/octet-stream",h=r||a,u=t,c=!i&&!r&&u,f=document.createElement("a"),w=function(n){return String(n)},o=e.Blob||e.MozBlob||e.WebKitBlob||w,v=i||"download",s,b,l;if(o=o.call?o.bind(e):Blob,String(this)==="true"&&(u=[u,h],h=u[0],u=u[1]),c&&c.length<2048&&(v=c.split("/").pop().split("?")[0],f.href=c,f.href.indexOf(c)!==-1))return l=new XMLHttpRequest,l.open("GET",c,!0),l.responseType="blob",l.onload=function(t){n(t.target.response,v,a)},setTimeout(function(){l.send()},0),l;if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(u))if(u.length>1048576*1.999&&o!==w)u=d(u),h=u.type||a;else return navigator.msSaveBlob?navigator.msSaveBlob(d(u),v):p(u);else if(/([\x80-\xff])/.test(u)){var y=0,k=new Uint8Array(u.length),g=k.length;for(y;y<g;++y)k[y]=u.charCodeAt(y);u=new o([k],{type:h})}if(s=u instanceof o?u:new o([u],{type:h}),navigator.msSaveBlob)return navigator.msSaveBlob(s,v);if(e.URL)p(e.URL.createObjectURL(s),!0);else{if(typeof s=="string"||s.constructor===w)try{return p("data:"+h+";base64,"+e.btoa(s))}catch(nt){return p("data:"+h+","+encodeURIComponent(s))}b=new FileReader;b.onload=function(){p(this.result)};b.readAsDataURL(s)}return!0}});WDChartView.prototype.OnSave=function(n,t){var f,e,s;if(this.m_oRenderer&&this.m_oPicture){if((bIEAvec11||bEdge&&this.m_oPicture.m_domBaliseSVG[0].indexOf("gradient")>-1)&&!this.m_oRenderer.m_oGraphe.m_bRetireOptionsNonSupporteesEnInteractif){document.location=n.sGetRequete(!0);return}try{var u=this.m_oPicture.m_domBaliseSVG.clone(),r=document.createElement("canvas"),o=r.getContext("2d"),i=new Image;u.find("text,tspan").each(function(){this.style.cssText=getComputedStyle(document.getElementById(this.id)).cssText});f=this.m_oPicture.m_domBaliseSVG[0].clientHeight||this.m_oPicture.m_domBaliseSVG.height();e=this.m_oPicture.m_domBaliseSVG[0].clientWidth||this.m_oPicture.m_domBaliseSVG.width();i.width=r.width=e;i.height=r.height=f;u.attr("width",e+"px").attr("height",f+"px");s=(new XMLSerializer).serializeToString(u[0]);i.onload=function(){var u,n;o.drawImage(i,0,0,i.width,i.height);t||(t="image/png");switch(t){case"image/bmp":if(window.btoa){u=function(n){var a=function(n){var i="",t;if(typeof n=="string")i=n;else for(t=0;t<n.length;t++)i+=String.fromCharCode(n[t]);return btoa(i)},t=n.width,i=n.height,r=t*i*3,u=r+54,p=[66,77,u&255,u>>8&255,u>>16&255,u>>24&255,0,0,0,0,54,0,0,0],w=[40,0,0,0,t&255,t>>8&255,t>>16&255,t>>24&255,i&255,i>>8&255,i>>16&255,i>>24&255,1,0,24,0,0,0,0,0,r&255,r>>8&255,r>>16&255,r>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=(4-t*3%4)%4,h=n.data,v="",k=t<<2,y=i,c=String.fromCharCode,f,e,o,s,l;do{for(f=k*(y-1),e="",o=0;o<t;o++)s=o<<2,e+=c(h[f+s+2])+c(h[f+s+1])+c(h[f+s]);for(l=0;l<b;l++)e+=String.fromCharCode(0);v+=e}while(--y);return a(p.concat(w))+a(v)};n="data:"+t+";base64,"+u(o.getImageData(0,0,r.width,r.height));break}default:case"image/png":n=r.toDataURL(t)}download(n,t.replace("/","."),t)};i.src="data:image/svg+xml,"+encodeURIComponent(s)}catch(h){window.open(n.sGetRequete(!0))}}else window.open(n.sGetRequete(!0))};WDChartView.prototype.OnPrint=function(n){var t,i,u,r;if(this.m_oRenderer&&this.m_oPicture)t=this.m_oPicture.getId(this.m_oPicture.m_domBaliseSVG),i=$('<style class="wbGrfprint">#'+t+" { display:none;position:absolute;left:-9999px; }@media print {form{ display:none; }#"+t+" { display:block;position:static; }}<\/style>"),$("head").append(i),u=this.m_oPicture.m_domBaliseSVG.parent(),r=this.m_oPicture.m_domBaliseSVG.detach(),$("body").append(r),window.print(),r.appendTo(u),i.remove();else{var f=(n.m_oHoteImage.offsetHeight||n.m_oHoteImage.clientHeight)+30,e=(n.m_oHoteImage.offsetWidth||n.m_oHoteImage.clientWidth)+30,o=window.open(n.sGetRequete(!1),"WDG_"+(new Date).getTime(),"resizable=yes,height="+f+",width="+e);o.print()}};WDChartView.prototype.ExecuteCommande=function(n,t){if(t||$(n.m_oHoteImage).removeAttr("src").attr("src",n.sGetRequete(!1)),this.m_bInteractif){var r=this.updateDepuisBarreOutils(n,t),i=!0;i&&r==WDChartView.ms_nDessinModifTypeGraphe&&(i=!1);i&&($.extend(n.m_oModele.m_oParametres,n.m_oParametres),this.m_oRenderer&&this.m_oRenderer.constructor.bParametresSupportes(this.m_oPicture,n.m_oModele)||(i=!1));i?($.extend(n.m_oModele.m_oParametres,n.m_oParametres),n.m_oVue.Redessine(n,r)):n.relanceInitialisation(r)}};WDChartView.prototype.OnOption=function(n,t){this.ExecuteCommande(n,t)};WDChartView.prototype.onDraw=function(n,t){this.m_oRenderer.Init(n,this.m_oPicture);this.m_oPicture.m_domBaliseSVG.wbData("wbGrfModeAffichage",t);switch(t){case WDChartView.ms_nDessin1erAffichage:var i=this;setTimeout(function(){i.m_oAnimator.play1erAffichage(n,i.m_oPicture)},this.m_oPicture.m_domBaliseSVG.wbData("wbGrf1erDrawFait")?1:WDChartView.DELAI_1ERAFFICHAGE);this.m_oPicture.m_domBaliseSVG.wbData("wbGrf1erDrawFait",!0);break;case WDChartView.ms_nDessinModifTypeGraphe:this.m_oAnimator.playModifTypeGraphe(n,this.m_oPicture);break;default:case WDChartView.ms_nDessinParDefaut:this.m_oRenderer.draw(this.m_oPicture,this.m_oAnimator);break;case WDChartView.ms_nDessinNouvellesDonnees:this.m_oAnimator.playMajDonnees(n,this.m_oPicture);break;case WDChartView.ms_nDessinAnimation:this.m_oRenderer.drawAnimation(this.m_oPicture,this.m_oAnimator)}n.m_oModele.SetDonneesDessinnees();n.m_oModele.SetParametresDejaDessinnes();this.m_oPicture.m_domBaliseSVG.wbRemoveData("wbGrfModeAffichage")};WDChartUtils.is_in_triangle=function(n,t,i,r,u,f,e,o){var s=[e-i,o-r],h=[u-i,f-r],c=[n-i,t-r],a=s[0]*s[0]+s[1]*s[1],l=s[0]*h[0]+s[1]*h[1],v=s[0]*c[0]+s[1]*c[1],y=h[0]*h[0]+h[1]*h[1],p=h[0]*c[0]+h[1]*c[1],w=1/(a*y-l*l),b=(y*v-l*p)*w,k=(a*p-l*v)*w;return b>=0&&k>=0&&b+k<1};WDChartUtils.formatValue=function(n,t,i,r){var u,f,e,o;if(r===undefined){for(u=t.length-1;u>=0&&isNaN(parseInt10(t[u]));)--u;++u;u<t.length&&(r=t.substr(u),t=t.substr(0,u))}if((t||"")==""&&(r||"")=="")return n;f=n||0;!0!==i&&(f=parseInt10(f));try{e=_WW_SEPDECIMAL_;_WW_SEPDECIMAL_=".";o=__reinitNombre(String(f),t.replace(".",sSepDecimalMasque),r!==undefined,r)}catch(s){}finally{_WW_SEPDECIMAL_=e}return o};ESerieCouleur.nSERIECOULEUR_DEFAUT=0;ESerieCouleur.nSERIECOULEUR_TREEMAP=1;ESerieCouleur.nSERIECOULEUR_TREEMAP_PASTEL=2;ESerieCouleur.nSERIECOULEUR_GABARIT=3;ESerieCouleur.Serie1=123;ESerieCouleur.Serie2=124;ESerieCouleur.Serie3=125;ESerieCouleur.Serie4=126;ESerieCouleur.Serie5=127;ESerieCouleur.Serie6=128;ESerieCouleur.Serie7=129;ESerieCouleur.Serie8=130;ESerieCouleur.Serie9=131;ESerieCouleur.Serie10=132;ESerieCouleur.Serie11=133;WDChartUtils.getCouleurAutoFromIndex=function(n,t){var r=t==ESerieCouleur.nSERIECOULEUR_GABARIT&&_COL,u,i;r||++n;u=!0;i=0;switch(n%11){case 0:i=r?_COL[ESerieCouleur.Serie1]:u?"#ffd440":"#48cfad";break;case 1:i=r?_COL[ESerieCouleur.Serie2]:u?"#d79df8":"#ffce54";break;case 2:i=r?_COL[ESerieCouleur.Serie3]:u?"#65c3e6":"#fc6e51";break;case 3:i=r?_COL[ESerieCouleur.Serie4]:u?"#b0e433":"#3bafda";break;case 4:i=r?_COL[ESerieCouleur.Serie5]:u?"#ffbf69":"#ab47bc";break;case 5:i=r?_COL[ESerieCouleur.Serie6]:u?"#b2a3ff":"#78909c";break;case 6:i=r?_COL[ESerieCouleur.Serie7]:u?"#5ed7cb":"#d4e157";break;case 7:i=r?_COL[ESerieCouleur.Serie8]:u?"#d8eb2b":"#ffa726";break;case 8:i=r?_COL[ESerieCouleur.Serie9]:u?"#ff9dc7":"#ffee58";break;case 9:i=r?_COL[ESerieCouleur.Serie10]:u?"#67afe8":"#5c6bc0";break;case 10:i=r?_COL[ESerieCouleur.Serie11]:u?"#88e371":"#ec407a"}return i};WDMathUtils.roundToMultiple=function(n,t){return t*Math.round(n/t)};WDRect.prototype.constructor=WDRect;WDRect.prototype.set=function(n,t,i,r){if(t===undefined&&n!==undefined&&n.m_nLeft!==undefined){this.set(n.m_nLeft,n.m_nTop,n.m_nRight,n.m_nBottom);return}this.setLeft(n);this.setTop(t);this.setRight(i);this.setBottom(r)};WDRect.prototype.setCorners=function(n,t,i,r){this.setLeft(Math.min(n,i));this.setTop(Math.min(t,r));this.setRight(Math.max(n,i));this.setBottom(Math.max(t,r))};WDRect.prototype.offset=function(n,t){this.setLeft(this.m_nLeft+n);this.setTop(this.m_nTop+t);this.setRight(this.m_nRight+n);this.setBottom(this.m_nBottom+t)};WDRect.prototype.setSize=function(n,t){this.setRight(this.m_nLeft+n);this.setBottom(this.m_nTop+t)};WDRect.prototype.setSizeAndLocation=function(n,t,i,r){this.setSize(i,r);this.setLocation(n,t,!0)};WDRect.prototype.setLocation=function(n,t,i){!i||(this.setRight(this.m_nRight+(n-this.m_nLeft)),this.setBottom(this.m_nBottom+(t-this.m_nTop)));this.setLeft(n);this.setTop(t)};WDRect.prototype.getLeft=function(){return this.m_nLeft};WDRect.prototype.getTop=function(){return this.m_nTop};WDRect.prototype.getRight=function(){return this.m_nRight};WDRect.prototype.getBottom=function(){return this.m_nBottom};WDRect.prototype.setTop=function(n){this.m_nTop=this.__toN(n)};WDRect.prototype.setRight=function(n){this.m_nRight=this.__toN(n)};WDRect.prototype.setBottom=function(n){this.m_nBottom=this.__toN(n)};WDRect.prototype.setLeft=function(n){this.m_nLeft=this.__toN(n)};WDRect.prototype.__toN=function(n){return Math.max(0,n||0)};WDRect.getWidth=WDRect.prototype.getWidth=function(n){return n||(n=this),n.m_nRight-n.m_nLeft};WDRect.getHeight=WDRect.prototype.getHeight=function(n){return n||(n=this),n.m_nBottom-n.m_nTop};WDRect.intersects=function(n,t){return n.m_nLeft<t.m_nRight&&t.m_nLeft<n.m_nRight&&n.m_nTop<t.m_nBottom&&t.m_nTop<n.m_nBottom};WDRect.getCenterX=function(n){return n.m_nLeft+n.m_nRight>>1};WDRect.prototype.getCenterX=function(){return WDRect.getCenterX(this)};WDRect.getCenterY=function(n){return n.m_nTop+n.m_nBottom>>1};WDRect.prototype.getCenterY=function(){return WDRect.getCenterY(this)};EAxisType.X=0;EAxisType.X2=1;EAxisType.Y=2;EAxisType.Y2=3;EAxisType.Z=4;EAxisOrientation.HORIZONTAL=0;EAxisOrientation.VERTICAL=1;WDChartAxis.prototype.constructor=WDChartAxis;WDChartAxis.prototype.setOriginValue=function(n){this.m_dOriginValue=n};WDChartAxis.prototype.getOriginValue=function(){return this.m_dOriginValue};WDChartAxis.prototype.isXAxis=function(){return this.m_type==EAxisType.X||this.m_type==EAxisType.X2};WDChartAxis.prototype.isYAxis=function(){return this.m_type==EAxisType.Y||this.m_type==EAxisType.Y2};WDChartAxis.prototype.isSecondaryAxis=function(){return this.m_type==EAxisType.X2||this.m_type==EAxisType.Y2};WDChartAxis.prototype.update=function(n){var u,f,s,v,r,y,c,h,e,o,l,a,p,t,i;if(this.m_lstData&&this.m_lstData.length!==0){u=0;f=0;switch(this.m_type){case EAxisType.X:case EAxisType.X2:u=n.getXAxisMin();f=n.getXAxisMax();break;case EAxisType.Y:u=n.getYAxisMin();f=n.getYAxisMax();break;case EAxisType.Y2:u=n.getY2AxisMin();f=n.getY2AxisMax()}if(this.m_dMinValue=u==IWDChartConstant.DEFAULT_VALUE?0:u,this.m_dMaxValue=f==IWDChartConstant.DEFAULT_VALUE?Number.NEGATIVE_INFINITY:f,u==IWDChartConstant.DEFAULT_VALUE||f==IWDChartConstant.DEFAULT_VALUE){if(this.isYAxis()){for(t=0;t<this.m_lstData.length;++t)if(i=this.m_lstData[t],i instanceof WDChartSeries&&i.getChartType()==WDChartParameters.kWaterfall)for(h=i.getNbValues(),s=i.getValueAt(0),t=1;t<h;++t)(v=this.m_oModele.getWaterfallTypeCategorie(t),v!=ETypeCategorieWaterfall.eWaterfallSousTotal&&v!=ETypeCategorieWaterfall.eWaterfallTotal)&&(e=i.getValueAt(t),s+=e,s>this.m_dMaxValue&&(this.m_dMaxValue=s),s<this.m_dMinValue&&(this.m_dMinValue=s));for(r=[],y=0,c=0;c<this.m_lstData.length;++c)if(i=this.m_lstData[c],i instanceof WDChartSeries&&(i.getChartType()==WDChartParameters.kHistoEmpile||i.getChartType()==WDChartParameters.kHistoEmpileHorizontal)){for(h=i.getNbValues(),t=0;t<h;++t)e=i.getValueAt(t),y>0&&t<r.length?(o=r[t],o>0?o+=Math.abs(e):o<0?o-=Math.abs(e):o=e,r[t]=o):r[t]=e;y++}if(u==IWDChartConstant.DEFAULT_VALUE){for(t=0;t<r.length;++t)(t===0||l>r[t])&&(l=r[t]);l<this.m_dMinValue&&(this.m_dMinValue=l)}if(f==IWDChartConstant.DEFAULT_VALUE){for(t=0;t<r.length;++t)(t===0||a<r[t])&&(a=r[t]);a>this.m_dMaxValue&&(this.m_dMaxValue=a)}}for(p=!1,t=0;t<this.m_lstData.length;++t)(i=this.m_lstData[t],this.isYAxis()&&i instanceof WDChartSeries&&(i.getChartType()==WDChartParameters.kHistoEmpile||i.getChartType()==WDChartParameters.kHistoEmpileHorizontal||i.getChartType()==WDChartParameters.kWaterfall))||(!p&&i instanceof WDChartSeries&&u==IWDChartConstant.DEFAULT_VALUE&&WDChartParameters.s_isBoursierChart(i.getChartType())&&(p=!0,this.m_dMinValue===0&&(this.m_dMinValue=Number.POSITIVE_INFINITY)),u==IWDChartConstant.DEFAULT_VALUE&&i.getMinValue()<this.m_dMinValue&&(this.m_dMinValue=i.getMinValue()),f==IWDChartConstant.DEFAULT_VALUE&&i.getMaxValue()>this.m_dMaxValue&&(this.m_dMaxValue=i.getMaxValue()))}}else this.m_dMinValue=0,this.m_dMaxValue=0};WDChartAxis.prototype.isDisplayCategories=function(){return this.m_lstData!=null&&this.m_lstData.length==1&&bCompareFonctions(this.m_lstData[0].constructor,WDChartCategories.prototype.constructor)};WDChartAxis.prototype.isDisplayDecimalValues=function(n){for(var f,i,u,t=!1,r=0;r<this.m_lstData.length;++r)if(f=this.m_lstData[r],f.isContainDecimalValues()){t=!0;break}return i=n.getAxisStep(this),t||i==IWDChartConstant.DEFAULT_VALUE||i==Math.floor(i)||(t=!0),t&&this.isYAxis()&&(u=n.m_sMasqueAxes,u&&!u.indexOf(".")&&(t=!1)),t};WDChartAxis.prototype.hasMasqueAxeY=function(){return this.isYAxis()};WDChartAxis.prototype.getAxisSize=function(n){return this.m_orientation==EAxisOrientation.HORIZONTAL?n.getWidth():n.getHeight()};WDChartAxisContinu.prototype=new WDChartAxis;WDChartAxisContinu.prototype.constructor=WDChartAxisContinu;WDChartAxisContinu.prototype.isDisplayCategories=function(){return!1};WDChartAxisContinu.prototype.hasMasqueAxeY=function(){return this.m_type!=EAxisType.Z};WDChartCategories.s_nNbMsDe1800a1970=53647488e5;WDChartCategories.prototype=new JSONPOO;WDChartCategories.prototype.constructor=WDChartCategories;WDChartCategories.prototype._bEstTypeHeureSelonMasque=function(){return this.m_oModele.m_oParametres.m_sMasqueAxeTemporel?this.m_oModele.m_oParametres.m_sMasqueAxeTemporel.indexOf("H")>-1||this.m_oModele.m_oParametres.m_sMasqueAxeTemporel.indexOf("m")>-1||this.m_oModele.m_oParametres.m_sMasqueAxeTemporel.indexOf("S")>-1||this.m_oModele.m_oParametres.m_sMasqueAxeTemporel.indexOf("C")>-1:this.m_tabValeurDateHeure[0]&&this.m_tabValeurDateHeure[1]&&this.m_tabValeurDateHeure[1]-this.m_tabValeurDateHeure[0]<864e5?!0:!1};WDChartCategories.prototype.bEstTypeHeure=function(){var n=this.m_eTypeWL;return n==25||n==129?!0:n==24||n==128?!1:this._bEstTypeHeureSelonMasque()};WDChartCategories.prototype.bEstTypeDate=function(){var n=this.m_eTypeWL;return n==24||n==128?!0:!this._bEstTypeHeureSelonMasque()};WDChartCategories.prototype.bEstTypeDateHeure=function(){var n=this.m_eTypeWL;return n==26?!0:!1};WDChartCategories.prototype.bEstTypeDuree=function(){var n=this.m_eTypeWL;return n==27?!0:!1};WDChartCategories.prototype.CalculeEchelleTemporelleReguliere=function(){var t=0,n;for(this.m_bEchelleTemporelleReguliere=!0,n=1;n<this.m_tabValeurDateHeure.length;++n)if(n>1){if(t!=this.m_tabValeurDateHeure[n]-this.m_tabValeurDateHeure[n-1]){this.m_bEchelleTemporelleReguliere=!1;break}}else t=this.m_tabValeurDateHeure[n]-this.m_tabValeurDateHeure[n-1]};WDChartCategories.prototype.bEchelleTemporelle=function(){return this.m_oModele.m_oParametres.m_bEchelleTemporelle&&(this.bEstTypeDate()||this.bEstTypeHeure())&&this.m_tabValeurDateHeure&&this.m_tabValeurDateHeure.length&&this.m_tabValeurDateHeure.length===this.m_tabValeur.length};WDChartCategories.prototype.isOnSecondaryAxis=function(){return!1};WDChartCategories.prototype.getMinValue=function(){return 0};WDChartCategories.prototype.getMaxValue=function(){return this.m_oModele.getMaxNbValuesSeries()-1};WDChartCategories.prototype.getNbValues=function(){return this.m_tabValeur?this.m_tabValeur.length+Math.max(this.m_nOffset-1,0):0};WDChartCategories.prototype.getValueAt=function(n){return this.m_tabValeur.length==0?"":n<this.m_nOffset-1?"":this.m_tabValeur[n-(this.m_nOffset-1)]};WDChartCategories.prototype.getTimeInMillisAt=function(n){return!this.m_tabValeurDateHeure||this.m_tabValeurDateHeure.length<=n?0:this.m_tabValeurDateHeure[n].getTime()+(this.bEstTypeHeure()?WDChartCategories.s_nNbMsDe1800a1970:0)};WDChartCategories.prototype.getMinValueInMillis=function(){var n,t,i;if(!this.m_tabValeurDateHeure||this.m_tabValeurDateHeure.length==0)return 0;for(n=Number.POSITIVE_INFINITY,t=0;t<this.m_tabValeurDateHeure.length;++t)i=this.m_tabValeurDateHeure[t].getTime(),i<n&&(n=i);return n+(this.bEstTypeHeure()?WDChartCategories.s_nNbMsDe1800a1970:0)};WDChartCategories.prototype.getMaxValueInMillis=function(){var n,t,i;if(!this.m_tabValeurDateHeure||this.m_tabValeurDateHeure.length==0)return 0;for(n=Number.NEGATIVE_INFINITY,t=0;t<this.m_tabValeurDateHeure.length;++t)i=this.m_tabValeurDateHeure[t].getTime(),i>n&&(n=i);return n+(this.bEstTypeHeure()?WDChartCategories.s_nNbMsDe1800a1970:0)};WDChartCategories.prototype.isContainDecimalValues=function(){return!1};WDChartModel.prototype=new JSONPOO;WDChartModel.prototype.constructor=WDChartModel;WDChartModel.prototype.FLAG_DEJA_DESSINEES=1;WDChartModel.prototype.bDonneesDejaDessinnees=function(){return this.m_oGraphe.m_oDonnees.m_bFlag&&this.m_oGraphe.m_oDonnees.m_bFlag&this.FLAG_DEJA_DESSINEES};WDChartModel.prototype.SetDonneesDessinnees=function(){this.m_oGraphe.m_oDonnees.m_bFlag=(this.m_oGraphe.m_oDonnees.m_bFlag||0)|this.FLAG_DEJA_DESSINEES};WDChartModel.prototype.bParametresDejaDessinnes=function(){return this.m_oGraphe.m_oParametres.m_bFlag&&this.m_oGraphe.m_oParametres.m_bFlag&this.FLAG_DEJA_DESSINEES};WDChartModel.prototype.SetParametresDejaDessinnes=function(){this.m_oGraphe.m_oParametres.m_bFlag=(this.m_oGraphe.m_oParametres.m_bFlag||0)|this.FLAG_DEJA_DESSINEES};WDChartModel.prototype.getNbSeriesType=function(n){return this.m_tabSeriesCountByChartType[n]||0};WDChartModel.prototype.getSeriesAt=function(n,t){return this.m_tabSeries===undefined||this.m_tabSeries[n]===undefined||this.m_tabSeries[n]===null?t?{}:undefined:this.m_tabSeries[n]};WDChartModel.prototype.nGetNbSeries=function(){return this.m_tabSeries.length};WDChartModel.prototype.getSeriesAtSelonType=function(n,t,i){for(var u=n,r=this.getSeriesAt(u++,i);r&&r.getChartType()!=t;)r=this.getSeriesAt(u++,i);return r};WDChartModel.prototype.convertSeriesIndexModelToType=function(n,t){for(var u,r=0,i=0;i<this.m_tabSeries.length;i++)if(u=this.getSeriesAt(i),u.getChartType()==t){if(i==n)return r;r++}return-1};WDChartModel.prototype.convertSeriesIndexTypeToModel=function(n,t){for(var u,r=0,i=0;i<this.m_tabSeries.length;i++)if(u=this.getSeriesAt(i),u.getChartType()==t){if(n==r)return i;r++}return-1};WDChartModel.prototype.getPartOffset=function(n,t){var i;return this.m_tabExcentrage!==undefined&&(n=n-(this.m_nOffsetExcentrage-1),n>=0&&this.m_tabExcentrage!==undefined&&n<this.m_tabExcentrage.length&&(i=this.m_tabExcentrage[n])),(i===undefined?t:i)||0};WDChartModel.prototype.hasPremiereSerieNonVide=function(){return this.m_tabSeries.length>0&&this.m_tabSeries[0].getNbValues()>0};WDChartModel.prototype.hasAuMoinsUneSerieNonVide=function(){for(var n=0;n<this.m_tabSeries.length;++n)if(this.m_tabSeries[n].getNbValues()>0)return!0;return!1};WDChartModel.prototype.getCategoryLabelAt=function(n){var t=this.m_oCategories.getValueAt(n);return t===undefined||t===null?"":t};WDChartModel.prototype.getFromSerieValueAt=function(n,t){return this.m_tabSeries[n].getValueAt(t)};WDChartModel.prototype.getCategoryColor=function(n,t){var i=undefined;return this.m_oCategories!==undefined&&this.m_oCategories.m_tabCouleur!=undefined&&(i=this.m_oCategories.m_tabCouleur[n]),t!==!0&&i==undefined&&(i=this.getSeriesColor(n)),i};WDChartModel.prototype.getWaterfallTypeCategorie=function(n){return n==0?ETypeCategorieWaterfall.eWaterfallTotal:this.m_oCategories===undefined||this.m_oCategories.m_tabTypeCategorieWaterfall==undefined?undefined:(n-=this.getMaxNbValuesSeries()-this.m_oCategories.m_tabTypeCategorieWaterfall.length,this.m_oCategories.m_tabTypeCategorieWaterfall[n]==undefined)?undefined:this.m_oCategories.m_tabTypeCategorieWaterfall[n]};WDChartModel.prototype.bCouleurNonDefinie=function(n){return n===undefined||n===null};WDChartModel.prototype.getSeriesColor=function(n){var i=this.m_tabSeries[n],t;return i&&(t=i.m_sCouleur),this.bCouleurNonDefinie(t)&&(t=WDChartUtils.getCouleurAutoFromIndex(n,this.m_oParametres.m_eSerieCouleur)),t};WDChartModel.prototype.setSeriesColor=function(n,t){var i=this.m_tabSeries[n];i&&(i.m_sCouleur=t)};WDChartModel.prototype.getSeriesAlpha=function(n){var i=this.m_tabSeries[n],t;return i&&(t=i.m_nOpacite),(t===undefined||t===-1)&&(t=this.m_oParametres.byGetAlpha()),t};WDChartModel.prototype.getSeriesSpline=function(n){var i=this.m_tabSeries[n],t;return i&&(t=i.m_eLissage),(t===undefined||t===-1)&&(t=this.m_oParametres.m_bSpline),t};WDChartModel.prototype.getSeriesDessinValeursNulles=function(n){var i=this.m_tabSeries[n],t;return i&&(t=i.m_eDessinValeursNulles),(t===undefined||t===-1)&&(t=this.m_oParametres.m_eDessinValeurNulle),t};WDChartModel.prototype.createAxis=function(){var s,f,h;this.m_lstAxis&&(this.m_lstAxis=null,delete this.m_lstAxis);this.m_lstAxis=[];s=this.m_oParametres.getType();switch(s){case WDChartParameters.kSecteur:case WDChartParameters.kDonut:case WDChartParameters.kHemicycle:case WDChartParameters.kEntonnoir:return}for(var e=[],o=[],i=undefined,u=undefined,n=0,t=undefined,r,n=0;this.m_tabSeries&&n<this.m_tabSeries.length;n+=r)(r=1,t=this.m_tabSeries[n],t)&&((r=this.m_oGraphe.m_oVue.m_oRenderer.nGetPasSerie(t),this.m_oGraphe.m_oVue.m_oRenderer&&this.m_oGraphe.m_oVue.m_oRenderer.bEstLegendeMasquee(n))||((r==1||WDChartParameters.s_isBoursierChart(t.getChartType()))&&(t.isOnSecondaryAxis()?(i||(i=[]),i.push(t)):o.push(t)),r>1&&this.m_tabSeries[n+1]&&(WDChartParameters.s_isBoursierChart(t.getChartType())||e.push(t),f=this.m_tabSeries[n+1],f.isOnSecondaryAxis()?(i||(i=[]),i.push(f)):o.push(f)),r>2&&this.m_tabSeries[n+2]&&(h=this.m_tabSeries[n+2],u||(u=[]),u.push(h))));e.length?this.m_lstAxis.push(new WDChartAxisContinu(EAxisType.X,e,this)):this.m_lstAxis.push(new WDChartAxis(EAxisType.X,[this.m_oCategories],this));this.m_lstAxis.push(new WDChartAxisContinu(EAxisType.Y,o,this));i!=null&&this.m_lstAxis.push(new WDChartAxisContinu(EAxisType.Y2,i,this));u!=null&&this.m_lstAxis.push(new WDChartAxisContinu(EAxisType.Z,u,this))};WDChartModel.prototype.getCategoryIndexForTime=function(n){for(var u,i=0,r=0,t=0;t<this.m_oCategories.getNbValues();++t){if(u=this.m_oCategories.getTimeInMillisAt(t),u<=n)i=r;else break;r++}return i};WDChartModel.prototype.getMaxNbValuesSeries=function(){var t=0,n,r,i;if(this.m_tabSeries)for(n=0;n<this.m_tabSeries.length;++n)r=this.m_tabSeries[n],i=r.getNbValues(),i>t&&(t=i);return t};WDChartModel.prototype.getAxisByType=function(n){var r,t,i;if(this.m_lstAxis)for(r=this.m_lstAxis.length,t=0;t<r;++t)if(i=this.m_lstAxis[t],i.m_type==n)return i;return undefined};EAlgoGestionAltitude.eagaDegradeLineaire=0;EAlgoGestionAltitude.eagaPalierInferieur=1;EAlgoGestionAltitude.eagaPalierSuperieur=2;CCouleurAltitude.prototype=new JSONPOO;CCouleurAltitude.prototype.constructor=CCouleurAltitude;CCouleurAltitude.prototype.bUtiliseCouleurAltitude=function(){return this.m_tabKeysTriees.length>0};CCouleurAltitude.prototype.AddCouleurAltitude=function(n,t){this.m_tabCouleurAltitude[n]=t;this.Trie()};CCouleurAltitude.prototype.Trie=function(){this.m_tabKeysTriees=Object.getOwnPropertyNames(this.m_tabCouleurAltitude).sort(function(n,t){return parseFloat(n)<parseFloat(t)?-1:1})};CCouleurAltitude.prototype.nGetNbCouleurs=function(){return this.m_tabKeysTriees.length};CCouleurAltitude.prototype.stGetI=function(n){return{m_crCouleur:this.m_tabCouleurAltitude[this.m_tabKeysTriees[n]],m_dAltitude:parseFloat(this.m_tabKeysTriees[n])}};CCouleurAltitude.prototype.sGetCouleurAltitude=function(n){for(var f,i,t={},u={},r=0;r<this.nGetNbCouleurs();++r){if((t=this.stGetI(r),r==0&&n<t.m_dAltitude)||t.m_dAltitude==n)return t.m_crCouleur;if(r<this.m_tabKeysTriees.length-1&&(u={m_crCouleur:this.m_tabCouleurAltitude[this.m_tabKeysTriees[r+1]],m_dAltitude:parseFloat(this.m_tabKeysTriees[r+1])},n<u.m_dAltitude&&n>t.m_dAltitude))switch(this.m_eAlgoPalier){case EAlgoGestionAltitude.eagaPalierInferieur:return u.m_crCouleur;case EAlgoGestionAltitude.eagaPalierSuperieur:return t.m_crCouleur;case EAlgoGestionAltitude.eagaDegradeLineaire:default:f=u.m_dAltitude-t.m_dAltitude;i=0;f!=0&&(i=(n-t.m_dAltitude)/f);var e=clWDUtil.tabHTML2RVBA(t.m_crCouleur),o=clWDUtil.tabHTML2RVBA(u.m_crCouleur),s=i*o[0]+(1-i)*e[0],h=i*o[1]+(1-i)*e[1],c=i*o[2]+(1-i)*e[2];return clWDUtil.sRVBA2HTML([s,h,c,1])}}if(this.m_tabKeysTriees.length)return this.m_tabCouleurAltitude[this.m_tabKeysTriees[this.m_tabKeysTriees.length-1]]};WDChartDataSampler.prototype.constructor=WDChartDataSampler;WDChartDataSampler.prototype.getSampleCategoryIndexAt=function(n){return this.m_tabCategoryIndexes!=null&&n>=0&&n<this.m_tabCategoryIndexes.length?this.m_tabCategoryIndexes[n]:-1};WDChartDataSampler.prototype.getValueDrawingPosition=function(n){return this.m_oSeries.getValueDrawingPosition(this.m_oSeries.m_model.getValueAt(n),this.m_dYOriginValue,this.m_nSeriesIndex,n,this.m_bSeriesOnSecondaryAxis)};WDChartDataSampler.prototype.getData=function(n,t){for(var r=[],i=n;i<=t;i++)r.push(this.getValueDrawingPosition(i));return r};WDChartDataSampler.prototype.doSample=function(n,t,i){var r,a,o,s,h,u,f,v,y,e,l;if(this.m_nFirstCategoryIndex!=n||this.m_nLastCategoryIndex!=t||this.m_nSampleValuesCount!=i){r=0;this.m_oSeries.m_chartRenderer.getSeriesDessinValeursNullesAt(this.m_nSeriesIndex)==eDESSINVALEURNULLE.eValeurNulleNonDessinee?r=2:(this.m_oSeries.m_chartRenderer.m_timeScale&&!this.m_oSeries.m_oModele.m_oCategories.m_bEchelleTemporelleReguliere||0||(r=1),i*(this.m_oSeries.m_chartRenderer.m_timeScale?3:100)<this.m_oSeries.m_model.getNbValues()&&(r=1));WDChartDataSampler.bAlgoPDF!==undefined&&(r=WDChartDataSampler.bAlgoPDF);switch(r){case 1:this.m_tabCategoryIndexes=largestTriangleThreeBuckets(undefined,this.m_oSeries.m_model.m_tabValeur.slice(n,t),i);break;case 2:this.m_tabCategoryIndexes=largestTriangleThreeBuckets(this,t-n,i);break;case 3:this.m_tabCategoryIndexes=largestTriangleThreeBuckets(this,this.getData(n,t,i),i);break;case 0:default:for(this.m_nFirstCategoryIndex=n,this.m_nLastCategoryIndex=t,this.m_nSampleValuesCount=i,this.m_tabCategoryIndexes=[n],a=i,o=this.getValueDrawingPosition(n),u=new Bucket,f=1;f<a-1;f++){this.getBucket(f,u);v=u.m_nFirstCategoryIndex;y=u.m_nLastCategoryIndex;this.getBucket(f+1,u);h=this.getBucketPointPosition(u);var c=0,p=0,w=0;for(e=v;e<=y;e++)s=this.getValueDrawingPosition(e),l=this.calculateTriangleArea(o.x,o.y,s.x,s.y,h.x,h.y),(l>w||c===0)&&(w=l,p=s,c=e);this.m_tabCategoryIndexes.push(c);o=p}}}};WDChartDataSampler.prototype.getBucket=function(n,t){if(n==0){t.set(this.m_nFirstCategoryIndex,this.m_nFirstCategoryIndex);return}if(n==this.m_nSampleValuesCount){t.set(this.m_nLastCategoryIndex,this.m_nLastCategoryIndex);return}var i=1,u=2,f=this.m_nLastCategoryIndex-this.m_nFirstCategoryIndex+i-u,e=this.m_nSampleValuesCount-u,o=f/e,r=f%e;n=n-i;t.m_nFirstCategoryIndex=this.m_nFirstCategoryIndex+i+n*o;t.m_nFirstCategoryIndex+=n<r?n:r;t.m_nLastCategoryIndex=t.m_nFirstCategoryIndex+o-1;n<r&&t.m_nLastCategoryIndex++;t.m_nFirstCategoryIndex=parseInt(t.m_nFirstCategoryIndex);t.m_nLastCategoryIndex=parseInt(t.m_nLastCategoryIndex)};WDChartDataSampler.prototype.getBucketPointPosition=function(n){for(var r,u=0,f=0,t=0,i=n.m_nFirstCategoryIndex;i<=n.m_nLastCategoryIndex;i++)r=this.getValueDrawingPosition(i),u+=r.x,f+=r.y,t++;return t==0&&(t=1),{x:u/t,y:f/t}};WDChartDataSampler.prototype.calculateTriangleArea=function(n,t,i,r,u,f){return Math.abs((n-u)*(r-t)-(n-i)*(f-t))};Bucket.prototype.constructor=Bucket;Bucket.prototype.set=function(n,t){this.m_nFirstCategoryIndex=n;this.m_nLastCategoryIndex=t},function(n,t){"use strict";typeof define=="function"&&define.amd?define([],t):n.largestTriangleThreeBuckets=t()}(this,function(){"use strict";function n(n,t,i){var w=Math.floor,ut=Math.abs,p=clWDUtil.isArray(t)?t.length:t,b=[],g=0,k=(p-2)/(i-2),h=0,nt,c,e,tt,o,l=0,a=0,u,s,it,r,rt,v,y,f,d;if(i>=p||i===0)return t;for(d=clWDUtil.isObject(t[0]),b[g++]=h,o=0;o<i-2;o++){if(l=0,a=0,u=w((o+1)*k)+1,s=w((o+2)*k)+1,s=s<p?s:p,it=s-u,n)for(;u<s;u++)f=d?t[u]:n.getValueDrawingPosition(u),l+=f.x,a+=f.y;else for(;u<s;u++)l+=u,a+=t[u];if(l/=it,a/=it,r=w(o*k)+1,rt=w((o+1)*k)+1,n)for(f=d?t[h]:n.getValueDrawingPosition(h),v=f.x,y=f.y,c=e=-1;r<rt;r++)f=d?t[r]:n.getValueDrawingPosition(r),e=ut((v-l)*(f.y-y)-(v-f.x)*(a-y))*.5,e>c&&(c=e,nt=r,tt=r);else for(v=h,y=t[h],c=e=-1;r<rt;r++)e=ut((v-l)*(t[r]-y)-(v-r)*(a-y))*.5,e>c&&(c=e,nt=r,tt=r);b[g++]=nt;h=tt}return b[g++]=p-1,b}return n});WDChartAnimation.prototype.constructor=WDChartAnimation;WDChartAnimation.prototype.run=function(){var n=this.prepare(this.m_domBaliseAnim.wbData("wbGrfAnim",this));n.animate(this.oStyleCssAnimation,this);clWDUtil.bEstChaineNonVide(this.queue)&&n.dequeue(this.queue)};WDChartAnimation.getAnim=function(n){return clWDUtil.isObject(n)&&n.m_oAnimator!==undefined?n:$(n).wbData("wbGrfAnim")};WDChartAnimation.prototype.prepare=function(n){return n};WDChartAnimation.prototype.tween=function(n,t,i){return i===undefined&&(i=this.m_dNow),WDChartAnimation.tween(n,t,i)};WDChartAnimation.tween=function(n,t,i){var r=t*i+(1-i)*n;return Math.abs(r)<.1?Math.round(r*1e10)/1e10:r};WDChartAnimation.prototype.tweenX=function(n,t,i){return this.tween(parseFloat(n),parseFloat(t),i)};WDChartAnimation.prototype.tweenY=function(n,t,i){return this.tween(parseFloat(n),parseFloat(t),i)};WDChartAnimation.prototype.tweenRect=function(n,t,i){return i===undefined&&(i=this.m_dNow),new WDRect(this.tweenX(n.m_nLeft,t.m_nLeft,i),this.tweenY(n.m_nTop,t.m_nTop,i),this.tweenX(n.m_nRight,t.m_nRight,i),this.tweenY(n.m_nBottom,t.m_nBottom,i))};WDChartAnimation.prototype.start=function(){var n=WDChartAnimation.getAnim(this);n.m_domEtatInitial=n.m_oPicture.m_domBaliseSVG.clone(!0,!0);WDPictureSVG.MethodeVDOM==WDPictureSVG.VDOM_JQUERYUI&&(n.m_domEtatInitial.off(),$(n.m_domEtatInitial.get(0).querySelectorAll("*")).off());n.m_domEtatInitial[0].wbGrfClone=!0};WDChartAnimation.prototype.step=function(n,t){var i=WDChartAnimation.getAnim(this);i&&(i.m_dNow=t.b1erStepFait?n:0,t.b1erStepFait=!0,i.m_oGraphe.m_oVue.Redessine(i.m_oGraphe,WDChartView.ms_nDessinAnimation))};WDChartAnimation.prototype.progress=function(n,t,i){var r=WDChartAnimation.getAnim(this);r&&(r.m_dProgress=t,r.m_dRemainingMS=i)};WDChartAnimation.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_domEtatInitial&&(n.m_domEtatInitial[0].wbGrfClone===!0&&n.m_domEtatInitial.empty().removeData().unbind(),n.m_domEtatInitial=null),n.m_oAnimator&&n.m_oAnimator.retireAnimation(n),n.m_domBaliseAnim&&n.m_domBaliseAnim.wbRemoveData("wbGrfAnim"))};WDChartAnimation.prototype.always=function(){var n=WDChartAnimation.getAnim(this);n&&n.done.apply(this,arguments)};WDChartAnimation.prototype.tweenHideLabel=function(n,t){return this.m_bToujoursAvecLibelles?t:this.m_dNow<=1/3?this.m_oModelePrecedent===undefined?!t:t:this.m_dNow<=2/3?!0:(this.m_dNow<1,t)};WDChartAnimation.prototype.tweenLabelPaint=function(n,t){var i=1;return this.m_dNow<=1/3?i=Math.sin(Math.PI/2*(1/3-this.m_dNow)*3):this.m_dNow<=2/3?i=0:this.m_dNow<1&&(i=Math.sin(Math.PI/2*((this.m_dNow-2/3)*3/2))),t.m_oStyle.opacity=i,t};WDChartAnimation.prototype.bAnimationPasFinie=function(){var n=WDChartAnimation.getAnim(this);return n?n.m_domBaliseAnim.wbData("wbGrfAnim")?!(n.m_dNow==1):!1:!1};WDChartAnimation.prototype.bAnimationPasCommencee=function(){var n=WDChartAnimation.getAnim(this);return n?!(n.m_dNow==0):!1};WDChartAnimationValeur.prototype=new WDChartAnimation;WDChartAnimationValeur.prototype.constructor=WDChartAnimationValeur;WDChartAnimationValeur.prototype.tweenValue=function(n,t,i,r){var u,f=0,e,o;return this.m_oGraphe&&(e=this.m_oGraphe.m_oModele.getAxisByType(EAxisType.Y),f=e?e.m_dOriginValue:0),this.m_oModelePrecedent&&(this.m_oModelePrecedent.m_tabSeries.length<=r?u=f:(o=this.m_oModelePrecedent.m_tabSeries[r].length,i>=o&&(u=this.m_oModelePrecedent.m_tabSeries[r].m_tabValeur[o-1]))),u===undefined&&(u=this.m_oModelePrecedent?this.m_oModelePrecedent.m_tabSeries[r].m_tabValeur[i]||f:f),this.tween(u,t)};WDChartAnimationValeur.prototype.tweenRedessineAxes=function(){return this.m_dNow===0?!0:!1};WDChartAnimationNoDraw.prototype=new WDChartAnimation;WDChartAnimationNoDraw.prototype.constructor=WDChartAnimationNoDraw;WDChartAnimationNoDraw.prototype.run=function(){};WDChartAnimationNoDraw.prototype.start=function(){var n=WDChartAnimation.getAnim(this);n.m_dNow=0;n.m_domEtatInitial=n.m_oPicture.m_domBaliseSVG};WDChartAnimationNoDraw.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_dNow=1,WDChartAnimation.prototype.done.apply(this,arguments))};WDChartAnimationNoDraw.prototype.step=function(n){var t=WDChartAnimation.getAnim(this);if(t)return t.m_dNow=n,t};WDChartAnimator.prototype.constructor=WDChartAnimator;WDChartAnimator.prototype.sGetFonctionEase=function(){return["linear","swing","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInExpo","easeOutExpo","easeInOutExpo","easeInSine","easeOutSine","easeInOutSine","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInBounce","easeOutBounce","easeInOutBounce"][parseInt10(Math.random()*32)]};WDChartAnimator.prototype.add=function(n,t,i){if(i!==!0&&this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){var r=this.m_oGraphe.m_oVue.m_oPicture.m_domBaliseSVG.wbData("wbGrfModeAffichage")===WDChartView.ms_nDessin1erAffichage;if(r)return}t&&(this.m_bDessinComplet=!0);this.m_tabAnimations.push(n);n.m_oAnimator=this;i!==!0&&n.run()};WDChartAnimator.prototype.call=function(n,t){var r,i=n[n.length===1?0:1],u;if(n[0]&&clWDUtil.isObject(n[0])&&n[0].queue&&n[0].queue("fx").length>0)return i;for(r=0;r<this.m_tabAnimations.length;++r)if(u=this.m_tabAnimations[r],u[t]!==undefined&&(i=u[t].apply(u,n),i!==undefined&&(n[n.length===1?0:1]=i,typeof i=="boolean"&&i)))return i;return i};WDChartAnimator.prototype.TermAnimator=function(){};WDChartAnimator.prototype.play1erAffichage=function(n,t){t.Raz();n.m_oVue.onDraw(n,WDChartView.ms_nDessinParDefaut)};WDChartAnimator.prototype.playMajDonnees=function(n,t){this.play1erAffichage(n,t)};WDChartAnimator.prototype.playModifTypeGraphe=function(n,t){this.play1erAffichage(n,t)};WDChartAnimator.prototype.retireAnimation=function(n){var t=this.m_tabAnimations.indexOf(n);t>-1&&this.m_tabAnimations.splice(t,1)};WDChartAnimator.prototype.tweenLegendPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenLegendPaint")};WDChartAnimator.prototype.tweenGroupeLegende=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenGroupeLegende")};WDChartAnimator.prototype.tweenGroupeTitre=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenGroupeTitre")};WDChartAnimator.prototype.tweenValue=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenValue")};WDChartAnimator.prototype.tweenHideLabel=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenHideLabel")};WDChartAnimator.prototype.bAnimationEnCours=function(){return this.m_tabAnimations.length>0};WDChartAnimator.prototype.bAnimationPasCommencee=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"bAnimationPasCommencee")};WDChartAnimator.prototype.bAnimationPasFinie=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"bAnimationPasFinie")};WDChartAnimator.prototype.bDessinComplet=function(){return this.m_bDessinComplet};WDChartAnimator.prototype.NotifDessinComplet=function(){this.m_bDessinComplet=!1};WDChartListener.prototype.constructor=WDChartListener;WDChartListener.getListener=function(n,t){var i=n.nodeType?n.wbGrfBind:n[0].wbGrfBind;return!t&&i&&i.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()?undefined:i};WDChartListener.bind=function(n,t,i,r,u,f,e){var o,s,h;if(t.m_oParametres.m_eEtat)switch(t.m_oParametres.m_eEtat){case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:return undefined}if(o=WDChartListener.getListener(i,!0),o&&bCompareFonctions(o.constructor,n.prototype.constructor))return o;o=new n(t,i,r,u,f,e);for(s in o)h="on"+s,s!="constructor"&&(bIEAvec11||i[0][h]!==undefined||s.indexOf("touch")===0||bFF&&s==="DOMMouseScroll")&&i.bind(s,o[s]);return o.setListener(i),o};WDChartListener.prototype.setListener=function(n){return n[0].wbGrfBind=this};WDChartZoom.prototype.constructor=WDChartZoom;WDChartZoom.prototype.reset=function(n){this.m_oRenderer&&this.m_oRenderer.bAutoriseZoom()&&(n&&this.m_oRenderer.m_oOrigineSansZoom===undefined||(this.m_dOrigineMinX=n?this.m_oRenderer.m_oOrigineSansZoom.X.min:undefined,this.m_dOrigineMaxX=n?this.m_oRenderer.m_oOrigineSansZoom.X.max:undefined,this.m_dOrigineMinY=n?this.m_oRenderer.m_oOrigineSansZoom.Y.min:undefined,this.m_dOrigineMaxY=n?this.m_oRenderer.m_oOrigineSansZoom.Y.max:undefined,this.m_dOrigineMinY2=n?this.m_oRenderer.m_oOrigineSansZoom.Y.min:undefined,this.m_dOrigineMaxY2=n?this.m_oRenderer.m_oOrigineSansZoom.Y.max:undefined))};WDChartZoom.prototype.setDouble=function(n,t){return this.setCoeff(n,t,2)};WDChartZoom.prototype.setRect=function(n,t){var i=this.m_oRenderer;n.getWidth()<2||n.getHeight()<2||(fMinMax=this.m_params.m_bAxeXHorizontal?Math.min:Math.max,this.__calculeUnitesDepuisCoordonnees(fMinMax(n.m_nLeft,n.m_nRight),fMinMax(n.m_nTop,n.m_nBottom),t),this.m_dOrigineMinX=this.m_dUniteMireX,this.m_dOrigineMaxY=this.m_dUniteMireY,this.m_axisRendererY2&&(this.m_dOrigineMaxY2=this.m_dUniteMireY2),fMinMax=this.m_params.m_bAxeXHorizontal?Math.max:Math.min,this.__calculeUnitesDepuisCoordonnees(fMinMax(n.m_nLeft,n.m_nRight),fMinMax(n.m_nTop,n.m_nBottom),t),this.m_dOrigineMaxX=this.m_dUniteMireX,this.m_dOrigineMinY=this.m_dUniteMireY,this.m_axisRendererY2&&(this.m_dOrigineMinY2=this.m_dUniteMireY2))};WDChartZoom.prototype.__calculeUnitesDepuisCoordonnees=function(n,t,i){var r=this.m_oRenderer,u;if(!i){if(u=r.coordonneesEcranVersGraphe(n,t),!u)return;n=u.x;t=u.y}r.m_rectAxis&&(n=Math.min(r.m_rectAxis.m_nRight,Math.max(r.m_rectAxis.m_nLeft,n)),t=Math.min(r.m_rectAxis.m_nBottom,Math.max(r.m_rectAxis.m_nTop,t)));this.m_params.m_bAxeXHorizontal?(this.m_dUniteMireX=this.m_axisRendererX.m_axis.m_dOriginValue+Math.round((n-this.m_oRenderer.nGetXOrigin())/this.m_oRenderer.dGetXPixelsPerUnit()),this.m_dUniteMireY=this.m_axisRendererY.m_axis.m_dOriginValue+Math.round((this.m_oRenderer.nGetYOrigin()-t)/this.m_oRenderer.dGetYPixelsPerUnit()),this.m_axisRendererY2&&(this.m_dUniteMireY2=this.m_axisRendererY2.m_axis.m_dOriginValue+Math.round((this.m_oRenderer.nGetYOrigin(!0)-t)/this.m_oRenderer.dGetYPixelsPerUnit(!0)))):(this.m_dUniteMireX=this.m_axisRendererX.m_axis.m_dOriginValue+Math.round((this.m_oRenderer.nGetYOrigin()-t)/this.m_oRenderer.dGetXPixelsPerUnit()),this.m_dUniteMireY=this.m_axisRendererY.m_axis.m_dOriginValue+Math.round((n-this.m_oRenderer.nGetXOrigin())/this.m_oRenderer.dGetYPixelsPerUnit()),this.m_axisRendererY2&&(this.m_dUniteMireY2=this.m_axisRendererY2.m_axis.m_dOriginValue+Math.round((n-this.m_oRenderer.nGetXOrigin())/this.m_oRenderer.dGetYPixelsPerUnit(!0))))};WDChartZoom.prototype.setCoeffMinMax=function(n,t,i,r){var u=this.m_oRenderer;u&&u.bAutoriseZoom()&&(u.m_oZoom||this.reset(!0),this.m_dOrigineMinX=n===undefined||n===""?this.m_dOrigineMinX:n*(u.m_oOrigineSansZoom.X.min+(u.m_oOrigineSansZoom.X.max-u.m_oOrigineSansZoom.X.min)),this.m_dOrigineMaxX=t===undefined||t===""?this.m_dOrigineMaxX:t*(u.m_oOrigineSansZoom.X.min+(u.m_oOrigineSansZoom.X.max-u.m_oOrigineSansZoom.X.min)),this.m_dOrigineMinY=i===undefined||i===""?this.m_dOrigineMinY:i*(u.m_oOrigineSansZoom.Y.min+(u.m_oOrigineSansZoom.Y.max-u.m_oOrigineSansZoom.Y.min)),this.m_dOrigineMaxY=r===undefined||r===""?this.m_dOrigineMaxY:r*(u.m_oOrigineSansZoom.Y.min+(u.m_oOrigineSansZoom.Y.max-u.m_oOrigineSansZoom.Y.min)),this.m_axisRendererY2&&(this.m_dOrigineMinY2=i===undefined||i===""?this.m_dOrigineMinY2:i*(u.m_oOrigineSansZoom.Y2.min+(u.m_oOrigineSansZoom.Y2.max-u.m_oOrigineSansZoom.Y2.min)),this.m_dOrigineMaxY2=r===undefined||r===""?this.m_dOrigineMaxY2:r*(u.m_oOrigineSansZoom.Y2.min+(u.m_oOrigineSansZoom.Y2.max-u.m_oOrigineSansZoom.Y2.min))))};WDChartZoom.prototype.deplace=function(n,t){var i=this.m_oRenderer,r,u,f;return i.m_oZoom||this.reset(!0),r=Math.round(n/this.m_oRenderer.dGetXPixelsPerUnit()),r<0?this.m_dOrigineMinX+r<i.m_oOrigineSansZoom.X.min&&(r=0,this.m_dOrigineMaxX=i.m_oOrigineSansZoom.X.min+(this.m_dOrigineMaxX-this.m_dOrigineMinX),this.m_dOrigineMinX=i.m_oOrigineSansZoom.X.min):this.m_dOrigineMaxX+r>i.m_oOrigineSansZoom.X.max&&(r=0,this.m_dOrigineMinX=i.m_oOrigineSansZoom.X.max-(this.m_dOrigineMaxX-this.m_dOrigineMinX),this.m_dOrigineMaxX=i.m_oOrigineSansZoom.X.max),this.m_dOrigineMinX+=r,this.m_dOrigineMaxX+=r,u=Math.round(t/this.m_oRenderer.dGetYPixelsPerUnit()),u<0?this.m_dOrigineMinY+u<i.m_oOrigineSansZoom.Y.min&&(u=0,this.m_dOrigineMaxY=i.m_oOrigineSansZoom.Y.min+(this.m_dOrigineMaxY-this.m_dOrigineMinY),this.m_dOrigineMinY=i.m_oOrigineSansZoom.Y.min):this.m_dOrigineMaxY+u>i.m_oOrigineSansZoom.Y.max&&(u=0,this.m_dOrigineMinY=i.m_oOrigineSansZoom.Y.max-(this.m_dOrigineMaxY-this.m_dOrigineMinY),this.m_dOrigineMaxY=i.m_oOrigineSansZoom.Y.max),this.m_dOrigineMinY+=u,this.m_dOrigineMaxY+=u,f=0,this.m_axisRendererY2&&(f=Math.round(t/this.m_oRenderer.dGetYPixelsPerUnit(!0)),f<0?this.m_dOrigineMinY2+f<i.m_oOrigineSansZoom.Y2.min&&(f=0,this.m_dOrigineMaxY2=i.m_oOrigineSansZoom.Y2.min+(this.m_dOrigineMaxY2-this.m_dOrigineMinY2),this.m_dOrigineMinY2=i.m_oOrigineSansZoom.Y2.min):this.m_dOrigineMaxY2+f>i.m_oOrigineSansZoom.Y2.max&&(f=0,this.m_dOrigineMinY2=i.m_oOrigineSansZoom.Y2.max-(this.m_dOrigineMaxY2-this.m_dOrigineMinY2),this.m_dOrigineMaxY2=i.m_oOrigineSansZoom.Y2.max),this.m_dOrigineMinY2+=f,this.m_dOrigineMaxY2+=f),{x:r*this.m_oRenderer.dGetXPixelsPerUnit(),y:u*this.m_oRenderer.dGetYPixelsPerUnit()}};WDChartZoom.prototype.checkXMinZoom=function(n){return n<this.m_oRenderer.m_oOrigineSansZoom.X.min?this.m_oRenderer.m_oOrigineSansZoom.X.min:n};WDChartZoom.prototype.checkXMaxZoom=function(n){return n>this.m_oRenderer.m_oOrigineSansZoom.X.max?this.m_oRenderer.m_oOrigineSansZoom.X.max:n};WDChartZoom.prototype.checkYMinZoom=function(n){return n<this.m_oRenderer.m_oOrigineSansZoom.Y.min?this.m_oRenderer.m_oOrigineSansZoom.Y.min:n};WDChartZoom.prototype.checkYMaxZoom=function(n){return n>this.m_oRenderer.m_oOrigineSansZoom.Y.max?this.m_oRenderer.m_oOrigineSansZoom.Y.max:n};WDChartZoom.prototype.checkY2MinZoom=function(n){return n<this.m_oRenderer.m_oOrigineSansZoom.Y2.min?this.m_oRenderer.m_oOrigineSansZoom.Y2.min:n};WDChartZoom.prototype.checkY2MaxZoom=function(n){return n>this.m_oRenderer.m_oOrigineSansZoom.Y2.max?this.m_oRenderer.m_oOrigineSansZoom.Y2.max:n};WDChartZoom.prototype.setCoeff=function(n,t,i,r){var v=this.m_oRenderer,c;v.m_oZoom||this.reset(!0);c=v.m_params;this.__calculeUnitesDepuisCoordonnees(n,t);r===undefined&&(r=i);var l=this.m_dUniteMireX,a=this.m_dUniteMireY,y=this.m_dUniteMireY2||0;var e=(1-1/i)*l+this.m_dOrigineMinX/i,o=(1-1/r)*a+this.m_dOrigineMinY/r,h=(1-1/r)*y+(this.m_dOrigineMinY2||0)/r,u=(1-1/i)*l+this.m_dOrigineMaxX/i,f=(1-1/r)*a+this.m_dOrigineMaxY/r,s=(1-1/r)*y+(this.m_dOrigineMaxY2||0)/r;return(e=this.checkXMinZoom(e),u=this.checkXMaxZoom(u),o=this.checkYMinZoom(o),f=this.checkYMaxZoom(f),h=this.checkY2MinZoom(h),s=this.checkY2MaxZoom(s),e==u&&(u==this.m_oRenderer.m_oOrigineSansZoom.X.max?--e:++u),o==f&&(f==this.m_oRenderer.m_oOrigineSansZoom.Y.max?--o:++f),h==s&&(s==this.m_oRenderer.m_oOrigineSansZoom.Y.max?--h:++s),e==this.m_oRenderer.m_oOrigineSansZoom.X.min&&u==this.m_oRenderer.m_oOrigineSansZoom.X.max&&o==this.m_oRenderer.m_oOrigineSansZoom.Y.min&&f==this.m_oRenderer.m_oOrigineSansZoom.Y.max?this.reset():(c.isHorizontalZoomEnabled()&&(this.m_dOrigineMinX=e,this.m_dOrigineMaxX=u),c.isVerticalZoomEnabled()&&(this.m_dOrigineMinY=o,this.m_dOrigineMaxY=f,this.m_dOrigineMinY2=h,this.m_dOrigineMaxY2=s)),this.m_dOrigineMinY>this.m_dOrigineMaxY)?!1:this.m_dOrigineMinX>this.m_dOrigineMaxX?!1:void 0};WDChartZoom.prototype.setMolette=function(n,t,i){return this.setCoeff(n,t,Math.pow(i<0?1.3:.7,Math.abs(i)/100))};WDChartZoom.prototype.bZoomGauche=function(n){return n/this.m_oPicture.m_domBaliseSVG.width()<.66};WDChartZoom.prototype.bZoomDroite=function(n){return n/this.m_oPicture.m_domBaliseSVG.width()>.33};WDChartZoom.prototype.bZoomHaut=function(n){return n/this.m_oPicture.m_domBaliseSVG.height()>.33};WDChartZoom.prototype.bZoomBas=function(n){return n/this.m_oPicture.m_domBaliseSVG.height()>.33};var PROFILMIRESIMPLE=1,PROFILMIREMULTIPLE=2,PROFILBULLESEULE=3;WDChartRenderer.prototype.toggleZoomDouble=function(n,t,i){var r=new WDChartZoom(this);return this.m_oZoom?r.reset():r.setDouble(n,t),this.drawZoom(r,i)};WDChartRenderer.prototype.bAutoriseZoom=function(){return this.m_oGraphe.m_oVue.m_oRenderer.m_timeScale!=ETimeScale.NONE?!1:this.getAxisRendererForType};WDChartRenderer.prototype.__bInitZoom=function(){if(!this.bAutoriseZoom())return!1;var r=this.m_oGraphe.m_oVue.m_oPicture,n=this.getAxisRendererForType(EAxisType.X),i=this.getAxisRendererForType(EAxisType.Y),t=this.getAxisRendererForType(EAxisType.Y2);return!n||!i?!1:(this.m_oOrigineSansZoom||(this.m_oOrigineSansZoom={X:{max:n.m_axis.m_dMaxValue+(n.isDrawLabelsBetweenGraduations()?1:0),min:n.m_axis.m_dMinValue},Y:{max:i.m_axis.m_dMaxValue,min:i.m_axis.m_dMinValue},Y2:{max:t?t.m_axis.m_dMaxValue:undefined,min:t?t.m_axis.m_dMinValue:undefined}}),this.m_params.isHorizontalZoomEnabled()||this.m_params.isVerticalZoomEnabled())};WDChartRenderer.prototype.coordonneesEcranVersGraphe=function(n,t){var l,y,p,w;if(n!==undefined&&t!==undefined){var e=this,r=this.m_oGraphe.m_oVue.m_oPicture,u=n,f=t,i=r.m_domBaliseSVG.wbData("wbGrfOnScrollResize");if(i&&i.height||$(window).on("scroll.wb.grf.mire resize.wb.grf.mire trigger.wb.grf.mire",function(){r.m_domBaliseSVG.wbData("wbGrfOnScrollResize",i={offset:r.m_domBaliseSVG.offset(),width:r.m_domBaliseSVG.width(),height:r.m_domBaliseSVG.height()})}).trigger("trigger.wb.grf.mire"),l=i.offset,u=n-l.left,f=t-l.top,y=r.m_domBaliseSVG[0].getAttribute("preserveAspectRatio")==="none",y)u=u/i.width*$(e.m_oGraphe.m_oHoteImage).data("width"),f=f/i.height*$(e.m_oGraphe.m_oHoteImage).data("height");else{var a=i.width,v=i.height,o=$(e.m_oGraphe.m_oHoteImage).data("width"),s=$(e.m_oGraphe.m_oHoteImage).data("height"),h,c;o>s?(h=a,c=a*(s/o)):(c=v,h=v*(o/s));p=(a-h)/2;w=(v-c)/2;u=(u-p)/h*o;f=(f-w)/c*s}return{x:u,y:f}}};WDChartRenderer.prototype.setZoom=function(n,t,i,r){if(n&&(this.__bInitZoom()||n.m_bDepuisGrZoom)){var u=this;u.m_oZoom=n;t=t?t:u.m_params.m_oAxeX;i=i?i:u.m_params.m_oAxeY;r=r?r:u.m_params.m_oAxeYSecondaire;t.m_bOrigineMin=t.m_bOrigineMax=i.m_bOrigineMin=i.m_bOrigineMax=!1;t.m_dOrigineMin=t.m_dOrigineMax=i.m_dOrigineMin=i.m_dOrigineMax=0;r&&(r.m_bOrigineMin=r.m_bOrigineMax=!1,r.m_dOrigineMin=r.m_dOrigineMax=0);n.m_dOrigineMinX!==undefined&&(t.m_bOrigineMin=!0,t.m_dOrigineMin=Math.round(this.m_params.m_bZoomArriereInfini?n.m_dOrigineMinX:n.checkXMinZoom(n.m_dOrigineMinX)));n.m_dOrigineMaxX!==undefined&&(t.m_bOrigineMax=!0,t.m_dOrigineMax=Math.round(this.m_params.m_bZoomArriereInfini?n.m_dOrigineMaxX:n.checkXMaxZoom(n.m_dOrigineMaxX)));n.m_dOrigineMinY!==undefined&&(i.m_bOrigineMin=!0,i.m_dOrigineMin=Math.round(this.m_params.m_bZoomArriereInfini?n.m_dOrigineMinY:n.checkYMinZoom(n.m_dOrigineMinY)));n.m_dOrigineMaxY!==undefined&&(i.m_bOrigineMax=!0,i.m_dOrigineMax=Math.round(this.m_params.m_bZoomArriereInfini?n.m_dOrigineMaxY:n.checkYMaxZoom(n.m_dOrigineMaxY)));r&&n.m_dOrigineMinY2!==undefined&&(r.m_bOrigineMin=!0,r.m_dOrigineMin=Math.round(this.m_params.m_bZoomArriereInfini?n.m_dOrigineMinY2:n.checkY2MinZoom(n.m_dOrigineMinY2)));r&&n.m_dOrigineMaxY2!==undefined&&(r.m_bOrigineMax=!0,r.m_dOrigineMax=Math.round(this.m_params.m_bZoomArriereInfini?n.m_dOrigineMaxY2:n.checkY2MaxZoom(n.m_dOrigineMaxY2)));t.m_dOrigineMin==this.m_oOrigineSansZoom.X.min&&t.m_dOrigineMax==this.m_oOrigineSansZoom.X.max&&i.m_dOrigineMin==this.m_oOrigineSansZoom.Y.min&&i.m_dOrigineMax==this.m_oOrigineSansZoom.Y.max&&(t.m_bOrigineMin=t.m_bOrigineMax=i.m_bOrigineMin=i.m_bOrigineMax=!1);t.m_bOrigineMin||t.m_bOrigineMax||i.m_bOrigineMin||i.m_bOrigineMax||(this.m_oZoom=undefined)}};WDChartRenderer.prototype.drawZoom=function(n,t){var i=this;if(n&&(this.__bInitZoom()||n.m_bDepuisGrZoom))return this.setZoom(n),i.rafZoom!==undefined&&cancelAnimationFrame(i.rafZoom),i.rafZoom=requestAnimationFrame(function(){i.m_oGraphe.m_oVue.Redessine(i.m_oGraphe,WDChartView.ms_nDessinParDefaut);i.rafZoom=undefined;t&&requestAnimationFrame(t)}),!0};WDChartRenderer.prototype.drawRectZoom=function(n,t,i){var r=this.m_oGraphe.m_oVue.m_oPicture,u=r.g(r.m_domBaliseSVG,"groupe-zoom");if(n){var l=r.rect(u,"fond"),f=i?"#f8cccc":"#cceaf8",e=clWDUtil.sGetCouleurHTMLAssocie(f);this.m_oPaint.setFill(f);this.m_oPaint.setFillOpacity255(125);this.m_oPaint.setStroke(e);r.drawRect(l,t,this.m_oPaint,undefined,undefined,!1);var o=i?$("<span/>").html("&#x1f50d;").text()+"-":$("<span/>").html("&#x1f50d;").text()+"+",s="user-select:none;font-size:150%;fill:"+e+";",h=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLibelle,o,["lineHeight","width"],s),c=r.text(u,"taille");this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle);this.m_oPaint.setStyle(s);h.width>t.getWidth()?r.empty(c):r.drawText(c,o,parseInt(h.lineHeight),t.m_nLeft+t.getWidth()/2,t.m_nTop+t.getHeight()/2,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint,!1)}else r.empty(u)};WDChartRenderer.prototype.drawMire=function(n,t,i,r,u,f,e,o){var h=this,pr,y,pi,s,wi,wr,bi,ki,wu,bu,hi,ci,pt,gr,ku,ur,nu,et,ot,l,v,or,ti,ru,uu,sr,vt,fu,eu,ff,k,vr,ef,su,of,hu,bt,yi,yr,cu,yt,ri;if(h.m_oPaint.raz(),pr=!1,y=h.m_params,e?pi=e.getChartType():o=0,s=pi===undefined?y.getType():pi,y.m_bBulleActive){if(h.m_oGraphe.m_oParametres.m_eType==WDChartParameters.kHeatMap){if(!r){for(wr=h.m_domGroupeSeries.find("rect"),bi=0;bi<wr.length;++bi)wi=WDChartListener.bind(WDChartMireListener,h.m_oGraphe,wr.eq(bi),i);wi=WDChartListener.bind(WDChartMireListener,h.m_oGraphe,n.m_domBaliseSVG,i)}}else wi=WDChartListener.bind(WDChartMireListener,h.m_oGraphe,n.m_domBaliseSVG,i),h.m_oMireListener=wi;if(h.m_domGroupeSeries&&h.m_domGroupeSeries.length!==0&&h.m_domGroupeSeries.children().length!==0&&!h.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()){var a=u,g=f,lu=r===undefined||isNaN(r.pageX)||isNaN(r.pageY);if(!lu){if(ki=h.coordonneesEcranVersGraphe(r.pageX,r.pageY),!ki)return;a=ki.x;g=ki.y}if(a!==undefined&&g!==undefined){WDChartRenderer.prototype.s_m_nProfileMireForce=WDXYChartRenderer.prototype.s_m_nProfileMireForce;var au=e&&(s==WDChartParameters.kHisto||s==WDChartParameters.kHistoHorizontal)||s==WDChartParameters.kCourbe||s==WDChartParameters.kRadar||s==WDChartParameters.kAire||s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHistoEmpileHorizontal,sf=s==WDChartParameters.kBulle||s==WDChartParameters.kNuage||s==WDChartParameters.kCourbe||s==WDChartParameters.kAire||s==WDChartParameters.kHeatMap,br=WDChartRenderer.prototype.s_m_nProfileMireForce||(y.m_bMire?y.m_bMireMultiple&&au?PROFILMIREMULTIPLE:PROFILMIRESIMPLE:PROFILBULLESEULE),dt=!(s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle)&&br!==PROFILBULLESEULE,st=dt&&au&&br===PROFILMIREMULTIPLE||!1,ht=br===PROFILMIREMULTIPLE&&!(s==WDChartParameters.kRadar)||s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle||WDChartRenderer.prototype.s_m_bSuivreCurseurForce===!0||!1,ft=st&&!0,di=0,hf=!0,ct=1,lt=ct,gt=100,at=!0,gi=!st&&sf&&!0,vu=dt&&!(s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHisto||s==WDChartParameters.kHistoEmpileHorizontal||s==WDChartParameters.kHistoHorizontal||s==WDChartParameters.kWaterfall||s==WDChartParameters.kRadar)&&!0,ui=!gi&&ft,yu=ft||!1,cf=!0,pu=st||s==WDChartParameters.kRadar||s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle||WDChartRenderer.prototype.s_m_bDeplacementForce===!0||!1,lf=s==WDChartParameters.kBulle||s==WDChartParameters.kHeatMap||s==WDChartParameters.kNuage||s==WDChartParameters.kCourbe||s==WDChartParameters.kAire||s==WDChartParameters.kRadar,kr=lf&&!0?3:0,nr=!ht&&(s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHisto||s==WDChartParameters.kHistoEmpileHorizontal||s==WDChartParameters.kHistoHorizontal||s==WDChartParameters.kWaterfall)||!1,fi=!nr&&!1,af=!1,vf=!1,dr=!0,yf=!1,ei=!dt&&(s==WDChartParameters.kNuage||s==WDChartParameters.kCourbe||s==WDChartParameters.kAire||s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHisto||s==WDChartParameters.kHistoEmpileHorizontal||s==WDChartParameters.kHistoHorizontal||s==WDChartParameters.kWaterfall||s==WDChartParameters.kRadar),ni=!ft&&!ht&&(!1||ei||!dt&&(s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHisto||s==WDChartParameters.kHistoEmpileHorizontal||s==WDChartParameters.kHistoHorizontal||s==WDChartParameters.kWaterfall)||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle||s==WDChartParameters.kEntonnoir),oi=!(s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle||s==WDChartParameters.kEntonnoir),pf=undefined,tr=undefined,si=undefined,df=undefined,d=h.m_rectChartInitial;h.m_rectAxis!==undefined&&(d.m_nLeft=h.m_rectAxis.m_nLeft,d.m_nBottom=h.m_rectAxis.m_nBottom,wu=n.findFromId(n.m_domBaliseSVG,"axe-vert-2").length>0,(wu||gi)&&(d.m_nRight=h.m_rectAxis.m_nRight),bu=n.findFromId(n.m_domBaliseSVG,"axe-horiz-2").length>0,(bu||dt)&&(d.m_nTop=h.m_rectAxis.m_nTop));var tt=!0,c=0,it=undefined,nt=0,v,ir=h.m_rectAxis||d;if(tt=a<ir.m_nLeft||g<ir.m_nTop||a>ir.m_nRight||g>ir.m_nBottom,!tt)if(s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle)tt=h.m_domGroupeSeries.find("path:hover").length===0,tt&&(hi=h.m_domGroupeSeries.find("path").first().wbData("wbGrfDrawPath"),hi&&(tt=hi.width<Math.sqrt(Math.pow(Math.abs(a-hi.x),2)+Math.pow(Math.abs(g-hi.y),2))));else if(s==WDChartParameters.kEntonnoir)tt=h.m_domGroupeSeries.find("path:hover").length===0;else if(s==WDChartParameters.kHisto||s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHistoHorizontal||s==WDChartParameters.kHistoEmpileHorizontal||s==WDChartParameters.kWaterfall)tt=h.m_domGroupeSeries.find("rect:hover").length===0,tt&&i.wbData("wbGrfMireSerie")!==undefined&&i.wbData("wbGrfMireX")!==undefined&&(ci=n.findFromId(h.m_domGroupeSeries,"groupe-serie-"+i.wbData("wbGrfMireSerie")),ci.length>0&&(pt=n.findFromId(ci,"series-barre-"+i.wbData("wbGrfMireX")),pt.length>0&&(tt=g<pt.attr("y"),tt||(tt=g>parseInt10(pt.attr("y"))+parseInt10(pt.attr("height"))),tt||(gr=n.findFromId(ci,"series-barre-"+(parseInt10(i.wbData("wbGrfMireX"))+1)),tt=gr.length>0?a>gr.attr("x"):a>parseInt10(pt.attr("x"))+parseInt10(pt.attr("width")),tt||(ku=n.findFromId(ci,"series-barre-"+(parseInt10(i.wbData("wbGrfMireX"))-1)),ku.length==0&&(tt=a<pt.attr("x")))))));else if(s==WDChartParameters.kHeatMap&&r&&r.target&&r.target.nodeType==1&&r.target.tagName.toLowerCase()=="rect")l=$(r.target),tt=!1;else if(s==WDChartParameters.kNuage||s==WDChartParameters.kRadar||s==WDChartParameters.kBulle||s==WDChartParameters.kHeatMap){var du=n.m_domBaliseSVG.find("*:hover").last(),rr=undefined;for(c=o;e&&!st&&pr?o==c:c<h.m_oGraphe.m_oModele.m_tabSeries.length;c+=h.nGetPasSerie(h.m_oGraphe.m_oModele.m_tabSeries[c]))if((it=n.findFromId(n.m_domBaliseSVG,"groupe-serie-"+c),it&&it.length!==0&&(h.m_oGraphe.m_oVue.bEstSerieMasquee(c)!==!0||!oi))&&(l=n.findFromId(it,"serie-line-"+c),l.length!==0))for(v=l.wbData("wbGrfSeriePoints"),nt=0;nt<v.length;++nt)ur=Math.abs(Math.abs(a)-Math.abs(parseInt10(v[nt].x)))+Math.abs(Math.abs(g)-Math.abs(parseInt10(v[nt].y))),nu=!1,rr!=ur||!1||(nu=s==WDChartParameters.kBulle||s==WDChartParameters.kHeatMap?du.is(n.findFromId(l,"series-"+c+"-point-"+nt)):l.is(du)),(rr===undefined||rr>ur||nu)&&(rr=ur,tr=nt,si=c);v&&(pf=v[tr])}if(tt){pi===undefined&&i.wbData("wbGrfMireFade")===1&&(i.stop("wbGrfMireFade",!0).wbData("wbGrfMireFade",0).animate({opacity:0},{duration:1e3,queue:"wbGrfMireFade"}).dequeue("wbGrfMireFade"),h.surbrillanceSerieDepuisMire(n,i.wbData("wbGrfMireSerie"),!1,!0,a,g));return}var wf=ht&&pu,bf=!0,rt=y.m_sCouleurAxe;rt=clWDUtil.sGetCouleurHTMLAssocie(rt);var w=d.m_nTop,li=y.m_sClasseBulle,ai=[],gu=[],vi=[],p,fr,ut,tu=[],er,b={},iu=a,nf=0,kt=undefined;for(c=o;p===undefined&&(e&&!st&&pr?o==c:c<h.m_oGraphe.m_oModele.m_tabSeries.length);c+=h.nGetPasSerie(h.m_oGraphe.m_oModele.m_tabSeries[c]))if(et=!1,it=n.findFromId(n.m_domBaliseSVG,"groupe-serie-"+c),it&&it.length!==0&&(h.m_oGraphe.m_oVue.bEstSerieMasquee(c)!==!0||!oi)){if(v=undefined,s==WDChartParameters.kCourbe||s==WDChartParameters.kAire){if(k=n.findFromId(it,"serie-line-"+c),k.length===0)continue;l=k;v=l.wbData("wbGrfSeriePoints")}else if(s==WDChartParameters.kNuage||s==WDChartParameters.kRadar){if(si!==undefined&&si!=c&&!st)continue;if(k=n.findFromId(it,"serie-line-"+c),k.length===0)continue;if(l=k,v=l.wbData("wbGrfSeriePoints"),tr!==undefined)kt=tr;else if(s==WDChartParameters.kNuage||kt===undefined)for(or=undefined,ti=0;ti<v.length;++ti)ru=Math.abs(Math.abs(a)-Math.abs(parseInt10(v[ti].x)))+Math.abs(Math.abs(g)-Math.abs(parseInt10(v[ti].y))),(or===undefined||or>ru)&&(or=ru,kt=ti);et=!0;ot=kt;dr=h.m_rectAxis.getCenterX()>v[kt].x;v=[{x:v[kt].x,y:v[kt].y}]}else if(s==WDChartParameters.kBulle){if(si!==undefined&&si!=c&&!st)continue;if(k=n.findFromId(it,"serie-line-"+c),k.length===0)continue;l=k;uu=l.find("circle");uu.length>0?(sr=undefined,uu.each(function(){var n=$(this),t=Math.abs(Math.abs(a)-Math.abs(parseInt10(n.attr("cx"))))+Math.abs(Math.abs(g)-Math.abs(parseInt10(n.attr("cy"))));(sr===undefined||sr>t)&&(sr=t,l=n)}),et=!0,ot=parseInt10(n.getId(l).substr(n.getId(l).lastIndexOf("-")+1)),v=[{x:l.attr("cx"),y:l.attr("cy")}]):v=l.wbData("wbGrfSeriePoints")}else if(s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle){if(k=h.m_domGroupeSeries.find("path:hover"),k.length===0)continue;if(l=k,et=!0,ot=WDPieChartRenderer.nGetIndicePart(n,l),vt=l.wbData("wbGrfDrawPath"),vt){var hr=vt.x,cr=vt.y,ii=vt.width,lr=a,ar=g;if(!ht)if(1)fu=Number(vt.options.startAngle+vt.options.sweep/2).toRad(),lr=hr+ii*Math.cos(fu),ar=cr+ii*Math.sin(fu);else{var tf=Number(vt.options.startAngle).toRad(),rf=Number(vt.options.startAngle+vt.options.sweep).toRad(),uf=hr+ii*Math.cos(tf),kf=hr+ii*Math.cos(rf);lr=uf+(kf-uf)/2;eu=cr+ii*Math.sin(tf);ff=cr+ii*Math.sin(rf);ar=eu+(ff-eu)/2}ar>cr?(fi=!0,nr=!fi):(fi=!1,nr=!fi);dr=lr<hr?!0:!1;v=[{x:lr,y:ar}]}else v=[{x:a,y:g}]}else if(s==WDChartParameters.kHisto||s==WDChartParameters.kHistoHorizontal||s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHistoEmpileHorizontal||s==WDChartParameters.kWaterfall||s==WDChartParameters.kHeatMap){if(k=r&&r.target&&r.target.nodeType==1&&r.target.tagName.toLowerCase()=="rect"?$(r.target):it.find("rect:hover"),k.length===0)continue;if(l=k,s!=WDChartParameters.kHeatMap&&(vr=l.wbData(),!(vr&&vr.wbGrfGrInfoXY&&vr.wbGrfGrInfoXY[0]==c)))continue;et=!0;ot=parseInt10(n.getId(l).substr(n.getId(l).lastIndexOf("-")+1));v=[{x:parseInt10(l.attr("x"))+parseInt10(l.attr("width"))/2,y:l.attr("y")}];s==WDChartParameters.kHeatMap&&(y.m_nMireOpacite=y.m_nMireEpaisseur=y.m_sMireCouleur=undefined,ct=h.m_dXPixelsPerUnit,lt=h.m_dYPixelsPerUnit,gt=0,rt=h.m_oGraphe.m_oModele.getSeriesColor(c))}else if(s==WDChartParameters.kMinMax||s==WDChartParameters.kChandelier||s==WDChartParameters.kBarCharts){var k=it.find("g:hover"),ou=!1,wt=this.m_mapSeriesRenderer[h.getSeriesAt(c).getChartType()];if(k.length===0){if(ef=h.m_oModele.getAxisByType(EAxisType.X),su=h.m_oGraphe.m_oModele.m_tabSeries[c],!su)continue;if(of=su.getNbValues(),hu=h.getDrawnValuesCount(of,ef),hu==0)continue;for(bt=0;bt<=hu;++bt)if(yi=h.getCategoryDrawingPositionX(bt+h.getFirstDrawnCategoryIndex(h.m_oModele.getAxisByType(EAxisType.X)),ou),yi+=wt.m_nBarSpacing+wt.m_nBarWidth/2,yi>a)break;if(yr=h.getCategoryDrawingPositionX(Math.max(bt-1,0),ou),yr+=wt.m_nBarSpacing+wt.m_nBarWidth/2,bt>0&&a-yr<yi-a?(--bt,a=yr):a=yi,ot=bt,k=n.findFromId(it,"groupe-chandelier-"+this.m_oGraphe.m_oModele.convertSeriesIndexTypeToModel(0,wt.getChartType())+"-barre-"+ot),!k||!k.length)return;l=k}else l=k,ot=parseInt10(n.getId(l).substr(n.getId(l).lastIndexOf("-")+1)),a=h.getCategoryDrawingPositionX(ot,ou)+(wt.m_nBarSpacing+wt.m_nBarWidth/2);y.m_nMireOpacite=y.m_nMireEpaisseur=y.m_sMireCouleur=undefined;lt=ct=wt.m_nBarWidth;gt=10;rt=h.m_oGraphe.m_oModele.getSeriesColor(c);et=!0;v=[{x:a,y:g}]}else return;if(v)for(h.nGetPasSerie(h.m_oGraphe.m_oModele.m_tabSeries[c])>1&&(v=[].concat(v),v.map(function(n,t){var i=n;return i.index=t,i}),v.sort(function(n,t){return n.x<t.x?-1:n.x>t.x?1:0})),nt=0;nt<v.length;++nt)if(clWDUtil.isObject(v[nt])?b=v[nt]:b.x=v[nt].x,b.x=parseInt10(b.x),cu=et,et||(cu=nt<v.length-1?Math.abs((parseInt10(v[nt+1].x||b.x+20)-b.x)/2)>Math.abs(a-b.x):v.length>1?Math.abs((b.x-parseInt10(v[nt-1].x||b.x-20))/2)>Math.abs(b.x-a):Math.abs(a-b.x)<20),cu){ai.length===0&&(nf=c);iu=s==WDChartParameters.kRadar&&nf!=c?iu:b.x;fr=et?ot:b.index!==undefined?b.index:nt;tu[c]=fr;ut=!et&&b.nCategoryIndex!==undefined?b.nCategoryIndex:fr;b.y=parseInt10(v[nt].y);yt=b.y;er!==!0&&(er=et?!0:Math.abs(g-yt)<20);ht&&(yt=g);!st&&er?(p=c,w=yt):w=s==WDChartParameters.kRadar?ai.length===0?yt:w:ai.length===0?yt:Math.min(w,yt);ai[c]=yt;gu[c]=b.x;vi[c]=b.y;break}else if(b.x>a)break}if(a=iu,!st&&p===undefined){if(p=i.wbData("wbGrfMireSerie"),p==undefined)return;if(it=n.g("groupe-serie-"+p),h.m_oGraphe.m_oVue.bEstSerieMasquee(p)===!0&&oi){i.wbData("wbGrfMireSerie",undefined);return}w=ai[p];c=p;s==WDChartParameters.kNuage||s==WDChartParameters.kCourbe||s==WDChartParameters.kAire||s==WDChartParameters.kRadar?l=n.findFromId(it,"serie-line-"+c):s==WDChartParameters.kBulle||s==WDChartParameters.kHeatMap?l=$().add(n.findFromId(it,"serie-line-"+c)).find("circle:hover").first():s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle?l=h.m_domGroupeSeries.find("path:hover"):(s==WDChartParameters.kHisto||s==WDChartParameters.kHistoHorizontal||s==WDChartParameters.kDonut||s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHistoEmpileHorizontal||s==WDChartParameters.kWaterfall)&&(l=it.find("rect:hover"))}if(w!==undefined&&er!==undefined)return lu?(ri=p===undefined?1:h.nGetPasSerie(h.m_oGraphe.m_oModele.m_tabSeries[p]),[p,ut,p!==undefined&&ut!==undefined?h.m_oGraphe.m_oModele.m_tabSeries[p+(ri>1?1:0)].getValueAtWithNull(ut):undefined,p!==undefined&&ut!==undefined?h.m_oGraphe.m_oModele.m_tabSeries[p+(ri>2?2:0)].getValueAtWithNull(ut):undefined,p!==undefined&&ut!==undefined?h.m_oGraphe.m_oModele.m_tabSeries[p+(ri>3?3:0)].getValueAtWithNull(ut):undefined,p!==undefined&&ut!==undefined?h.m_oGraphe.m_oModele.m_tabSeries[p+(ri>4?4:0)].getValueAtWithNull(ut):undefined]):(h.rAF!==undefined&&cancelAnimationFrame(h.rAF),h.rAF=requestAnimationFrame(function(){var wr=!(!pu&&fr===i.wbData("wbGrfMireX")&&(ft||p==i.wbData("wbGrfMireSerie")))||hf&&i.css("opacity")==0,br,pt,ti,tr,wt,ir,rr,ur,er,or,k,f,e,hi,it,ru,tt,kt,ci,si,lr,ar,ai,vt,u,pi,wi,yt,wu,bi,ki,bu,yr,pr;if(wr&&i.wbData("wbGrfMireFade")!==1&&i.stop("wbGrfMireFade",!0).wbData("wbGrfMireFade",1).animate({opacity:1},{duration:400,queue:"wbGrfMireFade"}).dequeue("wbGrfMireFade"),!wr){p!==undefined&&h.surbrillanceSerieDepuisMire(n,s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle||s==WDChartParameters.kHeatMap?ot:p,!0,undefined,a,g,l);return}if(i.wbData("wbGrfMireSerie",p),i.wbData("wbGrfMireX",ut),br=i.parent(),i.detach(),pt=n.g(i,"mire-axes-groupe"),ti=n.g(i,"mire-point-groupe"),ti.css("pointerEvents","none"),tr=n.g(i,"mire-bulle-groupe"),n.empty(ti),n.empty(pt),wt=vi[p],dt&&(vu&&(ir=n.line(pt,"mire-vert-haut"),ct=y.m_nMireEpaisseur||ct,rt=y.m_sMireCouleur||rt,h.m_oPaint.setStroke(rt,ct,(y.m_nMireOpacite||gt)/100),h.m_oPaint.DesactivePointerEvents(),n.SetAntiAliasing(!1,ir),n.drawLine(ir,a,w+di+(gi?lt:0),a,d.m_nBottom,h.m_oPaint),rr=n.line(pt,"mire-vert-bas"),ct=y.m_nMireEpaisseur||ct,rt=y.m_sMireCouleur||rt,h.m_oPaint.setStroke(rt,ct,(y.m_nMireOpacite||gt)/100),h.m_oPaint.DesactivePointerEvents(),n.SetAntiAliasing(!1,rr),n.drawLine(rr,a,d.m_nTop,a,w-di,h.m_oPaint)),gi&&(ur=n.line(pt,"mire-horiz-gauche"),lt=y.m_nMireEpaisseur||lt,rt=y.m_sMireCouleur||rt,h.m_oPaint.setStroke(rt,lt,(y.m_nMireOpacite||gt)/100),h.m_oPaint.DesactivePointerEvents(),n.SetAntiAliasing(!1,ur),er=h.getAxisRendererForType(EAxisType.Y),er&&er.isDrawLabelsBetweenGraduations()&&(wt+=h.m_dYPixelsPerUnit/2),n.drawLine(ur,d.m_nLeft,wt,a-di-(vu?ct/2:0),wt,h.m_oPaint),or=n.line(pt,"mire-horiz-droit"),lt=y.m_nMireEpaisseur||lt,rt=y.m_sMireCouleur||rt,h.m_oPaint.setStroke(rt,lt,(y.m_nMireOpacite||gt)/100),h.m_oPaint.DesactivePointerEvents(),n.SetAntiAliasing(!1,or),n.drawLine(or,a+di+lt,wt,d.m_nRight,wt,h.m_oPaint))),cf){var o=[],v=[],sr=!0,gr=0;for(c=0,ri=1;c<h.m_oGraphe.m_oModele.m_tabSeries.length;c+=h.nGetPasSerie(h.m_oGraphe.m_oModele.m_tabSeries[c]))if((s=h.m_oGraphe.m_oModele.m_tabSeries[c].getChartType(),k=undefined,s==WDChartParameters.kSecteurMultiniveau&&(k=l.attr("fill")),k===undefined&&ut!==undefined&&(k=h.m_oGraphe.m_oModele.getCategoryColor(ut,!0)),k||(k=s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle?h.m_oGraphe.m_oModele.getCategoryColor(ot):s==WDChartParameters.kWaterfall||s==WDChartParameters.kNuage?l.attr("stroke"):s==WDChartParameters.kHeatMap?l.attr("fill"):h.m_oGraphe.m_oModele.getSeriesColor(c)),h.surbrillanceSerieDepuisMire(n,s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle||s==WDChartParameters.kHeatMap?ot:c,p===c,undefined,a,g,l),p===undefined||p==c)&&(h.m_oGraphe.m_oVue.bEstSerieMasquee(c)!==!0||!oi)&&ut!==undefined){if(f=h.m_oGraphe.m_oModele.m_tabSeries[c].m_nEpaisseur,e=ut,et||(h.m_oOrigineSansZoom?e+=h.m_oOrigineSansZoom.X.min:h.m_params.getXAxisMin()!=IWDChartConstant.DEFAULT_VALUE&&(e+=h.m_params.getXAxisMin())),hi=s==WDChartParameters.kSecteurMultiniveau?l.wbData("wbGrfNode").name:h.m_oGraphe.m_oModele.getCategoryLabelAt(e),it=s==WDChartParameters.kSecteurMultiniveau?l.wbData("wbGrfNode").value:h.m_oGraphe.m_oModele.m_tabSeries[c].getValueAtWithNull(e),l.wbData("wbGrfDrawMire")&&l.wbData("wbGrfDrawMire").valeur&&(it=l.wbData("wbGrfDrawMire").valeur),it===IWDChartConstant.NULL_VALUE)continue;if(kr>0&&tu[c]!==undefined){var nu="series-"+c+"-point-"+tu[c],iu=n.findFromId(h.m_domGroupeSeries,nu),nt=undefined;iu.length>0?(nt=iu.clone(),WDPictureSVG.MethodeVDOM==WDPictureSVG.VDOM_JQUERYUI&&nt.off(),nt.css("strokeWidth",parseInt10(nt.attr("stroke-width"))+kr),s==WDChartParameters.kBulle?nt.attr("fill","transparent"):s==WDChartParameters.kHeatMap&&nt.attr("fill","rgba(255,255,255,0.3)"),n.setId(nt,nu+"-clone"),ti.append(nt)):a<d.m_nRight&&vi[c]>d.m_nTop&&a>d.m_nLeft&&vi[c]<d.m_nBottom&&(nt=n.circle(ti,"mire-point-"+c),ru=clWDUtil.sCouleurHTMLPlusBrillante(k),h.m_oPaint.setFill(s==WDChartParameters.kBulle||s==WDChartParameters.kHeatMap?"transparent":ru),h.m_oPaint.setStroke(k,f),n.drawCircle(nt,gu[c],vi[c],f+kr,h.m_oPaint))}var t=h.m_oGraphe.m_oModele.m_tabSeries[c].sGetBullePoint(ut)||(s==WDChartParameters.kMinMax||s==WDChartParameters.kBarCharts||s==WDChartParameters.kChandelier?h.m_params.m_sBulleBoursier||GRF.BULLE.BOURSIER:s==WDChartParameters.kEntonnoir||s==WDChartParameters.kSecteur||s==WDChartParameters.kSecteurMultiniveau||s==WDChartParameters.kDonut||s==WDChartParameters.kHemicycle?h.m_params.m_sBulleSecteur||"[%CATEGORIE%]\n[%VALEUR%]\n[%%%]":s==WDChartParameters.kNuage?h.m_params.m_sBulleNuage||"[%X%]\n[%Y%]\n[%SERIE%]\n[%CATEGORIE%]":s==WDChartParameters.kBulle?h.m_params.m_sBulleBulle||"([%X%];[%Y%]): [%Z%]\n[%CATEGORIE%]":s==WDChartParameters.kHeatMap?h.m_params.m_sBulleHeatmap||"([%X%];[%Y%]): [%Z%]\n[%SERIE%]\n[%CATEGORIE%]":y.m_sBulle||undefined),uu="",fu="",eu="",ou="",su="",hr="",cr="",ii=ft?"":hi||"",bt=h.m_oGraphe.m_oModele.m_tabSeries[c].m_sLibelle||"",hu=(ft?"[%VALEUR%]":"")+WDChartUtils.formatValue(it,y.m_sMasqueValeur,!0)+(ft?"[%VALEUR%]":""),ku=l.wbData("wbGrfPieLabelRenderer")?l.wbData("wbGrfPieLabelRenderer").m_strPercentLabel||"":"";if(s==WDChartParameters.kNuage||s==WDChartParameters.kBulle||s==WDChartParameters.kHeatMap?((s==WDChartParameters.kBulle||s==WDChartParameters.kHeatMap)&&(eu=h.m_oGraphe.m_oModele.m_tabSeries[c+2].getValueAtWithNull(e)),fu=h.m_oGraphe.m_oModele.m_tabSeries[c+1].getValueAtWithNull(e),uu=it,bt=h.m_oGraphe.m_oModele.m_tabSeries[c].m_sLibelle||""):(s==WDChartParameters.kMinMax||s==WDChartParameters.kBarCharts||s==WDChartParameters.kChandelier)&&(ou=it,su=h.m_oGraphe.m_oModele.m_tabSeries[c+1].getValueAtWithNull(e),hr=h.m_oGraphe.m_oModele.m_tabSeries[c+2]?h.m_oGraphe.m_oModele.m_tabSeries[c+2].getValueAtWithNull(e):0,cr=h.m_oGraphe.m_oModele.m_tabSeries[c+3]?h.m_oGraphe.m_oModele.m_tabSeries[c+3].getValueAtWithNull(e):0),ft&&(s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHistoEmpileHorizontal)&&(gr+=parseInt10(it)),t===undefined&&(t="",isNaN(parseInt10(ii))&&!clWDUtil.bEstChaineNonVide(ii)||(t+=ii+"\n"),isNaN(parseInt10(bt))&&!clWDUtil.bEstChaineNonVide(bt)||(t+=bt+" = "),t+="[%VALEUR%]"),t=t.replace("[%CATEGORIE%]",ii).replace("[%CATEGORY%]",ii).replace("[%SERIE%]",bt).replace("[%SERIES%]",bt).replace("[%VALEUR%]",hu).replace("[%VALUE%]",hu).replace("[%X%]",uu).replace("[%Y%]",fu).replace("[%Z%]",eu).replace("[%%%]",ku).replace("[%MIN%]",ou).replace("[%MAX%]",su).replace("[%DEBUT%]",hr).replace("[%BEGIN%]",hr).replace("[%FIN%]",cr).replace("[%END%]",cr).replace(/\n\n/g,"\n"),tt=undefined,ft){for(v.length===0&&(o[0]=(h.m_params.m_sBulleEnteteMire||"[%CATEGORIE%]").replace("[%CATEGORIE%]",hi).replace("[%CATEGORY%]",hi),tt=new WDPaintCSS,tt.addClasse(li),tt.DesactivePointerEvents(),v[0]=tt),kt=t.split("[%VALEUR%]"),o.push([$("<span/>").html("&#8226; ").text()].concat(kt.length==1?kt[0].split("\n").join(" "):kt.slice(0,kt.length-1))),ci=new WDPaintCSS,ci.setFill(k),tt=new WDPaintCSS,tt.addClasse(li),tt.DesactivePointerEvents(),ci.DesactivePointerEvents(),v.push([ci,tt]),kt.length==3&&(si=new WDPaintCSS,si.addClasse(li),si.css("font-weight","bold"),si.DesactivePointerEvents(),v[v.length-1]=v[v.length-1].concat([si,tt]));c+1<h.m_oGraphe.m_oModele.m_tabSeries.length;){if(!1==h.m_oGraphe.m_oVue.bEstSerieMasquee(c+1)&&oi&&h.m_oGraphe.m_oModele.m_tabSeries[c+1].getValueAtWithNull(e)!==IWDChartConstant.NULL_VALUE)break;++c}if(c+h.nGetPasSerie(h.m_oGraphe.m_oModele.m_tabSeries[c])<h.m_oGraphe.m_oModele.m_tabSeries.length)continue;for(ft&&(s==WDChartParameters.kHistoEmpile||s==WDChartParameters.kHistoEmpileHorizontal)&&(lr=WDChartUtils.formatValue(gr,y.m_sMasqueValeur,!0),o[0]=o[0].replace("[%VALEUR%]",lr).replace("[%VALUE%]",lr)),ar=1,t=o[0],t==""&&(o=o.slice(1),v=v.slice(1),ar=0),ai=ar;ai<o.length;++ai)t!=""&&(t+="\n"),t+=o[ai].join("")}var yi=WDPaintCSS.oGetInfoCSS(li,t.replace(/\n/g,"<br>"),["width","height","lineHeight","fontSize"]),du=Math.ceil(parseInt10(yi.width)),nf=Math.ceil(parseInt10(yi.height)),cu=parseInt10(yi.lineHeight);f=1;vt=du+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2+f*2+IWDChartConstant.MARGIN_LEGEND_BORDER;u=nf+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2+f*2+IWDChartConstant.MARGIN_LEGEND_BORDER;at?(w-=u,(ui&&sr||ni&&ht&&at)&&(w+=u/2)):(ui&&sr||ni&&ht&&!at)&&(w-=u/2);bTouch&&ui&&ht&&(w-=32+u);pi=w>=d.m_nTop;wi=w+u<=d.m_nBottom;pi&&wi||((fi?wi:!pi)?yf||(yu?w=d.m_nTop:w+=(ui?u/2:u)+(at?IWDChartConstant.MARGIN_LEGEND_BORDER:0)):(ni&&ht||(nr?pi:!wi))&&(yu?w=d.m_nBottom-u:w-=(ui?u/2:u)+(at?IWDChartConstant.MARGIN_LEGEND_BORDER:0)));var r,lu=a-d.m_nLeft>=vt/(ni?2:1),au=a+vt/(ni?2:1)<=d.m_nRight,vr=!1;!vf&&((dr?!lu:au)||af)?r=new WDRect(a+IWDChartConstant.MARGIN_LEGEND_BORDER,w+(at?0:IWDChartConstant.MARGIN_LEGEND_BORDER),a+vt,w+u-(at?IWDChartConstant.MARGIN_LEGEND_BORDER:0)):(vr=!0,r=new WDRect(a-vt,w+(at?0:IWDChartConstant.MARGIN_LEGEND_BORDER),a-IWDChartConstant.MARGIN_LEGEND_BORDER,w+u-(at?IWDChartConstant.MARGIN_LEGEND_BORDER:0)));ni&&(vr&&au?r.setLocation(r.m_nLeft+(vt-IWDChartConstant.MARGIN_LEGEND_BORDER)/2+IWDChartConstant.MARGIN_LEGEND_BORDER,r.m_nTop,!0):!vr&&lu&&r.setLocation(r.m_nLeft-(vt-IWDChartConstant.MARGIN_LEGEND_BORDER)/2-IWDChartConstant.MARGIN_LEGEND_BORDER,r.m_nTop,!0),ht);yt=wf?!1:WDSvgAnimationBulle;wu=new WDRect(r.m_nLeft-f,r.m_nTop-f-(ei?IWDChartConstant.MARGIN_LEGEND_BORDER:0),r.m_nRight+f,r.m_nBottom+f+(ei?IWDChartConstant.MARGIN_LEGEND_BORDER:0));bf&&(bi=n.clipRect(wu,"clip-bulle",yt));ki=undefined;!y.m_bLegendeBordArrondi||(ki=5);h.m_oPaint.setStroke(ft?y.m_sCouleurLegende:k,f);h.m_oPaint.setFillOpacity255(204);h.m_oPaint.setFill("#FFFFFF");h.m_oPaint.DesactivePointerEvents();bu=ft||!st?"mire-bulle":"mire-bulle-"+c;yr=h.__bDessineBulle(n,tr,bu,r,h.m_oPaint,ki,ki,ei?b.x:undefined,ei?b.y:undefined,yt);h.m_oPaint.addClasse(li);h.m_oPaint.DesactivePointerEvents();pr=n.text(tr,ft||!st?"legende-texte":"legende-texte-"+c);!yr&&yt&&(yt.prototype.ArreteEtVideAnimations(pr),bi&&yt.prototype.ArreteEtVideAnimations(bi));n.drawText(pr,ft?o:t.split("\n"),cu-(cu-parseInt10(yi.fontSize))/2,r.m_nLeft+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nTop+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*.5,IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,ft?[h.m_oPaint].concat(v):h.m_oPaint,yr?yt:!1);sr=!1;at||(w+=u);bi&&n.restoreClip()}br.append(i)}}),!0)}}}};WDPaintCSS.imgNormal=1;WDPaintCSS.imgCentre=2;WDPaintCSS.imgEtire=3;WDPaintCSS.imgRepete=4;WDPaintCSS.imgHomothetique=5;WDPaintCSS.imgHomothetiqueCentre=6;WDPaintCSS.imgHomothetiqueLarge=7;WDPaintCSS.imgHomothetiqueCentreLarge=8;WDPaintCSS.imgAdapte=9;WDPaintCSS.imgAdapteCentre=10;WDPaintCSS.prototype=new JSONPOO;WDPaintCSS.prototype.constructor=WDPaintCSS;WDPaintCSS.prototype.setStyle=function(n){var t=this;n.split(";").map(function(n){var i=n.split(":");t.m_oStyle[i[0]]=i[1]})};WDPaintCSS.prototype.raz=function(){this.m_oStyle={};this.m_sClasse=undefined;this.m_stRadialGradient=undefined;this.m_stLinearGradient=undefined};WDPaintCSS.prototype.setStroke=function(n,t,i){this.m_oStyle.stroke=n;t!==undefined&&(this.m_oStyle.strokeWidth=t);i!==undefined&&(this.m_oStyle.strokeOpacity=i)};WDPaintCSS.prototype.setDash=function(n,t){n!==undefined&&(this.m_oStyle.strokeDasharray=n.join(","));t!==undefined&&(this.m_oStyle.strokeDashoffset=t)};WDPaintCSS.prototype.setDashSelonType=function(n,t,i){switch(parseInt(t)){case ELineStyle.DASH:i?this.setDash([8*n,4*n],0):this.setDash([3*n,n],0);break;case ELineStyle.DOT:i?this.setDash([3*n,3*n],0):this.setDash([n,n],0);break;case ELineStyle.MIXED:i?this.setDash([12*n,2*n,2*n,2*n],0):this.setDash([3*n,n,n,n],0)}};WDPaintCSS.prototype.setStrokeOption=function(n,t){this.m_oStyle["stroke"+n]=t};WDPaintCSS.prototype.setStrokeLineJoin=function(n){this.m_oStyle.strokeLinejoin=n};WDPaintCSS.prototype.setFill=function(n){this.m_oStyle.fill=n};WDPaintCSS.prototype.setFillOpacity255=function(n){this.m_oStyle.fillOpacity=n/255};WDPaintCSS.prototype.addClasse=function(n){this.m_sClasse===undefined?this.m_sClasse="":this.m_sClasse+=" ";this.m_sClasse+=n};WDPaintCSS.prototype.setCouleurFond=function(n){this.m_oStyle.backgroundColor=n};WDPaintCSS.prototype.DesactivePointerEvents=function(){this.m_oStyle.pointerEvents="none"};WDPaintCSS.prototype.setImageFond=function(n,t,i,r){this.m_oStyle.backgroundImage="url("+clWDUtil.sGetCheminImage(n)+")";this.m_oStyle.backgroundRepeat="no-repeat";switch(t){case WDPaintCSS.imgCentre:this.m_oStyle.backgroundPosition="center center";break;case WDPaintCSS.imgEtire:this.m_oStyle.backgroundSize="100% 100%";break;case WDPaintCSS.imgRepete:this.m_oStyle.backgroundRepeat="repeat";break;case WDPaintCSS.imgHomothetique:this.m_oStyle.backgroundSize="contain";break;case WDPaintCSS.imgHomothetiqueCentre:this.m_oStyle.backgroundSize="contain";this.m_oStyle.backgroundPosition="center center";break;case WDPaintCSS.imgHomothetiqueLarge:this.m_oStyle.backgroundSize="cover";break;case WDPaintCSS.imgHomothetiqueCentreLarge:this.m_oStyle.backgroundSize="cover";this.m_oStyle.backgroundPosition="center center";break;case WDPaintCSS.imgAdapte:case WDPaintCSS.imgAdapteCentre:var u=$("<img>").attr("src",clWDUtil.sGetCheminImage(n));u[0].width>i||u[0].height>r?this.setImageFond(n,t==WDPaintCSS.imgAdapteCentre?WDPaintCSS.imgHomothetiqueCentre:WDPaintCSS.imgHomothetique,i,r):this.setImageFond(n,WDPaintCSS.imgNormal,i,r)}};WDPaintCSS.prototype.css=function(n,t){if(clWDUtil.isObject(n))for(var i in n)this.css(i,n[i]);else this.m_oStyle[n]=t};WDPaintCSS.prototype.css3=function(n,t){var i=this,r=n,u=t;return["-webkit-","-moz-","-ms-",""].forEach(function(n){i.css(n+r,u)}),this};WDPaintCSS.css3=function(n,t,i){n[0]===undefined&&(n=$(n));var r=n,u=t,f=i;return["-webkit-","-moz-","-ms-",""].forEach(function(n){r.css(n+u,f)}),n};WDPaintCSS.__gnGradientUniqueId=0;WDPaintCSS.getGradientUniqueId=function(){return++WDPaintCSS.__gnGradientUniqueId};WDPaintCSS.prototype._ajouteElementGradient=function(n,t,i,r){var c="wb-"+i+"-gradient-"+t[0].id,u=n.tag(n.m_domDefsSVG,c,i+"Gradient"),l=u.wbData("wbGrfGradientData"),h,e,f,o,s;if(l&&JSON.stringify(l)==JSON.stringify(r))return this.setGradientExistant(n,t,u),u;for(u.wbData("wbGrfGradientData",r),n.empty(u),r.gradientUnits!==undefined&&n.attrNS(u,null,"gradientUnits",r.gradientUnits),r.spreadMethod!==undefined&&n.attrNS(u,null,"spreadMethod",r.spreadMethod),h=Object.getOwnPropertyNames(r.stop).sort(function(n,t){return parseFloat(n)<parseFloat(t)?-1:1}),e=0;e<h.length;++e)f=h[e],o=n.tag(u,c+"stop"+u.children().length,"stop"),n.attrNS(o,null,"offset",f+"%"),n.attrNS(o,null,"stop-color",r.stop[f].color),n.attrNS(o,null,"stop-opacity",r.stop[f].opacity);this.setGradientExistant(n,t,u);for(s in r)s!="stop"&&n.attrNS(u,null,s,r[s]);return u};WDPaintCSS.prototype.ecritDegrade=function(n,t){return this.m_stRadialGradient!==undefined?this._ajouteElementGradient(n,t,"radial",this.m_stRadialGradient):this.m_stLinearGradient!==undefined?this._ajouteElementGradient(n,t,"linear",this.m_stLinearGradient):void 0};WDPaintCSS.prototype.applyStyle=function(n,t,i){var f,r,o,e;if(this.ecritDegrade(n,t),this.m_sClasse)if(f=t[0],f.classList){for(r=0,o=-1;(o=this.m_sClasse.indexOf(" ",r))>-1;)f.classList.add(this.m_sClasse.substr(r,o-r)),r=o+1;r===0?f.classList.add(this.m_sClasse):f.classList.add(this.m_sClasse.substr(r))}else n.addClass(t,this.m_sClasse);var s={},h=!1,u=this;["stroke","fill","fillOpacity","strokeWidth","strokeOpacity","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit"].forEach(function(n,t){if(typeof u.m_oStyle[n]!="undefined"){var r=n;t>1&&(r=t<3?"fill-"+r.substr(4,1).toLowerCase()+r.substr(5):"stroke-"+r.substr(6,1).toLowerCase()+r.substr(7));h=!0;s[r]=u.m_oStyle[n];i||(u.m_oStyle[n]=undefined)}});h&&t.attr(s);t.css(this.m_oStyle);e="background-image";u.m_oStyle[e]!==undefined&&(t.attr("style",t.attr("style")+e+":"+u.m_oStyle[e]+";"),i||(u.m_oStyle[e]=undefined));n.m_tabClipActif.length>0&&t.attr("clip-path","url(#"+n.getId(n.m_tabClipActif[n.m_tabClipActif.length-1])+")");i||this.raz()};WDPaintCSS.prototype.setGradientExistant=function(n,t,i){if(this.m_oStyle.fill="url(#"+i[0].id+")",t){if(t.wbData("wbGrfGradientId")){var r=n.findFromId(n.m_domDefsSVG,t.wbData("wbGrfGradientId"));r&&r.length>0&&(r.unbind().removeData().remove(),r=undefined)}t.wbData("wbGrfGradientId",i[0].id)}};WDPaintCSS.prototype.setRadialGradient=function(n,t,i,r,u,f,e,o,s){e===undefined&&(e=1);o===undefined&&(o=1);this.m_stRadialGradient={r:"100%",cx:s?"50%":"0%",cy:s?"50%":"0%",spreadMethod:f,stop:{0:{color:r,opacity:e},100:{color:u,opacity:o}}}};WDPaintCSS.prototype.setLinearGradient=function(n,t,i,r,u,f,e){u===undefined&&(u=1);f===undefined&&(f=1);this.m_stLinearGradient={x1:0,y1:0,x2:r===!0?0:1,y2:r===!0?1:0,spreadMethod:i,stop:{}};this.m_stLinearGradient.stop=e===!0?{0:{color:t,opacity:f},50:{color:n,opacity:u},100:{color:t,opacity:f}}:{0:{color:n,opacity:u},100:{color:t,opacity:f}}};WDPaintCSS.nGetLineHeight=function(n){return n<24?n+4:Math.round(n*1.2)};WDPaintCSS.jqTrouveCSS={};WDPaintCSS.oCacheFontSize={};WDPaintCSS.oGetInfoCSS=function(n,t,i,r,u){var e,s,l,y,a,k,v,w,o,b,h,c,f,p,d;if(r===undefined&&(r=""),e=clWDUtil.isObject(n)?n.m_sClasse:n,e=e||"aucuneClasse",WDPaintCSS.oCache||(WDPaintCSS.oCache={}),n&&(c=WDPaintCSS.oCacheFontSize[e])){if(i==="fontSize")return{fontSize:c+"px"};if(i==="lineHeight")return{lineHeight:WDPaintCSS.nGetLineHeight(c)+"px"}}if(s=undefined,y=!1,clWDUtil.isArray(t)?(l=t,y=!0):l=[t],s=JSON.stringify(arguments),s&&WDPaintCSS.oCache[s])return WDPaintCSS.oCache[s];for(a=WDPaintCSS.jqTrouveCSS[e],k=WDPaintCSS.domNoeudTexte||(WDPaintCSS.domNoeudTexte=document.createElement("span")),a||(a=WDPaintCSS.jqTrouveCSS[e]=$("<span class='grfWDPaintCSSoGetInfoCSS "+e+"'/>"),$(document.body).append(a)),v="",o=0;o<l.length;++o)v+=r?"<span style='display:inline-block;"+r+"'>":'<span style="display:inline-block;">',u?(k.innerText=l[o],v+=k.innerHTML):v+=l[o],v+="<\/span>";for(a[0].innerHTML=v,w=[],o=0;o<l.length;++o){if(b=a[0].children[o],h=window.getComputedStyle?window.getComputedStyle(b):b.currentStyle,!n||r||WDPaintCSS.oCacheFontSize[e]||(c=h.fontSize,/px/.test(c)&&(WDPaintCSS.oCacheFontSize[e]=parseInt10(c))),f={},i===!0)f=_clone(h,f);else if(clWDUtil.isObject(i))clWDUtil.bForEachIn(i,function(n){return f[n]=h[n],!0});else if(clWDUtil.isArray(i))for(p=0;p<i.length;++p)f[i[p]]=h[i[p]];else i!==undefined&&(f[i]=h[i]);(i===!0||f.hasOwnProperty("width")||f.hasOwnProperty("height"))&&(d=b.getBoundingClientRect(),f.height=d.height,f.width=d.width);(i===!0||f.hasOwnProperty("lineHeight"))&&f.lineHeight&&f.lineHeight.indexOf("px")==-1&&(f.lineHeight=WDPaintCSS.nGetLineHeight(parseInt10(h.fontSize)),f.hasOwnProperty("height")&&(f.height=Math.max(f.height,f.lineHeight)));y&&w.push(f)}return s&&(WDPaintCSS.oCache[s]=y?w:f),y?w:f};Path.prototype.constructor=Path;Path.prototype.add=function(n){this.d&&(this.d+=" ");this.d+=n};Path.prototype.moveTo=function(n,t){this.add("M "+n+" "+t)};Path.prototype.lineTo=function(n,t){this.add("L "+n+" "+t)};Path.prototype.toD=function(){return this.d};Path.prototype.close=function(){this.add("Z")};Path.prototype.rewind=function(){this.d=""};Path.prototype.AjouteLigne=function(n,t,i,r){this.moveTo(n,t);this.lineTo(i,r)};WDPictureSVG.prototype.constructor=WDPictureSVG;WDPictureSVG.prototype.svgns="http://www.w3.org/2000/svg";WDPictureSVG.prototype.smilanimns="http://www.w3.org/2001/smil-animation";WDPictureSVG.prototype.smil2ns="http://www.w3.org/2001/SMIL20";WDPictureSVG.prototype.smil21ns="http://www.w3.org/2005/SMIL21";WDPictureSVG.prototype.smil3ns="http://www.w3.org/ns/SMIL30";WDPictureSVG.prototype.timesheetns="http://www.w3.org/2007/07/SMIL30/Timesheets";WDPictureSVG.prototype.xlinkns="http://www.w3.org/1999/xlink";WDPictureSVG.VDOM_MUTATION=2;WDPictureSVG.VDOM_PROG=1;WDPictureSVG.VDOM_JQUERYUI=0;WDPictureSVG.MethodeVDOM=WDPictureSVG.VDOM_JQUERYUI;WDPictureSVG.prototype.PlaceDansLaPage=function(n){var t=$(n.m_oHoteImage),i;t.css("display","none");t[0].nextSibling!==undefined?t[0].parentNode.insertBefore(this.m_domBaliseSVG[0],t[0].nextSibling):t[0].appendChild(this.m_domBaliseSVG[0]);t.parent().is("a")&&t.parent().css("text-decoration","none");bEdge&&(i=this,this.rafGradient!=undefined&&cancelAnimationFrame(this.rafGradient),this.rafGradient=requestAnimationFrame(function(){i.m_domDefsSVG=i.m_domDefsSVG.detach();i.m_domBaliseSVG.append(i.m_domDefsSVG);i.rafGradient=undefined}))};WDPictureSVG.prototype.__removeOneDomFromMemory=function(n){this.m_tabId[n.id]=undefined};WDPictureSVG.prototype.__removeFromMemory=function(n){var t=this;n.each(function(){t.__removeOneDomFromMemory(this)})};WDPictureSVG.prototype.remove=function(n){return WDPictureSVG.MethodeVDOM==WDPictureSVG.VDOM_PROG&&this.__removeFromMemory(n),$.fn.remove.apply(n)};WDPictureSVG.prototype.empty=function(n){var i,t;if(WDPictureSVG.MethodeVDOM==WDPictureSVG.VDOM_PROG){for(i=n[0].querySelectorAll("*"),t=0;t<i.length;++t)this.__removeOneDomFromMemory(i[t]);this.__removeOneDomFromMemory(n[0])}return $.fn.empty.apply(n)};WDPictureSVG.prototype.emptyDOM=function(n){var i,t;if(WDPictureSVG.MethodeVDOM==WDPictureSVG.VDOM_PROG){for(i=n.querySelectorAll("*"),t=0;t<i.length;++t)this.__removeOneDomFromMemory(i[t]);this.__removeOneDomFromMemory(n)}while(n.firstChild)n.removeChild(n.firstChild)};WDPictureSVG.prototype.Raz=function(){if(this.m_domBaliseSVG!==undefined?(this.empty(this.m_domBaliseSVG),this.m_domBaliseSVG.wbData("wbGrfNbDessins",0),this.m_domDefsSVG=this.tag(this.m_domBaliseSVG,"defs","defs")):this.m_domBaliseSVG=this.tag("svg"),this.m_domBaliseSVG.attr("draggable","false").css("user-select","none").css("user-drag","none"),WDPictureSVG.MethodeVDOM==WDPictureSVG.VDOM_MUTATION&&!this.m_domObserver){var n=this;this.m_domObserver=new MutationObserver(function(t){t.forEach(function(t){t&&t.removedNodes&&t.removedNodes.length&&(n.m_tabId[t.removedNodes[0].id]=undefined)})});this.m_domObserver.observe(this.m_domBaliseSVG[0],{childList:!0,subtree:!0})}this.m_tabId={};this.m_tabCache=[]};WDPictureSVG.prototype.OnRecalculAncrageIE=function(){this.m_bAncrageLargeur&&this.m_domBaliseSVG.css("width","100%");this.m_bAncrageHauteur&&this.m_domBaliseSVG.css("height","100%")};WDPictureSVG.prototype.Init=function(n){var t,l,u,r,h,o,s,c,f,i,e;return(this.Raz(),t=$(n.m_oHoteImage),l=n.m_oHoteImage&&n.m_oHoteImage.parentNode&&clWDUtil.bEstDisplay(n.m_oHoteImage.parentNode,document),!l)?(t.css("opacity",0),!1):(t.css("opacity",""),this.m_oGraphe=n,u=n.m_oHoteImage.width,r=n.m_oHoteImage.height,t.css("display","block"),t.data("width")&&(u=t.data("width"),r=t.data("height")),u==0&&(u=t.attr("data-width")),r==0&&(r=t.attr("data-height")),t.hasClass("h100")&&t.css("height","100%"),h=(t.attr("style")||"").replace(/ /g,""),this.m_bAncrageLargeur=h.indexOf("width:100%")>-1||t.attr("width")=="100%"||t.width()!=u,this.m_bAncrageHauteur=h.indexOf("height:100%")>-1||t.attr("height")=="100%"||t.height()!=r,c=this.m_oGraphe.m_oBarreAutomatique&&this.m_oGraphe.m_oBarreAutomatique._bOptionVisible&&this.m_oGraphe.m_oBarreAutomatique._bOptionVisible&&this.m_oGraphe.m_oBarreAutomatique._bOptionVisible&&this.m_oGraphe.m_oBarreAutomatique._bOptionVisible("FULLSCREEN"),(this.m_bAncrageLargeur||this.m_bAncrageHauteur||c)&&(this.m_bAncrageLargeur&&(t.add(this.m_domBaliseSVG).css("position","absolute"),t.data("width",u=t.parent().width()||t.attr("data-width")),t.add(this.m_domBaliseSVG).css("position","")),this.m_bAncrageHauteur&&(t.add(this.m_domBaliseSVG).css("position","absolute"),f=t.parent().height(),t.add(this.m_domBaliseSVG).css("position",""),f==0?(f=parseInt10(t.attr("data-height"))/parseInt10(t.attr("data-width"))*parseInt10(t.data("width")),this.m_bAncrageHauteur=!1,r=f==0?r:f,t.css("height",r)):r=f,t.data("height",r)),this.m_nTimerRedim=null,this.m_bRedimEnCours=!1,i=this,e=!1,clWDUtil.AttacheOnScrollResize(i.m_pfAttacheOnScrollResize=function(n,r){if(!r&&!i.m_bRedimEnCours&&(i.m_oGraphe.m_oParametres.m_bInteractif||i.m_oGraphe.m_tabEtat.INT)&&(!$(document.documentElement).hasClass("grfFullScreenHTML")||i.m_domBaliseSVG.closest("table").hasClass("grfFullScreen"))){if(i.m_nTimerRedim==null){if(!clWDUtil.bEstDisplay(i.m_domBaliseSVG[0].parentNode,document))return}else clearTimeout(i.m_nTimerRedim);$(document.documentElement).hasClass("grfFullScreenHTML")&&(e=!0);i.m_nTimerRedim=setTimeout(function(){var n,r;try{i.m_bRedimEnCours=!0;var o=i.m_bAncrageHauteur&&t.data("height")<10,u={width:t.data("width"),height:t.data("height")},s=i.m_domBaliseSVG.closest("table").hasClass("grfFullScreen");if(s?(i.m_domBaliseSVG.css("display","none"),t.data("width",t.closest("td").width()),t.data("height",t.closest("td").height()),i.m_domBaliseSVG.css("display","")):((e||i.m_bAncrageLargeur)&&(t.add(i.m_domBaliseSVG).css("position","absolute"),t.data("width",t.parent().width()),t.add(i.m_domBaliseSVG).css("position","")),(e||i.m_bAncrageHauteur)&&(t.add(i.m_domBaliseSVG).css("position","absolute"),n=t.parent().height(),n==0&&(n=parseInt10(t.attr("data-height"))/parseInt10(t.attr("data-width"))*parseInt10(t.data("width")),i.m_bAncrageHauteur=!1,t.css("height",n)),t.data("height",n),t.add(i.m_domBaliseSVG).css("position",""))),r={width:t.data("width"),height:t.data("height")},u.width==r.width&&u.height==r.height)return;if(i.Init(i.m_oGraphe),i.m_oGraphe.m_oVue.Redessine(i.m_oGraphe,WDChartView.ms_nDessinParDefaut),e=!1,o)try{i.m_oGraphe.m_tabEtat.INT=!1;i.m_oGraphe.m_oVue.ExecuteCommande(i.m_oGraphe);i.m_oGraphe.m_tabEtat.INT=!0;i.m_oGraphe.m_oVue.ExecuteCommande(i.m_oGraphe)}catch(f){}finally{i.m_oGraphe.m_tabEtat.INT=!0}}catch(f){console.log(f)}finally{i.m_oGraphe.m_tabEtat.INT=!0;i.m_bRedimEnCours=!1;i.m_nTimerRedim=null}},50)}})),o=this.m_bAncrageLargeur?"100%":t.css("width"),s=this.m_bAncrageHauteur?"100%":t.css("height"),(parseInt(o||0)==0||parseInt(s||0)==0)&&(o=t.data("width"),s=t.data("height")),this.m_domBaliseSVG.attr("version","1.1").attr("xmlns",this.svgns).attr("title",t.attr("title")||"").attr("style",t.attr("style")||"").css({width:o,height:s,lineHeight:"normal"}).wbData("wbGrfAnimDuree",n.m_oModele.m_oParametres.m_nDureeAnimation),bIEAvec11&&(this.m_bAncrageLargeur||c)&&this.m_domBaliseSVG.css({width:u,height:r}),this.attrNS(this.m_domBaliseSVG,null,"viewBox","0 0 "+u+" "+r),!0)};WDPictureSVG.prototype.SetImageFond=function(n){n.applyStyle(this,this.m_domBaliseSVG)};WDPictureSVG.prototype.insert=function(n,t){n===undefined&&(n=this.m_domBaliseSVG);var i=n.children().first();return i.length>0?n[0].insertBefore(t[0],i[0]):this.append(n,t)};WDPictureSVG.prototype.insertAfter=function(n,t,i){return n===undefined&&(n=this.m_domBaliseSVG),i!==undefined&&i[0]!==undefined&&i[0].nextSibling!==undefined?n[0].insertBefore(t[0],i[0].nextSibling):this.append(n,t)};WDPictureSVG.prototype.append=function(n,t){if(n!==undefined||(n=this.m_domBaliseSVG,n!==undefined))return n[0].appendChild(t[0])};WDPictureSVG.prototype.SetAntiAliasing=function(n,t){t===undefined&&(t=this.m_domBaliseSVG);t.attr("shape-rendering",n?"auto":"crispEdges")};WDPictureSVG.prototype.path=function(n,t){return this.tag(n,t,"path")};WDPictureSVG.prototype.drawPath=function(n,t,i,r){var u=clWDUtil.isArray(t)||clWDUtil.bEstChaineNonVide(t)?{d:t}:t;return clWDUtil.isArray(u.d)&&(u.d=u.d.join(" ")),r===undefined&&(r=WDSvgAnimation),this.bDrawAvecAnimation(r,n,u)||(n.attr("d",u.d),r&&r.afffiche(n),n.wbData("wbGrfDrawInfos",u)),n.attr("fill")===undefined&&n.attr("fill","none"),i&&i.applyStyle(this,n),n};WDPictureSVG.prototype.drawPathFactory=function(n,t,i,r,u){var f=this.drawPath(n,i,r,u);return $.extend(f,t),n.wbData("wbGrfDrawPath",t),f};WDPictureSVG.prototype.tag=function(n,t,i){var u=n,f=t,e=i,r,o;return(arguments.length===2?(e=f,u=undefined,f=undefined):arguments.length===1?(e=u,u=undefined,f=undefined):arguments.length!==3||clWDUtil.isObject(u)||f||!e||(f=u,u=undefined),u===undefined&&(u=this.m_domBaliseSVG),r=u?this.findFromId(u,f):undefined,r&&r.length===1)?r:(r=$(document.createElementNS(this.svgns,e)),this.setId(r,f),this.append(u,r),WDPictureSVG.MethodeVDOM==WDPictureSVG.VDOM_PROG&&(o=this,r.remove=function(){return o.remove(r)},r.empty=function(){return o.empty(r)}),r)};WDPictureSVG.prototype.getId=function(n){return n[0].id};WDPictureSVG.prototype.setId=function(n,t){var i=this.sConstruitId(t),r=n.eq(0),u;r[0].id=i;this.m_tabId[i]=r;u=this;WDPictureSVG.MethodeVDOM==WDPictureSVG.VDOM_JQUERYUI&&r.bind("remove",function(){u.m_tabId[i]=undefined})};WDPictureSVG.prototype.sConstruitId=function(n){return this.m_Id+"-"+(n||"svg")};WDPictureSVG.prototype.getChildren=function(n){return n.children()};WDPictureSVG.prototype.find=function(n,t){var i=this.m_tabId[this.getId(t)]||[];return i};WDPictureSVG.prototype.findFromId=function(n,t,i){var r=this.m_tabId[i?t:this.sConstruitId(t)]||[];return r};WDPictureSVG.prototype.drawContenu=function(n,t){var i;if(n[0].childNodes&&(i=n[0].childNodes[0],i&&i.nodeType==3)){i.nodeValue=t;return}n[0].appendChild(document.createTextNode(t))};WDPictureSVG.prototype.attrNS=function(n,t,i,r){n[0]!==undefined&&(n=n[0]);try{n.setAttributeNS(t,i,r)}catch(o){}};WDPictureSVG.bDessinPossible=function(){return!!document.createElementNS&&!!document.createElementNS(WDPictureSVG.prototype.svgns,"svg").createSVGRect};WDPictureSVG.prototype.g=function(n,t){return this.tag(n,t,"g").attr({role:"presentation",ariaHidden:"true"})};WDPictureSVG.prototype.arc=function(n,t){return this.path(n,t)};WDPictureSVG.prototype.line=function(n,t){return this.tag(n,t,"line")};WDPictureSVG.prototype.bDrawAvecAnimation=function(n,t,i,r,u){if(n===!1)return!1;var f=this.m_domBaliseSVG.wbData("wbGrfAnimDuree")===0&&this.m_domBaliseSVG.wbData("wbGrfModeAffichage")===WDChartView.ms_nDessin1erAffichage;return!f&&(n.bIgnorePendantAnimation()||!this.bPendantAnimation())&&t.wbData("wbGrfDrawInfos")!==undefined?(new n.prototype.constructor(this.m_oGraphe,this,t,t.wbData("wbGrfDrawInfos"),i,r,u).run(),!0):!1};WDPictureSVG.prototype.drawLine=function(n,t,i,r,u,f,e){var o={x1:t,y1:i,x2:r,y2:u};return e===undefined&&(e=WDSvgAnimation),this.bDrawAvecAnimation(e,n,o)||(this.attrNS(n,null,"x1",t),this.attrNS(n,null,"y1",i),this.attrNS(n,null,"x2",r),this.attrNS(n,null,"y2",u),e&&e.afffiche(n),n.wbData("wbGrfDrawInfos",o)),f.applyStyle(this,n),n};WDPictureSVG.prototype.rect=function(n,t){return this.tag(n,t,"rect")};WDSvgAnimation.prototype=new WDChartAnimation;WDSvgAnimation.prototype.constructor=WDSvgAnimation;WDSvgAnimation.prototype.ArreteEtVideAnimations=function(n){n||(n=this.m_domBaliseAnim);n.stop(this.queue,!0);var t=this;n.children().each(function(){t.ArreteEtVideAnimations($(this))})};WDSvgAnimation.prototype.start=function(){var n=WDChartAnimation.getAnim(this);clWDUtil.bForEachIn(n.m_oAttributs,function(t,i){return i!==undefined&&n.m_oAttributsAvant[t]===undefined&&(n.m_oAttributsAvant[t]=n.m_domBalise.attr(t)),!0})};WDSvgAnimation.prototype.step=function(n){var t=WDChartAnimation.getAnim(this),i;t&&(t.m_dNow=n,t.m_dNow!==0)&&(i={},clWDUtil.bForEachIn(t.m_oAttributs,function(r,u){var f,s,h;if(u!==undefined){if(r.indexOf("data-")===0)return i[r]||(i[r]=u),!0;if(t.m_dNow!==1||clWDUtil.isObject(u))if(r.indexOf("color")>-1||r=="fill"||r=="stroke"){var e=clWDUtil.tabHTML2TSLA(t.m_oAttributsAvant[r]||u),o=clWDUtil.tabHTML2TSLA(u),a=[t.tween(e[0],o[0]),t.tween(e[1],o[1]),t.tween(e[2],o[2]),t.tween(e[3],o[3])];i[r]=clWDUtil.sTSLA2HTML(a)}else if(r==="d")oPath=t.tweenPath(t.m_oAttributsAvant[r],u,n),clWDUtil.isObject(oPath)?clWDUtil.bForEachIn(oPath,function(n){return i[n]=oPath[n],!0}):i[r]=(oPath||"")+"";else if(r==="dx"||r==="x"||r==="width")i[r]=t.tweenX(t.m_oAttributsAvant[r],u,n);else if(r==="dy"||r==="y"||r==="height")i[r]=t.tweenY(t.m_oAttributsAvant[r],u,n);else if(r==="points"){var c="",l=u.trim().split(" "),v=t.m_oAttributsAvant[r].trim().split(" ");for(f=0;f<l.length;++f)s=l[f].split(","),h=v[f].split(","),c+=" "+t.tweenX(h[0],s[0],n)+","+t.tweenY(h[1],s[1],n);i[r]=c.trim()}else i[r]=t.tween(t.m_oAttributsAvant[r],u,n);else i[r]=u;t.m_oPicture.attrNS(t.m_domBalise,null,r,i[r])}return!0}),t.m_domBalise.wbData("wbGrfDrawInfos",i))};WDSvgAnimation.prototype.tweenPath=function(n,t,i){var u=clWDUtil.isArray(n)?n:n.split(" "),e=clWDUtil.isArray(t)?t:t.split(" "),r,s,h;if(u.length!==e.length)return u.join(" ");var f=[],c=!1,o=0;for(r=0;r<u.length;++r)s=parseInt10(u[r]),h=parseInt10(e[r]),isNaN(s)||isNaN(h)?(f[r]=u[r],c=f[r]=="M"||f[r]=="L",o=0):(f[r]=o%2==0?this.tweenX(u[r],e[r],i):this.tweenY(u[r],e[r],i),++o);return{d:f.join(" ")}};WDSvgAnimation.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&n.m_fFinAnimation&&n.m_fFinAnimation.apply(arguments)};WDSvgAnimation.afffiche=function(){};WDSvgAnimation.bIgnorePendantAnimation=function(){return!1};WDSvgAnimationGridLine.prototype=new WDSvgAnimation;WDSvgAnimationGridLine.prototype.constructor=WDSvgAnimationGridLine;WDSvgAnimationGridLine.prototype.step=function(n){WDSvgAnimation.prototype.step.apply(this,arguments);$(this).css("opacity",n)};WDSvgAnimationGridLine.afffiche=function(n){n.css("opacity",0).fadeTo(800,1)};WDSvgAnimationGridLine.bIgnorePendantAnimation=function(){return!0};WDSvgAnimationBulle.prototype=new WDSvgAnimation;WDSvgAnimationBulle.prototype.constructor=WDSvgAnimationBulle;WDSvgAnimationBulle.prototype.step=function(){WDSvgAnimation.prototype.step.apply(this,arguments)};WDSvgAnimationBulle.prototype.ArreteEtVideAnimations=function(){WDSvgAnimation.prototype.ArreteEtVideAnimations.apply(this,arguments)};WDSvgAnimationBulle.prototype.bAnimationBullePathPossible=function(n,t){var i=t.wbData("wbGrfDrawInfos"),r;return i?(r=clWDUtil.isArray(i.d)?i.d:i.d.split(" "),!r||r.length!=n.d.length)?!1:!0:!1};WDSvgAnimationBulle.prototype.tweenX=function(n,t,i){if(WDSvgAnimationBulle.gbEase===!0)return WDSvgAnimation.prototype.tweenX.apply(this,arguments);var r=new clWDUtil.WDBezier(.25,.25,.225,.855);return this.tween(n,t,r.dCalcule(i,this.duration))};WDSvgAnimationBulle.prototype.tweenY=function(){return WDSvgAnimation.prototype.tweenY.apply(this,arguments)};WDSvgAnimationBulle.prototype.tweenPath=function(n,t,i){var u=this.m_oAttributsAvant["data-arguments"],f,o;if(!u||!clWDUtil.isArray(u))return WDSvgAnimation.prototype.tweenPath.apply(this,arguments);if(f=clWDUtil.isArray(n)?n:n.split(" "),o=clWDUtil.isArray(t)?t:t.split(" "),f.length!==o.length)return f.join(" ");var r=this.m_oAttributs["data-arguments"],s=this.tweenRect(u[0],r[0]),e=WDChartRenderer.prototype.__oPathBulle(s,this.tween(u[1],r[1]),this.tween(u[2],r[2]),this.tween(u[3],r[3]),this.tweenX(u[0].m_nRight,r[0].m_nRight,i)-(r[0].m_nRight-r[4]),this.tweenY(u[0].m_nBottom,r[0].m_nBottom,i)-(r[5]-r[0].m_nBottom));return e.d=e.d.join(" "),e};WDSvgAnimationBulle.afffiche=function(n){return WDSvgAnimation.afffiche(n)};WDSvgAnimationBulle.bIgnorePendantAnimation=function(){return WDSvgAnimation.bIgnorePendantAnimation()};WDSvgAnimationLegende.prototype=new WDSvgAnimation;WDSvgAnimationLegende.prototype.constructor=WDSvgAnimationLegende;WDSvgAnimationLegende.afffiche=function(n){return WDSvgAnimationGridLine.afffiche(n)};WDSvgAnimationLegende.bIgnorePendantAnimation=function(){return WDSvgAnimationGridLine.bIgnorePendantAnimation()};WDPictureSVG.prototype.drawRect=function(n,t,i,r,u,f){var e={x:t.m_nLeft,y:t.m_nTop,width:WDRect.getWidth(t),height:WDRect.getHeight(t),rx:r,ry:u};return f===undefined&&(f=WDSvgAnimation),this.bDrawAvecAnimation(f,n,e)||(this.attrNS(n,null,"x",e.x),this.attrNS(n,null,"y",e.y),this.attrNS(n,null,"width",e.width),this.attrNS(n,null,"height",e.height),r!==undefined&&this.attrNS(n,null,"rx",r),u!==undefined&&this.attrNS(n,null,"ry",u),f&&f.afffiche(n),n.wbData("wbGrfDrawInfos",e)),i&&(i.m_oStyle.fill===undefined&&i.setFill("none"),i.applyStyle(this,n)),n};WDPictureSVG.prototype.text=function(n,t){return this.tag(n,t,"text").css({userSelect:"none",userDrag:"none"})};WDPictureSVG.prototype.tspan=function(n,t){return this.tag(n,t,"tspan")};WDPictureSVG.prototype.circle=function(n,t){return this.tag(n,t,"circle")};WDPictureSVG.prototype.polygon=function(n,t){return this.tag(n,t,"polygon")};WDPictureSVG.prototype.drawPolygon=function(n,t,i,r){var u={points:t.join(" ")};return r===undefined&&(r=WDSvgAnimation),this.bDrawAvecAnimation(r,n,u)||(this.attrNS(n,null,"points",t.join(" ")),r&&r.afffiche(n),n.wbData("wbGrfDrawInfos",u)),i&&i.applyStyle(this,n),n};WDPictureSVG.prototype.drawCircle=function(n,t,i,r,u,f){var e={cx:t,cy:i,r:r};return f===undefined&&(f=WDSvgAnimation),this.bDrawAvecAnimation(f,n,e)||(this.attrNS(n,null,"cx",t),this.attrNS(n,null,"cy",i),this.attrNS(n,null,"r",r),f&&f.afffiche(n),n.wbData("wbGrfDrawInfos",e)),u&&u.applyStyle(this,n),n};WDPictureSVG.prototype.drawTextVertically=function(n,t,i,r,u,f,e,o,s){return this.rotate(n,270,r,u,!0,!1),this.drawText(n,t,i,r,u-(s||0),f,e,o)};WDPictureSVG.prototype.applyStyleAvecHackColor=function(n,t,i){var r,u;t!=undefined&&t.m_oStyle.fill==undefined&&(this.m_tabCache[t.m_sClasse]||(WDPictureSVG.applyStyleAvecHackColorDejaAppele?r=$(document.getElementById("wbGrfWDPictureSVG")):(r=$('<span style="position:absolute;visibility:hidden" id="wbGrfWDPictureSVG"><\/span>'),$("body").append(r)),r.attr("class",t.m_sClasse),u=window.getComputedStyle(r[0]),this.m_tabCache[t.m_sClasse]=u.color,WDPictureSVG.applyStyleAvecHackColorDejaAppele=!0),t.setFill(this.m_tabCache[t.m_sClasse]));t.applyStyle(this,n,i)};WDPictureSVG.prototype.bPendantAnimation=function(){return this.m_domBaliseSVG.wbData("wbGrfModeAffichage")==WDChartView.ms_nDessinAnimation};WDPictureSVG.prototype.addClass=function(n,t){this.removeClass(n,t);n.attr("class",((n.attr("class")||"").trim()+" "+t).trim())};WDPictureSVG.prototype.removeClass=function(n,t){n.attr("class",(n.attr("class")||"").replace(t,"").trim())};WDPictureSVG.prototype.drawText=function(n,t,i,r,u,f,e,o,s){var l={x:r,y:u+i},w=clWDUtil.isArray(t)?t:[t],p=[t,r,u],h,a,c,v,y;if(n.wbData("wbGrfCacheDrawText")==p)return n;for(n.wbData("wbGrfCacheDrawText",p),h=this,a=n[0].querySelectorAll("*"),c=0;c<a.length;++c)a[c].wbGrfGC=!0;for(this.attrNS(n,null,"text-anchor",f==IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE?"middle":f==IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE?"start":"end"),o===undefined&&(o=WDSvgAnimation),clWDUtil.isArray(e)?(v=e[0],e=e.slice(1)):v=e,this.bDrawAvecAnimation(o,n,l)||(this.attrNS(n,null,"x",l.x),this.attrNS(n,null,"y",l.y),o&&o.afffiche(n),n.wbData("wbGrfDrawInfos",l)),y=0,clWDUtil.bForEachIn(w,function(t,r){var s=undefined,f,c,u,a;for(!clWDUtil.isArray(r)&&clWDUtil.bEstChaineNonVide(r)&&r.indexOf("\n")&&(s=r.split("\n")),f=r,c=0;c<(s?s.length:1);++c)s&&(f=s[c]),u=h.tspan(n,h.getId(n)+"-texte-ligne-"+ ++y),u[0].wbGrfGC=undefined,(t>0||c>0)&&(h.attrNS(u,null,"dy",i),u.wbData("wbGrfDrawInfos",n.wbData("wbGrfDrawInfos"))),a={x:l.x},h.bDrawAvecAnimation(o,u,a)||(h.attrNS(u,null,"x",l.x),u.wbData("wbGrfDrawInfos",a),o&&o.afffiche(u)),clWDUtil.isArray(f)&&f.length>1?clWDUtil.bForEachIn(f,function(i,r){var f,o;return i>0?(o=h.tspan(n,"texte-ligne-"+y+"-sous-"+i),h.attrNS(o,null,"dx",0),f=o):f=u,f[0].wbGrfGC=undefined,h.drawContenu(f,r),clWDUtil.isArray(e)&&clWDUtil.isArray(e[t])&&clWDUtil.isObject(e[t][i])&&h.applyStyleAvecHackColor(f,e[t][i]),!0}):(h.drawContenu(u,f),clWDUtil.isArray(e)&&clWDUtil.isObject(e[t])?h.applyStyleAvecHackColor(u,e[t]):h.applyStyleAvecHackColor(u,e,!0));return!0}),v&&this.applyStyleAvecHackColor(n,v,s),c=0;c<a.length;++c)a[c].wbGrfGC&&this.emptyDOM(a[c]);return n};WDPictureSVG.prototype.translate=function(n,t,i,r,u){var f=(""+(t||"")).split(",");return f.length==2&&(t=f[0],i=f[1]),r||bIEAvec11?n.attr("transform",(!u?"":(n.attr("transform")||"")+" ")+"translate("+t+","+i+")"):n.css("transform",(!u?"":(n.css("transform")||"")+" ")+"translateX("+t+") translateY("+i+")"),n.wbData("wbGrfDrawTranslate",arguments),n};WDPictureSVG.prototype.scale=function(n,t,i,r,u){var f=(""+(t||"")).split(",");return f.length==2&&(t=f[0],i=f[1]),r||bIEAvec11?n.attr("transform",(!u?"":(n.attr("transform")||"")+" ")+"scale("+t+","+i+")"):n.css("transform",(!u?"":(n.css("transform")||"")+" ")+"scale("+t+","+i+")"),n.wbData("wbGrfDrawScale",arguments),n};WDPictureSVG.prototype.rotate=function(n,t,i,r,u,f){var e=(""+(t||"")).split(","),o;return e.length==3&&(t=e[0],i=e[1],r=e[2]),u||bIEAvec11?(o="rotate("+t,i!==undefined&&r!=undefined&&(o+=","+i+","+r),o+=")",n.attr("transform",(!f?"":(n.attr("transform")||"")+" ")+o)):(n.css("transform",(!f?"":(n.css("transform")||"")+" ")+"rotateZ("+(""+t).replace("deg","")+"deg)"),n.css("transform-origin",(typeof i=="string"?i:i+"px")+" "+(typeof r=="string"?r:r+"px"))),n.wbData("wbGrfDrawRotate",arguments),n};WDPictureSVG.prototype.bulle=function(n,t){return this.tag(n,t,"title")};WDPictureSVG.prototype.drawBulle=function(n,t,i){return this.drawContenu(n,t),i.applyStyle(this,n),n};WDPictureSVG.prototype.__tabPathVersArc=function(n,t,i,r,u){var h=Number(u.start).toRad(),f=u.rx||i||r,o=u.ry||f,e=Number(Math.abs(u.start+u.sweep)%360).toRad()-.001,s=u.rDonut||0,l=u.open||e===-.001,a=Math.cos(h),v=Math.sin(h),y=Math.cos(e),p=Math.sin(e),w=e===-.001||e-h>=Math.PI?1:0,c=s*(o/f);return["M",n+f*a,t+o*v,"A",f,o,0,w,1,n+f*y,t+o*p,l?"M":"L",n+s*y,t+c*p,"A",s,c,0,w,0,n+s*a,t+c*v,l?"":"Z"]};WDPictureSVG.prototype.drawArc=function(n,t,i,r){var u=this.__tabPathVersArc(Math.round(t.x),Math.round(t.y),t.width,t.height,t.options);return this.drawPathFactory(n,t,u,i,r),n};WDPictureSVG.prototype.draw=function(n){this.m_bDessinDirectementDansLaPage||this.PlaceDansLaPage(n);this.removeGradient()};WDPictureSVG.prototype.removeGradient=function(){this._removeGradient(this.m_domDefsSVG[0].getElementsByTagName("linearGradient"));this._removeGradient(this.m_domDefsSVG[0].getElementsByTagName("radialGradient"))};WDPictureSVG.prototype._removeGradient=function(n){for(var t,r,u=this.m_domDefsSVG[0].attributes.id.value.split("-")[0],i=0;i<n.length;++i)t=n[i],r=t.id.substr(this.m_Id.length+1+t.tagName.length+5),this.m_tabId[r]||this.remove(t)};WDPictureSVG.prototype.clipRect=function(n,t,i){var r=this.tag(this.m_domDefsSVG,t,"clipPath"),u=this.rect(r,t+"-rect");return this.drawRect(u,n,undefined,undefined,undefined,i===undefined?!1:i),this.m_tabClipActif.push(r),u};WDPictureSVG.prototype.restoreClip=function(){this.m_tabClipActif.pop()};WDChartRenderer.prototype.constructor=WDChartRenderer;WDChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i){var r=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+t),u,f;r&&r.length&&(u=r.find("text"),u.length)&&(f=new WDSvgAnimation(this.m_oGraphe,n,u,{"font-weight":i?"":900},{"font-weight":i?900:""}),f.duration=1,f.run())};WDChartRenderer.crPlusFonce=WDChartRenderer.prototype.crPlusFonce=function(n){var t=clWDUtil.tabHTML2RVBA(n);return t[0]=Math.max(t[0]-64,0),t[1]=Math.max(t[1]-64,0),t[2]=Math.max(t[2]-64,0),clWDUtil.sRVBA2HTML(t)};WDChartRenderer.bParametresSupportes=function(n,t){var i=t.m_oParametres;return i.m_bInteractif===!1?!1:parseInt10(i.m_nProfondeur)>0&&!i.m_bInterdit3D&&!n.m_b3DActive?!1:i.m_bLogarithmique?!1:i.m_bPossedeFils?!1:!i.m_bAxeHDroite||!i.m_bAxeVHaut?!1:!0};WDChartRenderer.prototype.Init=function(n){this.m_oGraphe=n;this.m_oModele=n.m_oModele;this.m_params=n.m_oModele.m_oParametres;this.setZoom(this.m_oZoom);this.m_oPaint=new WDPaintCSS};WDChartRenderer.prototype.bEstLegendeMasquee=function(n){return this.m_oGraphe.m_oVue.bEstSerieMasquee(n)===!0};WDChartRenderer.prototype.getNbLegendLabels=function(){var n=this.m_oModele.getSeriesAt(0,!1);return n!==undefined?n.getNbValues():0};WDChartRenderer.prototype.getLegendColorAt=function(n){return this.m_oModele.getCategoryColor(n)};WDChartRenderer.prototype.getSeriesAlphaAt=function(n){return this.m_oModele.getSeriesAlpha(n)};WDChartRenderer.prototype.getSeriesSplineAt=function(n){return this.m_oModele.getSeriesSpline(n)};WDChartRenderer.prototype.getSeriesDessinValeursNullesAt=function(n){return this.m_oModele.getSeriesDessinValeursNulles(n)};WDChartRenderer.prototype.getLegendLabelAt=function(n){var t=this.m_oModele.getCategoryLabelAt(n);return t===undefined?"":t};WDChartRenderer.prototype.drawAnimation=function(n,t){t.bDessinComplet()?(this.m_domBulle&&n.empty(this.m_domBulle),t.NotifDessinComplet(),this.m_oGraphe.m_oVue.Redessine(this.m_oGraphe,WDChartView.ms_nDessinParDefaut)):this.drawChart(n,t,this.m_domGroupeSeries)};WDChartRenderer.prototype.draw=function(n,t,i){var e,r,u,f;e=this.m_oModele.m_oParametres.m_oPositionnementManuel!=undefined?new WDRect(this.m_params.m_oPositionnementManuel.m_oGraphe):new WDRect(IWDChartConstant.MARGIN_BORDER,IWDChartConstant.MARGIN_BORDER,IWDChartConstant.MARGIN_BORDER*2,IWDChartConstant.MARGIN_BORDER*2);f=$(this.m_oGraphe.m_oHoteImage);f.data("width")&&(r=f.data("width"),u=f.data("height"));r&&u||(r=this.m_oGraphe.m_oHoteImage.width,u=this.m_oGraphe.m_oHoteImage.height,r==0&&(r=f.attr("data-width")),u==0&&(u=f.attr("data-height")),f.data("width",r),f.data("height",u));this.m_rectChart=new WDRect(e.m_nLeft,e.m_nTop,r-e.m_nRight,u-e.m_nBottom);this.m_rectChartInitial=new WDRect(0,0,r,u);n.m_bDessinDirectementDansLaPage?n.PlaceDansLaPage(this.m_oGraphe):n.m_domBaliseSVG=n.m_domBaliseSVG.detach();((this.m_params.m_sImageFond||"")!==""||(this.m_params.m_sCouleurFond||"")!=="")&&((this.m_params.m_sImageFond||"")!==""&&this.m_oPaint.setImageFond(this.m_params.m_sImageFond,this.m_params.m_eImageFondMode,WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart)),(this.m_params.m_sCouleurFond||"")!==""&&this.m_oPaint.setCouleurFond(this.m_params.m_sCouleurFond),n.SetImageFond(this.m_oPaint));n.SetAntiAliasing(this.m_params.m_bAntiAliasing);this.m_domGroupeSeries=n.g("series-axis-grids-groupe");this.m_domGroupeLegendeEtTitre=n.g("legende-titre-groupe");this.drawTitle(n,t,this.m_domGroupeLegendeEtTitre);this.drawLegend(n,t,this.m_domGroupeLegendeEtTitre);i!==!1&&this.drawChart(n,t,this.m_domGroupeSeries);this.m_domBulle=n.g("bulle-groupe");this.drawMire(n,t,this.m_domBulle);n.draw(this.m_oGraphe);n.m_domBaliseSVG.wbData("wbGrfNbDessins",1+(n.m_domBaliseSVG.wbData("wbGrfNbDessins")||0));t.NotifDessinComplet();this.m_oGraphe.m_oVue.updateModeleReference(this.m_oGraphe,!0)};WDChartRenderer.prototype.liaisonLegendePart=function(n,t,i){var u=WDChartListener.bind(this.m_ProtoLegendListener,this.m_oGraphe,t),r;u&&(r=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+i),r&&r.length!==0&&r[0].wbGrfBind)&&(r[0].wbGrfBind.m_domPart=t,u.m_domLegende=r)};WDChartRenderer.prototype.drawTitle=function(n,t,i){var f,e,r,s;if(this.m_oPaint.raz(),f=this.m_params.getTitlePosition(),e=n.g(i,"title-group"),f===IWDChartConstant.FLAG_TITLE_POSITION_NONE||f===IWDChartConstant.FLAG_TITLE_POSITION_MANUAL&&!(this.m_params.m_oPositionnementManuel&&this.m_params.m_oPositionnementManuel.m_oTitre)){n.empty(e);return}if(r=this.m_params.m_sTitre,r!=""){t.tweenGroupeTitre(e);this.m_oPaint.addClasse(this.m_params.m_sClasseTitre);var h=WDPaintCSS.oGetInfoCSS(this.m_oPaint,r,"lineHeight"),u=parseInt10(h.lineHeight),o=n.text(e,"titre");f===IWDChartConstant.FLAG_TITLE_POSITION_MANUAL?(s=this.m_params.m_oPositionnementManuel.m_oTitre,n.drawText(o,r,u,WDRect.getCenterX(s),s.m_nTop,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint,!1)):f===IWDChartConstant.FLAG_TITLE_POSITION_TOP?(n.drawText(o,r,u,WDRect.getCenterX(this.m_rectChart),this.m_rectChart.m_nTop,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint,!1),this.m_rectChart.setLocation(this.m_rectChart.m_nLeft,this.m_rectChart.m_nTop+u+IWDChartConstant.MARGIN_TITLE_GRAPH)):(n.drawText(o,r,u,WDRect.getCenterX(this.m_rectChart),this.m_rectChart.m_nBottom-u,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint,!1),this.m_rectChart.setSize(WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart)-u-IWDChartConstant.MARGIN_TITLE_GRAPH))}};WDChartRenderer.prototype.ecouteLegende=function(){return undefined};WDChartRenderer.prototype.drawChart=function(){this.m_oPaint.raz()};WDChartRenderer.prototype.RecreerRenderer=function(n){n.Raz()};WDChartRenderer.prototype.TermRenderer=function(n,t){var i=this.m_oGraphe.m_oVue;t!==WDChartView.ms_nDessinModifTypeGraphe&&(i.m_oModeleInitialSeries=undefined,i.m_tabSeriesMasquees=[],i.m_oAnimator.m_tabAnimations=[]);n.m_tabCache=[]};WDChartRenderer.prototype.__oPathBulle=function(n,t,i,r,u,f){var p=6,l=6,o=n.m_nLeft,e=n.m_nTop,c=n.getWidth(),s=n.getHeight(),h=i||0,a=h+l,w=Math.round(t||0)%2/2,v,y;return o+=w,e+=w,f&&(f-=e),v=["M",o+h,e,"L",o+c-h,e,"C",o+c,e,o+c,e,o+c,e+h,"L",o+c,e+s-h,"C",o+c,e+s,o+c,e+s,o+c-h,e+s,"L",o+h,e+s,"C",o,e+s,o,e+s,o,e+s-h,"L",o,e+h,"C",o,e,o,e,o+h,e],y=!1,f&&f>s&&u>o+a&&u<o+c-a?v.splice(23,3,"L",u+l,e+s,u,e+s+p,u-l,e+s,o+h,e+s):f&&f<0&&u>o+a&&u<o+c-a?v.splice(3,3,"L",u-l,e,u,e-p,u+l,e,o+c-h,e):y=u&&u>c&&f>e+a&&f<e+s-a?!0:u&&u<0&&f>e+a&&f<e+s-a?!0:!0,y&&f&&u&&v.splice(23,3,"L",o+l,e+s,o+l,e+s,o+l,e+s,o+h,e+s),{d:v,"data-arguments":Array.prototype.slice.call(arguments,0)}};WDChartRenderer.prototype.__bDessineBulle=function(n,t,i,r,u,f,e,o,s,h){for(var p=u.m_oStyle.strokeWidth,w=this.__oPathBulle(r,p,f,e,o,s),v=[{width:5,opacity:.05},{width:3,opacity:.1},{width:1,opacity:.15}],c=0,l=undefined,y,c=0;c<v.length;++c)l=n.path(t,i+"-ombre-"+c);var y=n.path(t,i),a=h&&h.prototype.bAnimationBullePathPossible(w,y,o&&s),b=new WDPaintCSS;for(c=0;c<v.length;++c)l=n.path(t,i+"-ombre-"+c),!a&&h&&h.prototype.ArreteEtVideAnimations(l),n.translate(l,p,p,!0),b.setStroke("black",v[c].width,v[c].opacity),b.DesactivePointerEvents(),n.drawPath(l,w,b,a?h:!1);return y=n.path(t,i),!a&&h&&h.prototype.ArreteEtVideAnimations(y),n.drawPath(y,w,u,a?h:!1),a};WDChartRenderer.prototype._vbLegendevaleur=function(){return!1};WDChartRenderer.prototype.nGetPasSerie=function(){return 1};WDChartRenderer.prototype.getSeriesAt=function(n,t){return this.m_oModele.getSeriesAt(n,t)};WDChartRenderer.prototype.nGetNbSeries=function(){return this.m_oModele.nGetNbSeries()};WDChartRenderer.prototype.convertSeriesIndexSelonPasToModel=function(n){return n};WDChartRenderer.GRAPHEINFOPOINT_AXEX=-10001;WDChartRenderer.GRAPHEINFOPOINT_AXEY=-10002;WDChartRenderer.GRAPHEINFOPOINT_AXEZ=-10003;WDChartRenderer.GRAPHEINFOPOINT_MIN=-20001;WDChartRenderer.GRAPHEINFOPOINT_MAX=-20002;WDChartRenderer.prototype.grInfoPoint=function(n,t,i){var r=this.m_oGraphe.m_oVue.m_oPicture,e,w,a,o,u,f;if(!r||!this.m_rectAxis)return 0;if(t!=WDChartRenderer.GRAPHEINFOPOINT_AXEX&&t!=WDChartRenderer.GRAPHEINFOPOINT_AXEY){if(e=this.m_oModele.getSeriesAt(t-1),!e)return 0;var s=e,h=e,v=this.getSeriesRenderer?this.getSeriesRenderer(e.getChartType()):undefined;if(v&&v.getValueDrawingPosition){for(var y=t,p=0,c=0,c=0;c<this.m_oModele.nGetNbSeries();c+=this.nGetPasSerie(this.m_oModele.getSeriesAt(c,!1)))if(y==++p){e=this.m_oModele.getSeriesAt(c);break}if(y!=p||!e)return 0;if(w=this.nGetPasSerie(e),w>1){a=c;s=this.m_oModele.getSeriesAt(a);h=this.m_oModele.getSeriesAt(a+1);var b=s.isOnSecondaryAxis(),k=this.getYOriginValue(b),f=h.getValueAtWithNull(i-1),d=s.getValueAt(i-1),l=v.getValueDrawingPosition(f,k,a,d,b)}}}switch(n){case eGRAPHEAXE.kAbscisse:switch(t){case WDChartRenderer.GRAPHEINFOPOINT_AXEX:return o=r.findFromId(r.m_domBaliseSVG,"axe-horiz"),u=o.get(0).getBoundingClientRect(),(i==WDChartRenderer.GRAPHEINFOPOINT_MIN?u.left:u.right)-r.m_domBaliseSVG.offset().left;case WDChartRenderer.GRAPHEINFOPOINT_AXEY:return o=r.findFromId(r.m_domBaliseSVG,"axe-vert"),u=o.get(0).getBoundingClientRect(),(i==WDChartRenderer.GRAPHEINFOPOINT_MIN?u.left:u.right)-r.m_domBaliseSVG.offset().left;default:switch(i){case WDChartRenderer.GRAPHEINFOPOINT_MIN:f=s.m_dMinValue;break;case WDChartRenderer.GRAPHEINFOPOINT_MAX:f=s.m_dMaxValue;break;default:if(l&&l.x!==undefined)return l.x;f=i-1}return this.getCategoryDrawingPositionX(f,s.isOnSecondaryAxis())}break;case eGRAPHEAXE.kOrdonnee:case eGRAPHEAXE.kOrdonneeSecondaire:switch(t){case WDChartRenderer.GRAPHEINFOPOINT_AXEX:return o=r.findFromId(r.m_domBaliseSVG,"axe-horiz"),u=o.get(0).getBoundingClientRect(),(i==WDChartRenderer.GRAPHEINFOPOINT_MIN?u.bottom:u.top)-r.m_domBaliseSVG.offset().top;case WDChartRenderer.GRAPHEINFOPOINT_AXEY:return o=r.findFromId(r.m_domBaliseSVG,"axe-vert"),u=o.get(0).getBoundingClientRect(),(i==WDChartRenderer.GRAPHEINFOPOINT_MIN?u.bottom:u.top)-r.m_domBaliseSVG.offset().top;default:switch(i){case WDChartRenderer.GRAPHEINFOPOINT_MIN:f=h.m_dMinValue;break;case WDChartRenderer.GRAPHEINFOPOINT_MAX:f=h.m_dMaxValue;break;default:if(l&&l.y!==undefined)return l.y;f=h.getValueAt(i-1)}return this.getDrawingPositionY(f,h.isOnSecondaryAxis())}}return 0};WDChartXYAnimationValeur.prototype=new WDChartAnimationValeur;WDChartXYAnimationValeur.prototype.constructor=WDChartXYAnimationValeur;WDChartXYAnimationValeur.prototype._RelativiseSelonModelePrecedent=function(){for(var n,u,c,r=this.m_oGraphe.m_oVue.m_oRenderer,f=this.m_oModelePrecedent,e=this.m_oGraphe.m_oModele,a=f.m_tabSeries.length,t=a-1;t>=0;t-=r.nGetPasSerie(f.m_tabSeries[t])){var i=f.m_tabSeries[t],o=f.m_tabSeries[t].m_oAxis,s=e.getSeriesAt(t,!1);if(s){if(n=e.getAxisByType(s.isOnSecondaryAxis()?EAxisType.Y2:EAxisType.Y),r.nGetPasSerie(i)>1&&!WDChartParameters.s_isBoursierChart(i.getChartType())){switch(t%r.nGetPasSerie(i)==0){case 0:n=e.getAxisByType(s.isOnSecondaryAxis()?EAxisType.X2:EAxisType.X);break;case 2:n=undefined}if(n===undefined)continue}var h=[],l=s.getNbValues(),v=r.getDrawnValuesCount(l,e.getAxisByType(EAxisType.X));for(u=0;u<v;++u){if(u>=l)break;c=i.m_tabValeur[u];o.m_dOriginValue&&n.m_dOriginValue&&r.m_params.isBoursierChart()?h.push(c*n.m_dOriginValue/o.m_dOriginValue):h.push(c*(n.m_dMaxValue-n.m_dMinValue)/(o.m_dMaxValue-o.m_dMinValue))}i.m_tabValeur=h;i.m_nOffset=1}}};WDChartXYAnimationValeur.prototype.tweenValue=function(n,t,i,r){return this.m_oModelePrecedent&&!this.m_bDejaRelativise&&(this._RelativiseSelonModelePrecedent(),this.m_bDejaRelativise=!0),n[0].opacity==undefined&&(n[0].opacity=n.css("opacity")),this.m_dNow==0&&n.css("display",""),this.m_oGraphe.m_oVue.bEstSerieMasquee(r)&&n[0].opacity>0?(n.css("opacity",1-this.m_dNow),n[0].opacity=1-this.m_dNow,this.m_dNow==1&&n.css("display","none")):!this.m_oGraphe.m_oVue.bEstSerieMasquee(r)&&n[0].opacity<1&&(n.css("opacity",this.m_dNow),n[0].opacity=this.m_dNow),WDChartAnimationValeur.prototype.tweenValue.apply(this,arguments)};WDXYChartAnimator.prototype=new WDChartAnimator;WDXYChartAnimator.prototype.constructor=WDPieChartAnimator;WDXYChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDChartAnimationValeur(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);i.m_oModelePrecedent=undefined;this.add(i)};WDXYChartAnimator.prototype.playMajDonnees=function(n,t){if(n.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDChartXYAnimationValeur(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);this.add(i,!0)};WDXYChartAnimator.prototype.playModifTypeGraphe=function(n,t){this.playMajDonnees(n,t)};WDXYChartAnimator.prototype.tweenRedessineAxes=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenRedessineAxes")};WDXYChartAnimator.prototype.tweenRectChart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenRectChart")};WDHeatmapChartAnimator.prototype=new WDXYChartAnimator;WDHeatmapChartAnimator.prototype.constructor=WDHeatmapChartAnimator;WDHeatmapChartAnimator.ms_bAnimationPluie=!1;WDHeatmapChartAnimator.prototype.playMajDonnees=function(n,t){if(n.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDChartAnimationValeurHeatMap(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);WDHeatmapChartAnimator.ms_bAnimationPluie&&(i.m_oModelePrecedent=undefined,i.duration=1);this.add(i,!0)};WDHeatmapChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDChartAnimationValeurHeatMap(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);i.m_oModelePrecedent=undefined;WDHeatmapChartAnimator.ms_bAnimationPluie&&(i.duration=1);this.add(i)};WDHeatmapChartAnimator.prototype.tweenValuePaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenValuePaint")};WDChartAnimationValeurHeatMap.prototype=new WDChartAnimationValeur;WDChartAnimationValeurHeatMap.prototype.constructor=WDChartAnimationValeurHeatMap;WDChartAnimationValeurHeatMap.prototype.tweenValue=function(n,t,i,r){switch((r+1)%3){case 0:return t;case 1:if(this.m_oModelePrecedent)break;return t;case 2:if(this.m_oModelePrecedent)break;return t;default:return t}return WDChartAnimationValeur.prototype.tweenValue.apply(this,arguments)};WDChartAnimationValeurHeatMap.prototype.tweenValuePaint=function(n,t,i,r){var u=clWDUtil.tabHTML2RVBA(t),f,e;if(this.m_oModelePrecedent&&n&&n.length){n.wbData("fill")||(n.wbData("fill",n.attr("fill")),n.wbData("fill")=="none"&&n.wbData("fill",this.m_oGraphe.m_oVue.m_oRenderer.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(this.m_oGraphe.m_oVue.m_oRenderer.m_dValeurMinZ)));var o=this.m_oGraphe.m_oModele.getSeriesAt(i,!1),h=o.getValueAt(r),s=(h-1)/o.getMaxValue();if(this.m_dNow<s)return n.wbData("fill");f=1-(1-this.m_dNow)/(1-s);e=clWDUtil.tabHTML2RVBA(n.wbData("fill")||t);u[0]=this.tween(e[0],u[0],f);u[1]=this.tween(e[1],u[1],f);u[2]=this.tween(e[2],u[2],f);this.m_dNow==1&&n.wbRemoveData("fill")}else u[3]=u[3]*this.m_dNow;return clWDUtil.sRVBA2HTML(u)};WDPieChartAnimator.prototype=new WDChartAnimator;WDPieChartAnimator.prototype.constructor=WDPieChartAnimator;WDPieChartAnimator.prototype.add=function(n){n.m_bToujoursAvecLibelles=this.m_oGraphe.m_oModele.m_oParametres.m_bEtiquetteSecteurExterieures;WDChartAnimator.prototype.add.apply(this,arguments)};WDPieChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDPieChartAnimation1erAffichageWindevLike(n,t);this.add(i,!0)};WDPieChartAnimator.prototype.playModifTypeGraphe=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.playModifTypeGraphe.apply(this,arguments);return}this.add(new WDPieChartAnimation1erAffichageAngleFinCroissant(n,t))};WDPieChartAnimator.prototype.playSurbrillancePart=function(n,t,i,r,u){r!==undefined&&this.add(new WDPieChartAnimationSurbrillancePartNoDraw(n,t,i,r,u))};WDPieChartAnimator.prototype.playSelectionPart=function(n,t,i,r){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation!==0&&this.m_oGraphe.m_oModele.m_oParametres.getType()!=WDChartParameters.kHemicycle){var u=new WDPieChartAnimationSelectionPart(n,t,i,r);u.m_dAngleFinal!=u.m_dAngleInitial&&this.add(u)}};WDPieChartAnimator.prototype.playSelectionLegende=function(n,t,i,r){var u,f;i.wbData("wbGrfDrawPath")&&i.wbData("wbGrfDrawPath").options.sweep>=359||(u=this.m_oGraphe.m_oVue.bEstSerieMasquee(WDPieChartRenderer.nGetIndicePart(t,i)),r.fadeTo(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0?0:400,u?1:.5,function(){i.attr("pointer-events",u?"all":"none")}).find("text").css("text-decoration",u?"":"line-through"),f=new WDPieChartAnimationSelectionLegende(n,t,i,r),this.add(f))};WDPieChartAnimator.prototype.tweenInitialStartAngle=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenInitialStartAngle")};WDPieChartAnimator.prototype.tweenInitialEndAngle=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenInitialEndAngle")};WDPieChartAnimator.prototype.tweenRectChart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenRectChart")};WDPieChartAnimator.prototype.tweenHoleRadius=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenHoleRadius")};WDPieChartAnimator.prototype.tweenPart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenPart")};WDPieChartAnimator.prototype.tweenPartPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenPartPaint")};WDPieChartAnimator.prototype.tweenLabelPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenLabelPaint")};WDPieChartZoomAnimation.prototype=new WDChartAnimation;WDPieChartZoomAnimation.prototype.constructor=WDPieChartZoomAnimation;WDPieChartZoomAnimation.prototype.tweenRectChart=function(n,t){this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect")===undefined&&this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",t);var i=this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect"),r=(i.getWidth()-this.m_dZoom*i.getWidth())/2,u=(i.getHeight()-this.m_dZoom*i.getHeight())/2;return this.tweenRect(i,new WDRect(i.m_nLeft-r,i.m_nTop-u,i.m_nRight+r,i.m_nBottom+u))};WDPieChartZoomAnimation.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&n.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart)};WDPieChartAnimationSurbrillancePartNoDraw.prototype=new WDChartAnimationNoDraw;WDPieChartAnimationSurbrillancePartNoDraw.prototype.constructor=WDPieChartAnimationSurbrillancePartNoDraw;WDPieChartAnimationSurbrillancePartNoDraw.prototype.run=function(){this.m_domPartEnSurbrillance.clearQueue().finish().animate({opacity:this.m_bEtat?.8:1},this.m_bEtat?this.duration:1,this.easing);this.m_oAnimator.retireAnimation(this.m_domPartEnSurbrillance.parent().wbData("wbGrfAnim"));this.m_domPartEnSurbrillance.parent().wbData("wbGrfAnim",this).clearQueue().finish().animate({content:1},this)};WDPieChartAnimationSurbrillancePartNoDraw.prototype.step=function(){var n=WDChartAnimationNoDraw.prototype.step.apply(this,arguments),t;n&&(t=n.tween(n.m_nEcartInitial,n.m_bEtat?n.m_nEcart:0,n.m_dNow),WDPieChartRenderer.prototype.m_bDessinneSelonBissectire&&$(this).wbData("wbGrfAnimSurbrillanceEcart",t).attr("transform","translate("+t+", 0)"))};WDPieChartAnimationSelectionLegende.prototype=new WDChartAnimation;WDPieChartAnimationSelectionLegende.prototype.constructor=WDPieChartAnimationSelectionLegende;WDPieChartAnimationSelectionLegende.prototype.tweenValue=function(n,t,i){return this.m_nIndiceValeurDansSerie==i?(this.m_bAffiche?this.m_dNow:1-this.m_dNow)*t:t};WDPieChartAnimationSelectionLegende.prototype.done=function(){};WDPieChartAnimationSelectionLegende.prototype.run=function(){for(var n,t=this.m_oAnimator.m_tabAnimations.length-1;t>-1;--t)(n=this.m_oAnimator.m_tabAnimations[t],n!==this)&&n.constructor==this.constructor&&n.m_nIndiceValeurDansSerie===this.m_nIndiceValeurDansSerie&&WDChartAnimation.prototype.done.apply(n,arguments);WDChartAnimation.prototype.run.apply(this,arguments)};WDPieChartAnimationSelectionLegende.prototype.tweenLabelPaint=function(n,t){return this.m_nIndiceValeurDansSerie==n&&(t.m_oStyle.opacity=this.m_bAffiche?this.m_dNow:1-this.m_dNow),t};WDPieChartAnimationSelectionLegende.prototype.tweenPartPaint=function(n,t){return this.m_nIndiceValeurDansSerie==WDPieChartRenderer.nGetIndicePart(this.m_oPicture,n)&&(t.m_oStyle.opacity=this.m_bAffiche?this.m_dNow:1-this.m_dNow),t};WDPieChartAnimationSelectionLegende.prototype.tweenLegendPaint=function(n,t){return t};WDPieChartAnimationSelectionLegende.prototype.tweenHideLabel=function(n,t,i){if(this.m_bToujoursAvecLibelles)return t;if(this.m_dNow<=1/3){var r=this.m_oGraphe.m_oVue.bEstSerieMasquee(i);if(r)return!1}return WDChartAnimation.prototype.tweenHideLabel.apply(this,arguments)};WDPieChartAnimationSurbrillancePart.prototype=new WDChartAnimation;WDPieChartAnimationSurbrillancePart.prototype.constructor=WDPieChartAnimationSurbrillancePart;WDPieChartAnimationSurbrillancePart.prototype.tweenPartPaint=function(n,t){return this.m_oPicture.getId(this.m_domPartEnSurbrillance)===this.m_oPicture.getId(n)&&(t.m_oStyle.opacity=this.tween(this.m_bEtat?1:.8,this.m_bEtat?.8:1)),t};WDPieChartAnimation1erAffichageBase.prototype=new WDChartAnimation;WDPieChartAnimation1erAffichageBase.prototype.constructor=WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageBase.prototype.tweenLabelPaint=function(n,t){return t.m_oStyle.opacity=(t.m_oStyle.opacity===undefined?1:t.m_oStyle.opacity)*Math.max(0,Math.exp(this.m_dNow)*Math.log(this.m_dNow)+1),t};WDPieChartAnimation1erAffichageArretDuVinyle.prototype=new WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageArretDuVinyle.prototype.constructor=WDPieChartAnimation1erAffichageArretDuVinyle;WDPieChartAnimation1erAffichageArretDuVinyle.prototype.tweenInitialStartAngle=function(n,t){return this.m_dNow*t*this.m_dPourcentRotation+t*(1-this.m_dPourcentRotation)};WDPieChartAnimationSelectionPart.prototype=new WDChartAnimation;WDPieChartAnimationSelectionPart.prototype.constructor=WDPieChartAnimationSelectionPart;WDPieChartAnimationSelectionPart.prototype.tweenInitialStartAngle=function(){return this.tween(this.m_dAngleInitial,this.m_dAngleFinal)};WDPieChartAnimationSelectionPart.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_oGraphe.m_oVue.m_oRenderer.m_params.m_dAngle=Number(n.m_dAngleFinal-270).toRad(),WDChartAnimation.prototype.done.apply(this,arguments))};WDPieChartAnimation1erAffichageWindevLike.prototype=new WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageWindevLike.prototype.constructor=WDPieChartAnimation1erAffichageWindevLike;WDPieChartAnimation1erAffichageWindevLike.prototype.tweenInitialStartAngle=function(n,t){return this.m_dNow*t*this.m_dPourcentRotation+t*(1-this.m_dPourcentRotation)};WDPieChartAnimation1erAffichageWindevLike.prototype.tweenPart=function(n,t){return t.options.sweep*=this.m_dNow,t};WDPieChartAnimation1erAffichageWindevLike.prototype.tweenRectChart=function(n,t){this.m_dNow==0&&n.wbData("wbGrfWDPieChartAnimation1erAffichageWindevLikeRect",t);var i=n.wbData("wbGrfWDPieChartAnimation1erAffichageWindevLikeRect"),r=i.m_nTop+i.getHeight()/2,u=i.m_nLeft+i.getWidth()/2;return this.tweenRect(new WDRect(u,r,u,r),i)};WDPieChartAnimation1erAffichageClipPath.prototype=new WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageClipPath.prototype.constructor=WDPieChartAnimation1erAffichageClipPath;WDPieChartAnimation1erAffichageClipPath.prototype.tweenPart=function(n,t){var i=360*this.m_dNow,r;return t.options.startAngle-t.options.firstAngle>=i?t.options.sweep=0:(r=t.options.startAngle-t.options.firstAngle+t.options.sweep,i<r&&(t.options.sweep=i-(t.options.startAngle-t.options.firstAngle))),t};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype=new WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.constructor=WDPieChartAnimation1erAffichageAngleFinCroissant;WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.tweenInitialEndAngle=function(n,t){var r=this.m_oPicture.find(this.m_domEtatInitial,n),i=r.wbData("wbGrfAnimTweenInitialEndAngle");return i||(i=0),this.tween(i,t)};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.tweenInitialStartAngle=function(n,t){var r=this.m_oPicture.find(this.m_domEtatInitial,n),i=r.wbData("wbGrfAnimTweenInitialStartAngle");return i||(i=0),this.tween(i,t)};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.tweenHoleRadius=function(n,t){var r=this.m_oPicture.find(this.m_domEtatInitial,n),i=r.wbData("wbGrfAnimTweenHoleRadius");return i||(i=0),t||(t=0),this.tween(i,t)};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.tweenRectChart=function(n,t){this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect")===undefined&&this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",t);var i=this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect");return this.tweenRect(i,t)};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart),WDChartAnimation.prototype.done.apply(this,arguments))};WDPieChartAnimationTourneNoDraw.prototype=new WDChartAnimationNoDraw;WDPieChartAnimationTourneNoDraw.prototype.constructor=WDPieChartAnimationTourneNoDraw;WDPieChartAnimationTourneNoDraw.prototype.run=function(){this.m_oGraphe.m_oVue.Redessine(this.m_oGraphe,WDChartView.ms_nDessinAnimation)};WDPieChartAnimationTourneNoDraw.prototype.tweenInitialStartAngle=function(n,t){return t+this.m_nAngle};WDRadarChartAnimator.prototype=new WDXYChartAnimator;WDRadarChartAnimator.prototype.constructor=WDRadarChartAnimator;WDRadarChartAnimator.prototype.TermAnimator=function(){WDChartAnimator.prototype.TermAnimator.apply(this.m_oGraphe.m_oVue.m_oRenderer.arguments);this.m_oGraphe.m_oVue.m_oRenderer.m_domStyle.remove()};WDSunburstChartAnimator.prototype=new WDPieChartAnimator;WDSunburstChartAnimator.prototype.constructor=WDSunburstChartAnimator;WDSunburstChartAnimator.prototype.add=function(n){n.m_bToujoursAvecLibelles=!1;WDChartAnimator.prototype.add.apply(this,arguments)};WDSunburstChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDSunburstChartAnimation1erAffichageEventailNoDraw(n,t);i.duration=this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation;this.add(i,!0)};WDSunburstChartAnimator.prototype.playModifTypeGraphe=function(){WDChartAnimator.prototype.playModifTypeGraphe.apply(this,arguments)};WDSunburstChartAnimator.prototype.playSurbrillancePart=function(n,t,i,r,u){r!==undefined&&(bTouch||this.add(new WDSunburstChartAnimationSurbrillancePartNoDraw(n,t,i,r,u)))};WDSunburstChartAnimator.prototype.playSelectionPart=function(n,t,i){var r=i.wbData("wbGrfNode");r&&r.clicked&&r.clicked()};WDSunburstChartAnimator.prototype.playSelectionLegende=function(){};WDSunburstChartAnimation1erAffichage.prototype=new WDPieChartAnimation1erAffichageBase;WDSunburstChartAnimation1erAffichage.prototype.constructor=WDSunburstChartAnimation1erAffichage;WDSunburstChartAnimation1erAffichage.prototype.tweenInitialEndAngle=function(n){var i=this.m_oPicture.find(this.m_domEtatInitial,n),t=i.wbData("wbGrfAnimTweenInitialEndAngle");return t||(t=0),this.tween(0,360)};WDSunburstChartAnimation1erAffichage.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart),WDChartAnimation.prototype.done.apply(this,arguments))};WDSunburstChartAnimation1erAffichageEventailNoDraw.prototype=new WDChartAnimationNoDraw;WDSunburstChartAnimation1erAffichageEventailNoDraw.prototype.constructor=WDSunburstChartAnimation1erAffichageEventailNoDraw;WDSunburstChartAnimation1erAffichageEventailNoDraw.prototype.run=function(){this.m_oGraphe.m_oVue.Redessine(this.m_oGraphe,WDChartView.ms_nDessinParDefaut);var n=this;this.m_domBaliseAnim.wbData("wbGrfAnim",this);setTimeout(function(){n.done()},this.duration)};WDSunburstChartAnimation1erAffichageEventailNoDraw.prototype.step=function(){var n=WDChartAnimationNoDraw.prototype.step.apply(this,arguments);!n};WDSunburstChartAnimation1erAffichageEventailNoDraw.prototype.tweenHideLabel=function(n,t){return t};WDSunburstChartAnimation1erAffichageEventailNoDraw.prototype.tweenLabelPaint=function(n,t){return t};WDSunburstChartAnimation1erAffichageEventailNoDraw.prototype.tweenPartPaint=function(n,t){return t};WDSunburstChartAnimationSurbrillancePartNoDraw.prototype=new WDChartAnimationNoDraw;WDSunburstChartAnimationSurbrillancePartNoDraw.prototype.constructor=WDSunburstChartAnimationSurbrillancePartNoDraw;WDSunburstChartAnimationSurbrillancePartNoDraw.prototype.run=function(){this.m_domPartEnSurbrillance.clearQueue().finish().animate({opacity:this.m_bEtat?.8:1},this.m_bEtat?this.duration:1,this.easing);this.m_oAnimator.retireAnimation(this.m_domPartEnSurbrillance.parent().wbData("wbGrfAnim"));this.m_domPartEnSurbrillance.parent().wbData("wbGrfAnim",this).clearQueue().finish().animate({content:1},this)};WDSunburstChartAnimationSurbrillancePartNoDraw.prototype.step=function(){var n=WDChartAnimationNoDraw.prototype.step.apply(this,arguments),t;n&&(t=n.tween(n.m_nEcartInitial,n.m_bEtat?n.m_nEcart:1,n.m_dNow),$(this).wbData("wbGrfAnimSurbrillanceEcart",t).css("transform-origin","center center").css("transform","scale("+t+")"),n.svgTexte&&n.svgTexte.parent().parent().css("transform-origin","center center").css("transform","scale("+t+")"))};WDChartMireListener.prototype=new WDChartListener;WDChartMireListener.prototype.constructor=WDChartMireListener;WDChartMireListener.LONGTAP_DUREE=500;WDChartMireListener.DOUBLETAP_TIMEOUT=200;WDChartMireListener.DOUBLETAP_MAX_DISTANCE=60;WDChartMireListener.pinchOptimViaTransform=!0;WDChartMireListener.prototype.swipeStatus=function(n,t,i,r,u,f,e){var o=WDChartListener.getListener(this),h,s,c,b,a,v;if(o&&(h=o.m_oGraphe,s=o.m_oGraphe.m_oVue.m_oRenderer,s&&s.bAutoriseZoom())){if(o.timerFinLongTap!==undefined&&(clearTimeout(o.timerFinLongTap),o.timerFinLongTap=undefined),t==="cancel"||t==="end"){o.fRAFDeplacementTimer!==undefined&&o.fRAFDeplacement();return}if(t=="start"&&(o.nDistancePendantTimeout=0),u<WDChartMireListener.LONGTAP_DUREE&&(o.nDistancePendantTimeout=Math.max(o.nDistancePendantTimeout,r)),o.startTouch=o.startTouch||{pageX:nGetPageX(n),pageY:nGetPageY(n)},!o.fRAFTimer&&(!n.touches||n.touches.length===1)&&f===1){if(u<WDChartMireListener.LONGTAP_DUREE&&o.nDistancePendantTimeout<WDChartMireListener.DOUBLETAP_MAX_DISTANCE&&!s.m_oZoom){h.m_oBarreAutomatique&&h.m_oBarreAutomatique.m_jqBurger&&h.m_oBarreAutomatique.m_eModeBarre!=h.m_oBarreAutomatique.ms_eModeBarreJamais&&!h.m_oBarreAutomatique.m_jqBurger.find("input").prop("checked")&&(o.timerFinLongTap=setTimeout(function(){h.m_oBarreAutomatique.m_jqBurger.find("input").prop("checked",!0).change();clearTimeout(o.timerFinLongTap);o.timerFinLongTap=undefined},WDChartMireListener.LONGTAP_DUREE-u));return}if(o.nDistancePendantTimeout<WDChartMireListener.DOUBLETAP_MAX_DISTANCE||!s.m_oZoom){WDChartMireListener.prototype.click.apply(this,[extendEvent(n,{type:"click"})]);return}if(c=o.m_oGraphe.m_oVue.m_oPicture,o.isRendererZoomable(s)){if(n.preventDefault(),b={start:{x:o.startTouch.pageX,y:o.startTouch.pageY},end:{x:nGetPageX(n),y:nGetPageY(n)}},o.startTouch=undefined,a=s.m_params.isHorizontalZoomEnabled()?e[0].start.x-e[0].end.x:0,v=s.m_params.isVerticalZoomEnabled()?e[0].end.y-e[0].start.y:0,a==0&&v==0)return;WDChartMireListener.prototype.mouseleave.apply(this,[extendEvent(n,{type:"mouseleave",grfX:s.m_rectAxis.m_nRight+1,grfY:s.m_rectAxis.m_nBottom+1})]);var k=c.findFromId(c.m_domBaliseSVG,"groupe-series"),d=c.findFromId(c.m_domBaliseSVG,"barre-texte"),l=k.add(d);l.attr("clip-path","url(#"+c.sConstruitId("clip-axes")+")");var w=new WDChartZoom(s),y=w.deplace(a,v),p=y.x!==0||y.y!==0;p?l.children().attr("transform","translate("+-y.x+", "+y.y+")"):l.children().attr("transform","translate("+-a/3+", "+v/3+")");o.fRAFDeplacement=function(){s.drawZoom(w,p?undefined:function(){l.children().animate({content:1},{start:function(){this.startX=a/3;this.startY=v/3},step:function(n){$(this).attr("transform","translate("+-(this.startX*(1-n))+", "+this.startY*(1-n)+")")},done:function(){l.removeAttr("clip-path");$(this).removeAttr("transform").removeAttr("transform-origin")},duration:350,easing:"easeOutBounce"})});p&&l.removeAttr("clip-path").children().removeAttr("transform").removeAttr("transform-origin");o.fRAFDeplacementTimer!==undefined&&(clearTimeout(o.fRAFDeplacementTimer),o.fRAFDeplacementTimer=undefined)};o.fRAFDeplacementTimer!==undefined&&(clearTimeout(o.fRAFDeplacementTimer),o.fRAFDeplacementTimer=undefined);o.fRAFDeplacementTimer=setTimeout(o.fRAFDeplacement,100)}}}};WDChartMireListener.prototype.bAutorisePinch=function(){var n=this,t=n.m_oGraphe;return t.m_oVue.m_oRenderer&&t.m_oVue.m_oRenderer.m_rectAxis&&n.m_oGraphe.m_oVue.m_oRenderer.bAutoriseZoom()};WDChartMireListener.prototype.pinchIn=WDChartMireListener.prototype.pinchOut=function(n){var t=WDChartListener.getListener(this),i;t&&t.bAutorisePinch()&&(i=t.m_oGraphe.m_oVue.m_oRenderer,t.isRendererZoomable(i))&&(n.preventDefault(),t.fRAF&&t.fRAF())};WDChartMireListener.prototype.pinchStatus=function(n,t,i,r,u,f,e){var o=WDChartListener.getListener(this),s;if(o&&o.bAutorisePinch()&&f==2&&n.touches.length==2&&(s=o.m_oGraphe.m_oVue.m_oRenderer,s&&s.bAutoriseZoom())){var v=Math.min(n.touches[1].pageX,n.touches[0].pageX),p=Math.max(n.touches[1].pageX,n.touches[0].pageX),l=v+(p-v)/2,y=Math.min(n.touches[1].pageY,n.touches[0].pageY),w=Math.max(n.touches[1].pageY,n.touches[0].pageY),a=y+(w-y)/2,c=o.m_oGraphe.m_oVue.m_oPicture;if(n.scale&&e!=1&&(e=n.scale),s.m_params.isHorizontalZoomEnabled()||s.m_params.isVerticalZoomEnabled()){n.preventDefault();WDChartMireListener.pinchOptimViaTransform||(e==1||t=="start")&&(o.lastZoom=new WDChartZoom(s,!0));WDChartMireListener.prototype.mouseleave.apply(this,[extendEvent(n,{type:"mouseleave",grfX:s.m_rectAxis.m_nRight+1,grfY:s.m_rectAxis.m_nBottom+1})]);var b=c.findFromId(c.m_domBaliseSVG,"groupe-series"),k=c.findFromId(c.m_domBaliseSVG,"barre-texte"),h=b.add(k);if(o.fRAF=function(){var n=new WDChartZoom(s);o.lastZoom&&s.setZoom(o.lastZoom);n.setCoeff(l,a,parseFloat(e))!==!1&&s.drawZoom(n);h.removeAttr("clip-path").children().removeAttr("transform").removeAttr("transform-origin");o.fRAFTimer!==undefined&&(clearTimeout(o.fRAFTimer),o.fRAFTimer=undefined)},!WDChartMireListener.pinchOptimViaTransform){o.fRAF(!0);return}o.fRAFTimer!==undefined&&(clearTimeout(o.fRAFTimer),o.fRAFTimer=undefined);o.fRAFTimer=setTimeout(o.fRAF,100);h.attr("clip-path","url(#"+c.sConstruitId("clip-axes")+")");e!==n.scale?s.m_params.isHorizontalZoomEnabled()&&s.m_params.isVerticalZoomEnabled()?h.children().attr("transform","scale("+e+" "+e+")").attr("transform-origin",l+" "+a):s.m_params.isHorizontalZoomEnabled()?h.children().attr("transform","scale("+e+" 1)").attr("transform-origin",l+" center"):s.m_params.isVerticalZoomEnabled()&&h.children().attr("transform","scale(1 "+e+")").attr("transform-origin","center "+a):h.children().each(function(){var n,t,i;$(this).attr("transform","");n="scale(";t=0;s.m_params.isVerticalZoomEnabled()?(t=($(this).width()/e-$(this).width()*1)/2,n+=e+","):n+="1,";i=0;s.m_params.isVerticalZoomEnabled()?(i=($(this).height()/e-$(this).height()*1)/2,n+=e+")"):n+="1)";$(this).attr("transform",n+" translate("+t+" "+i+")")})}}};WDChartMireListener.prototype.keyup=function(n){if(n.key==="Escape"||n.code==="Escape"){var t=WDChartListener.getListener(this);t&&WDChartMireListener.prototype.mouseleave.apply(this,[extendEvent(n,{type:"mouseleave"})])}};WDChartMireListener.prototype.dblclick=function(n){var t,i;(bTouch||n.type==="dblclick")&&(t=WDChartListener.getListener(this),t)&&(i=t.m_oGraphe.m_oVue.m_oRenderer,i&&i.bAutoriseZoom())&&t.m_oGraphe.m_oVue.m_oRenderer.toggleZoomDouble(nGetPageX(extendEvent(n,t.lastTap)),nGetPageY(extendEvent(n,t.lastTap)),function(){t.UpdateMire(extendEvent(n,{type:"mouseleave"}))})&&n.preventDefault()};WDChartMireListener.prototype.isRendererZoomable=function(n){return n instanceof WDXYChartRenderer&&n.m_rectAxis&&(n.m_params.isHorizontalZoomEnabled()||n.m_params.isVerticalZoomEnabled())};WDChartMireListener.prototype.isPositionHorsAxe=function(n,t){return n.x<t.m_rectAxis.m_nLeft||n.x>t.m_rectAxis.m_nRight||n.y<t.m_rectAxis.m_nTop||n.y>t.m_rectAxis.m_nBottom};WDChartMireListener.prototype.mousewheel=function(n){var t=WDChartListener.getListener(this),i,r,u,e,f;t&&(i=t.m_oGraphe.m_oVue.m_oRenderer,i&&i.bAutoriseZoom())&&((r=nGetPageX(n,0),u=nGetPageY(n,0),t.isRendererZoomable(i)&&(e=i.coordonneesEcranVersGraphe(r,u),t.isPositionHorsAxe(e,i)))||(f=new WDChartZoom(t.m_oGraphe.m_oVue.m_oRenderer),f.setMolette(r,u,nGetDeltaY(n,0))!==!1&&t.m_oGraphe.m_oVue.m_oRenderer.drawZoom(f,function(){t.UpdateMire(extendEvent(n,{type:"mouseleave"}))})&&(n.stopPropagation(),n.preventDefault())))};bFF?WDChartMireListener.prototype.DOMMouseScroll=WDChartMireListener.prototype.mousewheel:WDChartMireListener.prototype.wheel=WDChartMireListener.prototype.mousewheel;WDChartMireListener.prototype.touchstart=function(n){var t=WDChartListener.getListener(this);t&&(t.lastTap={pageX:nGetPageX(n),pageY:nGetPageY(n)})};WDChartMireListener.prototype.click=WDChartMireListener.prototype.mouseleave=WDChartMireListener.prototype.mousedown=WDChartMireListener.prototype.mouseup=WDChartMireListener.prototype.mouseenter=WDChartMireListener.prototype.mousemove=function(n){var t,i,u,s,f,h,c,r,a,e,w,o;if(n.button!=2&&(t=WDChartListener.getListener(this),t)&&(i=t.m_oGraphe.m_oVue.m_oRenderer,u=t.m_oGraphe,t.getChartType()!=WDChartParameters.kHeatMap||this.tagName.toLowerCase()=="rect")){if(s=u.m_oBarreAutomatique&&u.m_oBarreAutomatique.m_jqBurger&&u.m_oBarreAutomatique.m_jqBurger.find("input").prop("checked"),f=!s&&t.isRendererZoomable(i)&&i.bAutoriseZoom(),!f){t.UpdateMire(extendEvent(n),n.grfX,n.grfY);return}var v=n.type==="mousedown"||n.type==="pointerdown"||n.type==="touchstart",l=n.type==="click"||n.type==="mouseup"||n.type==="mouseleave"||n.type==="pointerup"||n.type==="touchend"||n.type==="touchcancel",y=nGetPageX(n,t.m_oPositionDerniere?t.m_oPositionDerniere.x:0),p=nGetPageY(n,t.m_oPositionDerniere?t.m_oPositionDerniere.y:0);if(t.m_oPositionDerniere=i.coordonneesEcranVersGraphe(y,p),h=f&&(t.m_oPositionDerniere.x<i.m_rectAxis.m_nLeft||t.m_oPositionDerniere.x>i.m_rectAxis.m_nRight||t.m_oPositionDerniere.y<i.m_rectAxis.m_nTop||t.m_oPositionDerniere.y>i.m_rectAxis.m_nBottom),c=t.m_oGraphe.m_oVue.m_oPicture,t.m_oPositionDebut?(r=new WDRect(Math.min(t.m_oPositionDebut.x,t.m_oPositionDerniere.x),Math.min(t.m_oPositionDebut.y,t.m_oPositionDerniere.y),Math.max(t.m_oPositionDebut.x,t.m_oPositionDerniere.x),Math.max(t.m_oPositionDebut.y,t.m_oPositionDerniere.y)),i.m_params.isHorizontalZoomEnabled()||(r.m_nLeft=i.m_rectAxis.m_nLeft,r.m_nRight=i.m_rectAxis.m_nRight),i.m_params.isVerticalZoomEnabled()||(r.m_nTop=i.m_rectAxis.m_nTop,r.m_nBottom=i.m_rectAxis.m_nBottom),a=t.m_oPositionDebut.x>t.m_oPositionDerniere.x,t.fRAFRect=function(){i.drawRectZoom(!0,r,a);t.fRAFRectTimer!==undefined&&cancelAnimationFrame(t.fRAFRectTimer)},t.fRAFRectTimer!==undefined&&cancelAnimationFrame(t.fRAFRectTimer),l?t.fRAFRect():t.fRAFRectTimer=requestAnimationFrame(t.fRAFRect)):v&&f&&!h&&(t.m_oPositionDebut=t.m_oPositionDerniere,e="crosshair",i.m_params.isHorizontalZoomEnabled()||(e="ns-resize"),i.m_params.isVerticalZoomEnabled()||(e="ew-resize"),c.m_domBaliseSVG.css("cursor",e)),w=t.UpdateMire(extendEvent(n),n.grfX,n.grfY),l&&(t.m_oPositionDebut&&(i.drawRectZoom(!1),c.m_domBaliseSVG.css("cursor",""),o=new WDChartZoom(t.m_oGraphe.m_oVue.m_oRenderer),(r,t.m_oPositionDebut.x>t.m_oPositionDerniere.x)?o.reset():o.setRect(r,!0),i.drawZoom(o,function(){t.UpdateMire(extendEvent(n))}),t.m_oPositionDerniere=t.m_oPositionDebut=undefined),window.getSelection&&window.getSelection().removeAllRanges()),!h&&!s)try{n.domEvent?n.domEvent.preventDefault():n.preventDefault()}catch(b){}}};bEdge&&(WDChartMireListener.prototype.pointerleave=WDChartMireListener.prototype.pointerdown=WDChartMireListener.prototype.pointerup=WDChartMireListener.prototype.pointerenter=WDChartMireListener.prototype.pointermove=WDChartMireListener.prototype.mousemove);WDChartMireListener.prototype.getChartType=function(){return this.m_oGraphe.m_oParametres.m_eType};WDChartMireListener.prototype.UpdateMire=function(n,t,i){return this.m_oGraphe.m_oVue.m_oRenderer.drawMire(this.m_oGraphe.m_oVue.m_oPicture,this.m_oGraphe.m_oVue.m_oAnimator,$(this.m_oGraphe.m_oVue.m_oPicture.m_domBaliseSVG[0].getElementById(this.m_oGraphe.m_oVue.m_oPicture.getId(this.m_domBulle))),n,t,i)};WDPieChartSelectionnePartListenerBase.prototype=new WDChartListener;WDPieChartSelectionnePartListenerBase.prototype.constructor=WDPieChartSelectionnePartListenerBase;WDPieChartSelectionnePartListenerBase.prototype.SelectionnePart=function(n,t){this.m_oVue.m_oAnimator.playSelectionPart(this.m_oGraphe,this.m_oVue.m_oPicture,n,t)};WDPieChartSelectionnePartListenerBase.prototype.SurbrillancePart=function(n,t,i){this.m_oVue.m_oAnimator.playSurbrillancePart(this.m_oGraphe,this.m_oVue.m_oPicture,n,t,i)};WDPieChartSelectionnePartListenerBase.prototype.SurbrillanceLegende=function(n,t,i){var r=t.find("text"),u,f;r.css("font-weight")===undefined&&r.css("font-weight",0);u=new WDSvgAnimation(this.m_oGraphe,this.m_oGraphe.m_oVue.m_oPicture,r,{"font-weight":r.css("font-weight")},{"font-weight":n?900:0});u.duration=1;u.run();f=this.m_oVue.bEstSerieMasquee(WDPieChartRenderer.nGetIndicePart(this.m_oVue.m_oPicture,i));f||this.m_oVue.m_oAnimator.playSurbrillancePart(this.m_oGraphe,this.m_oVue.m_oPicture,n,i,t)};WDPieChartSelectionnePartListenerBase.prototype.SelectionneLegende=function(n,t){this.m_oVue.m_oAnimator.playSelectionLegende(this.m_oGraphe,this.m_oVue.m_oPicture,t,n)};WDPieChartSelectionnePartListenerBase.prototype.domGetLegendeAssociee=function(n,t){return t?t:undefined};WDPieChartSelectionnePartListenerBase.prototype.domGetPartAssociee=function(n,t){return t?t:undefined};WDPieChartPartListener.prototype=new WDPieChartSelectionnePartListenerBase;WDPieChartPartListener.prototype.constructor=WDPieChartPartListener;WDPieChartPartListener.prototype.click=function(){var n=WDChartListener.getListener(this);n&&n.SelectionnePart(n.m_domBalise,n.m_domLegende=n.domGetLegendeAssociee(n.m_domBalise,n.m_domLegende))};WDPieChartPartListener.prototype.mouseenter=function(){var n=WDChartListener.getListener(this);n&&n.SurbrillancePart(!0,n.m_domBalise,n.m_domLegende=n.domGetLegendeAssociee(n.m_domBalise,n.m_domLegende))};WDPieChartPartListener.prototype.mouseleave=function(){var n=WDChartListener.getListener(this);n&&n.SurbrillancePart(!1,n.m_domBalise,n.m_domLegende=n.domGetLegendeAssociee(n.m_domBalise,n.m_domLegende))};WDPieChartLegendListener.prototype=new WDPieChartSelectionnePartListenerBase;WDPieChartLegendListener.prototype.constructor=WDPieChartLegendListener;WDPieChartLegendListener.prototype.click=function(){var n=WDChartListener.getListener(this);n&&n.m_domPart&&n.SelectionneLegende(n.m_domBalise,n.m_domPart=n.domGetPartAssociee(n.m_domBalise,n.m_domPart))};WDPieChartLegendListener.prototype.mouseenter=function(){var n=WDChartListener.getListener(this);n&&($(this).css("cursor","pointer"),n.m_domPart&&n.SurbrillanceLegende(!0,n.m_domBalise,n.m_domPart=n.domGetPartAssociee(n.m_domBalise,n.m_domPart)))};WDPieChartLegendListener.prototype.mouseleave=function(){var n=WDChartListener.getListener(this);n&&($(this).css("cursor",""),n.m_domPart&&n.SurbrillanceLegende(!1,n.m_domBalise,n.m_domPart=n.domGetPartAssociee(n.m_domBalise,n.m_domPart)))};WDSunburstChartPartListener.prototype=new WDPieChartPartListener;WDSunburstChartPartListener.prototype.constructor=WDSunburstChartPartListener;bTouch&&(WDSunburstChartPartListener.prototype.touchstart=function(){var n=WDChartListener.getListener(this);n&&n.SelectionnePart(n.m_domBalise,n.m_domLegende=n.domGetLegendeAssociee(n.m_domBalise,n.m_domLegende))},WDSunburstChartPartListener.prototype.click=function(){});WDXYChartLegendListener.prototype=new WDChartListener;WDXYChartLegendListener.prototype.constructor=WDXYChartLegendListener;WDXYChartLegendListener.prototype.click=function(n){var t=WDChartListener.getListener(this);t&&(t.SelectionneLegende(),n&&n.stopPropagation())};WDXYChartLegendListener.prototype.mouseenter=function(n){var t=WDChartListener.getListener(this);t&&(t.event=n,$(this).css("cursor","pointer"),t.SurvolLegende(!0))};WDXYChartLegendListener.prototype.mouseleave=function(){var n=WDChartListener.getListener(this);n&&($(this).css("cursor",""),n.SurvolLegende(!1))};WDXYChartLegendListener.prototype.SurvolLegende=function(n){var t=this.m_domGroupeSerie.find("path"),i;t.length===0?(t=this.m_domGroupeSerie.find("rect"),i=this.m_oGraphe,i.m_oVue.m_oRenderer.surbrillanceSerieDepuisMire(i.m_oVue.m_oPicture,this.m_nIndexSerie,n,this.m_nIndexSerie)):t.css("strokeWidth",parseInt10(t.attr("stroke-width")||1)+(n?1:0))};WDXYChartLegendListener.prototype.SelectionneLegende=function(){var r,u,f,e,n,i,t;for(this.m_oGraphe.m_oVue.toggleSerieMasquee(this.m_nIndexSerie),r=[undefined,undefined],n=0;n<this.m_oGraphe.m_oModele.m_tabSeries.length;n+=this.m_oGraphe.m_oVue.m_oRenderer.nGetPasSerie(this.m_oGraphe.m_oModele.m_tabSeries[n]))u=this.m_oGraphe.m_oModele.m_tabSeries[n].isOnSecondaryAxis()?1:0,r[u]===undefined&&(r[u]=!1),!this.m_oGraphe.m_oVue.bEstSerieMasquee(n)&&this.m_oGraphe.m_oModele.m_tabSeries[n].m_tabValeur.length&&(r[u]=!0);if(r[0]===!1||r[1]===!1){this.m_oGraphe.m_oVue.toggleSerieMasquee(this.m_nIndexSerie);return}for(f=1;f<this.m_oGraphe.m_oVue.m_oRenderer.nGetPasSerie(this.m_oGraphe.m_oModele.m_tabSeries[this.m_nIndexSerie]);++f)this.m_oGraphe.m_oVue.toggleSerieMasquee(this.m_nIndexSerie+f);if(e=this.m_oGraphe.m_oVue,this.m_oGraphe.m_oVue.m_oRenderer.m_params.m_nDureeAnimation!=0)for(e.updateModeleReference(this.m_oGraphe),n=0;n<this.m_oGraphe.m_oModele.m_tabSeries.length;++n){if(i=this.m_oGraphe.m_oModele.m_tabSeries[n],this.m_oGraphe.m_oVue.bEstSerieMasquee(n))t=i.getChartType(),this.m_oGraphe.m_oModele.m_tabSeries[n]=new WDChartSeries(this.m_oGraphe,i,Array.apply(null,new Array(i.m_tabValeur.length+(i.m_nOffset-1))).map(Number.prototype.valueOf,t==WDChartParameters.kHistoEmpile||t==WDChartParameters.kHisto||t==WDChartParameters.kHistoEmpileHorizontal||t==WDChartParameters.kHistoHorizontal||t==WDChartParameters.kWaterfall||t==WDChartParameters.kRadar||t==WDChartParameters.kMinMax||t==WDChartParameters.kBarCharts||t==WDChartParameters.kChandelier?0:i.m_dMinValue+(i.m_dMaxValue-i.m_dMinValue)/2));else if(n>=this.m_nIndexSerie&&n<this.m_nIndexSerie+this.m_oGraphe.m_oVue.m_oRenderer.nGetPasSerie(this.m_oGraphe.m_oModele.m_tabSeries[n]))this.m_oGraphe.m_oModele.m_tabSeries[n]=new WDChartSeries(this.m_oGraphe,i,e.m_oModeleInitialSeries.m_tabSeries[n].m_tabValeur);else continue;this.m_oGraphe.m_oModele.m_tabSeries[n].m_nOffset=1}this.m_oGraphe.m_oModele.createAxis();this.m_oGraphe.m_oVue.onDraw(this.m_oGraphe,WDChartView.ms_nDessinNouvellesDonnees)};WDHeatmapChartLegendListener.prototype=new WDXYChartLegendListener;WDHeatmapChartLegendListener.prototype.constructor=WDHeatmapChartLegendListener;WDHeatmapChartLegendListener.prototype.SurvolLegende=function(n){var f,i,t;if(this.event){var e=this.m_oGraphe.m_oVue.m_oRenderer,r=this.m_oGraphe.m_oVue.m_oPicture,o=e._surbrillancePointeurLegende(r,{x:this.event.pageX,y:this.event.pageY},n),s=r.findFromId(r.m_domBaliseSVG,"serie-line-0"),u=s.find("rect");if(u.attr("fill-opacity",1),n)for(f=this.m_oGraphe.m_oModele.getSeriesAt(2,!1),t=undefined,i=0;i<u.length;++i)t=$(u[i]),f.getValueAt(t.wbData("wbGrfDonneesInfos").i)<o&&t.attr("fill-opacity",.25)}};WDHeatmapChartLegendListener.prototype.mousemove=function(){WDHeatmapChartLegendListener.prototype.mouseenter.apply(this,arguments)};WDHeatmapChartLegendListener.prototype.SelectionneLegende=function(){};WDRadarChartLegendListener.prototype=new WDXYChartLegendListener;WDRadarChartLegendListener.prototype.constructor=WDRadarChartLegendListener;WDRadarChartLegendListener.prototype.SurvolLegende=function(n){WDXYChartLegendListener.prototype.SurvolLegende.apply(this,arguments);var t=this.m_oVue.m_oPicture,i=this.m_domGroupeSerie.parent();t.removeClass(i,"wbGrfHover");n&&t.addClass(i,"wbGrfHover");i.find(".wbGrfHover").each(function(){t.removeClass($(this),"wbGrfHover")});n&&t.addClass(this.m_domGroupeSerie,"wbGrfHover")};WDBarreBoutonOnOffGraphe.prototype=new WDBarreBoutonOnOff;WDBarreBoutonOnOffGraphe.prototype.constructor=WDBarreBoutonOnOffGraphe;WDBarreBoutonOnOffGraphe.prototype.bActif=function(){return this.m_oObjetParent.bActif(this.m_oParamCommande)};WDBarreBoutonGraphe.prototype=new WDBarreBouton;WDBarreBoutonGraphe.prototype.constructor=WDBarreBoutonGraphe;WDBarreBoutonGraphe.prototype.ExecuteCommande=function(n){this.m_oObjetParent.m_oGraphe[this.m_oParamCommande](n)};WDBarreOutilsGraphe.prototype=new WDBarre;WDBarreOutilsGraphe.prototype.constructor=WDBarreOutilsGraphe;WDBarreOutilsGraphe.prototype.ms_tagBoutonClic="img";WDBarreOutilsGraphe.s_pclCreate=function(n,t){return n.m_bInteractif?new WDBurger(n,t):new WDBarreOutilsGraphe(n,t)};WDBarreOutilsGraphe.prototype.ExecuteCommande=function(n,t){this.m_oGraphe.ExecuteCommande(n,t)};WDBarreOutilsGraphe.prototype.OnOption=function(n,t){this.m_oGraphe.OnOption(n,t)};WDBarreOutilsGraphe.prototype.Init=function(){WDBarre.prototype.Init.apply(this,[])};WDBarreOutilsGraphe.prototype._InitBarreAutomatique=function(){var n=this;this.m_fRafBarreTrue=function(t){return n.RafBarre(t||event,!0)};this.m_fRafBarreFalse=function(t){return n.RafBarre(t||event)};this.m_fRafBarreTrueMMove=function(t){return n.RafBarreMMove(t||event)};this.m_oGraphe.m_oHote&&(clWDUtil.AttacheDetacheEvent(!0,this.m_oGraphe.m_oHote,"mouseover",this.m_fRafBarreTrue),clWDUtil.AttacheDetacheEvent(!0,this.m_oGraphe.m_oHote,"mouseout",this.m_fRafBarreFalse),this.m_oBarre&&clWDUtil.AttacheDetacheEvent(!0,this.m_oBarre,"mouseout",this.m_fRafBarreFalse),clWDUtil.AttacheDetacheEvent(!0,this.m_oGraphe.m_oHote,"mousemove",this.m_fRafBarreTrueMMove))};WDBarreOutilsGraphe.prototype.RafBarre=function(n,t){var r=this.m_oGraphe,i;switch(r.m_oParametres?r.m_oParametres.m_eEtat||WDChamp.prototype.ms_eEtatActif:WDChamp.prototype.ms_eEtatActif){case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:t=!1;break;default:case WDChamp.prototype.ms_eEtatActif:this.m_eModeBarre==this.ms_eModeBarreAutomatique&&t===undefined&&(t=!1,n&&(i=null,bIE||(i=n.relatedTarget),i||(i=n.toElement),(clWDUtil.bEstFils(i,this.m_oBarre)||clWDUtil.bEstFils(i,this.m_oHote))&&(t=!0)))}WDBarre.prototype.RafBarre.apply(this,[n,t])};WDBarreOutilsGraphe.prototype.bActif=function(n){return this.m_oGraphe.bActif(n)};WDBarreOutilsGraphe.prototype.RafBarreMMove=function(n){clWDUtil.AttacheDetacheEvent(!1,this.m_oGraphe.m_oHote,"mousemove",this.m_fRafBarreTrueMMove);delete this.m_fRafBarreTrueMMove;this.RafBarre(n,!0)};WDBarreOutilsGraphe.prototype._vLiaisonHTML=function(n,t){n="";t="";WDBarre.prototype._vLiaisonHTML.apply(this,[n,t]);
//! arguments car les params ont \u00e9t\u00e9 modifi\u00e9s   
};WDBarreOutilsGraphe.prototype.bActifOption=function(n,t){return this.m_oGraphe.bActifOption(n,t)};WDBarreOutilsGraphe.prototype._voNewBoutonMenu=function(n,t){for(var r=new Array(t.tabP.length),u=t.tabP.length,i=0;i<u;i++)r[i]={oTD:this.oGetElementByIdBarre(document,t.sSuf+"_"+t.tabP[i]),oParamCommande:[this.m_tabConversionCom[t.sSuf],this.m_tabConversionVal[t.sSuf][i]],sTexte:CHART_TOOLBAR[t.sSuf][i]};return t.nType==this.ms_nBoutonPopupMenu?new WDBarreBoutonPopupMenu(this,n,t.sCom,this.oGetElementByIdBarre(document,t.sSuf+"P"),r):new WDBarreBoutonPopupMenuS(this,n,t.sCom,this.oGetElementByIdBarre(document,t.sSuf+"P"),r)};WDBarreOutilsGraphe.prototype._voNewBoutonMenuS=function(n,t){return this._voNewBoutonMenu(n,t)};WDBarreOutilsGraphe.prototype._voNewBoutonOnOff=function(n,t){return new WDBarreBoutonOnOffGraphe(this,n,t.sCom,t.sSty,t.tabP)};WDBarreOutilsGraphe.prototype._voNewBoutonAction=function(n,t){return new WDBarreBoutonGraphe(this,n,t.sCom,t.tabP)};WDBurger.prototype=new WDBarreOutilsGraphe;WDBurger.prototype.constructor=WDBurger;WDBurger.prototype.Init=function(n){this.m_jqUlMenu||(WDBarreOutilsGraphe.prototype.Init.apply(this,arguments),$(document.getElementById(n.m_sAliasChamp+"_COM")).hide(),this._CreerMenu(),this.m_jqUlMenu.attr("class")!="grfBurgerMenuPosition")&&($(document.forms[0]).append(this.m_jqDivPositionBurger),this._CreerBouton(),this._InitJS())};WDBurger.prototype._InitJS=function(){var n=this,e,o,t,i=$(),r=$(),f,u;n.bAvecHistorique&&window.addEventListener("popstate",function(n){n&&n.state&&n.state.trigger&&$(document).trigger(n.state.trigger,n)});n.m_oGraphe.m_oVue.m_oPicture.m_domBaliseSVG.contextmenu(function(t){n.m_jqBurger.wbData("grfBurgerFade")===1&&(n.m_jqBurger.find("input").prop("checked",!0).trigger("change",{left:nGetPageX(t),top:nGetPageY(t)}),t.stopPropagation(),t.preventDefault())});this.m_jqBurger.find("input").on("change trigger.wb.grf.burger.maj",function(u,f){var c=$(this).parent(),h;if(this.checked){if(t=n.m_oGraphe.m_oVue.m_oRenderer,e=t&&t.getAxisRendererForType?t.getAxisRendererForType(EAxisType.X):undefined,o=t&&t.getAxisRendererForType?t.getAxisRendererForType(EAxisType.Y):undefined,r.length&&r.prop("checked",n.m_oGraphe.m_tabEtat.ZOH),i.length&&i.prop("checked",n.m_oGraphe.m_tabEtat.ZOV),t&&t.__bInitZoom()&&r[0]&&!r[0].idTimer&&i[0]&&!i[0].idTimer&&(i.length&&i.prop("checked")&&o&&n.jqZoomVerticalSaisie&&(n.m_oGraphe.m_tabEtat.ZOV=n.m_oGraphe.m_tabEtat.ZOV||t.m_params.m_oAxeY.m_bOrigineMin||t.m_params.m_oAxeY.m_bOrigineMax,n.m_oGraphe.m_tabEtat.ZVN=t.m_params.m_oAxeY.m_bOrigineMin?(t.m_params.m_oAxeY.m_dOrigineMin-t.m_oOrigineSansZoom.Y.min)/(t.m_oOrigineSansZoom.Y.max-t.m_oOrigineSansZoom.Y.min):0,n.m_oGraphe.m_tabEtat.ZVX=t.m_params.m_oAxeY.m_bOrigineMax?(t.m_params.m_oAxeY.m_dOrigineMax-t.m_oOrigineSansZoom.Y.min)/(t.m_oOrigineSansZoom.Y.max-t.m_oOrigineSansZoom.Y.min):1,n.jqZoomVerticalSaisie.slider("values",[100*n.m_oGraphe.m_tabEtat.ZVN,100*n.m_oGraphe.m_tabEtat.ZVX])),r.length&&r.prop("checked")&&e&&n.jqZoomHorizontalSaisie&&(n.m_oGraphe.m_tabEtat.ZOH=n.m_oGraphe.m_tabEtat.ZOH||t.m_params.m_oAxeX.m_bOrigineMin||t.m_params.m_oAxeX.m_bOrigineMax,n.m_oGraphe.m_tabEtat.ZHN=t.m_params.m_oAxeX.m_bOrigineMin?(t.m_params.m_oAxeX.m_dOrigineMin-t.m_oOrigineSansZoom.X.min)/(t.m_oOrigineSansZoom.X.max-t.m_oOrigineSansZoom.X.min):0,n.m_oGraphe.m_tabEtat.ZHX=t.m_params.m_oAxeX.m_bOrigineMax?(t.m_params.m_oAxeX.m_dOrigineMax-t.m_oOrigineSansZoom.X.min)/(t.m_oOrigineSansZoom.X.max-t.m_oOrigineSansZoom.X.min):1,n.jqZoomHorizontalSaisie.slider("values",[100*n.m_oGraphe.m_tabEtat.ZHN,100*n.m_oGraphe.m_tabEtat.ZHX]))),u.type!=="change")return;n.m_jqUlMenu.find("[data-grfCommande]").each(function(){var t=$(this),f=this.value,i=t.attr("type"),u,r;i=="radio"||i=="checkbox"?(t.prop("checked",!1),f==n.m_oGraphe.bActif([t.attr("data-grfCommande")])&&t.prop("checked",!0)):i=="number"||i=="range"?(u=n.m_oGraphe.bActif([t.attr("data-grfCommande")]),u<2?t.attr("value",!u?t.attr("max"):t.attr("min")):t.attr("value",n.m_oGraphe.bActif([t.attr("data-grfCommande")]))):t.attr("value",n.m_oGraphe.bActif([t.attr("data-grfCommande")]));r=t.siblings(".ui-slider");r&&r.length&&r.data("sliderSansTriggerChanger",1).slider("value",t.attr("value")).removeData("sliderSansTriggerChanger")});h=$(window);n.m_jqDivPositionBurger.css({display:"block"}).removeClass("grfMenuMasque");var w=Math.max(n.m_jqDivPositionBurger[0].clientWidth||0,n.m_jqDivPositionBurger.width()),b=Math.max(n.m_jqDivPositionBurger[0].clientHeight||0,n.m_jqDivPositionBurger.height()),s={marginLeft:"0.5rem",left:f?f.left:c.offset().left+c.width()/2-h.scrollLeft(),top:f?f.top:c.offset().top+c.height()-h.scrollTop()},l=!1;s.left+w>h.width()&&(s.left=(f?h.width():c.offset().left-window.nBordGaucheNavigateur)-w-17,l=!0);s.left<0&&(s.left=0,l=!0);s.top+b>h.height()&&(s.top=h.height()-b-17,l=!0);s.top<0&&(s.top=0,l=!0);n.m_jqDivPositionBurger.css(s);n.bAvecHistorique&&window.history.pushState({trigger:"trigger.wb.grf.burger.ouvre"},document.title);var v=n.m_jqUlMenu.children().css({opacity:0}),a=new clWDUtil.WDDinoCouleur(n.m_jqUlMenu.css("backgroundColor")),y=n.m_jqUlMenu.add(v.first()),d=a.tabGetTSLA()[3];a.SetProp(3,0);y.css({backgroundColor:a.toString()});var k=new clWDUtil.WDBezier(.4,0,.2,1),g=Math.max(n.m_jqDivPositionBurger.children().get(0).clientWidth||0,n.m_jqDivPositionBurger.children().first().width()),nt=Math.max(n.m_jqDivPositionBurger.children().get(0).clientHeight||0,n.m_jqDivPositionBurger.children().first().height()),p=300;v.each(function(n){var t=200,i=(p-t/1.5)*(n/v.length);v.eq(n).delay(i).animate({content:1},{duration:t,queue:"fx",easing:"linear",step:function(n){this.style.opacity=k.dCalcule(n,t)}})});n.m_jqDivPositionBurger.animate({content:1},{duration:p,queue:"fx",easing:"linear",start:function(){},step:function(n){n=k.dCalcule(n,p);l||$(this).css({clip:"rect(-10px "+(g+20)*n+"px "+(nt+20)*n+"px -10px)"});a.SetProp(3,d*100*n);y.css({background:a.toString()})},always:function(){$(this).css({overflow:"",width:"",height:"",clip:""});y.css({background:""})}})}else u.type=="change"&&(n.m_jqDivPositionBurger.addClass("grfMenuMasque").fadeOut(150),n.RafBarre(u))});f=function(t){if(n.m_jqDivPositionBurger.hasClass("grfMenuMasque"))return!1;var r=$(t.target).parents(".grfBurger").parent(),i=r.length?r.get(0)!=n.m_oGraphe.m_oVue.m_oPicture.m_domBaliseSVG.parent().get(0):!1;return i||t.type=="trigger"||t.keyCode==27||!t.keyCode&&$(t.target).parents(".grfBurgerMenuPosition,.grfBurger").length===0?(n.m_jqBurger.find("input").prop("checked",!1).trigger("change"),!i&&n.bAvecHistorique&&window.history.back(),i?!1:!0):!1};$(document).add(n.m_jqUlMenu).add(n.m_jqUlMenu.find("input")).keyup(function(n){f(n)&&n.preventDefault()});$(document).on("click.wb.grf.burger.ferme trigger.wb.grf.burger.ferme",function(n){f(n)&&n.preventDefault()});if(this.m_jqUlMenu.find(".grfTypeAutres>a").first().click(function(){$(this).prev().css("height","").slideToggle()}),this.m_jqUlMenu.find("input").keyup(function(){$(this).trigger("change")}).on("change trigger.wb.grf.burger.zoom.maj",function(t,i){var s=$(this),c=s.attr("type")!="checkbox"?this.value:this.checked?1:0,e,o;this.idTimer!==undefined&&(cancelAnimationFrame(this.idTimer),this.idTimer=undefined);var r=s.attr("data-grfCommande"),f=[[r,c]],l=function(){n.m_oGraphe.OnOption(t,f);cancelAnimationFrame(s[0].idTimer);s[0].idTimer=undefined};if(n.m_oGraphe.m_oVue.m_oRenderer&&(r=="ZOV"||r=="ZOH")){var h=r=="ZOH"?n.jqZoomHorizontalSaisie:n.jqZoomVerticalSaisie,a=r!="ZOH"?n.jqZoomHorizontalSaisie:n.jqZoomVerticalSaisie,u=$(this).prop("checked");r=="ZOH"?n.m_oGraphe.m_oModele.m_oParametres.setHorizontalZoomEnabled(u):n.m_oGraphe.m_oModele.m_oParametres.setVerticalZoomEnabled(u);r=="ZOH"?n.m_oGraphe.m_oVue.m_oRenderer.m_params.setHorizontalZoomEnabled(u):n.m_oGraphe.m_oVue.m_oRenderer.m_params.setVerticalZoomEnabled(u);r=="ZOH"?n.m_oGraphe.m_oParametres.m_bZoomX=u:n.m_oGraphe.m_oParametres.m_bZoomY=u;u||t.type==="change"&&h.slider("values",[0,100]);e=i?i:h.slider("option","values");o=a.slider("option","values");f=[["ZOH",n.jqZoomHorizontalSaisie.parent().prev().find("input").prop("checked")],["ZOV",n.jqZoomVerticalSaisie.parent().prev().find("input").prop("checked")]];f=f.concat(r=="ZOH"?[["ZHN",e[0]/100],["ZHX",e[1]/100]]:[["ZVN",e[0]/100],["ZVX",e[1]/100]]);f=f.concat(r!="ZOH"?[["ZHN",o[0]/100],["ZHX",o[1]/100]]:[["ZVN",o[0]/100],["ZVX",o[1]/100]])}this.idTimer=requestAnimationFrame(l)}).filter("[type=range]").keydown(function(){$(this).attr("type","number")}).focusout(function(){$(this).attr("type","range")}).mousemove(function(){$(this).attr("title",this.value<3?"Transparent":this.value+"%")}),this.m_jqUlMenu.find("[data-grfExec]").click(function(t){var i=$(this);f(i);n.m_oGraphe[i.attr("data-grfExec")]();t.preventDefault()}),$(n.m_oGraphe.m_oHoteImage.parentNode).hover(function(t){n.RafBarre(t,!0)},function(t){n.RafBarre(t,!n.m_jqDivPositionBurger.hasClass("grfMenuMasque")||undefined)}),this.m_bAvecTitreDeplacable&&this.m_jqDivPositionBurger.draggable({handle:"li"}),this.jqSampling&&this.jqSampling.slider({range:"min",min:1,max:200,value:100,slide:function(t,i){this.timer&&cancelAnimationFrame(this.timer);this.timer=requestAnimationFrame(function(){WDLineChartSeriesRenderer.nMaxDrawnValuesCount=i.value*n.m_oGraphe.m_oVue.m_oRenderer.m_rectAxis.getWidth()/100;n.m_oGraphe.relanceInitialisation()})}}),u=$(),this.jqZoomVerticalSaisie){i=n.jqZoomVerticalSaisie.closest(".grfZoom").find("input");this.jqZoomVerticalSaisie[0].fOnSlide=function(n,t){i.prop("checked",!0).trigger("trigger.wb.grf.burger.zoom.maj",[t.values])};this.jqZoomVerticalSaisie.slider({range:!0,min:0,max:100,values:[0,100]}).on("slide",this.jqZoomVerticalSaisie[0].fOnSlide);u=u.add(this.jqZoomVerticalSaisie.children().first())}if(this.jqZoomHorizontalSaisie){r=n.jqZoomHorizontalSaisie.closest(".grfZoom").find("input");this.jqZoomHorizontalSaisie[0].fOnSlide=function(n,t){r.prop("checked",!0).trigger("trigger.wb.grf.burger.zoom.maj",[t.values])};this.jqZoomHorizontalSaisie.slider({range:!0,min:0,max:100,values:[0,100]}).on("slide",this.jqZoomHorizontalSaisie[0].fOnSlide);u=u.add(this.jqZoomHorizontalSaisie.children().first())}u.siblings().css("cursor","ew-resize");u.css("cursor","move").mousedown(function(n){var t=this,i=$(this);if(t==n.target){var r=$(t.parentNode),u=r.width(),f=r.offset().left,e=n,o=$(t.parentNode).slider("option","values"),s=o[0],h=o[1],c=h-s;i.css("background-color","1px solid rgb(66, 129, 244)");n.stopPropagation();n.preventDefault();$(document.body).attr("style",($(document.body).attr("style")||"")+";cursor:move !important");$(window).on("mousemove.wb.grf.burger.zoom",function(n){var o;if(n.stopPropagation(),n.preventDefault(),!(n.pageX<f)&&!(n.pageX>f+u)){var a=n.pageX-e.pageX,l=100*a/u,r=s+l,i=h+l;r<0?(r=0,i=c):i>100&&(i=100,r=i-c);o=[r,i];$(t.parentNode).slider("values",o);t.parentNode.fOnSlide(n,{values:o})}}).one("mouseup.wb.grf.burger.zoom click.wb.grf.burger.zoom",function(n){e&&(n.stopPropagation(),n.preventDefault(),i.css("background-color",""),$(document.body).css("cursor",""),$(window).off("mousemove.wb.grf.burger.zoom"))})}});this.jqOpaciteSaisie&&this.jqOpaciteSaisie.slider({range:"min",min:2,max:100,change:function(){var t=n.jqOpaciteSaisie.next().attr("value",$(this).slider("value"));n.jqOpaciteSaisie.data("sliderSansTriggerChanger")||t.trigger("change")}})};WDBurger.prototype._CreerBouton=function(){this.m_jqBurger=$('<label class="grfBurger" style="transform:scale(0);opacity:0;"><input type="checkbox"/><div><span><\/span><\/div><\/label>');this.m_jqBurger.insertBefore(this.m_oGraphe.m_oHoteImage);this.m_jqBurger.parent().addClass("pr")};WDBurger.prototype.RafBarre=function(n,t,i){var r=this.m_oGraphe;if(i||clWDUtil.bEstDisplay(r.m_oHoteImage.parentNode,document,!0)){switch(r.m_oParametres?r.m_oParametres.m_eEtat||WDChamp.prototype.ms_eEtatActif:WDChamp.prototype.ms_eEtatActif){case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:t=!1;break;default:case WDChamp.prototype.ms_eEtatActif:this.m_eModeBarre==this.ms_eModeBarreAutomatique&&t===undefined&&(bTouch?t=!0:t===undefined&&(t=$(r.m_oHoteImage.parentNode).is(":hover")))}if(this.m_eModeBarre==this.ms_eModeBarreJamais?t=!1:this.m_eModeBarre==this.ms_eModeBarreToujours&&(t=!0),t)this.m_jqBurger&&this.m_jqBurger.wbData("grfBurgerFade")!==1&&this.m_jqBurger.wbData("grfBurgerFade",1).css({transform:"scale(1)",opacity:1});else{this.m_jqBurger&&this.m_jqBurger.wbData("grfBurgerFade")!==0&&this.m_jqBurger.wbData("grfBurgerFade",0).css({transform:"scale(0)",opacity:0});return}}};WDBurger.prototype.RafBarreMMove=function(){};WDBurger.prototype._voNewBoutonMenu=function(){return undefined};WDBurger.prototype._voNewBoutonOnOff=function(){return undefined};WDBurger.prototype._voNewBoutonAction=function(){return undefined};WDBurger.prototype._voNewBoutonMenuS=function(n,t){return this._voNewBoutonMenu(n,t)};WDBurger.prototype._bOptionVisible=function(n){return n=="FULLSCREEN"?this._bOptionVisible("SAV")||this._bOptionVisible("PRI"):!(this.m_tabBoutonsInfo[n]&&this.m_tabBoutonsInfo[n].bVisible===!1)};WDBurger.prototype._CreerMenu=function(){this.m_jqDivPositionBurger=$('<div class="grfBurgerMenuPosition grfMenuMasque" style="display:none;z-index:999;"/>');this.m_bAvecTitreDeplacable&&this.m_jqDivPositionBurger.addClass("grfTitreDeplacable");this.m_jqUlMenu=$('<ul class="grfBurgerMenu"/>');bIEAvec11||bEdge||this.m_jqUlMenu.addClass("grfPlancheSVG");this.m_jqDivPositionBurger.append(this.m_jqUlMenu);this._CreerContenuMenu()};WDBurger.prototype._CreerContenuMenu=function(){this._AjouteTitre();this._AjouteFaaType();this._AjouteFaaQuadrillage();this._AjouteFaaOptions();this._AjouteFaaZoom();this._AjouteFaaSampling();this._AjouteFaaOpacite();this._AjouteFaaLegende();this._AjouteFaaBulle();this._AjouteFaaEnreg()};WDBurger.prototype._AjouteTitre=function(){if(this.m_bAvecTitreDeplacable){var n=this._CreerFaa("grfTitre"),t=$("<h1>"+CHART_TOOLBAR.PARAMS+"<\/h1>");n.append(t);n.css("cursor","move")}};WDBurger.prototype._CreerFaa=function(n){var t=$('<li class="'+n+'"/>');return this.m_jqUlMenu.append(t),t};WDBurger.prototype._ListeTypeGraphe=function(){var r=[{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:0,sClassesCSS:"grfTypeSecteur"},{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:1,sClassesCSS:"grfTypeHemicycle"},{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:2,sClassesCSS:"grfTypeDonut"},{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:4,sClassesCSS:"grfTypeSunburst"},{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:3,sClassesCSS:"grfTypeEntonnoir"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:0,sClassesCSS:"grfTypeHistoGroupe"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:1,sClassesCSS:"grfTypeHistoEmpile"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:2,sClassesCSS:"grfTypeHistoGroupeHoriz"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:3,sClassesCSS:"grfTypeHistoEmpileHoriz"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:4,sClassesCSS:"grfTypeWaterfall"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:0,sClassesCSS:"grfTypeCourbe"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:1,sClassesCSS:"grfTypeNuage"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:2,sClassesCSS:"grfTypeAire"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:3,sClassesCSS:"grfTypeRadar"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:4,sClassesCSS:"grfTypeBulles"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:5,sClassesCSS:"grfTypeHeatMap"},{nIndiceConversionVal:"STO",nSousIndiceConversionVal:0,sClassesCSS:"grfTypeChandelier"},{nIndiceConversionVal:"STO",nSousIndiceConversionVal:1,sClassesCSS:"grfTypeBarChart"},{nIndiceConversionVal:"STO",nSousIndiceConversionVal:2,sClassesCSS:"grfTypeMinMax"}],t,n=[],i=[];for(iGraphe=0;iGraphe<r.length;++iGraphe)oTypeGraphe=r[iGraphe],t||this.m_tabConversionVal[oTypeGraphe.nIndiceConversionVal][oTypeGraphe.nSousIndiceConversionVal]!=this.m_oGraphe.m_oParametres.m_eType?this._bOptionVisible(oTypeGraphe.nIndiceConversionVal)&&(this.m_tabConversionVal[oTypeGraphe.nIndiceConversionVal][oTypeGraphe.nSousIndiceConversionVal]==WDChartParameters.kSecteurMultiniveau||n.push(oTypeGraphe)):(t=oTypeGraphe.nIndiceConversionVal,i.push(oTypeGraphe));for(iGraphe=0;iGraphe<n.length;++iGraphe)oTypeGraphe=n[iGraphe],t==oTypeGraphe.nIndiceConversionVal&&i.push(oTypeGraphe);for(iGraphe=0;iGraphe<n.length;++iGraphe)oTypeGraphe=n[iGraphe],t!=oTypeGraphe.nIndiceConversionVal&&i.push(oTypeGraphe);return i};WDBurger.prototype._AjouteFaaType=function(){var t=this._ListeTypeGraphe(),f,i,n,r,u,e;if(t.length!=0){for(f=this._CreerFaa("grfType"),i=$('<ul class="clearfix"/>'),f.append(i),n=0;n<3&&n<t.length;++n)this._CreerFaaTypeGraphe(i,t[n]);if(!(t.length<=3))for(r=$('<li class="grfTypeAutres clearfix"><\/li>'),i.append(r),u=$('<ul class="clearfix"/>'),r.append(u),e=$("<a><i><\/i><\/a>"),r.append(e),n=3;n<t.length;++n)this._CreerFaaTypeGraphe(u,t[n])}};WDBurger.prototype._CreerFaaTypeGraphe=function(n,t){this.m_jqUlMenu.addClass("grfType"+t.nIndiceConversionVal);n.append($('<li class="'+t.sClassesCSS+" grfType"+t.nIndiceConversionVal+'"><label><input type="radio" name="grfType" value="'+this.m_tabConversionVal[t.nIndiceConversionVal][t.nSousIndiceConversionVal]+'" data-grfCommande="TYP"/><span>'+CHART_TOOLBAR[t.nIndiceConversionVal][t.nSousIndiceConversionVal]+"<\/span><\/label><\/li>"))};WDBurger.prototype._AjouteFaaQuadrillage=function(){if(this._bOptionVisible("GDV")||this._bOptionVisible("GDH")){var t=this._CreerFaa("grfQuadrillage"),n=$('<ul class="clearfix"/>');t.append(n);this._AjouteFaaUnQuadrillage(n,"grfQuadrillageVertical","GDV");this._AjouteFaaUnQuadrillage(n,"grfQuadrillageHorizontal","GDH")}};WDBurger.prototype._AjouteFaaUnQuadrillage=function(n,t,i){this._bOptionVisible(i)&&(this.m_jqUlMenu.addClass(t),n.append($('<li><label class="grfBouton '+t+'"><input type="checkbox" name="'+t+'" data-grfCommande="'+i+'" value="1"><span>'+CHART_TOOLBAR.ALTTEXT[i]+"<\/span><\/label><\/li>")))};WDBurger.prototype._AjouteFaaOpacite=function(){var i,t,n,r;this._bOptionVisible("TRA")&&(i=this._CreerFaa("grfOpacite"),t=$("<ul><li>"+CHART_TOOLBAR.ALTTEXT.TRA+"<\/li><\/ul>"),i.append(t),this.m_jqUlMenu.addClass("grfOpacite"),n=$('<li class="grfSaisie"><\/li>'),this.jqOpaciteSaisie=$('<div class="grfOpaciteSaisie"><\/div>'),r=$('<input type="'+((bIEAvec11||bEdge)?"number":"range")+'" min="2" max="100" name="grfOpaciteSaisie" value="0" data-grfCommande="TRA"><span>%<\/span>'),n.append(this.jqOpaciteSaisie),n.append(r),t.append(n))};WDBurger.prototype._AjouteFaaZoom=function(){this.m_oGraphe.m_oParametres.m_bEchelleTemporelle||(this._AjouteFaaZoomHorizontal(),this._AjouteFaaZoomVertical())};WDBurger.prototype._AjouteFaaZoomHorizontal=function(){var i=this._CreerFaa("grfZoomHorizontal").addClass("grfZoom"),t=$("<ul><\/ul>"),r=$('<li><label class="grfBouton grfZoomHorizontal"><input type="checkbox" name="grfZoomHorizontal" data-grfCommande="ZOH" value="1"><span>'+CHART_TOOLBAR.ALTTEXT.ZOH+"<\/span><\/label><\/li>"),n;t.append(r);i.append(t);this.m_jqUlMenu.addClass("grfZoom");n=$('<li class="grfSaisie"><\/li>');this.jqZoomHorizontalSaisie=$('<div class="grfZoomHorizontalSaisie"><\/div>');n.append(this.jqZoomHorizontalSaisie);bTouch&&n.css("display","none");t.append(n)};WDBurger.prototype._AjouteFaaZoomVertical=function(){var i=this._CreerFaa("grfZoomVertical").addClass("grfZoom"),t=$("<ul><\/ul>"),r=$('<li><label class="grfBouton grfZoomVertical"><input type="checkbox" name="grfZoomVertical" data-grfCommande="ZOV" value="1"><span>'+CHART_TOOLBAR.ALTTEXT.ZOV+"<\/span><\/label><\/li>"),n;t.append(r);i.append(t);this.m_jqUlMenu.addClass("grfZoom");n=$('<li class="grfSaisie"><\/li>');this.jqZoomVerticalSaisie=$('<div class="grfZoomVerticalSaisie"><\/div>');n.append(this.jqZoomVerticalSaisie);bTouch&&n.css("display","none");t.append(n)};WDBurger.prototype._AjouteFaaSampling=function(){};WDBurger.prototype._AjouteFaaOptions=function(){for(var t=[{sClassesCSS:"grfOptionDegrade",sAlt:"GRA"},{sClassesCSS:"grfOptionLissage",sAlt:"SMO"},{sClassesCSS:"grfOptionRelief",sAlt:"RAI",bNonSupporteInteractif:!0},{sClassesCSS:"grfOptionAntiAliasing",sAlt:"ANT"},{sClassesCSS:"grfOptionInteractif",sAlt:"INT",bNonSupporteInteractif:!0},{sClassesCSS:"grfOptionAnimation",sAlt:"ANI"}],n=0,r=!1,i,n=0;n<t.length;++n)if((!this.m_bRetireOptionsNonSupporteesEnInteractif||!t[n].bNonSupporteInteractif)&&this._bOptionVisible(t[n].sAlt)){r=!0;break}if(r)for(i=this._CreerFaa("grfOptions"),i.addClass("clearfix"),n=0;n<t.length;++n)this.m_bRetireOptionsNonSupporteesEnInteractif&&t[n].bNonSupporteInteractif||this._AjouteFaaUneOption(i,t[n].sClassesCSS,t[n].sAlt)};WDBurger.prototype._AjouteFaaUneOption=function(n,t,i){this.m_jqUlMenu.addClass(t);n.append($('<label class="'+t+' grfBouton"><input type="checkbox" data-grfCommande="'+i+'" value="1"><span>'+CHART_TOOLBAR.ALTTEXT[i]+"<\/span><\/label>"))};WDBurger.prototype._AjouteFaaBulle=function(){var i,t,n;this._bOptionVisible("MIR")&&(i=this._CreerFaa("grfBulle"),t=$('<ul class="clearfix"><li>'+CHART_TOOLBAR.MIR[2]+"<\/li><\/ul>"),i.append(t),n=$("<li/>"),t.append(n),this.m_jqUlMenu.addClass("grfBulle"),this._AjouteFaaUneBulle(n,"grfSansBulle",CHART_TOOLBAR.LEG[0],-1),this._AjouteFaaUneBulle(n,"grfBulleSimple",CHART_TOOLBAR.MIR[2],2),this._AjouteFaaUneBulle(n,"grfMire",CHART_TOOLBAR.MIR[1],1),this._AjouteFaaUneBulle(n,"grfMireMultiple",CHART_TOOLBAR.MIR[0],0))};WDBurger.prototype._AjouteFaaUneBulle=function(n,t,i,r){n.append($('<label class="'+t+'" title="'+i+'"><input type="radio" name="grfBulle" data-grfCommande="MIR" value="'+r+'"><span>'+i+"<\/span><\/label>"))};WDBurger.prototype._AjouteFaaLegende=function(){var i,t,n;this._bOptionVisible("LEG")&&(i=this._CreerFaa("grfLegende"),t=$('<ul class="clearfix"><li>'+CHART_TOOLBAR.ALTTEXT.LEG+"<\/li><\/ul>"),i.append(t),n=$("<li/>"),t.append(n),this._AjouteFaaUneLegende(n,"grfLegendeAucune",CHART_TOOLBAR.LEG[0],0),this._AjouteFaaUneLegende(n,"grfLegendeDroite",CHART_TOOLBAR.LEG[1],1),this._AjouteFaaUneLegende(n,"grfLegendeGauche",CHART_TOOLBAR.LEG[2],2),this._AjouteFaaUneLegende(n,"grfLegendeHaut",CHART_TOOLBAR.LEG[3],3),this._AjouteFaaUneLegende(n,"grfLegendeBas",CHART_TOOLBAR.LEG[4],4))};WDBurger.prototype._AjouteFaaUneLegende=function(n,t,i,r){this.m_jqUlMenu.addClass(t);n.append($('<label class="'+t+'" title="'+i+'"><input type="radio" name="grfLegende" data-grfCommande="LEG" value="'+r+'"><span>'+i+"<\/span><\/label>"))};WDBurger.prototype._AjouteFaaEnreg=function(){function f(n){return n.requestFullscreen?n.requestFullscreen:n.mozRequestFullScreen?n.mozRequestFullScreen:n.webkitRequestFullscreen?n.webkitRequestFullscreen:n.msRequestFullscreen?n.msRequestFullscreen:undefined}function o(n){f(n).apply(n,[])}function s(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}function h(){return document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled}function e(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}var n,t,i,r,u;if(this._bOptionVisible("FULLSCREEN")){n=this;t=this._CreerFaa("grfEnreg");i=$('<button type="button" title="'+CHART_TOOLBAR.ALTTEXT.FUS+'"><svg style="width: 1.15rem;height: 1.15rem;" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M4.5 11H3v4h4v-1.5H4.5V11zM3 7h1.5V4.5H7V3H3v4zm10.5 6.5H11V15h4v-4h-1.5v2.5zM11 3v1.5h2.5V7H15V3h-4z"/><\/svg><\/button>');h()&&f(document.documentElement)&&t.append(i);r=function(){var t,r;WDBurger.oInstanceEncoursFullscreen==n&&(n.m_jqBurger.find("input").prop("checked",!1).trigger("change"),e()?(n.m_jqBurger.addClass("grfFullScreenBurger"),i.addClass("wbActif"),t=n.m_oGraphe.m_oVue.m_oPicture.m_domBaliseSVG.closest("table"),n.m_oGraphe.m_oVue.m_oPicture.addClass(t,"grfFullScreen"),clWDUtil.__OnScrollResize(undefined,!1),$(document.documentElement).addClass("grfFullScreenHTML"),r=function(){var n=$(this);(n.css("transform")!="none"||n.css("will-change")!="auto"&&n.css("overflow")!="visible")&&n.addClass("grfFullScreenT0")},$(t.parents()).each(r),setTimeout(function(){$(window).trigger("resize")},350)):(n.m_jqBurger.removeClass("grfFullScreenBurger"),i.removeClass("wbActif"),clWDUtil.__OnScrollResize(undefined,!1),n.m_oGraphe.m_oVue.m_oPicture.removeClass(n.m_oGraphe.m_oVue.m_oPicture.m_domBaliseSVG.closest("table"),"grfFullScreen"),$(document.documentElement).removeClass("grfFullScreenHTML"),$(document.getElementsByClassName("grfFullScreenT0")).removeClass("grfFullScreenT0")),$(document.body).animate({opacity:1}))};$(document.documentElement).on("webkitfullscreenchange fullscreenchange",r);$(document).on("mozfullscreenchange",r);document.addEventListener("MSFullscreenChange",r);i.click(function(t){$(document.body).css({opacity:0});var i=this;WDBurger.oInstanceEncoursFullscreen=n;e()?s():o(document.documentElement);t.preventDefault();t.stopPropagation()});u=$('<button type="button">'+TDB_MENU.EDITION.sLibelle+"<\/button>");t.append(u);u.click(function(t){var i=this,l,o,v;if($(this).toggleClass("wbActif"),this.bModeEdition=!this.bModeEdition,l=this.bModeEdition,!l)i.jqTous.fadeOut();else if(i.jqTous)i.jqTous.fadeIn();else{var y=$(document.getElementById(n.m_oGraphe.m_sAliasChamp+"-legende-groupe")),f=$(document.getElementById(n.m_oGraphe.m_sAliasChamp+"-titre")),p=$(document.getElementById(n.m_oGraphe.m_sAliasChamp+"-series-axis-grids-groupe")),e=$(document.getElementById(n.m_oGraphe.m_sAliasChamp+"-clip-legende-rect")),u=p.parents("svg"),r=u.offset(),c=u.parent();c.css("position","relative");o=function(){var t=i.jqTrackerLegende,f=i.jqTrackerTitre,e=i.jqTrackerGraphe;r=u.offset();n.m_oGraphe.m_oParametres.m_oPositionnementManuel={m_oLegende:new WDRect(t.offset().left,t.offset().top,t.offset().left+t.width(),t.offset().top+t.height()),m_oGraphe:new WDRect(e.offset().left,e.offset().top,e.offset().left+e.width(),e.offset().top+e.height()),m_oTitre:new WDRect(f.offset().left,f.offset().top,f.offset().left+f.width(),f.offset().top+f.height())};n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oLegende.offset(-r.left,-r.top);n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.offset(-r.left,-r.top);n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oTitre.offset(-r.left,-r.top);n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.m_nRight=u.width()-n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.m_nRight;n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.m_nBottom=u.height()-n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.m_nBottom;n.m_oGraphe.m_oParametres.m_ePosLegende=t.children(".grfFermer").hasClass("grfMasque")?IWDChartConstant.FLAG_LEGEND_POSITION_NONE:IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL;n.m_oGraphe.m_oParametres.m_ePosTitre=f.children(".grfFermer").hasClass("grfMasque")?IWDChartConstant.FLAG_TITLE_POSITION_NONE:IWDChartConstant.FLAG_TITLE_POSITION_MANUAL;n.m_oGraphe.relanceInitialisation()};i.jqTrackerGraphe=$('<div class="grfTracker grfTrackerGraphe"><\/div>');i.jqTrackerGraphe.css({top:n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart.m_nTop,left:n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart.m_nLeft,width:n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart.getWidth(),height:n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart.getHeight()});var s=n.m_oGraphe.m_oParametres.m_ePosLegende==IWDChartConstant.FLAG_LEGEND_POSITION_NONE,h=n.m_oGraphe.m_oParametres.m_ePosTitre==IWDChartConstant.FLAG_TITLE_POSITION_NONE,a=s||h;a&&(s&&(n.m_oGraphe.m_oParametres.m_ePosLegende=IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT),h&&(n.m_oGraphe.m_oParametres.m_ePosTitre=IWDChartConstant.FLAG_TITLE_POSITION_TOP),n.m_oGraphe.relanceInitialisation(),s&&(n.m_oGraphe.m_oParametres.m_ePosLegende=IWDChartConstant.FLAG_LEGEND_POSITION_NONE,y=$(document.getElementById(n.m_oGraphe.m_sAliasChamp+"-legende-groupe")),e=$(document.getElementById(n.m_oGraphe.m_sAliasChamp+"-clip-legende-rect"))),h&&(n.m_oGraphe.m_oParametres.m_ePosTitre=IWDChartConstant.FLAG_TITLE_POSITION_NONE,f=$(document.getElementById(n.m_oGraphe.m_sAliasChamp+"-titre"))));i.jqTrackerLegende=$('<div class="grfTracker grfTrackerLegende"><a class="grfFermer'+(s?" grfMasque":"")+'"><\/a><\/div>');i.jqTrackerTitre=$('<div class="grfTracker grfTrackerTitre"><a class="grfFermer'+(h?" grfMasque":"")+'"><\/a><\/div>');i.jqTrackerLegende.css({top:parseInt10(e.attr("y")),left:parseInt10(e.attr("x")),width:parseInt10(e.attr("width")),height:parseInt10(e.attr("height"))});v=f.wbData("wbGrfCacheDrawText");i.jqTrackerTitre.css({top:parseInt10(v[2]),left:parseInt10(f.offset().left-r.left),width:f[0].getBoundingClientRect().width,height:f[0].getBoundingClientRect().height});a&&n.m_oGraphe.relanceInitialisation();i.jqTous=i.jqTrackerGraphe.add(i.jqTrackerTitre).add(i.jqTrackerLegende);i.jqTous.children("a").click(function(){$(this).toggleClass("grfMasque");o()});i.jqTous.resizable({containment:c,stop:o,handles:"all"}).draggable({containment:c,stop:o}).css("position","absolute").insertAfter(u)}n.m_jqBurger.find("input").prop("checked",!1).trigger("change");t.preventDefault()});this._bOptionVisible("SAV")&&(t.append($('<button type="button" class="grfEnregSAV" data-grfExec="OnSave">'+CHART_TOOLBAR.ALTTEXT.SAV+"<\/button>")),this.m_jqUlMenu.addClass("grfEnregSAV"));this._bOptionVisible("PRI")&&(t.append($('<button type="button" class="grfEnregPRI" data-grfExec="OnPrint">'+CHART_TOOLBAR.ALTTEXT.PRI+"<\/button>")),this.m_jqUlMenu.addClass("grfEnregPRI"))}};WDChartAxisRenderer.prototype.constructor=WDChartAxisRenderer;WDChartAxisRenderer.prototype.getAxisSize=function(n){return this.m_axis.getAxisSize(n)};WDChartAxisRenderer.getAxisStep=WDChartAxisRenderer.prototype.getAxisStep=function(n,t,i,r){if(n==0)return 1;var f=Math.ceil(Math.log10(t/(5*n))),u=Math.pow(10,f);if(u*n<=t&&(u=2*u*n>t?2*u:5*u*n>t?5*u:10*u),i)switch(r){case ETimeScale.DATE:u=Math.max(864e5,WDMathUtils.roundToMultiple(u,864e5));break;case ETimeScale.DATETIME:case ETimeScale.TIME:u=Math.max(36e5,WDMathUtils.roundToMultiple(u,36e5));break;case ETimeScale.DUREE:case ETimeScale.NONE:default:u=Math.ceil(u)}return u};WDChartAxisRenderer.prototype.getNbGraduations=function(){return this.m_nNbPositiveGraduations+this.m_nNbNegativeGraduations};WDChartAxisRenderer.prototype.getGraduationSize=function(n){var t=this.getNbGraduations();return t<=1?n:n/(t-1)};WDChartAxisRenderer.prototype.prepare=function(n,t,i,r,u){var nt,ot,w,tt,st,ct,f,it,b,at,e,pt,s,dt,lt,gt,ft;if(this.m_axis=n,this.m_axis.m_type!==EAxisType.Z){var et=this.getAxisSize(i),d=0,g=0;u!=ETimeScale.NONE?(nt=n.m_oModele.m_oCategories,nt.getNbValues()>0&&(d=nt.getMinValueInMillis(),g=nt.getMaxValueInMillis())):(d=this.m_axis.m_dMinValue,g=this.m_axis.m_dMaxValue);ot=0;ot=this.m_axis.isXAxis()?t.getAxisLabelOrientation(this.m_axis)==WDChartParameters.eOrientationVerticale?IWDChartConstant.GRADUATION_MIN_SIZE_X_VERTICAL:IWDChartConstant.GRADUATION_MIN_SIZE_X_HORIZONTAL:IWDChartConstant.GRADUATION_MIN_SIZE_Y;w=0;tt=g-d;tt>0&&(w=et/tt);this.m_dStep=t.getAxisStep(this.m_axis);st=this.m_axis.isDisplayDecimalValues(t);(this.m_dStep==IWDChartConstant.DEFAULT_VALUE||u!=ETimeScale.NONE)&&(this.m_dStep=this.getAxisStep(w,ot,!st,u));var h=0,c=0,l=0,ht=this.isDrawLabelsBetweenGraduations();if(this.m_dStep!=0?(c=Math.floor(d/this.m_dStep)*this.m_dStep,l=Math.ceil(g/this.m_dStep)*this.m_dStep,this.m_axis.m_oModele.m_oGraphe.m_oVue.m_oRenderer.m_dRayonMaxBulle>0&&(ct=Math.ceil(this.m_axis.m_oModele.m_oGraphe.m_oVue.m_oRenderer.m_dRayonMaxBulle/(w==0?1:w)),l+=ct),c<0?(this.m_axis.m_oModele.m_oGraphe.m_oVue.m_oRenderer.m_dRayonMaxBulle>0&&(c-=ct),l<0&&-1===this.m_chartRenderer.m_oGraphe.m_oModele.convertSeriesIndexTypeToModel(0,WDChartParameters.kWaterfall)?(this.m_nNbNegativeGraduations=Math.ceil((l-c)/this.m_dStep)+1,this.m_nNbPositiveGraduations=0,this.m_axis.m_dOriginValue=l):(this.m_nNbNegativeGraduations=Math.abs(c)/this.m_dStep,this.m_nNbPositiveGraduations=l>=0?Math.ceil(l/this.m_dStep)+1:1,this.m_axis.m_dOriginValue=0)):(this.m_nNbNegativeGraduations=0,this.m_nNbPositiveGraduations=Math.ceil((l-c)/this.m_dStep)+1,this.m_axis.m_dOriginValue=c),ht&&this.isDrawnZero()&&this.m_nNbPositiveGraduations++):(this.m_nNbNegativeGraduations=this.m_nNbPositiveGraduations=0,this.m_axis.m_dOriginValue=0),h=this.getNbGraduations(),this.m_tabGraduationLabels=[],f=0,this.m_axis.isDisplayCategories()){b=this.m_axis.m_oModele;switch(u){case ETimeScale.DUREE:at=new Date(0);case ETimeScale.DATE:case ETimeScale.TIME:case ETimeScale.DATETIME:it=b.getCategoryIndexForTime(Math.floor(this.m_axis.m_dOriginValue));var vt=b.m_oCategories.getMinValueInMillis(),ni=b.m_oCategories.getMaxValueInMillis(),ti=ni-vt,yt=ti>864e5;for(f=0;f<h;++f)e=new Date,e.setTime(vt+(f*this.m_dStep+it)),e.setTime(e.getTimezoneOffset()*6e4+e.getTime()),u==ETimeScale.TIME?this.m_tabGraduationLabels[f]=t.m_sMasqueAxeTemporel!=""||!e.toLocaleTimeString?clWDUtil.sHeureVersChaine(clWDUtil.sGetDateHeureWL(e,!1,!1,!0),t.m_sMasqueAxeTemporel||"HH:MM:SS:CC"):e.toLocaleTimeString():u==ETimeScale.DATE?this.m_tabGraduationLabels[f]=t.m_sMasqueAxeTemporel!=""||!e.toLocaleDateString?clWDUtil.sDateVersChaine(clWDUtil.sGetDateHeureWL(e,!1,!0,!1),t.m_sMasqueAxeTemporel||"DD/MM/YYYY"):e.toLocaleDateString():u==ETimeScale.DATETIME?this.m_tabGraduationLabels[f]=t.m_sMasqueAxeTemporel!=""||!e.toLocaleTimeString?clWDUtil.sDateVersChaine(clWDUtil.sGetDateHeureWL(e,!1,!0,!0),t.m_sMasqueAxeTemporel||(yt?"DD/MM/YYYY HH:MM:SS:CC":"HH:MM:SS:CC")):yt?e.toLocaleDateString()+" "+e.toLocaleTimeString():e.toLocaleTimeString():u==ETimeScale.DUREE&&(pt=e-at,this.m_tabGraduationLabels[f]=(window.NSPCS&&NSPCS.NSOperations?NSPCS.NSOperations.sDureeVersChaine:clWLangage.sDureeVersChaine)(pt,t.m_sMasqueAxeTemporel||"JHHMMSSLLL"));break;default:case ETimeScale.NONE:for(it=Math.floor(this.m_axis.m_dOriginValue),f=0;f<h;++f)this.m_tabGraduationLabels[f]=b.getCategoryLabelAt(f*this.m_dStep+it)}}else{var wt=this.m_axis.hasMasqueAxeY()?t.m_sMasqueAxes:undefined,v=c,k=this.m_axis.isXAxis()?t.m_tabHmLibelleX:t.m_tabHmLibelleY;for(f=0;f<h;++f)this.m_tabGraduationLabels[f]=k&&(k[f]||k[f+"."])?k[f]||k[f+"."]:wt?WDChartUtils.formatValue(v,wt,st):v,v+=this.m_dStep,v.toPrecision&&(v=parseFloat(v.toPrecision(10),10))}if(h<=0){this.m_dTopOverflow=this.m_dLeftOverflow=this.m_dRightOverflow=this.m_dBottomOverflow=0;return}var y=[],bt=WDPaintCSS.oGetInfoCSS(t.m_sClasseLibelle,"0",["lineHeight","width"]),p=parseInt10(bt.lineHeight),a=0,rt=0,ii=bt.width,ut=[],kt=[],o=0;for(f=0;f<h;++f)s=this.m_tabGraduationLabels[f],s===undefined&&(s=""),o=0,(s||s===0)&&!isNaN(parseInt10(s))?o=ii*(""+s).length:clWDUtil.bEstChaineNonVide(s)&&(ut.push(s),kt.push(f)),o>a&&(a=o),y[f]=o,f>0&&(rt+=IWDChartConstant.MARGIN_HORIZONTAL_GRADUATION_LABEL),rt+=o;if(ut.length)for(dt=WDPaintCSS.oGetInfoCSS.apply(undefined,[t.m_sClasseLibelle,ut,"width"]),f=0;f<ut.length;++f)o=dt[f].width,rt+=o,y[kt[f]]=o,o>a&&(a=o);lt=t.getAxisLabelOrientation(this.m_axis);lt==WDChartParameters.eOrientationDefaut?this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL?(gt=this.getGraduationSize(et),this.m_bVerticalOrientationLabel=a+a/10>gt||rt>et):this.m_bVerticalOrientationLabel=!1:this.m_bVerticalOrientationLabel=lt==WDChartParameters.eOrientationVerticale;t.isAxisVisible(this.m_axis)?this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL&&this.m_tabGraduationLabels.join("").length>0?(this.m_dLeftOverflow=this.m_bVerticalOrientationLabel?p/2:y[0]/2,this.m_dRightOverflow=this.m_bVerticalOrientationLabel?p/2:y[Math.max(0,h-(ht?2:1))]/2,this.m_dBottomOverflow=this.m_bVerticalOrientationLabel?a:p,this.m_dBottomOverflow+=IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,this.m_dTopOverflow=0,this.m_axis.isSecondaryAxis()&&(ft=this.m_dBottomOverflow,this.m_dBottomOverflow=this.m_dTopOverflow,this.m_dTopOverflow=ft)):this.m_axis.m_orientation==EAxisOrientation.VERTICAL&&(this.m_dTopOverflow=this.m_bVerticalOrientationLabel?y[Math.max(0,h-(ht?2:1))]/2:p/2,this.m_dBottomOverflow=this.m_bVerticalOrientationLabel?y[0]/2:p/2,this.m_dLeftOverflow=this.m_bVerticalOrientationLabel?p:a,this.m_dBottomOverflow+=IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,this.m_dRightOverflow=0,this.m_axis.isSecondaryAxis()&&(ft=this.m_dLeftOverflow,this.m_dLeftOverflow=this.m_dRightOverflow,this.m_dRightOverflow=ft)):this.m_dTopOverflow=this.m_dLeftOverflow=this.m_dRightOverflow=this.m_dBottomOverflow=0}};WDChartAxisRenderer.prototype.getPixelsPerUnit=function(n){return this.m_dStep==0?0:this.getGraduationSize(this.getAxisSize(n))/this.m_dStep};WDChartAxisRenderer.prototype.draw=function(n,t,i,r,u,f,e,o){var c=0,nt,tt,s,h,it,rt,vt,yt,k,lt,kt,w,b,d,l,ut,ht,y,at,p;if(this.m_axis){nt=Align.LEFT;tt=i.getAxisTitle(this.m_axis).replace(/\n/g,"");tt&&(it=WDPaintCSS.oGetInfoCSS(i.m_sClasseAxe,tt,"lineHeight"),rt=parseInt10(it.lineHeight),this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL?(s=u.getLeft()+u.getWidth()/2,nt=Align.CENTER,h=this.m_axis.isSecondaryAxis()?r.getTop():r.getBottom()-rt,vt=n.text(t,"axe-titre-horiz"+(this.m_axis.isSecondaryAxis()?"-2":"")),o.addClasse(i.m_sClasseAxe),n.drawText(vt,tt,rt,s,h,nt,o,!1)):(h=u.getTop()+u.getHeight()/2,nt=Align.CENTER,s=this.m_axis.isSecondaryAxis()?r.getRight()-rt:r.getLeft(),yt=n.text(t,"axe-titre-vert"+(this.m_axis.isSecondaryAxis()?"-2":"")),o.addClasse(i.m_sClasseAxe),n.drawTextVertically(yt,tt,rt,s,h,nt,o,!1)));var et=i.m_sCouleurAxe,ct=this.getNbGraduations(),ot=this.getAxisSize(u),pt=this.isDrawLabelsBetweenGraduations(),wt=ct,it=WDPaintCSS.oGetInfoCSS(i.m_sClasseLibelle,"Ap",["lineHeight","fontSize"]),a=parseInt10(it.lineHeight),dt=parseInt10(it.fontSize);if(this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL){var s=u.getLeft(),v=this.getGraduationSize(ot),h=this.m_axis.isSecondaryAxis()?u.getTop():i.isBoursierChart()?u.getBottom():e;for(this.isDrawnAxisLine()&&(b=n.line(t,"axe-horiz"+(this.m_axis.isSecondaryAxis()?"-2":"")),o.setStroke(et),n.SetAntiAliasing(!1,b),n.drawLine(b,s,h,s+ot,h,o,!1)),k=s,c=0;c<ct;++c){if(!i.m_bAutoriseChevauchementEtiquettes&&c>0&&Math.abs(s-k)<=5+a){s+=v;continue}k=s;d=n.line(t,"axe-graduation-horiz-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c);o.setStroke(et);n.SetAntiAliasing(!1,d);n.drawLine(d,s,h,s,h-IWDChartConstant.GRADUATION_TICK_SIZE,o,!1);s+=v}s=u.getLeft();k=s;var bt=this.m_axis.m_dMinValue,g=bt-this.m_dStep,st=!1;for(c=0;c<wt;++c){if(g+=this.m_dStep,!i.m_bAutoriseChevauchementEtiquettes&&st&&Math.abs(s-k)<=5+a){s+=v;continue}if(g!=0||this.isDrawnZero())if(l=this.m_tabGraduationLabels[c],l=l===undefined?"":""+l,ut=a*l.split("\n").length,isNaN(parseInt10(l))&&!clWDUtil.bEstChaineNonVide(l)){s+=v;continue}else{if(k=s,st=!0,y=s,pt&&(y+=v/2),y-u.m_nRight>VALEUR_EPSILON)break;this.m_bVerticalOrientationLabel?(w=0,this.m_axis.isSecondaryAxis()?(lt=a,l.length>1&&(kt=WDPaintCSS.oGetInfoCSS(i.m_sClasseLibelle,l.replace(/\n/g,"<br>"),"width"),lt=parseInt10(kt.width)),w=-(IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL+lt)):w=IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,p=n.text(t,"axe-horiz-label-vert-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c),o.addClasse(i.m_sClasseLibelle),o.DesactivePointerEvents(),n.drawTextVertically(p,l,a,y-ut/2,h+w,Align.RIGHT,o,!1,a-dt)):(w=0,w=this.m_axis.isSecondaryAxis()?-(IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL+a):IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,p=n.text(t,"axe-horiz-label-horiz-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c),o.addClasse(i.m_sClasseLibelle),o.DesactivePointerEvents(),n.drawText(p,l,a,y,h+w,Align.CENTER,o,!1));p.wbData("wbGrfGraduationValeur",g);s+=v}}}else{var h=u.getBottom(),v=this.getGraduationSize(ot),s=this.m_axis.isSecondaryAxis()?u.getRight():f;this.isDrawnAxisLine()&&(b=n.line(t,"axe-vert"+(this.m_axis.isSecondaryAxis()?"-2":"")),o.setStroke(et),n.SetAntiAliasing(!1,b),n.drawLine(b,s,h,s,h-ot,o,!1));var it=WDPaintCSS.oGetInfoCSS(i.m_sClasseLibelle,"0","lineHeight"),a=parseInt10(it.lineHeight),ft=h;for(c=0;c<ct;++c){if(!i.m_bAutoriseChevauchementEtiquettes&&c>0&&Math.abs(h-ft)<=5+a){h-=v;continue}ft=h;d=n.line(t,"axe-graduation-vert-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c);o.setStroke(et);n.SetAntiAliasing(!1,d);n.drawLine(d,s,h,s+IWDChartConstant.GRADUATION_TICK_SIZE,h,o,!1);h-=v}h=u.getBottom();ft=h;var bt=this.m_axis.m_dMinValue,g=bt-this.m_dStep,st=!1;for(c=0;c<wt;++c){if(g+=this.m_dStep,!i.m_bAutoriseChevauchementEtiquettes&&st&&Math.abs(h-ft)<=5+a){h-=v;continue}(g!=0||this.isDrawnZero())&&(ft=h,st=!0,l=this.m_tabGraduationLabels[c],l=l===undefined?"":""+l,ut=a*l.split("\n").length,isNaN(parseInt10(l))&&!clWDUtil.bEstChaineNonVide(l)||(ht=h,y=0,pt&&(ht-=v/2),this.m_bVerticalOrientationLabel?(y=this.m_axis.isSecondaryAxis()?s+IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL:s-ut-IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,p=n.text(t,"axe-vert-label-vert-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c),o.addClasse(i.m_sClasseLibelle),o.DesactivePointerEvents(),n.drawTextVertically(p,l,a,y,ht,Align.CENTER,o,!1)):(this.m_axis.isSecondaryAxis()?(at=Align.LEFT,y=s+IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL):(at=Align.RIGHT,y=s-IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL),p=n.text(t,"axe-vert-label-horiz-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c),o.addClasse(i.m_sClasseLibelle),o.DesactivePointerEvents(),n.drawText(p,l,a,y,ht-ut/2,at,o,!1)),p.wbData("wbGrfGraduationValeur",g),h-=v))}}}};WDChartAxisRenderer.prototype.isDrawnZero=function(){return!0};WDChartAxisRenderer.prototype.isDrawnAxisLine=function(){return!0};WDFunnelChartRenderer.nGetIndicePart=function(n,t){return WDPieChartRenderer.nGetIndicePart(n,t)};WDFunnelChartRenderer.bParametresSupportes=function(n,t){return WDChartRenderer.bParametresSupportes(n,t)?!0:!1};WDFunnelChartRenderer.prototype=new WDChartRenderer;WDFunnelChartRenderer.prototype.constructor=WDFunnelChartRenderer;WDFunnelChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r){var e,u,f;if(i||r===!0)for(e=t,u=0;u<this.m_oGraphe.m_oModele.m_tabSeries[0].m_tabValeur.length;++u)f=Array.prototype.slice.call(arguments,0),f[1]=u,f[2]=e==u?i:!1,WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,f);else WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments)};WDFunnelChartRenderer.prototype.Init=function(){WDChartRenderer.prototype.Init.apply(this,arguments)};WDFunnelChartRenderer.prototype.ecouteLegende=function(n){return WDChartListener.bind(WDPieChartLegendListener,this.m_oGraphe,n)};WDFunnelChartRenderer.eEntonnoirHauteur=0;WDFunnelChartRenderer.eEntonnoirAire=1;WDFunnelChartRenderer.FACTEUR_COURBURE_3D=15;WDFunnelChartRenderer.STInfoPortion=function(){this.m_dY=0;this.m_dHauteurBoutTraverse=0;this.m_dHauteurBoutDroit=0;this.m_dLargeurBase1=0;this.m_dLargeurBase2=0;this.m_dAire=0;this.m_dValeur=0;this.m_nNumCategorie=0};WDFunnelChartRenderer.STInfoPortion.prototype.constructor=WDFunnelChartRenderer.STInfoPortion;WDFunnelChartRenderer.prototype.drawChart=function(n,t,i){var r,u,e,f;if((WDChartRenderer.prototype.drawChart.apply(this,arguments),this.m_rectChart=t.tweenRectChart(i,this.m_rectChart),r=n.g(i,"groupe-serie-0"),this.m_rectChart.getWidth()!=0&&this.m_rectChart.getHeight()!=0)&&(this.bGetPremiereValeurNonDessinee()&&(this.m_params.m_bPremiereValeurNonDessinee=!1,u=n.findFromId(n.m_domBaliseSVG,"legende-groupe-0"),e=n.arc(r,"part-0"),u&&u.clearQueue().finish().css("opacity",.5).find("text").css("text-decoration","line-through"),this.m_oGraphe.m_oVue.setSerieMasquee(0,!1),f=new WDPieChartAnimationSelectionLegende(this.m_oGraphe,n,e,u),f.m_dNow=1,this.m_oGraphe.m_oVue.m_oAnimator.add(f,!1,!0)),this.__bCalculeVariables(n,t,r))&&this.__bCalculeAireDonnees(n,t,r)){switch(this.eGetAlgoEntonnoir()){case WDFunnelChartRenderer.eEntonnoirHauteur:if(!this.__bCalculePortions_Hauteur())return;break;case WDFunnelChartRenderer.eEntonnoirAire:if(!this.__bCalculePortions_Aire())return}!this.__bDessinePortions(n,t,r)}};WDFunnelChartRenderer.prototype.nGetPourcentageHauteurEmbout=function(){return this.m_params.m_nPourcentageHauteurEmbout===undefined?10:this.m_params.m_nPourcentageHauteurEmbout};WDFunnelChartRenderer.prototype.nGetPourcentageLargeurEmbout=function(){return this.m_params.m_nPourcentageLargeurEmbout===undefined?10:this.m_params.m_nPourcentageLargeurEmbout};WDFunnelChartRenderer.prototype.bGetPremiereValeurNonDessinee=function(){return this.m_params.m_bPremiereValeurNonDessinee===undefined?!1:this.m_params.m_bPremiereValeurNonDessinee};WDFunnelChartRenderer.prototype.__bCalculeVariables=function(n,t,i){var r=new WDRect(this.m_rectChart),h=this.m_rectChart.m_nLeft,f=this.m_rectChart.m_nTop,e,o,s,u;for(f=parseInt10(f+r.getWidth()/WDFunnelChartRenderer.FACTEUR_COURBURE_3D/2),r.setLocation(h,f,!0),r.setSize(r.getWidth(),parseInt10(r.getHeight()-r.getWidth()/WDFunnelChartRenderer.FACTEUR_COURBURE_3D/2)),this.m_nHauteurEmbout=parseInt10(r.getHeight()*this.nGetPourcentageHauteurEmbout()/100),this.m_nLargeurEmbout=parseInt10(r.getWidth()*this.nGetPourcentageLargeurEmbout()/100),(this.m_nLargeurEmbout==0||this.m_nHauteurEmbout==0)&&(this.m_nLargeurEmbout=0,this.m_nHauteurEmbout=0),e=this.m_nHauteurEmbout*this.m_nLargeurEmbout,o=(r.getWidth()+this.m_nLargeurEmbout)*(r.getHeight()-this.m_nHauteurEmbout)/2,this.m_nAireTotaleUtile=e+o,this.m_dSommeValeurs=0,s=this.m_oModele.m_tabSeries[0].getNbValues(),u=0;u<s;++u)this.m_dSommeValeurs+=t.tweenValue(i,Math.abs(this.m_oModele.getFromSerieValueAt(0,u)),u,0);return this.m_clRectCalcul=r,this.m_dSommeValeurs!=0};WDFunnelChartRenderer.prototype.__EmptyPortions=function(){for(var n=0;n<this.m_clTabPortions.length;++n)delete this.m_clTabPortions[n];this.m_clTabPortions=[]};WDFunnelChartRenderer.prototype.__bCalculeAireDonnees=function(n,t,i){var f,r;for(this.__EmptyPortions(),f=this.m_oModele.m_tabSeries[0].getNbValues(),r=0;r<f;++r){var e=t.tweenValue(i,Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),r,0),o=e/this.m_dSommeValeurs,s=this.m_nAireTotaleUtile*o,u=new WDFunnelChartRenderer.STInfoPortion;u.m_dAire=s;u.m_nNumCategorie=r;u.m_dValeur=e;this.m_clTabPortions.push(u)}return!0};WDFunnelChartRenderer.prototype.nGetEspacement=function(){return this.m_params.m_nEspacement};WDFunnelChartRenderer.prototype.eGetAlgoEntonnoir=function(){return this.m_params.m_eAlgoEntonnoir===undefined?WDFunnelChartRenderer.eEntonnoirHauteur:this.m_params.m_eAlgoEntonnoir};WDFunnelChartRenderer.prototype.__bCalculePortions_Hauteur=function(){for(var n,t,f,o=this.m_clRectCalcul.getHeight(),r=2*(this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout)/(this.m_clRectCalcul.getWidth()-this.m_nLargeurEmbout),i=0,u=this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout,e=0;e<this.m_clTabPortions.length;++e)(n=this.m_clTabPortions[e],n.m_dValeur!=0)&&(n.m_dY=i,t=o*(n.m_dValeur/this.m_dSommeValeurs),f=0,i=n.m_dY+t,n.m_dY>u?(f=t,t=0):i>u&&(f=i-u,t=t-(i-u)),n.m_dHauteurBoutDroit=f,n.m_dHauteurBoutTraverse=t,n.m_dHauteurBoutDroit==0?(n.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*n.m_dY/r,n.m_dLargeurBase2=this.m_clRectCalcul.getWidth()-2*i/r):n.m_dHauteurBoutTraverse!=0?(n.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*n.m_dY/r,n.m_dLargeurBase2=this.m_nLargeurEmbout):(n.m_dLargeurBase1=this.m_nLargeurEmbout,n.m_dLargeurBase2=this.m_nLargeurEmbout));return this.__CalculeEspacement(r),!0};WDFunnelChartRenderer.prototype.__CalculeEspacement=function(n){for(var t,i=0,r=0;r<this.m_clTabPortions.length;++r)(t=this.m_clTabPortions[r],t.m_dValeur!=0)&&(t.m_dY+=this.nGetEspacement()/2,t.m_dHauteurBoutDroit==0?t.m_dHauteurBoutTraverse-=this.nGetEspacement()/2:t.m_dHauteurBoutDroit-=this.nGetEspacement()/2,t.m_dHauteurBoutTraverse!=0?(t.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*t.m_dY/n,t.m_dLargeurBase2=this.m_clRectCalcul.getWidth()-2*(t.m_dY+t.m_dHauteurBoutTraverse)/n,i=t.m_dLargeurBase2):(t.m_dLargeurBase1=i,t.m_dLargeurBase2=i))};WDFunnelChartRenderer.prototype.__bCalculePortions_Aire=function(){for(var n,u,e,i=2*(this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout)/(this.m_clRectCalcul.getWidth()-this.m_nLargeurEmbout),t=0,f=!1,r=0;r<this.m_clTabPortions.length;++r)if(n=this.m_clTabPortions[r],n.m_dValeur!=0){if(n.m_dY=t,f){u=this.m_nLargeurEmbout!=0?n.m_dAire/this.m_nLargeurEmbout:0;n.m_dHauteurBoutDroit=u;t=n.m_dY+u;continue}t=this.__dCalculeYSuivant(n.m_dY,n.m_dAire,i);t>this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout||t==-1?(t==-1&&(t=0),n.m_dHauteurBoutTraverse=this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout-n.m_dY,n.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*n.m_dY/i,n.m_dLargeurBase2=this.m_nLargeurEmbout,e=n.m_dAire-this.__dCalculAireTrapeze(n.m_dY,this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout,i),n.m_dHauteurBoutDroit=this.m_nLargeurEmbout!=0?e/this.m_nLargeurEmbout:0,t=this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout+n.m_dHauteurBoutDroit,f=!0):(n.m_dHauteurBoutTraverse=t-n.m_dY,n.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*n.m_dY/i,n.m_dLargeurBase2=this.m_clRectCalcul.getWidth()-2*t/i)}return this.__CalculeEspacement(i),!0};WDFunnelChartRenderer.prototype.__dCalculeYSuivant=function(n,t,i){if(i==0)return-1;var s=this.m_clRectCalcul.getWidth(),c=-t-s*n+n*n/i,r=s,u=-1/i,f=r*r-4*u*c;if(f<0)return-1;if(f==0)return-r/2*u;var h=Math.sqrt(f),e=(-r-h)/(2*u),o=(-r+h)/(2*u);return e>0&&e<this.m_clRectCalcul.getHeight()?e:o>0&&o<this.m_clRectCalcul.getHeight()?o:-1};WDFunnelChartRenderer.prototype.__dCalculAireTrapeze=function(n,t,i){var r=this.m_clRectCalcul.getWidth()-2*n/i,u=this.m_clRectCalcul.getWidth()-2*t/i;return(r+u)*(t-n)/2};WDFunnelChartRenderer.prototype.__bDessinePortions=function(n,t,i){for(var u,r=this.m_clTabPortions.length-1;r>=0;--r)u=this.m_clTabPortions[r],this.__bDessinePortion(u,n,t,i),this.__bDessineTextePortion(u,n,t,i);return!0};WDFunnelChartRenderer.prototype.__bDessinePortion=function(n,t,i,r){var s=t.arc(r,"part-"+n.m_nNumCategorie),h,c,l,v;if(n.m_nNumCategorie==0&&s.css("display",""),n.m_dValeur==0)return n.m_nNumCategorie==0?(this.liaisonLegendePart(t,s,n.m_nNumCategorie),s.css("display","none")):this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()||t.remove(s),!0;h=this.m_oModele.getCategoryColor(n.m_nNumCategorie);c=this.m_params.getGradientType();c==IWDChartConstant.FLAG_VERTICAL_GRADIENT||c==IWDChartConstant.FLAG_HORIZONTAL_GRADIENT?this.m_oPaint.setLinearGradient(clWDUtil.sCouleurHTMLPlusBrillante(h),h,"pad",!1,1,1,!0):this.m_oPaint.setFill(h);var u=n.m_dY+this.m_clRectCalcul.m_nTop,a=this.m_clRectCalcul.m_nLeft,e=a+this.m_clRectCalcul.getWidth()/2-n.m_dLargeurBase1/2,o=a+this.m_clRectCalcul.getWidth()/2-n.m_dLargeurBase2/2,f=new Path;return n.m_dHauteurBoutDroit==0&&n.m_dHauteurBoutTraverse!=0?(f.AjouteLigne(e,u,e+n.m_dLargeurBase1,u),f.lineTo(o+n.m_dLargeurBase2,u+n.m_dHauteurBoutTraverse),f.lineTo(o,u+n.m_dHauteurBoutTraverse),f.lineTo(e,u)):n.m_dHauteurBoutDroit!=0&&n.m_dHauteurBoutTraverse==0?(f.AjouteLigne(e,u,e+n.m_dLargeurBase1,u),f.lineTo(e+n.m_dLargeurBase1,u+n.m_dHauteurBoutDroit),f.lineTo(o,u+n.m_dHauteurBoutDroit),f.lineTo(o,u)):(f.AjouteLigne(e,u,e+n.m_dLargeurBase1,u),f.lineTo(o+n.m_dLargeurBase2,u+n.m_dHauteurBoutTraverse),f.lineTo(o+n.m_dLargeurBase2,u+n.m_dHauteurBoutTraverse+n.m_dHauteurBoutDroit),f.lineTo(o,u+n.m_dHauteurBoutDroit+n.m_dHauteurBoutTraverse),f.lineTo(o,u+n.m_dHauteurBoutTraverse),f.lineTo(e,u)),l=this.getSeriesAlphaAt(n.m_nNumCategorie),l<255?this.m_oPaint.setFillOpacity255(l):this.m_oPaint.setFillOpacity255(255),v=this.crPlusFonce(h),this.m_oPaint.setStroke(v),f.close(),this.liaisonLegendePart(t,s,n.m_nNumCategorie),this.m_oPaint=i.tweenPartPaint(s,this.m_oPaint,n,this),t.drawPath(s,f.toD(),this.m_oPaint),!0};WDFunnelChartRenderer.prototype.__bDessineTextePortion=function(n,t,i,r){var a,d,g,nt,u,tt,e,ut,o,l;if(n.m_dValeur==0)a=!1;else{var w={cx:0,cy:0},b={cx:0,cy:0},k={cx:0,cy:0},v="",s="",y="";this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle);var ft=n.m_dY+this.m_clRectCalcul.m_nTop,h=this.m_params.isDisplayValuesLabel(),c=this.m_params.isDisplayPercentage(),f=this.m_params.isDisplayCategoriesLabel(),a=!i.tweenHideLabel(r,!(f||c||h),n.m_nNumCategorie);a||(h=c=f=!1);h&&(d=this.m_params.m_sMasqueValeur,v=WDChartUtils.formatValue(n.m_dValeur,d,!0),u=WDPaintCSS.oGetInfoCSS(this.m_oPaint,v,["height","lineHeight"]),w.cy=parseInt10(u.height));f&&(s=this.m_oModele.getCategoryLabelAt(n.m_nNumCategorie),s==""&&(f=!1));f&&(u=WDPaintCSS.oGetInfoCSS(this.m_oPaint,s,["height","lineHeight"]),b.cy=parseInt10(u.height));c&&(g=this.m_params.m_sMasquePourcentage,nt=Math.abs(this.m_oModele.getFromSerieValueAt(0,0)),y=WDChartUtils.formatValue(n.m_dValeur/nt*100,g.replace("%",""),!0,"%"),u=WDPaintCSS.oGetInfoCSS(this.m_oPaint,y,["height","lineHeight"]),k.cy=parseInt10(u.height));tt=w.cy+b.cy+k.cy;e=n.m_dLargeurBase1;e==0&&(e=this.m_nLargeurEmbout);var et=this.m_clRectCalcul.m_nLeft,it=et+this.m_clRectCalcul.getWidth()/2-e/2,rt=ft+0,p=new WDRect;p.setCorners(parseInt10(it),parseInt10(rt),parseInt10(it+e),parseInt10(rt+n.m_dHauteurBoutTraverse+n.m_dHauteurBoutDroit));ut=p.getCenterY()-tt/2;o=[];f&&o.push(s);h&&o.push(v);c&&o.push(y)}return l=t.text(r,"label-"+n.m_nNumCategorie),a?(this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),this.m_oPaint.DesactivePointerEvents(),this.m_oPaint=i.tweenLabelPaint(n.m_nNumCategorie,this.m_oPaint,l),t.drawText(l,o,parseInt10(u.lineHeight),p.getCenterX(),ut,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint)):this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()||t.remove(l),!0};WDFunnelChartAnimator.prototype=new WDChartAnimator;WDFunnelChartAnimator.prototype.constructor=WDFunnelChartAnimator;WDFunnelChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDFunnelChartAnimation1erAffichageCoulissantNoDraw(n,t);this.add(i,!0)};WDFunnelChartAnimator.prototype.playSurbrillancePart=function(n,t,i,r,u){r!==undefined&&(n.m_oVue.m_oAnimator.bAnimationPasFinie()||this.add(new WDFunnelChartAnimationSurbrillancePartNoDraw(n,t,i,r,u)))};WDFunnelChartAnimator.prototype.playSelectionPart=function(){return};WDFunnelChartAnimator.prototype.playSelectionLegende=function(n,t,i,r){var o=WDPieChartRenderer.nGetIndicePart(t,i),f=this.m_oGraphe.m_oVue.bEstSerieMasquee(o),e,u;if(!f){for(e=!0,u=this.m_oGraphe.m_oDonnees.m_tabSeries[0].m_tabValeur.length-1;u>=0;u--)if(u!=o&&!1===this.m_oGraphe.m_oVue.bEstSerieMasquee(u)){e=!1;break}if(e)return}r&&r.fadeTo(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0?0:400,f?1:.5).find("text").css("text-decoration",f?"":"line-through");this.add(new WDPieChartAnimationSelectionLegende(n,t,i,r))};WDFunnelChartAnimator.prototype.tweenRectChart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenRectChart")};WDFunnelChartAnimator.prototype.tweenPart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenPart")};WDFunnelChartAnimator.prototype.tweenPartPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenPartPaint")};WDFunnelChartAnimator.prototype.tweenLabelPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenLabelPaint")};WDFunnelChartAnimator.prototype.playMajDonnees=function(n,t){if(n.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDFunnelChartAnimationValeur(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);this.add(i,!0)};WDFunnelChartAnimationSurbrillancePartNoDraw.prototype=new WDChartAnimationNoDraw;WDFunnelChartAnimationSurbrillancePartNoDraw.prototype.constructor=WDFunnelChartAnimationSurbrillancePartNoDraw;WDFunnelChartAnimationSurbrillancePartNoDraw.prototype.run=function(){this.m_domPartEnSurbrillance.clearQueue().finish().animate({opacity:this.m_bEtat?.8:1},{duration:this.m_bEtat?this.duration:1,easing:this.easing,queue:"fx"});this.m_oAnimator.retireAnimation(this.m_domPartEnSurbrillance.wbData("wbGrfAnim"));this.m_domPartEnSurbrillance.wbData("wbGrfAnim",this).clearQueue().finish().animate({content:1},this)};WDFunnelChartAnimationSurbrillancePartNoDraw.prototype.step=function(){var n=WDChartAnimationNoDraw.prototype.step.apply(this,arguments),t;n&&(t=n.tween(n.m_nEchelleInitiale,n.m_bEtat?n.m_nEchelle:0,n.m_dNow),n.m_domPartEnSurbrillance.wbData("wbGrfAnimSurbrillanceEcart",t))};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype=new WDChartAnimationNoDraw;WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.constructor=WDFunnelChartAnimation1erAffichageCoulissantNoDraw;WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.run=function(){this.m_oGraphe.m_oVue.Redessine(this.m_oGraphe,WDChartView.ms_nDessinParDefaut);var n=this;this.m_domBaliseAnim.wbData("wbGrfAnim",this);setTimeout(function(){n.done()},this.duration)};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.step=function(){var n=WDChartAnimationNoDraw.prototype.step.apply(this,arguments);n&&n.m_domBaliseAnim.css({opacity:n.tween(0,1,(n.m_oBezier||(n.m_oBezier=new clWDUtil.WDBezier(.42,0,1,-.1))).dCalcule(n.m_dNow,n.duration*(WDPieChartRenderer.nGetIndicePart(n.m_oPicture,n.m_domBaliseAnim)/n.m_oGraphe.m_oModele.m_tabSeries[0].m_tabValeur.length)))}).attr("transform","translate(0,"+.8*(n.m_pstPortion.m_dY*n.m_dNow-n.m_pstPortion.m_dY)+")")};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.tweenHideLabel=function(n,t){return t};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.tweenLabelPaint=function(n,t,i){return i.css({opacity:0}).delay(this.duration*2/3).animate({opacity:1},{queue:"fx",duration:this.duration/3,easing:this.easing}),t};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.tweenPartPaint=function(n,t,i){this.m_oAnimator.retireAnimation(n.wbData("wbGrfAnim"));var r=new WDFunnelChartAnimation1erAffichageCoulissantNoDraw(this.m_oGraphe,this.m_oPicture);return r.m_domBaliseAnim=n,r.m_pstPortion=i,n.wbData("wbGrfAnim",r).clearQueue().finish().animate({content:1},r),t};WDFunnelChartAnimationValeur.prototype=new WDChartAnimationValeur;WDFunnelChartAnimationValeur.prototype.constructor=WDFunnelChartAnimationValeur;WDFunnelChartAnimationValeur.prototype.tweenValue=function(n,t,i){var r=this.m_dNow,u;return this.m_oModelePrecedent===undefined&&(this.m_dNow=Math.exp(r*i)/Math.exp(i)),u=WDChartAnimationValeur.prototype.tweenValue.apply(this,arguments),this.m_dNow=r,u};WDChartRenderer.prototype.drawLegend=function(n,t,i){var l,ct,bt,e,b,kt,si,dt,ft,ii,ri,di,gi,u,f,hi,p,ni,ir,vt,tt,ur,li,ai,vi;this.m_oPaint.raz();for(var o=this.m_params.getLegendPosition(),w=n.g(i,"legende-groupe"),c=this.getNbLegendLabels(),ei=[o],r=0,r=0;r<c;++r)ei.push(this.getLegendLabelAt(r));if(w.wbData("wbGrfCacheDrawLegend")!=ei&&(w.wbData("wbGrfCacheDrawLegend",ei),l=w.children().length>0,n.empty(w),o!==IWDChartConstant.FLAG_LEGEND_POSITION_NONE&&(o!==IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL||this.m_params.m_oPositionnementManuel&&this.m_params.m_oPositionnementManuel.m_oLegende))){if(c<=0){n.empty(w);return}t.tweenGroupeLegende(w);var et=0,rt=o===IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL?0:IWDChartConstant.MARGIN_LEGEND_BORDER,yt=rt*2+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2,pt=rt*2+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2,wt=rt*2+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2,ut=rt*2+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2;o!==IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL&&(pt+=IWDChartConstant.MARGIN_BORDER,ut+=IWDChartConstant.MARGIN_BORDER);var ht=0,ti=[],oi=[],yi=[];for(r=0;r<c;++r)ct=this.getLegendLabelAt(r),isNaN(parseInt10(ct))&&!clWDUtil.bEstChaineNonVide(ct)&&(ct="N"+$("<span/>").html("&#176;").text()+(r+1)),oStyle=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLegende,ct,["width","lineHeight","fontSize"],"font-weight:900",!0),bt=Math.ceil(parseInt10(oStyle.width)),oi[r]=Math.ceil(parseInt10(oStyle.fontSize)),et=Math.max(et,Math.ceil(parseInt10(oStyle.lineHeight))),bt>ht&&(ht=bt),ti[r]=bt,ut+=IWDChartConstant.LEGEND_SQUARE_SIZE+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*(r>0?2:1)+bt,yt+=et+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*(r>0?1:0),yi[r]=ct;if(e=!0,b=!1,this._vbLegendevaleur())e=o==IWDChartConstant.FLAG_LEGEND_POSITION_TOP||o==IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM,b=!1;else switch(o){default:case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:e=yt>WDRect.getHeight(this.m_rectChart);e&&(b=!0);break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:e=ut<=WDRect.getWidth(this.m_rectChart);e||(b=!0);break;case IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL:e=this.m_params.isLegendLabelInRow();e&&this.m_params.m_oPositionnementManuel.m_oLegende.m_nLeft+ut>this.m_rectChartInitial.m_nRight?b=!0:!e&&this.m_params.m_oPositionnementManuel.m_oLegende.m_nTop+yt>this.m_rectChartInitial.m_nBottom&&(b=!0)}if(b){var lt=WDRect.getHeight(this.m_rectChartInitial),ot=WDRect.getWidth(this.m_rectChartInitial),fr=o;switch(o){default:case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:ot=ot/2;break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:lt=lt/3;break;case IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL:o=this.m_params.isLegendLabelInRow()?IWDChartConstant.FLAG_LEGEND_POSITION_TOP:IWDChartConstant.FLAG_LEGEND_POSITION_LEFT;kt=this.m_params.m_oPositionnementManuel.m_oLegende;this.m_params.isLegendAdaptSizeToContent()?(ot-=kt.m_nLeft,lt-=kt.m_nTop):(ot=WDRect.getWidth(kt),lt=WDRect.getHeight(kt))}var pi=IWDChartConstant.MARGIN_LEGEND_ELEMENTS+et,wi=IWDChartConstant.LEGEND_SQUARE_SIZE+ht+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2,d=undefined,g=undefined;switch(o){default:case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:g=parseInt10(lt/pi);d=g?parseInt(c/g)+(c%g>0?1:0):0;break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:d=parseInt10(ot/wi);g=d?parseInt(c/d)+(c%d>0?1:0):0;break;case IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL:d=1;g=1}if(!d||!g){n.empty(w);return}ut=Math.min(ot,pt+d*wi-IWDChartConstant.MARGIN_LEGEND_ELEMENTS);switch(o){default:case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:ot>ut&&(si=parseInt10(c/d),g=parseInt10(c/si)+(c%si>0?1:0));break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:break;case IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL:}wt=Math.min(lt,wt+g*pi-IWDChartConstant.MARGIN_LEGEND_ELEMENTS);e=!0;o=fr}else pt+=IWDChartConstant.LEGEND_SQUARE_SIZE+IWDChartConstant.MARGIN_LEGEND_ELEMENTS+ht,wt+=et;var a=0,k=0,v=0,y=0;if(o===IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL)dt=this.m_params.m_oPositionnementManuel.m_oLegende,a=dt.m_nLeft,k=dt.m_nTop,this.m_params.isLegendAdaptSizeToContent()?(v=e?ut:pt,y=e?wt:yt):(v=WDRect.getWidth(dt),y=WDRect.getHeight(dt));else{v=e?ut:pt;y=e?wt:yt;switch(o){case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:a=this.m_rectChart.m_nLeft;k=this.m_rectChart.m_nTop+Math.max(0,(WDRect.getHeight(this.m_rectChart)-y)/2);this.m_rectChart.setLocation(a+v,this.m_rectChart.m_nTop,!1);break;case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:a=this.m_rectChart.m_nRight-v;k=this.m_rectChart.m_nTop+Math.max(0,(WDRect.getHeight(this.m_rectChart)-y)/2);this.m_rectChart.setSize(WDRect.getWidth(this.m_rectChart)-v,WDRect.getHeight(this.m_rectChart));break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:a=this.m_rectChart.m_nLeft+Math.max(0,(WDRect.getWidth(this.m_rectChart)-v)/2);k=this.m_rectChart.m_nTop;this.m_rectChart.setLocation(this.m_rectChart.m_nLeft,k+y,!1);break;case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:a=this.m_rectChart.m_nLeft+Math.max(0,(WDRect.getWidth(this.m_rectChart)-v)/2);k=this.m_rectChart.m_nBottom-y;this.m_rectChart.setSize(WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart)-y)}}a+=rt;k+=rt;v-=2*rt;y-=2*rt;o!==IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL&&(v-=IWDChartConstant.MARGIN_BORDER);var bi=this.m_params.m_sCouleurLegende,ki=this.m_params.m_sCouleurLegendeFond,nt=new WDRect(a,k,a+v,k+y);if(ki!==undefined&&this.m_oPaint.setFill(ki),ft=0,bi!==undefined&&(ft=1,this.m_oPaint.setStroke(bi,ft)),ii=undefined,!this.m_params.m_bLegendeBordArrondi||(ii=10),ri=new WDRect,ri.setLocation(Math.min(nt.m_nLeft,nt.m_nRight)-ft,Math.min(nt.m_nTop,nt.m_nBottom)-ft),ri.setSize(nt.getWidth()+2*ft,nt.getHeight()+2*ft),n.clipRect(ri,"clip-legende"),di=n.path(w,"legende-fond"),gi=this.__oPathBulle(nt,ft,ii,ii),n.drawPath(di,gi,this.m_oPaint,this.m_params.m_nDureeAnimation===0||l?!1:WDSvgAnimationLegende),u=a+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,f=k+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,this._vbLegendevaleur())this._drawLegendValeurPaint(w,n,t,nt,l);else for(r=0;r<c;++r){var s=this.convertSeriesIndexSelonPasToModel(r),at=this.getLegendColorAt(s),ui=this.getSeriesAlphaAt(s);ui<255?this.m_oPaint.setFillOpacity255(ui):this.m_oPaint.setFillOpacity255(255);var nr=clWDUtil.sCouleurHTMLPlusBrillante(at),st=IWDChartConstant.LEGEND_SQUARE_SIZE,h=et,tr=this.m_params.getGradientType();switch(tr){case IWDChartConstant.FLAG_VERTICAL_GRADIENT:case IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:this.m_oPaint.setLinearGradient(at,nr,"pad",tr==IWDChartConstant.FLAG_VERTICAL_GRADIENT);break;case IWDChartConstant.FLAG_NO_GRADIENT:this.m_oPaint.setFill(at)}hi=1;this.m_oPaint.setStroke(nr,hi);p=n.g(w,"legende-groupe-"+s);this.ecouteLegende(p);var gt=this.m_mapSeriesRenderer?this.getSeriesAt(s):this.getSeriesAt(0),fi=gt.getChartType(),er=this.m_mapSeriesRenderer?this.m_mapSeriesRenderer[fi]:undefined,ci=new WDPaintCSS(this.m_oPaint);switch(fi){case WDChartParameters.kAire:ni=new WDPaintCSS;ni.setFill(clWDUtil.sCouleurHTMLPlusBrillante(at));ui<255?ni.setFillOpacity255(ui):ni.setFillOpacity255(255);ir=n.path(p,"legende-picto-"+s+"-aire");vt=new Path;vt.moveTo(u,f+h);vt.lineTo(u+st,f);vt.lineTo(u+st,f+h);vt.close();n.drawPath(ir,vt.toD(),ni,this.m_params.m_nDureeAnimation===0||l?!1:WDSvgAnimationLegende);case WDChartParameters.kCourbe:tt=n.line(p,"legende-picto-"+s+"-courbe");ci.setStroke(at,gt.m_nEpaisseur);ci.setDashSelonType(gt.m_nEpaisseur,parseInt(gt.m_eTypeTrait));n.drawLine(tt,u,fi==WDChartParameters.kAire?f+h:f+h/2,u+st,fi==WDChartParameters.kAire?f:f+h/2,ci,this.m_params.m_nDureeAnimation===0||l?!1:WDSvgAnimationLegende);er.drawUnPoint(n,p,s,gt,[{nom:"legende-picto-"+s+"-point",x:u+st/2,y:f+h/2,z:.5*3*h/7}],0,this.m_params,at,this.m_params.m_nDureeAnimation===0||l?!1:WDSvgAnimationLegende);this.m_oPaint.raz();break;case WDChartParameters.kHisto:case WDChartParameters.kHistoEmpile:case WDChartParameters.kHistoEmpileHorizontal:case WDChartParameters.kHistoHorizontal:var rr=Math.ceil(h/3),it=Math.ceil((st-2)/3),tt=n.rect(p,"legende-picto-"+s+"-1");n.drawRect(tt,new WDRect(u+(it+1)*0,f+rr*2,u+(it+1)*0+it,f+h),new WDPaintCSS(this.m_oPaint),undefined,undefined,this.m_params.m_nDureeAnimation===0||l?!1:WDSvgAnimationLegende);tt=n.rect(p,"legende-picto-"+s+"-2");n.drawRect(tt,new WDRect(u+(it+1)*1,f+rr,u+(it+1)*1+it,f+h),new WDPaintCSS(this.m_oPaint),undefined,undefined,this.m_params.m_nDureeAnimation===0||l?!1:WDSvgAnimationLegende);tt=n.rect(p,"legende-picto-"+s+"-3");n.drawRect(tt,new WDRect(u+(it+1)*2,f,u+(it+1)*2+it,f+h),this.m_oPaint,undefined,undefined,this.m_params.m_nDureeAnimation===0||l?!1:WDSvgAnimationLegende);break;default:tt=n.rect(p,"legende-picto-"+s);n.drawRect(tt,new WDRect(u,f,u+st,f+h),this.m_oPaint,undefined,undefined,this.m_params.m_nDureeAnimation===0||l?!1:WDSvgAnimationLegende)}u+=st+IWDChartConstant.MARGIN_LEGEND_ELEMENTS;this.m_oPaint.addClasse(this.m_params.m_sClasseLegende);ur=n.text(p,"legende-texte-"+s);this.m_oPaint=t.tweenLegendPaint(r,this.m_oPaint);n.drawText(ur,yi[r],oi[r],u,f+(h/2-oi[r]/2-hi*2),IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,this.m_oPaint,this.m_params.m_nDureeAnimation===0||l?!1:bIEAvec11?WDSvgAnimation:WDSvgAnimationLegende);li=this.bEstLegendeMasquee(s);p.css("opacity",li?.5:1).find("text").css("text-decoration",li?"line-through":"");ai=IWDChartConstant.MARGIN_LEGEND_ELEMENTS+(b?ht:ti[r]);vi=et+IWDChartConstant.MARGIN_LEGEND_ELEMENTS;(e||b)&&(u+ai+(r+2==c&&ti[r+1]?ti[r+1]:ht)>nt.m_nRight?(e=!1,y+=vi):b&&(e=!0));e?u+=ai:(u=a+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,f+=vi)}n.restoreClip()}};WDPieChartRenderer.nGetIndicePart=function(n,t){return parseInt10(n.getId(t).substr(n.getId(t).lastIndexOf("-")+1))};WDPieChartRenderer.bParametresSupportes=function(n,t){return WDChartRenderer.bParametresSupportes(n,t)?!t.m_bPhong?!0:!1:!1};WDPieChartRenderer.prototype=new WDChartRenderer;WDPieChartRenderer.prototype.constructor=WDPieChartRenderer;WDPieChartRenderer.prototype.m_bDessinneSelonBissectire=!0;WDPieChartRenderer.AUTORISE_COULEUR_ETIQUETTE_AUTO=!0;WDPieChartRenderer.prototype.RecreerRenderer=function(n,t){t==WDChartView.ms_nDessinModifTypeGraphe?n.remove(this.m_domGroupeSeries.find("text")):(this.m_domGroupeSeries&&n.empty(this.m_domGroupeSeries),this.tabLabelRenderers=undefined)};WDPieChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r){var e,u,f;if(i||r===!0)for(e=t,u=0;u<this.m_oGraphe.m_oModele.m_tabSeries[0].m_tabValeur.length;++u)f=Array.prototype.slice.call(arguments,0),f[1]=u,f[2]=e==u?i:!1,WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,f);else WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments)};WDPieChartRenderer.prototype.Init=function(){WDChartRenderer.prototype.Init.apply(this,arguments);this.m_nCenterX=0;this.m_nCenterY=0;this.m_nRadius=0;this.m_dTotalValue=0};WDPieChartRenderer.prototype.ecouteLegende=function(n){return WDChartListener.bind(WDPieChartLegendListener,this.m_oGraphe,n)};WDPieChartRenderer.prototype.getInitialStartAngle=function(n){return(Number(n.m_dAngle||0).toDeg()+270)%360};WDPieChartRenderer.prototype.getAngleForValue=function(n,t,i){var r=n/t*(i||360);return r===360?360:(r>=i&&(r=i-1),r)};WDPieChartRenderer.prototype.drawChart=function(n,t,i){var oi,l,v,r,f,w,vt,yt,pt,wt,ni,c,s,k,d,y,st,u,fi,ht,tt,it;WDChartRenderer.prototype.drawChart.apply(this,arguments);
/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
	 * Licensed under the MIT License (LICENSE.txt).
	 *
	 * Version: 3.1.12
	 *
	 * Requires: jQuery 1.2.2+
	 */
if(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?module.exports=n:n(jQuery)}(function(n){function e(r){var f=r||window.event,w=h.call(arguments,1),l=0,o=0,e=0,a=0,b=0,k=0,v,y,p;if(r=n.event.fix(f),r.type="mousewheel","detail"in f&&(e=f.detail*-1),"wheelDelta"in f&&(e=f.wheelDelta),"wheelDeltaY"in f&&(e=f.wheelDeltaY),"wheelDeltaX"in f&&(o=f.wheelDeltaX*-1),"axis"in f&&f.axis===f.HORIZONTAL_AXIS&&(o=e*-1,e=0),l=e===0?o:e,"deltaY"in f&&(e=f.deltaY*-1,l=e),"deltaX"in f&&(o=f.deltaX,e===0&&(l=o*-1)),e!==0||o!==0)return f.deltaMode===1?(v=n.data(this,"mousewheel-line-height"),l*=v,e*=v,o*=v):f.deltaMode===2&&(y=n.data(this,"mousewheel-page-height"),l*=y,e*=y,o*=y),a=Math.max(Math.abs(e),Math.abs(o)),(!t||a<t)&&(t=a,s(f,a)&&(t/=40)),s(f,a)&&(l/=40,o/=40,e/=40),l=Math[l>=1?"floor":"ceil"](l/t),o=Math[o>=1?"floor":"ceil"](o/t),e=Math[e>=1?"floor":"ceil"](e/t),i.settings.normalizeOffset&&this.getBoundingClientRect&&(p=this.getBoundingClientRect(),b=r.clientX-p.left,k=r.clientY-p.top),r.deltaX=o,r.deltaY=e,r.deltaFactor=t,r.offsetX=b,r.offsetY=k,r.deltaMode=0,w.unshift(r,l,o,e),u&&clearTimeout(u),u=setTimeout(c,200),(n.event.dispatch||n.event.handle).apply(this,w)}function c(){t=null}function s(n,t){return i.settings.adjustOldDeltas&&n.type==="mousewheel"&&t%120==0}var o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice,u,t,f,i;if(n.event.fixHooks)for(f=o.length;f;)n.event.fixHooks[o[--f]]=n.event.mouseHooks;i=n.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=r.length;t;)this.addEventListener(r[--t],e,!1);else this.onmousewheel=e;n.data(this,"mousewheel-line-height",i.getLineHeight(this));n.data(this,"mousewheel-page-height",i.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=r.length;t;)this.removeEventListener(r[--t],e,!1);else this.onmousewheel=null;n.removeData(this,"mousewheel-line-height");n.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var r=n(t),i=r["offsetParent"in n.fn?"offsetParent":"parent"]();return i.length||(i=n("body")),parseInt(i.css("fontSize"),10)||parseInt(r.css("fontSize"),10)||16},getPageHeight:function(t){return n(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};n.fn.extend({mousewheel:function(n){return n?this.bind("mousewheel",n):this.trigger("mousewheel")},unmousewheel:function(n){return this.unbind("mousewheel",n)}})}),oi=this,i,l=this.m_params.getType()==WDChartParameters.kHemicycle?180:360,l=t.tweenInitialEndAngle(i,l),i.wbData("wbGrfAnimTweenInitialEndAngle",l),!1!==this.m_oModele.hasPremiereSerieNonVide()){for(v=this.m_oModele.m_tabSeries[0].getNbValues(),this.m_dTotalValue=0,r=0,r=0;r<v;++r)f=t.tweenValue(i,Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),r,0),this.m_dTotalValue+=f;if(this.m_dTotalValue!==0){this.m_dInitialStartAngle=this.m_params.getType()==WDChartParameters.kHemicycle?180:this.getInitialStartAngle(this.m_params);this.m_dInitialStartAngle=t.tweenInitialStartAngle(i,this.m_dInitialStartAngle);i.wbData("wbGrfAnimTweenInitialStartAngle",this.m_dInitialStartAngle);var h=this.m_dInitialStartAngle,ft=0,ct=this.m_params.isDisplayValuesLabel(),lt=this.m_params.isDisplayPercentage(),at=this.m_params.isDisplayCategoriesLabel();if(this.tabLabelRenderers===undefined&&(this.tabLabelRenderers=[]),w=!t.tweenHideLabel(i,!(at||lt||ct),r),w||!this.m_params.m_bBulleActive)for(vt=this.m_params.m_sMasqueValeur,yt=this.m_params.m_sMasquePourcentage,r=0;r<v;++r)(f=Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),f!=0)&&(f=t.tweenValue(i,f,r,0),s=this.getAngleForValue(f,this.m_dTotalValue,l),this.tabLabelRenderers[r]===undefined?u=new WDLabelRenderer(this,h,s,r):(u=this.tabLabelRenderers[r],u.setAngle(h,s)),u.setCategoryLabel(at,this.m_oModele.getCategoryLabelAt(r)),u.setValueLabel(ct,WDChartUtils.formatValue(f,vt,!0)),u.setPercentLabel(lt,WDChartUtils.formatValue(f/this.m_dTotalValue*100,yt.replace("%",""),!0,"%")),this.tabLabelRenderers[r]=u,h+=s);if(h=this.m_dInitialStartAngle,this.m_rectChart=t.tweenRectChart(i,this.m_rectChart),this.m_nCenterX=Math.floor((this.m_rectChart.m_nLeft+this.m_rectChart.m_nRight)/2),this.m_nCenterY=Math.floor((this.m_rectChart.m_nTop+this.m_rectChart.m_nBottom)/2),this.m_params.getType()==WDChartParameters.kHemicycle&&(pt=Math.floor((this.m_rectChart.m_nBottom-this.m_rectChart.m_nTop)/2),this.m_nCenterY+=pt/2),this.m_nRadius=Math.min(WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart))/2,!(this.m_nRadius<=IWDChartConstant.MARGIN_PIE+IWDChartConstant.MARGIN_LABEL_PIE)){var rt=0,o=undefined,e=undefined;if(w&&(this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),wt=WDPaintCSS.oGetInfoCSS(this.m_oPaint,"Ap","lineHeight"),rt=parseInt10(wt.lineHeight),o=new WDRect,!!this.m_params.m_bEtiquetteSecteurExterieures)){var bt=this.m_rectChart.m_nLeft,kt=this.m_rectChart.m_nTop,dt=this.m_rectChart.m_nRight,gt=this.m_rectChart.m_nBottom;for(e=0,r=0;r<v;++r)(ni=this.m_oModele.getPartOffset(r,et),u=this.tabLabelRenderers[r],u)&&(u.getBounds(rt,ni,o),bt-o.m_nLeft>e&&(e=bt-o.m_nLeft),kt-o.m_nTop>e&&(e=kt-o.m_nTop),o.m_nRight-dt>e&&(e=o.m_nRight-dt),o.m_nBottom-gt>e&&(e=o.m_nBottom-gt))}if(e===undefined)for(e=0,r=0;r<v;++r)if(c=this.m_oModele.getPartOffset(r,et),!(c<=0)){if(s=undefined,u=this.tabLabelRenderers[r],u)s=Number(u.m_dAngleR).toDeg();else{if(f=Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),f==0)continue;f=t.tweenValue(i,f,r,0);s=this.getAngleForValue(f,this.m_dTotalValue,l)}y=Number(90-(ft+s/2)).toRad();e=Math.max(e,Math.abs(c*Math.sin(y)));e=Math.max(e,Math.abs(c*Math.cos(y)))}if(this.m_nRadius-=e,this.m_nRadius-=IWDChartConstant.MARGIN_PIE,!(this.m_nRadius<=0)){var et=this.m_params.m_nExcentrageGlobal,ot=new WDRect(this.m_nCenterX-this.m_nRadius,this.m_nCenterY-this.m_nRadius,this.m_nCenterX+this.m_nRadius,this.m_nCenterY+this.m_nRadius),p=this.m_params.getDonutHoleSize(),si=p>0&&this.m_params.getType()!=WDChartParameters.kSecteur&&this.m_params.getType()!=WDChartParameters.kHemicycle||this.m_params.getType()==WDChartParameters.kDonut,b=0;si?(p<0&&(p=30),b=Math.ceil(this.m_nRadius*p/100)):p=0;b=t.tweenHoleRadius(i,b);i.wbData("wbGrfAnimTweenHoleRadius",b);var hi=n.g(i,"groupe-serie-parts"),ti=n.g(i,"groupe-serie-etiquettes"),ii=[];for(r=0;r<v;++r)if(k=0,d=0,f=Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),f!=0){f=t.tweenValue(i,f,r,0);var s=this.getAngleForValue(f,this.m_dTotalValue,l),c=this.m_oModele.getPartOffset(r,et),g=this.m_oModele.getCategoryColor(r),ci=this.m_params.isBorderColorAuto()?clWDUtil.sCouleurHTMLPlusBrillante(g):this.m_params.m_sCouleurBordure,ri=this.m_params.getGradientType();ri==IWDChartConstant.FLAG_VERTICAL_GRADIENT||ri==IWDChartConstant.FLAG_HORIZONTAL_GRADIENT?this.m_oPaint.setRadialGradient(this.m_nCenterX,this.m_nCenterY,this.m_nRadius,clWDUtil.sCouleurHTMLPlusBrillante(g),g,"pad"):this.m_oPaint.setFill(g);c>0&&(y=Number(90-(ft+s/2)).toRad(),k=c*Math.sin(y),d=c*Math.cos(y),ot.offset(k,d));this.m_oPaint.setStroke(ci);st=this.getSeriesAlphaAt(r);st<255?this.m_oPaint.setFillOpacity255(st):this.m_oPaint.setFillOpacity255(255);var ui=n.g(hi,"groupe-serie-"+r),ut=n.g(ui,"part-effect-"+r),a=n.arc(ut,"part-"+r),nt=new stPath(ot,{rDonut:b,start:this.m_bDessinneSelonBissectire?ft:h,startAngle:h,sweep:s,firstAngle:this.m_dInitialStartAngle});if(n.drawArc(a,nt=t.tweenPart(a,nt),this.m_oPaint=t.tweenPartPaint(a,this.m_oPaint)),a.wbData("wbGrfGrInfoXY",[0,r,f]),this.m_bDessinneSelonBissectire&&(n.rotate(ui,h+nt.options.sweep/2,this.m_nCenterX,this.m_nCenterY,!0),n.rotate(a,-nt.options.sweep/2,this.m_nCenterX,this.m_nCenterY,!0)),this.liaisonLegendePart(n,a,r),(k!==0||d!==0)&&ot.offset(-k,-d),(w||!this.m_params.m_bBulleActive)&&(u=this.tabLabelRenderers[r],a.wbData("wbGrfPieLabelRenderer",u),this.m_params.m_bBulleActive||(this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),fi=n.bulle(ut,"bulle-"+r),ht=this.m_params.m_sBulleSecteur||"[%CATEGORIE%]\n[%SERIE%]\n[%%%]",n.drawBulle(fi,ht.replace("[%CATEGORIE%]",u.m_strCategoryLabel||"").replace("[%SERIE%]",ht.indexOf("[%VALEUR%]")>-1?this.m_oModele.m_tabSeries[0].m_sLibelle||"":u.m_strValueLabel||"").replace("[%VALEUR%]",u.m_strValueLabel||"").replace("[%%%]",u.m_strPercentLabel||""),this.m_oPaint)),w)){if(tt=u.getBounds(rt,c,o,p),tt&&!this.m_params.m_bAutoriseChevauchementEtiquettes&&(clWDUtil.bForEachIn(ii,function(n,t){return WDRect.intersects(o,t)?(tt=!1,!1):!0}),ii.push(_clone(o))),tt){if(it=n.text(ti,"label-"+n.getId(ut)),this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),WDPieChartRenderer.AUTORISE_COULEUR_ETIQUETTE_AUTO&&!this.m_params.m_bEtiquetteSecteurExterieures){function ei(n){return 1-(.299*n[0]+.587*n[1]+.114*n[2])/255}function li(n,t){var i=t,u=ei(n),r=ei(t);return u<.5?r<.5&&(i="#000"):r>=.5&&(i="#FFF"),i}this.m_oPaint.setFill(li(clWDUtil.tabHTML2RVBA(g),clWDUtil.tabHTML2RVBA("#000")))}u.draw(n,it,o.m_nLeft,o.m_nTop,rt,this.m_oPaint,t)}it=n.findFromId(ti,"label-"+n.getId(ut));!tt&&it.length>0&&it.remove()}h+=nt.options.sweep}}}}}};WDLabelRenderer.prototype.constructor=WDLabelRenderer;WDLabelRenderer.prototype.setAngle=function(n,t){for(this.m_dAngleValueR=Number(t).toRad();n<0;)n+=360;var i=n%360;this.m_dStartAngleR=Number(i%360).toRad();i+=t/2;this.m_dAngleR=Number(90-i).toRad();switch(Math.round(Number(i).toRad()/(Math.PI/4))){case 8:case 0:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_CENTRE;break;case 1:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT;break;case 2:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT;break;case 3:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT;break;case 4:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT;break;case 5:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_BAS;break;case 6:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_BAS;break;case 7:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_BAS}};WDLabelRenderer.prototype.setValueLabel=function(n,t){t!=""&&t!=this.m_strValueLabel&&(this.m_strValueLabel=t,this.m_bValueLabel=n&&t!==undefined,this.m_bValueLabel&&this.updateTotalWidth(t))};WDLabelRenderer.prototype.updateTotalWidth=function(n){var i=WDPaintCSS.oGetInfoCSS(this.m_oRenderer.m_params.m_sClasseLibelle,n,"width"),t=parseInt10(i.width);t>this.m_dWidth&&(this.m_dWidth=t)};WDLabelRenderer.prototype.setCategoryLabel=function(n,t){t!=""&&t!=this.m_strCategoryLabel&&(this.m_strCategoryLabel=t,this.m_bCategoryLabel=n&&t!==undefined,this.m_bCategoryLabel&&this.updateTotalWidth(t))};WDLabelRenderer.prototype.setPercentLabel=function(n,t){t!=""&&t!=this.m_strPercentLabel&&(this.m_strPercentLabel=t,this.m_bPercentLabel=n&&t!==undefined,this.m_bPercentLabel&&this.updateTotalWidth(t))};WDLabelRenderer.prototype.getBounds=function(n,t,i,r){var e=Math.ceil(this.m_dWidth),o=n*this.getNbLines(),h=1,c=1,s=IWDChartConstant.MARGIN_LABEL_PIE,u,f;this.m_oRenderer.m_params.m_bEtiquetteSecteurExterieures||(c=h=.5*(1+r/100),s=0,this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_CENTRE);u=Math.round(this.m_oRenderer.m_nCenterX+(this.m_oRenderer.m_nRadius*h+s+t)*Math.sin(this.m_dAngleR));switch(this.m_nAlignmentH){default:case IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE:i.m_nLeft=u;i.m_nRight=u+e;break;case IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE:i.m_nLeft=u-e/2;i.m_nRight=u+e/2;break;case IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT:i.m_nLeft=u-e;i.m_nRight=u}f=Math.round(this.m_oRenderer.m_nCenterY+(this.m_oRenderer.m_nRadius*c+s+t)*Math.cos(this.m_dAngleR));switch(this.m_nAlignmentV){default:case IWDConstante.ALIGNEMENT_VERTICAL_HAUT:i.m_nTop=f;i.m_nBottom=f+o;break;case IWDConstante.ALIGNEMENT_VERTICAL_CENTRE:i.m_nTop=f-o/2;i.m_nBottom=f+o/2;break;case IWDConstante.ALIGNEMENT_VERTICAL_BAS:i.m_nTop=f-o;i.m_nBottom=f}return!0};WDLabelRenderer.prototype.contains=function(n,t){if(this.m_dAngleValueR>Math.PI/4)return!0;var r,u,f,e,o,s,i=this.m_oRenderer.m_nRadius,h=this.m_dStartAngleR+this.m_dAngleValueR,c=this.m_dStartAngleR+this.m_dAngleValueR/2;return r=this.m_oRenderer.m_nCenterX+i*(t/100)*Math.cos(c),u=this.m_oRenderer.m_nCenterY+i*(t/100)*Math.sin(c),f=this.m_oRenderer.m_nCenterX+i*Math.cos(this.m_dStartAngleR),e=this.m_oRenderer.m_nCenterY+i*Math.sin(this.m_dStartAngleR),o=this.m_oRenderer.m_nCenterX+i*Math.cos(h),s=this.m_oRenderer.m_nCenterY+i*Math.sin(h),WDChartUtils.is_in_triangle(n.m_nLeft,n.m_nTop,r,u,f,e,o,s)&&WDChartUtils.is_in_triangle(n.m_nRight,n.m_nTop,r,u,f,e,o,s)&&WDChartUtils.is_in_triangle(n.m_nLeft,n.m_nBottom,r,u,f,e,o,s)&&WDChartUtils.is_in_triangle(n.m_nRight,n.m_nBottom,r,u,f,e,o,s)};WDLabelRenderer.prototype.getNbLines=function(){var n=0;return this.m_bValueLabel&&++n,this.m_bCategoryLabel&&++n,this.m_bPercentLabel&&++n,n};WDLabelRenderer.prototype.draw=function(n,t,i,r,u,f,e){this.m_nAlignmentH===IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE?i+=this.m_dWidth/2:this.m_nAlignmentH===IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT&&(i+=this.m_dWidth);var o=[];this.m_bCategoryLabel&&o.push(this.m_strCategoryLabel);this.m_bValueLabel&&o.push(this.m_strValueLabel);this.m_bPercentLabel&&o.push(this.m_strPercentLabel);f.DesactivePointerEvents();f=e.tweenLabelPaint(this.m_nIndice,f,t);n.drawText(t,o,u,i,r,this.m_nAlignmentH,f)};WDXYChartRenderer.bParametresSupportes=function(n,t){var r,i,u;if(!WDChartRenderer.bParametresSupportes(n,t))return!1;for(r=t.m_oParametres,i=0;i<t.m_tabSeries.length;++i)if(u=t.m_tabSeries[i],u.isOnSecondaryAxis()&&!r.m_oAxeYSecondaire)return!1;return!0};WDXYChartRenderer.prototype=new WDChartRenderer;WDXYChartRenderer.prototype.constructor=WDXYChartRenderer;WDXYChartRenderer.prototype.createAxisRenderer=function(){return new WDXYChartAxisRenderer(this)};WDXYChartRenderer.prototype.nGetYOrigin=function(n){return n?this.m_nY2Origin:this.m_nYOrigin};WDXYChartRenderer.prototype.nGetXOrigin=function(n){return n?this.m_nX2Origin:this.m_nXOrigin};WDXYChartRenderer.prototype.dGetXPixelsPerUnit=function(n){return n?this.m_dX2PixelsPerUnit:this.m_dXPixelsPerUnit};WDXYChartRenderer.prototype.dGetYPixelsPerUnit=function(n){return n?this.m_dY2PixelsPerUnit:this.m_dYPixelsPerUnit};WDXYChartRenderer.prototype.dGetY2PixelsPerUnit=function(){return this.dGetYPixelsPerUnit(!0)};WDXYChartRenderer.prototype.Init=function(n,t){var s,f,e,i,u,r,h,o;for(WDChartRenderer.prototype.Init.apply(this,arguments),s=this.m_oGraphe.m_oModele.m_tabSeries.length,f={},e=0;e<s;e++){if(i=this.m_oGraphe.m_oModele.getSeriesAt(e,!1),u=i.getChartType(),this.m_mapSeriesRenderer[u])f[u]=this.m_mapSeriesRenderer[u];else{r=undefined;switch(u){default:case WDChartParameters.kSecteur:case WDChartParameters.kDonut:case WDChartParameters.kHemicycle:case WDChartParameters.kEntonnoir:case WDChartParameters.kCourbe:r=new WDLineChartSeriesRenderer(this.m_oGraphe,this,i);break;case WDChartParameters.kAire:r=new WDAreaChartSeriesRenderer(this.m_oGraphe,this,i);break;case WDChartParameters.kHistoHorizontal:case WDChartParameters.kHistoEmpileHorizontal:case WDChartParameters.kHisto:case WDChartParameters.kHistoEmpile:r=new WDBarChartSeriesRenderer(this.m_oGraphe,this,i);break;case WDChartParameters.kWaterfall:r=new WDWaterfallChartSeriesRenderer(this.m_oGraphe,this,i);break;case WDChartParameters.kBulle:r=new WDBubbleChartSeriesRenderer(this.m_oGraphe,this,i);break;case WDChartParameters.kNuage:r=new WDScatterChartSeriesRenderer(this.m_oGraphe,this,i);break;case WDChartParameters.kChandelier:case WDChartParameters.kBarCharts:case WDChartParameters.kMinMax:r=new WDCandleStickChartSeriesRenderer(this.m_oGraphe,this,i);break;case WDChartParameters.kRadar:r=new WDRadarChartSeriesRenderer(this.m_oGraphe,this,i);break;case WDChartParameters.kHeatMap:r=new WDHeatmapChartSeriesRenderer(this.m_oGraphe,this,i)}f[u]=this.m_mapSeriesRenderer[u]=r}this.m_mapSeriesRenderer[u].m_oModele=this.m_oGraphe.m_oModele}h=this;clWDUtil.bForEachIn(this.m_mapSeriesRenderer,function(n){return f[n]||delete h.m_mapSeriesRenderer[n],!0});o=t.findFromId(t.m_domBaliseSVG,"groupe-series");o.length&&!this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()&&t.empty(o)};WDXYChartRenderer.prototype.RecreerRenderer=function(){this.m_params.m_oAxeYSecondaire&&(nAffichage=WDChartView.ms_nDessin1erAffichage);this.m_oOrigineSansZoom=undefined};WDXYChartRenderer.prototype.getSeriesRenderer=function(n){return this.m_mapSeriesRenderer[n]};WDXYChartRenderer.prototype.getNbLegendLabels=function(){for(var t=0,n=0;n<this.nGetNbSeries();n+=this.nGetPasSerie(this.getSeriesAt(n,!1))){if(n+this.nGetPasSerie(this.getSeriesAt(n,!1))>this.nGetNbSeries())break;++t}return t};WDXYChartRenderer.prototype.getLegendColorAt=function(n){return this.m_oModele.getSeriesColor(n)};WDXYChartRenderer.prototype.getLegendLabelAt=function(n){for(var i,r=0,t=0;t<this.nGetNbSeries();t+=this.nGetPasSerie(this.getSeriesAt(t,!1)))if(++r,r>n)break;return i=this.getSeriesAt(t,!1),i?i.m_sLibelle:""};WDXYChartRenderer.prototype.convertSeriesIndexSelonPasToModel=function(n){for(var i=0,r,t=0;t<this.nGetNbSeries();t+=r=this.nGetPasSerie(this.getSeriesAt(t,!1)))if(++i,i>n)break;return t};WDXYChartRenderer.prototype.draw=function(){this.m_oModele.createAxis();WDChartRenderer.prototype.draw.apply(this,arguments)};WDXYChartRenderer.prototype.drawChart=function(n,t,i){var h,a,o,r,c,p,w,f,e,u,s,l;if(WDChartRenderer.prototype.drawChart.apply(this,arguments),h=this.m_oModele.m_tabSeries.length,h===0||h<this.nGetPasSerie(this.m_oModele.m_tabSeries[0])){n.empty(i);return}if(this.m_rectChart=t.tweenRectChart(i,this.m_rectChart),t.tweenRedessineAxes(i,!0)){if(!this.prepareRendering(n,t,i,this.m_params))return;if(this.drawGrids(n,this.m_params,this.m_rectAxis,i)===!1)return}a=this.isClipOnAxisRectBeforeDrawingChart();a&&n.clipRect(this.m_rectAxis,"clip-axes");var v=n.g(i,"groupe-series"),h=this.m_oModele.m_tabSeries.length,r=0,u;if(Object.keys(this.m_mapSeriesRenderer).length>1)for(r=0;r<h;r+=u?o.nGetPasSerie(u):1)u=this.m_oModele.getSeriesAt(r,!1),o=this.getSeriesRenderer(u.getChartType()),c=n.g(v,"groupe-serie-"+r),this.m_oGraphe.m_oVue.bEstSerieMasquee(r)&&(!this.m_oGraphe.m_oVue.m_oAnimator.bAnimationEnCours()||this.m_params.m_nDureeAnimation==0)||o.drawSeries(n,c,r,u,this.m_params),e=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+r),e.length&&(p=WDChartListener.bind(o.m_ProtoLegendListener,this.m_oGraphe,e,c,r));else{var s=this.m_oModele.getSeriesAt(0,!1).getChartType(),o=this.getSeriesRenderer(s),y=s==WDChartParameters.kCourbe||s==WDChartParameters.kAire;for(r=y?h-1:0;y?r>=0:r<h;y?r-=u?o.nGetPasSerie(u):1:r+=u?o.nGetPasSerie(u):1)u=this.m_oModele.getSeriesAt(r,!1),c=n.g(v,"groupe-serie-"+r),this.m_oGraphe.m_oVue.bEstSerieMasquee(r)&&(!this.m_oGraphe.m_oVue.m_oAnimator.bAnimationEnCours()||this.m_params.m_nDureeAnimation==0)||o.drawSeries(n,c,r,u,this.m_params),e=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+r),e.length&&(p=WDChartListener.bind(o.m_ProtoLegendListener,this.m_oGraphe,e,c,r))}for(f=h;(w=n.findFromId(v,"groupe-serie-"+f)).length>0;++f)n.remove(w),e=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+f),e.length&&n.remove(e),l=n.findFromId(n.m_domBaliseSVG,"barre-texte-"+f),l.length&&n.remove(l);for(f=0;f<this.m_oModele.m_tabSeries.length;f++)(u=this.m_oModele.getSeriesAt(f),s=u.getChartType(),s!=WDChartParameters.kHistoHorizontal&&s!=WDChartParameters.kHistoEmpileHorizontal&&s!=WDChartParameters.kHisto&&s!=WDChartParameters.kHistoEmpile)&&(l=n.findFromId(n.m_domBaliseSVG,"barre-texte-"+f),l.length&&n.remove(l));a&&n.restoreClip();t.tweenRedessineAxes(i,!0)&&this.drawAxis(n,t,i,this.m_params)};WDXYChartRenderer.prototype.isClipOnAxisRectBeforeDrawingChart=function(){return this.m_mapSeriesRenderer[WDChartParameters.kHistoHorizontal]||this.m_mapSeriesRenderer[WDChartParameters.kHistoEmpileHorizontal]||this.m_mapSeriesRenderer[WDChartParameters.kHisto]||this.m_mapSeriesRenderer[WDChartParameters.kHistoEmpile]||this.m_mapSeriesRenderer[WDChartParameters.kMinMax]?!this.m_oModele.m_oParametres.isDisplayValuesLabel():!0};WDXYChartRenderer.prototype.getDrawnValuesCount=function(n,t){var i=0,r,u;return(this.m_mapSeriesRenderer[WDChartParameters.kHeatMap]||this.m_mapSeriesRenderer[WDChartParameters.kNuage]||this.m_mapSeriesRenderer[WDChartParameters.kBulle])&&(i=n),r=Math.floor(t.m_dMinValue),u=Math.ceil(t.m_dMaxValue),Math.max(i,Math.min(n,u-r+1))};WDXYChartRenderer.prototype.getYOriginValue=function(n){var t=this.getAxisRendererForType(n?EAxisType.Y2:EAxisType.Y);return t?t.m_axis.m_dOriginValue:0};WDXYChartRenderer.prototype.getXOriginValue=function(n){var t=this.getAxisRendererForType(n?EAxisType.X2:EAxisType.X);return t?t.m_axis.m_dOriginValue:0};WDXYChartRenderer.prototype.getFirstDrawnCategoryIndex=function(n){var t=n.m_dOriginValue;return this.m_timeScale!=ETimeScale.NONE?this.m_oModele.getCategoryIndexForTime(Math.floor(t)):Math.floor(t)};WDXYChartRenderer.prototype.getCategoryDrawingPositionX=function(n,t){if(n-=this.getFirstDrawnCategoryIndex(this.m_oModele.getAxisByType(EAxisType.X)),this.m_timeScale!=ETimeScale.NONE){var i=this.m_oModele.m_oCategories,r=i.getTimeInMillisAt(n)-i.getMinValueInMillis();return this.getDrawingPositionX(r,t)}return this.getDrawingPositionX(n,t)};WDXYChartRenderer.prototype.getDrawingPositionX=function(n,t){return this.nGetXOrigin(t)+Math.ceil(n*this.dGetXPixelsPerUnit(t))};WDXYChartRenderer.prototype.getDrawingPositionY=function(n,t){return this.nGetYOrigin(t)-Math.ceil(n*this.dGetYPixelsPerUnit(t))};WDXYChartRenderer.prototype.getCategoryDrawingPositionY=function(n,t,i){if(n-=this.getFirstDrawnCategoryIndex(this.m_oModele.getAxisByType(EAxisType.X)),this.m_timeScale!=ETimeScale.NONE){var r=this.m_oModele.m_oCategories,u=r.getTimeInMillisAt(n)-r.getMinValueInMillis();return i?this.getDrawingPositionY(u,t):this.nGetYOrigin(t)-Math.ceil(u*this.dGetYPixelsPerUnit(t))}return i?this.getDrawingPositionY(n,t):this.nGetYOrigin(t)-Math.ceil(n*this.dGetXPixelsPerUnit(t))};WDXYChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r){WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments);var u=this;clWDUtil.bForEachIn(this.m_mapSeriesRenderer,function(f){return u.m_mapSeriesRenderer[f].surbrillanceSerieDepuisMire(n,t,i,r),!0})};WDXYChartRenderer.prototype.drawAxis=function(n,t,i,r){var e=n.g(i,"groupe-axes"),o,u,f,s;if(n.empty(e),this.m_oModele.hasAuMoinsUneSerieNonVide())for(o=this.m_oModele.m_lstAxis.length,u=0;u<o;++u)f=this.m_tabAxisRenderer[u],r.isAxisVisible(f.m_axis)&&(s=n.g(e,"groupe-axe-"+u),f.draw(n,s,r,this.m_rectChart,this.m_rectAxis,this.m_nXOrigin,this.m_nYOrigin,this.m_oPaint))};WDXYChartRenderer.prototype.drawGrids=function(n,t,i,r){var u=0,f=n.g(r,"groupe-grids"),g,nt,e,v,it,rt;if(n.empty(f),n.SetAntiAliasing(!1,f),this.m_oModele.hasAuMoinsUneSerieNonVide()){var ut=WDPaintCSS.oGetInfoCSS(t.m_sClasseLibelle,"0","lineHeight"),k=parseInt10(ut.lineHeight),o=undefined,h=undefined,p=undefined,y=undefined,l=undefined,a=t.m_bAxeXHorizontal?this.getAxisRendererForType(EAxisType.X):this.getAxisRendererForType(EAxisType.Y);if(a){h=a.getNbGraduations();p=a.getAxisSize(i);y=a.getGraduationSize(p);var s=i.getLeft(),ft=i.getTop(),et=i.getBottom(),d=s;for(u=0;u<h;++u){if(this.m_oGraphe.m_oParametres.m_eType!=WDChartParameters.kHeatMap&&u>0&&Math.abs(s-d)<=5+k){s+=y;continue}d=s;l=s!=this.nGetXOrigin(a.m_axis.isSecondaryAxis())||!t.isAxisVisible(a.m_axis);o=n.line(f,"grid-vert-"+u);this.m_oPaint.setDashSelonType(1,t.getVerticalGridStyle(),!0);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,l&&t.isVerticalGridShown()?1:0);n.drawLine(o,s,ft,s,et,this.m_oPaint,!1);s+=y}for(v=h;(o=n.findFromId(f,"grid-vert-"+v)).length>0;++v)n.remove(o);g=n.line(f,"grid-horiz-haut");nt=n.line(f,"grid-horiz-bas");this.m_oPaint.setDashSelonType(1,t.getHorizontalGridStyle(),!0);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,t.isVerticalGridShown()||t.isHorizontalGridShown()?1:0);n.drawLine(g,i.getLeft(),i.getTop(),i.getRight(),i.getTop(),this.m_oPaint,!1);this.m_oPaint.setDashSelonType(1,t.getHorizontalGridStyle(),!0);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,t.isVerticalGridShown()||t.isHorizontalGridShown()?1:0);n.drawLine(nt,i.getLeft(),i.getBottom(),i.getRight(),i.getBottom(),this.m_oPaint,!1)}if(e=t.m_bAxeXHorizontal?this.getAxisRendererForType(EAxisType.Y):this.getAxisRendererForType(EAxisType.X),e){h=e.getNbGraduations();p=e.getAxisSize(i);y=e.getGraduationSize(p);var c=i.getBottom(),ot=i.getLeft(),st=i.getRight(),tt=c,w=0,b=!1;for(u=0;u<h;++u){if(l=c!=this.nGetYOrigin(e.m_axis.isSecondaryAxis())||!t.isAxisVisible(e.m_axis),this.m_oGraphe.m_oParametres.m_eType!=WDChartParameters.kHeatMap&&u>0&&Math.abs(c-tt)<=5+k?(l=!1,b||++w):(tt=c,!b&&w>0&&(b=!0)),u>0&&u==h-1&&!l&&(this.m_params.m_oAxeY.m_dPasMin||0)<this.m_params.m_oAxeY.m_dPas&&(this.m_params.m_oAxeY.m_dPasMin=this.m_params.m_oAxeY.m_dPas,this.m_params.m_oAxeY.m_dPas=e.m_dStep*(1+w),this.m_params.m_oAxeY.m_dPas>=e.m_dStep))return this.drawChart(n,this.m_oGraphe.m_oVue.m_oAnimator,this.m_domGroupeSeries),!1;o=n.line(f,"grid-horiz-"+u);this.m_oPaint.setDashSelonType(1,t.getHorizontalGridStyle(),!0);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,l&&t.isHorizontalGridShown()?1:0);n.drawLine(o,ot,c,st,c,this.m_oPaint,!1);c-=y}for(v=h;(o=n.findFromId(f,"grid-horiz-"+v)).length>0;++v)n.remove(o);it=n.line(f,"grid-vert-gauche");rt=n.line(f,"grid-vert-droite");this.m_oPaint.setDashSelonType(1,t.getVerticalGridStyle(),!0);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,t.isVerticalGridShown()||t.isHorizontalGridShown()?1:0);n.drawLine(it,i.getLeft(),i.getTop(),i.getLeft(),i.getBottom(),this.m_oPaint,!1);this.m_oPaint.setDashSelonType(1,t.getVerticalGridStyle(),!0);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,t.isVerticalGridShown()||t.isHorizontalGridShown()?1:0);n.drawLine(rt,i.getRight(),i.getTop(),i.getRight(),i.getBottom(),this.m_oPaint,!1)}}};WDXYChartRenderer.prototype.adjustAxisSizeBeforePreparingRenderer=function(n){for(var t,u,f,i,r=0;r<this.m_oModele.m_lstAxis.length;++r)t=this.m_oModele.m_lstAxis[r],u=n.getAxisTitle(t),u&&(f=WDPaintCSS.oGetInfoCSS(n.m_sClasseAxe,u,"lineHeight"),i=parseInt10(f.lineHeight),t.m_orientation==EAxisOrientation.HORIZONTAL?t.isSecondaryAxis()?this.m_rectAxis.setLocation(this.m_rectAxis.getLeft(),this.m_rectAxis.getTop()+i+IWDChartConstant.MARGIN_AXIS_TITLE_SECONDARY,!1):this.m_rectAxis.setSize(this.m_rectAxis.getWidth(),this.m_rectAxis.getHeight()-(i+IWDChartConstant.MARGIN_AXIS_TITLE)):t.m_orientation==EAxisOrientation.VERTICAL&&(t.isSecondaryAxis()?this.m_rectAxis.setSize(this.m_rectAxis.getWidth()-(i+IWDChartConstant.MARGIN_AXIS_TITLE_SECONDARY),this.m_rectAxis.getHeight()):this.m_rectAxis.setLocation(this.m_rectAxis.getLeft()+IWDChartConstant.MARGIN_AXIS_TITLE+i,this.m_rectAxis.getTop(),!1)))};WDXYChartRenderer.prototype.prepareRendering=function(n,t,i,r){var s,tt,v,k,it,d,g,e,u,f,rt,p,nt,a,w,ut,st;this.m_mapSeriesRenderer[WDChartParameters.kBulle]&&(this.CalculeBorneZ(),this.m_dRayonMaxBulle=this.__dCalculeRayonMaxBulle(this.m_params));s=0;this.m_rectAxis.set(this.m_rectChart);this.m_timeScale=this.m_oGraphe.m_oModele.m_oCategories.bEchelleTemporelle()&&this.m_oGraphe.m_oModele.m_oCategories.m_tabValeurDateHeure.length?this.m_oGraphe.m_oModele.m_oCategories.bEstTypeDate()?ETimeScale.DATE:this.m_oGraphe.m_oModele.m_oCategories.bEstTypeDateHeure()?ETimeScale.DATETIME:this.m_oGraphe.m_oModele.m_oCategories.bEstTypeDuree()?ETimeScale.DUREE:ETimeScale.TIME:ETimeScale.NONE;this.adjustAxisSizeBeforePreparingRenderer(r,this.m_oPaint);var o=0,y=0,c=0,h=0,l=this.m_oModele.m_lstAxis.length;if(!this.m_tabAxisRenderer||this.m_tabAxisRenderer.length!=l)for(this.m_tabAxisRenderer=undefined,delete this.m_tabAxisRenderer,this.m_tabAxisRenderer=[],s=0;s<l;++s)this.m_tabAxisRenderer[s]=this.createAxisRenderer();for(tt=!this.m_oZoom&&r.m_eRepereOrthonorme!=ERepereGrapheOrthonorme.ergNonOrthonorme,v=!1,v=!1;tt?v<2:v<1;v++){if(tt){var ht=Number.POSITIVE_INFINITY,ct=Number.NEGATIVE_INFINITY,b=Number.POSITIVE_INFINITY;for(k=!1;k<2;k++)for(e=0;e<l;++e){f=this.m_oModele.m_lstAxis[e];switch(f.m_type){case EAxisType.X:case EAxisType.Y:break;case EAxisType.Y2:if(r.m_eRepereOrthonorme===ERepereGrapheOrthonorme.ergXYSecondaireOrthonorme)break;case EAxisType.Z:default:continue}k?(it=f.getAxisSize(this.m_rectAxis)/(f.m_dMaxValue-f.m_dMinValue),f.m_dMinValue*=it/b,f.m_dMaxValue*=it/b):b=Math.min(b,f.getAxisSize(this.m_rectAxis)/(f.m_dMaxValue-f.m_dMinValue))}}for(e=0;e<l;++e)f=this.m_oModele.m_lstAxis[e],u=this.m_tabAxisRenderer[e],u.prepare(f,r,this.m_rectAxis,this.m_oPaint,f.isDisplayCategories()?this.m_timeScale:ETimeScale.NONE);if(!v){for(e=0;e<l;++e)if(u=this.m_tabAxisRenderer[e],u.m_axis.m_orientation==EAxisOrientation.HORIZONTAL&&!u.m_axis.isSecondaryAxis()){if(u.m_tabGraduationLabels.join("").length==0)for(d=0;d<l;++d)g=this.m_tabAxisRenderer[d],g.m_axis.m_orientation==EAxisOrientation.VERTICAL&&g.m_nNbNegativeGraduations==0&&(g.m_dBottomOverflow=0);break}for(e=0;e<l;++e)u=this.m_tabAxisRenderer[e],u.m_dLeftOverflow>o&&(o=u.m_dLeftOverflow),u.m_dRightOverflow>y&&(y=u.m_dRightOverflow),u.m_dTopOverflow>c&&(c=u.m_dTopOverflow),u.m_dBottomOverflow>h&&(h=u.m_dBottomOverflow);for(o=Math.ceil(o),y=Math.ceil(y),c=Math.ceil(c),h=Math.ceil(h),s=0;s<l;++s)(u=this.m_tabAxisRenderer[s],f=u.m_axis,f.m_type!==EAxisType.Z)&&(rt=u.m_nNbNegativeGraduations,f.isSecondaryAxis()||f.m_orientation!=EAxisOrientation.HORIZONTAL?(a=this.m_rectAxis.getBottom(),rt==0?a-=h:(w=u.getGraduationSize(this.m_rectAxis.getHeight()-u.m_dTopOverflow-u.m_dBottomOverflow)*(u.m_nNbNegativeGraduations-(u.m_nNbPositiveGraduations===0?1:0))+u.m_dBottomOverflow,w<=h?(ut=w-u.m_dBottomOverflow,ut>c?(a-=w,h=u.m_dBottomOverflow):(a-=c,c-=ut)):(a-=w,h=u.m_dBottomOverflow)),f.isSecondaryAxis()?this.m_nY2Origin=Math.ceil(a):this.m_nYOrigin=Math.ceil(a)):(p=this.m_rectAxis.getLeft(),rt==0?p+=o:(nt=u.getGraduationSize(this.m_rectAxis.getWidth()-u.m_dLeftOverflow-u.m_dRightOverflow)*u.m_nNbNegativeGraduations+u.m_dLeftOverflow,nt<=o?(p+=o,o-=nt-u.m_dLeftOverflow):(p+=nt,o=u.m_dLeftOverflow)),this.m_nX2Origin=this.m_nXOrigin=Math.ceil(p)));this.m_rectAxis.set(this.m_rectAxis.getLeft()+o,this.m_rectAxis.getTop()+c,this.m_rectAxis.getRight()-y,this.m_rectAxis.getBottom()-h)}}this.adjustAxisSizeBeforeDrawing();var ft=this.getAxisRendererForType(EAxisType.X),et=this.getAxisRendererForType(EAxisType.Y),ot=this.getAxisRendererForType(EAxisType.Y2);return!ft||!et?!1:(this.m_dXPixelsPerUnit=ft.getPixelsPerUnit(this.m_rectAxis),this.m_dYPixelsPerUnit=et.getPixelsPerUnit(this.m_rectAxis),ot&&(this.m_dY2PixelsPerUnit=ot.getPixelsPerUnit(this.m_rectAxis)),this.m_dX2PixelsPerUnit=this.m_dXPixelsPerUnit,st=this,clWDUtil.bForEachIn(this.m_mapSeriesRenderer,function(u){return st.m_mapSeriesRenderer[u].prepareRendering(n,t,i,r),!0}),!0)};WDXYChartRenderer.prototype.adjustAxisSizeBeforeDrawing=function(){for(var t,i,n,f,r,e=this.m_tabAxisRenderer.length,u=0;u<e;++u)(t=this.m_tabAxisRenderer[u],i=t.m_axis,i.m_type!==EAxisType.Z)&&(n=i.m_orientation==EAxisOrientation.HORIZONTAL?this.m_rectAxis.getWidth():this.m_rectAxis.getHeight(),f=n,n=t.getGraduationSize(n)*(Math.max(1,t.getNbGraduations())-1),n!==0)&&(r=f-n,r!=0&&(i.m_orientation==EAxisOrientation.HORIZONTAL?this.m_rectAxis.setRight(this.m_rectAxis.getRight()-r):this.m_rectAxis.setTop(this.m_rectAxis.getTop()+r)))};WDXYChartRenderer.prototype.getAxisRendererForType=function(n){var r,t,i;if(this.m_tabAxisRenderer!=null)for(r=this.m_tabAxisRenderer.length,t=0;t<r;++t)if(i=this.m_tabAxisRenderer[t],i.m_axis.m_type==n)return i;return undefined};WDXYChartRenderer.prototype.drawMire=function(n,t,i,r,u,f,e){params=this.m_params;var l=WDChartRenderer.prototype.s_m_nProfileMireForce||(params.m_bMire?params.m_bMireMultiple?PROFILMIREMULTIPLE:PROFILMIRESIMPLE:PROFILBULLESEULE),c=this,s=!1,v=this.m_oGraphe.m_oModele,a=v.m_tabSeries.length,h,e,o;if(l===PROFILMIREMULTIPLE)for(o=0;o<a;o+=c.nGetPasSerie(this.getSeriesAt(o,!1)))if(h=this.getSeriesAt(o,!1),e=h.getChartType(),(e==WDChartParameters.kCourbe||e==WDChartParameters.kRadar||e==WDChartParameters.kAire||e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHistoEmpileHorizontal)&&(s=WDChartRenderer.prototype.drawMire.apply(c,[n,t,i,r,u,f,h,o])))break;if(s)return s;for(o=0;o<a;o+=c.nGetPasSerie(this.getSeriesAt(o,!1)))if((h=this.getSeriesAt(o,!1),e=h.getChartType(),l!==PROFILMIREMULTIPLE||e!=WDChartParameters.kCourbe&&e!=WDChartParameters.kRadar&&e!=WDChartParameters.kAire&&e!=WDChartParameters.kHistoEmpile&&e!=WDChartParameters.kHistoEmpileHorizontal)&&(s=WDChartRenderer.prototype.drawMire.apply(c,[n,t,i,r,u,f,h,o])))break;return s?s:WDChartRenderer.prototype.drawMire.apply(c,[n,t,i,r,u,f])};WDXYChartRenderer.prototype.nGetPasSerie=function(n){return this.m_mapSeriesRenderer[n.getChartType()]?this.m_mapSeriesRenderer[n.getChartType()].nGetPasSerie(n):WDChartRenderer.prototype.nGetPasSerie.apply(this,arguments)};WDXYChartRenderer.prototype.__dCalculeRayonMaxBulle=function(n){var t=this.m_rectChart,i=Math.min(t.m_nRight-t.m_nLeft,t.m_nBottom-t.m_nTop),r;return i/=10,r=n.m_nEchelleTailleBulle===undefined?1:n.m_nEchelleTailleBulle/100,i*r};WDXYChartRenderer.prototype.CalculeBorneZ=function(){for(var f,t,i,o=this.m_oModele.m_tabSeries.length,n,r=0;(n=this.m_oModele.getSeriesAt(r,!1))||r<o;++r)if(n&&n.getChartType()==WDChartParameters.kBulle&&(r+=2,n=this.m_oModele.getSeriesAt(r,!1),n)){var h=this.m_oModele.getAxisByType(EAxisType.Z),e=n.getNbValues(),s=e,u=0;for(f=0;f<s;++f,++u)if(!(u<0)){if(u>=e)break;(i=n.getValueAtWithNull(u),i!==undefined&&i!==IWDChartConstant.NULL_VALUE)&&(t===undefined||i>t)&&(t=i)}}this.m_dValeurMaxZ=t=Math.max(t,0)};WDXYChartAxisRenderer.prototype=new WDChartAxisRenderer;WDXYChartAxisRenderer.prototype.constructor=WDXYChartAxisRenderer;WDXYChartAxisRenderer.prototype.isDrawLabelsBetweenGraduations=function(){if(this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kHistoHorizontal]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kHistoEmpileHorizontal]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kHisto]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kHistoEmpile]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kWaterfall]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kChandelier]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kMinMax]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kBarCharts]){var n=this.m_axis.m_type;return this.m_dStep==1&&(n==EAxisType.X||n==EAxisType.X2)}return!1};WDXYChartAxisRenderer.prototype.prepare=function(n,t,i){var s,f,h,e,c,o;if(WDChartAxisRenderer.prototype.prepare.apply(this,arguments),(this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kHistoHorizontal]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kHistoEmpileHorizontal]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kHisto]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kHistoEmpile]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kWaterfall]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kChandelier]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kMinMax]||this.m_chartRenderer.m_mapSeriesRenderer[WDChartParameters.kBarCharts])&&n.isYAxis()&&t.isDisplayValuesLabel()){var r=n.m_dMinValue,u=n.m_dMaxValue,l=WDPaintCSS.oGetInfoCSS(t.m_sClasseLibelle,Math.abs(r)>Math.abs(u)?r:u,["lineHeight","width"]),a=parseInt10(l.lineHeight),v=parseInt10(l.width),y=this.getGraduationSize(this.getAxisSize(i));u>0&&(s=(this.m_nNbPositiveGraduations-1)*y,n.m_orientation==EAxisOrientation.HORIZONTAL?(f=u,r>0&&(f-=r),e=Math.ceil(f*this.getPixelsPerUnit(i))+v,e>s&&(this.m_dRightOverflow+=e-s)):(f=u,r>0&&(f-=r),o=Math.ceil(f*this.getPixelsPerUnit(i))+a,o>s&&(this.m_dTopOverflow+=o-s)));r<0&&(h=this.m_nNbNegativeGraduations*y,n.m_orientation==EAxisOrientation.HORIZONTAL?(e=Math.ceil(Math.abs(r)*this.getPixelsPerUnit(i))+v,e>h&&(this.m_dLeftOverflow+=e-h)):(c=r,u<0&&(c-=u),o=Math.ceil(Math.abs(c)*this.getPixelsPerUnit(i))+a,o>h&&(this.m_dBottomOverflow+=o-h)))}};WDXYChartSeriesRenderer.bParametresSupportes=function(){return this.m_chartRenderer.bParametresSupportes.apply(this.m_chartRenderer,arguments)};WDXYChartSeriesRenderer.prototype=new JSONPOO;WDXYChartSeriesRenderer.prototype.constructor=WDXYChartSeriesRenderer;WDXYChartSeriesRenderer.prototype.getChartType=function(){return this.m_model.getChartType()};WDXYChartSeriesRenderer.prototype.nGetPasSerie=function(){return 1};WDXYChartSeriesRenderer.prototype.prepareRendering=function(){return!0};WDXYChartSeriesRenderer.prototype.getValueDrawingPosition=abstract;WDXYChartSeriesRenderer.prototype.drawSeries=abstract;WDXYChartSeriesRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i){if(t!==undefined){var u=n.g("groupe-serie-"+t),r=u.find("path");r.length&&r.css("strokeWidth",parseInt10(r.attr("stroke-width"))+(i?1:0))}};WDSunburstChartRenderer.nGetIndicePart=function(){return WDPieChartRenderer.prototype.nGetIndicePart.apply(this,arguments)};WDSunburstChartRenderer.bParametresSupportes=function(n,t){return WDPieChartRenderer.bParametresSupportes(n,t)?!0:!1};WDSunburstChartRenderer.prototype=new WDPieChartRenderer;WDSunburstChartRenderer.prototype.constructor=WDSunburstChartRenderer;WDSunburstChartRenderer.prototype.RecreerRenderer=function(){WDPieChartRenderer.prototype.RecreerRenderer.apply(this,arguments)};WDSunburstChartRenderer.prototype.AppelAsync=function(n){return requestAnimationFrame(n)};WDSunburstChartRenderer.prototype.AnnuleAppelAsync=function(n){cancelAnimationFrame(n)};WDSunburstChartRenderer.prototype.AppelAsyncIdle=function(n){return window.requestIdleCallback?requestIdleCallback(n):this.AppelAsync(n)};WDSunburstChartRenderer.prototype.AnnuleAppelAsyncIdle=function(n){cancelIdleCallback(n)};WDSunburstChartRenderer.prototype.surbrillanceSerieDepuisMire=function(){};WDSunburstChartRenderer.nGetIndicePart=function(n,t){return parseInt10(n.getId(t).substr(n.getId(t).lastIndexOf("-")+1))};WDSunburstChartRenderer.prototype.drawLegend=function(){this.m_oPaint.raz()};WDSunburstChartRenderer.prototype.Init=function(){WDPieChartRenderer.prototype.Init.apply(this,arguments)};WDSunburstChartRenderer.prototype.ecouteLegende=function(){return undefined};WDSunburstChartRenderer._CreeArbreDepuisTab=function(n,t,i,r){var f,u;if(!t.length)return i.value=r,i.indiceProg=n,i.depth;for(f=t[0],u=0;i.children&&u<i.children.length;++u)if(i.children[u].name==f)return WDSunburstChartRenderer._CreeArbreDepuisTab(n,t.slice(1),i.children[u],r);return i.children&&i.children.length||(i.children=[]),i.children.push({name:f,parent:i,indice:i.children.length,fullName:(i.name?i.name+"\t":"")+f}),WDSunburstChartRenderer._CreeArbreDepuisTab(n,t.slice(1),i.children[i.children.length-1],r)};WDSunburstChartRenderer._calculSommePronfondeur=function(n,t){var u=t||0,i,r;if(n.children){for(i=0,r=0;n.children&&r<n.children.length;++r)i+=WDSunburstChartRenderer._calculSommePronfondeur(n.children[r],u+1);(n.value==undefined||i>=n.value)&&(n.value=i)}return n.depth=u,n.value};WDSunburstChartRenderer.prototype._calculExcentrage=function(n,t){var i,r;if(n.nPartOffset=this.m_oModele.getPartOffset(n.indiceProg,this.m_params.m_nExcentrageGlobal),n.nPartOffsetCumul=(t||0)+n.nPartOffset,i=n.nPartOffsetCumul,n.children)for(r=0;n.children&&r<n.children.length;++r)i=Math.max(i,this._calculExcentrage(n.children[r],n.nPartOffsetCumul));return i};WDSunburstChartRenderer._calculHauteur=function(n){var t,i;if(!n.children)return n.height=0,n.depth;for(t=0,i=0;n.children&&i<n.children.length;++i)t=Math.max(t,WDSunburstChartRenderer._calculHauteur(n.children[i]));return n.height=t-n.depth,t};WDSunburstChartRenderer.prototype.prepareDessin=function(n,t,i,r){var u=this,f=this.dPourcentDonut,c=t.x0,l=t.x1-t.x0,o=f*u.m_nRadius+(1-f)*u.m_nRadius/u.oArbreDonnees.height*(t.y0-u.m_nRadius/(u.oArbreDonnees.height+1))/(u.m_nRadius/(u.oArbreDonnees.height+1)),s=f*u.m_nRadius+(1-f)*u.m_nRadius/u.oArbreDonnees.height*(t.y1-u.m_nRadius/(u.oArbreDonnees.height+1))/(u.m_nRadius/(u.oArbreDonnees.height+1)),a,v,e,y,h;if(u.m_params.m_nNiveauMaxSunburst&&(n.depth-u.racineCourante.depth>u.m_params.m_nNiveauMaxSunburst||n.depth<=u.racineCourante.depth?s=o=f*u.m_nRadius:(a=(s-o)*(u.oArbreDonnees.height-u.m_params.m_nNiveauMaxSunburst-u.racineCourante.depth),a>0&&(v=a/u.m_params.m_nNiveauMaxSunburst,s+=.5*v*(n.depth-u.racineCourante.depth),o+=.5*v*(n.depth-u.racineCourante.depth-1)))),!r&&n.nPartOffsetCumul>0){u.oArbreDonnees.cacheExcentrage||(u.oArbreDonnees.cacheExcentrage={});function p(n){function t(r,u,f,e){var o,h,s;for(e||(o=i(r,u,f),u=o.dAngleDepart,f=o.dAngleArc,n[r.fullName]=o),h=u,s=0;r.children&&s<r.children.length;++s){var c=r.children[s],a=c.value/r.value,l=f*a;t(c,h,l,!1);h+=l}}function i(n,t,i){var r=0,o,e;return n.nPartOffset>0&&(o=n.nPartOffset/2,e=n.nPartOffsetCumul,e+=n.parent!=u.racineCourante?f*u.m_nRadius+(1-f)*u.m_nRadius/u.oArbreDonnees.height*(n.parent.y0-u.m_nRadius/(u.oArbreDonnees.height+1))/(u.m_nRadius/(u.oArbreDonnees.height+1)):f*u.m_nRadius,r=o/e,t+=r,i-=2*r),{dAngleDepart:t,dAngleArc:i}}return n={},t(u.racineCourante,0,Math.PI*2,!0),n}if(e=u.oArbreDonnees.cacheExcentrage[u.racineCourante.fullName]=u.oArbreDonnees.cacheExcentrage[u.racineCourante.fullName]||p(u.oArbreDonnees.cacheExcentrage[u.racineCourante.fullName]),i!==undefined&&u.racinePrecedente&&u.oArbreDonnees.cacheExcentrage[u.racinePrecedente.fullName]&&u.oArbreDonnees.cacheExcentrage[u.racinePrecedente.fullName][n.fullName]){if(!e[n.fullName]){for(y=!1,h=n;h;){if(h==u.racineCourante){y=!0;break}h=h.parent}e[n.fullName]=y?{dAngleDepart:.01,dAngleArc:Math.PI*2}:{dAngleDepart:Math.PI*2,dAngleArc:.01}}c=WDChartAnimation.tween(u.oArbreDonnees.cacheExcentrage[u.racinePrecedente.fullName][n.fullName].dAngleDepart,e[n.fullName].dAngleDepart,i);l=WDChartAnimation.tween(u.oArbreDonnees.cacheExcentrage[u.racinePrecedente.fullName][n.fullName].dAngleArc,e[n.fullName].dAngleArc,i)}else e[n.fullName]&&(c=e[n.fullName].dAngleDepart,l=e[n.fullName].dAngleArc);o+=n.nPartOffsetCumul;s+=n.nPartOffsetCumul}return{startAngle:c,endAngle:c+l,innerRadius:o,outerRadius:s}};WDSunburstChartRenderer.prototype.prepareDessinArc=function(n,t,i){var r=this.prepareDessin(n,t,i),u=this,e=new WDRect(u.m_nCenterX-r.outerRadius,u.m_nCenterY-r.outerRadius,u.m_nCenterX+r.outerRadius,u.m_nCenterY+r.outerRadius),f=new stPath(e,{rDonut:r.innerRadius,start:Number(r.startAngle).toDeg(),startAngle:Number(r.startAngle).toDeg(),sweep:Number(r.endAngle-r.startAngle).toDeg()});return f.options.startAngle+f.options.sweep==360&&(f.options.sweep-=.001),f};WDSunburstChartRenderer.prototype.__bAnimNowDrawEnCours=function(n){var t=this.jqBaliseAnimArc&&this.jqBaliseAnimArc.queue("fx").length||this.jqBaliseAnimTexte&&this.jqBaliseAnimTexte.queue("fx").length;return n&&t&&(this.jqBaliseAnimArc&&this.jqBaliseAnimArc.clearQueue().finish(),this.jqBaliseAnimTexte&&this.jqBaliseAnimTexte.clearQueue().finish()),t};WDSunburstChartRenderer.prototype.drawChart=function(n,t,i){function l(t,i,f,e){(r.__bAnimNowDrawEnCours(e),t.children)&&(r.racinePrecedente=r.racineCourante,r.racineCourante=t,r.rafClick=r.AppelAsync(function(){var t=undefined,e;u(r.oArbreDonnees,function(n){n.target={x0:Math.max(0,Math.min(1,(n.x0-r.racineCourante.x0)/(r.racineCourante.x1-r.racineCourante.x0)))*2*Math.PI,x1:Math.max(0,Math.min(1,(n.x1-r.racineCourante.x0)/(r.racineCourante.x1-r.racineCourante.x0)))*2*Math.PI,y0:Math.max(0,n.y0)-r.m_nRadius/(r.oArbreDonnees.height+1)*r.racineCourante.depth+r.m_nRadius/(r.oArbreDonnees.height+1)*r.racineCourante.depth/r.racineCourante.height*(n.depth-1-r.racineCourante.depth),y1:Math.max(0,n.y1)-r.m_nRadius/(r.oArbreDonnees.height+1)*r.racineCourante.depth+r.m_nRadius/(r.oArbreDonnees.height+1)*r.racineCourante.depth/r.racineCourante.height*(n.depth-r.racineCourante.depth)};n.target.y0>0&&(t===undefined||t>n.target.y0)&&(t=n.target.y0)});var o=f?r.m_params.m_nDureeAnimation:0,s=y.find("path"),h=p.find("text").map(function(){return this.parentNode}),l=h.filter(function(){var n=$(this).wbData("wbGrfNode");return+n.labelRenderer.labelVisible(!0)});l.each(function(){var n=$(this).wbData("wbGrfNode");n.labelRenderer.labelTransform(!0,!0)});h.attr("fill-opacity",0);c.css("cursor",r.racineCourante==r.oArbreDonnees?"":"pointer");e=new WDPaintCSS;s.each(function(){var s=$(this),u=s.wbData("wbGrfNode"),h={},o;for(k in u.current)h[k]=u.current[k];for(var l=+this.getAttribute("fill-opacity"),c=!1,f=u.parent;f;){if(f==r.racineCourante){c=!0;break}f=f.parent}o=+(c&&ut(u.target));this.setAttribute("pointer-events",o?"all":"none");this.style.cursor=u.children&&u.children.length?"pointer":"";this.fStep=function(f){var c,v,a;f=Math.max(.01,f*f);c={};for(k in u.target)u.current[k]=c[k]=WDChartAnimation.tween(h[k],u.target[k],f);c.y0<t&&(c.y0=t);c.y1<t&&(c.y1=t);v=WDChartAnimation.tween(l,o,f);e.setFillOpacity255(255*v);e.setStrokeOption("Opacity",v);a=r.prepareDessinArc(u,c,i?undefined:f);i&&(a.options.startAngle*=f,a.options.start*=f,a.options.sweep*=f);n.drawArc(s,a,e,!1)}});r.jqBaliseAnimArc=r.jqBaliseAnimArc||$("<p/>");r.jqBaliseAnimArc.animate({content:1},{duration:o,easing:"linear",queue:"fx",step:function(n){s.each(function(){this.fStep(n)})}});r.jqBaliseAnimTexte=r.jqBaliseAnimTexte||$("<p/>");r.jqBaliseAnimTexte.delay(f?Math.max(o,600)-250:0,"fx").animate({content:1},{queue:"fx",duration:f?250:0,easing:"linear",step:function(n){n*=n;l.attr("fill-opacity",n)}})}))}function ut(n){return n.y1<=r.m_nRadius&&n.y0>=1&&n.x1>n.x0}function ft(n,t,i,r,u){for(var e=n.children,f,o=-1,s=e.length,h=n.value&&(r-t)/n.value;++o<s;)f=e[o],f.y0=i,f.y1=u,f.x0=t,f.x1=t+=f.value*h}function et(n,t){return function(i){i.children&&ft(i,i.x0,n*(i.depth+1)/t,i.x1,n*(i.depth+2)/t);var r=i.x0,u=i.y0,f=i.x1,e=i.y1;f<r&&(r=f=(r+f)/2);e<u&&(u=e=(u+e)/2);i.x0=r;i.y0=u;i.x1=f;i.y1=e}}function ot(n,t,i){var r=n.height+1;return n.x0=n.y0=0,n.x1=t,n.y1=i/r,u(n,et(i,r),!0),u(n,function(n){n.current=$.extend({},n)},!0),n}function u(n,t,i,r){r||(r={i:0});(i||n.name!="")&&t(n,r.i++);for(var f=0;n.children&&f<n.children.length;++f)if(u(n.children[f],t,i,r)===!1)return!1}var r,h,w,f,b,c,e,o,y,p,it,rt,s;if(WDChartRenderer.prototype.drawChart.apply(this,arguments),r=this,r.__bAnimNowDrawEnCours(!0)){r.rafClickDiffere&&r.AnnuleAppelAsync(r.rafClickDiffere);r.rafClickDiffere=r.AppelAsync(function(){r.drawChart(n,t,i);r.rafClickDiffere=undefined});return}if(h=360,r.bAvecTween&&(h=t.tweenInitialEndAngle(i,360),i.wbData("wbGrfAnimTweenInitialEndAngle",h)),!1!==this.m_oModele.hasPremiereSerieNonVide()){for(w=this.m_oModele.m_oCategories.getNbValues(),r.oArbreDonnees={name:"",height:0,depth:0},f=0,f=0;f<w;++f)WDSunburstChartRenderer._CreeArbreDepuisTab(f,this.m_oModele.m_oCategories.getValueAt(f).split("\t"),r.oArbreDonnees,this.m_oModele.m_tabSeries[0].m_tabValeur[f]);if((r.oArbreDonnees.value=WDSunburstChartRenderer._calculSommePronfondeur(r.oArbreDonnees),r.oArbreDonnees.height=WDSunburstChartRenderer._calculHauteur(r.oArbreDonnees),b=r._calculExcentrage(r.oArbreDonnees),r.bAvecTween&&(this.m_rectChart=t.tweenRectChart(i,this.m_rectChart)),this.m_nCenterX=Math.floor((this.m_rectChart.m_nLeft+this.m_rectChart.m_nRight)/2),this.m_nCenterY=Math.floor((this.m_rectChart.m_nTop+this.m_rectChart.m_nBottom)/2),this.m_nRadius=Math.min(WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart))/2,this.m_nRadius-=IWDChartConstant.MARGIN_PIE+b,!(this.m_nRadius<=IWDChartConstant.MARGIN_PIE+IWDChartConstant.MARGIN_LABEL_PIE))&&(r.oArbreDonnees=ot(r.oArbreDonnees,2*Math.PI*(h/360),this.m_nRadius),r.oArbreDonnees.height!==0)){this.m_dInitialStartAngle=this.getInitialStartAngle(this.m_params);r.bAvecTween&&(this.m_dInitialStartAngle=t.tweenInitialStartAngle(i,this.m_dInitialStartAngle));i.wbData("wbGrfAnimTweenInitialStartAngle",this.m_dInitialStartAngle);var d=this.m_dInitialStartAngle,g=this.m_params.isDisplayValuesLabel(),nt=this.m_params.isDisplayPercentage(),tt=this.m_params.isDisplayCategoriesLabel(),a=(tt||nt||g)&&(!r.bAvecTween||!r.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()),v=0,st=undefined,ht=new WDRect(this.m_nCenterX-this.m_nRadius,this.m_nCenterY-this.m_nRadius,this.m_nCenterX+this.m_nRadius,this.m_nCenterY+this.m_nRadius);this.dPourcentDonut=this.m_params.getDonutHoleSize();this.dPourcentDonut<0&&(this.dPourcentDonut=30);this.dPourcentDonut/=100;e=Math.ceil(this.m_nRadius*this.dPourcentDonut);r.bAvecTween&&(e=t.tweenHoleRadius(i,e));this.dPourcentDonut=e/this.m_nRadius;i.wbData("wbGrfAnimTweenHoleRadius",e);o=!r.racineCourante;o?(r.racineCourante=r.oArbreDonnees,r.racinePrecedente=r.oArbreDonnees):u(r.oArbreDonnees,function(n){n.fullName==r.racineCourante.fullName&&(r.racineCourante=n);n.fullName==r.racinePrecedente.fullName&&(r.racinePrecedente=n)},!0);r.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()||n.empty(i);y=n.g(i,"groupe-serie-parts");p=n.g(i,"groupe-serie-etiquettes");c=n.circle(i,"centre");r.m_oPaint.setFill("transparent");r.m_oPaint.setStroke("transparent",0);n.drawCircle(c,r.m_nCenterX,r.m_nCenterY,e,r.m_oPaint);c.off(bTouch?"touchstart":"click").on(bTouch?"touchstart":"click",function(){r.racineCourante.parent&&l(r.racineCourante.parent,!1,!0)});(a||!this.m_params.m_bBulleActive)&&(it=this.m_params.m_sMasqueValeur,rt=this.m_params.m_sMasquePourcentage,u(r.oArbreDonnees,function(n,t){if(!n.labelRenderer){var i=n.value;i!=0&&(n.labelRenderer=new WDSunburstLabelRenderer(r,d,0,t),n.labelRenderer.setNode(n),n.labelRenderer.setCategoryLabel(tt,n.name),n.labelRenderer.setValueLabel(g,WDChartUtils.formatValue(i,it,!0)),n.labelRenderer.setPercentLabel(nt,WDChartUtils.formatValue(i/r.oArbreDonnees.value*100,rt.replace("%",""),!0,"%")))}}));s=[];u(r.oArbreDonnees,function(u,f){var k,et,nt,c,b,ot,tt;if(dValue=u.value,dValue!=0){var rt=n.g(y,"groupe-serie-"+f),ut=n.g(rt,"part-effect-"+f),e=n.arc(ut,"part-"+f);r.bAvecTween&&(dValue=t.tweenValue(i,dValue,u.indiceProg,0));for(var g=r.m_params.getGradientType(),h=r.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()||g!=IWDChartConstant.FLAG_NO_GRADIENT?undefined:e.attr("fill"),w=u,ft=-1;!h&&w;)w.indiceProg!==undefined&&(h=r.m_oModele.getCategoryColor(w.indiceProg,!0)),h==undefined&&w.parent==r.oArbreDonnees&&(h=r.m_oModele.getCategoryColor(w.indice,!1)),w=w.parent,++ft;while(ft-->0)k=clWDUtil.tabHTML2TSLA(h),k[2]=Math.min(250/255,k[2]+.075),h=clWDUtil.sTSLA2HTML(k);if(et=r.m_params.isBorderColorAuto()?"#FFFFFF":r.m_params.m_sCouleurBordure,g==IWDChartConstant.FLAG_VERTICAL_GRADIENT||g==IWDChartConstant.FLAG_HORIZONTAL_GRADIENT?r.m_oPaint.setRadialGradient(r.m_nCenterX,r.m_nCenterY,r.m_nRadius,clWDUtil.sCouleurHTMLPlusBrillante(h),h,"pad"):r.m_oPaint.setFill(h),r.m_oPaint.setStroke(et),nt=Math.min(255,!o&&!r.bAvecTween?0:r.getSeriesAlphaAt(0)),r.m_oPaint.setFillOpacity255(nt),r.m_oPaint.setStrokeOption("Opacity",nt/255),c=r.prepareDessinArc(u,u.current),r.bAvecTween?(c=t.tweenPart(e,c),r.m_oPaint=t.tweenPartPaint(e,r.m_oPaint)):o&&r.m_params.m_nDureeAnimation>0&&!r.m_params.m_sPortionRacine&&(c.options.start*=.01,c.options.startAngle*=.01,c.options.sweep*=.01),n.drawArc(e,c,r.m_oPaint),e.wbData("wbGrfNode",u),u.svgPart=e,u.clicked=function(n){l(u,!1,!0,n)},e.wbData("wbGrfGrInfoXY",[0,u.fullName,dValue]),n.rotate(rt,d+c.options.sweep/2,r.m_nCenterX,r.m_nCenterY,!0),n.rotate(e,-c.options.sweep/2,r.m_nCenterX,r.m_nCenterY,!0),r.m_params.m_bInteractionSunburst!==!1&&r.liaisonLegendePart(n,e,u.indiceProg),(a||!r.m_params.m_bBulleActive)&&(b=u.labelRenderer,e.wbData("wbGrfPieLabelRenderer",b),r.m_params.m_bBulleActive||(r.m_oPaint.addClasse(r.m_params.m_sClasseLibelle),ot=n.bulle(ut,"bulle-"+f),tt=r.m_params.m_sBulleSecteur||"[%CATEGORIE%]\n[%SERIE%]\n[%%%]",n.drawBulle(ot,tt.replace("[%CATEGORIE%]",b.m_strCategoryLabel||"").replace("[%SERIE%]",tt.indexOf("[%VALEUR%]")>-1?r.m_oModele.m_tabSeries[0].m_sLibelle||"":b.m_strValueLabel||"").replace("[%VALEUR%]",b.m_strValueLabel||"").replace("[%%%]",b.m_strPercentLabel||""),r.m_oPaint)),a)){var ct=n.g(p,"part-effect-text-"+f),it=n.g(ct,"part-transform-text-"+f),st=n.text(it,"label-"+f);if(it.wbData("wbGrfNode",u),u.svgTexte=st,r.m_oPaint.addClasse(r.m_params.m_sClasseLibelle),v||(v=+WDPaintCSS.oGetInfoCSS(r.m_oPaint,"Ap","height").height),WDPieChartRenderer.AUTORISE_COULEUR_ETIQUETTE_AUTO&&!r.m_params.m_bEtiquetteSecteurExterieures){function ht(n){return 1-(.299*n[0]+.587*n[1]+.114*n[2])/255}function lt(n,t){var i=t,u=ht(clWDUtil.tabHTML2RVBA(n)),r=ht(clWDUtil.tabHTML2RVBA(t));return u<.5?r<.5&&(i="#000"):r>=.5&&(i="#FFF"),i}r.m_oPaint.setFill(lt(h,"#000"))}r.m_params.m_nDureeAnimation>0&&!r.bAvecTween&&it.attr("fill-opacity",0);s.push(u.labelRenderer.draw(n,st,0,0,v,r.m_oPaint,t))}}});r.AppelAsyncIdle(function(){for(var t,i=function(n){for(var t=0;t<s.length;++t)s[t][0](n)},n=0;n<s.length;++n)s[n][1]();t=!1;o&&r.m_params.m_sPortionRacine&&(!r.bAvecTween||!r.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie())&&u(r.oArbreDonnees,function(n){if(r.m_params.m_sPortionRacine==n.fullName)return n.clicked(!0),t=!0,!1});t||l(r.racineCourante,!0,o)})}}};WDSunburstLabelRenderer.prototype=new WDLabelRenderer;WDSunburstLabelRenderer.prototype.constructor=WDSunburstLabelRenderer;WDSunburstLabelRenderer.prototype.setNode=function(n){this.m_oNode=n};WDSunburstLabelRenderer.prototype.updateTotalWidth=function(){};WDSunburstLabelRenderer.prototype.labelVisible=function(n){var r=n?this.m_oNode.target||this.m_oNode.current:this.m_oNode.current,i=this.m_oRenderer,t;return this.m_oNode.name!=""&&this.m_oNode==i.racineCourante?!0:this.m_oNode.depth<=i.racineCourante.depth?!1:(t=i.prepareDessin(this.m_oNode,r,1,!0),t.outerRadius<=i.m_nRadius&&t.innerRadius>=1&&(t.outerRadius-t.innerRadius)/i.m_nRadius*(t.endAngle-t.startAngle)>.012&&Math.abs(Math.sin((t.endAngle-t.startAngle)/2))*t.innerRadius*2>10/.8)};WDSunburstLabelRenderer.prototype.labelTransform=function(n,t){var w=n,r=this.m_oNode,ut=this,i=this.m_oRenderer,e,s,h,o,y,k,nt,rt,v,u;if(r.bTextRaf&&i.AnnuleAppelAsync(r.bTextRaf),t){r.bTextRaf=i.AppelAsync(function(){ut.labelTransform(w,!1)});return}var ft=w?this.m_oNode.target||this.m_oNode.current:this.m_oNode.current,f=r.svgTexte[0],b=f.parentNode;if(!r.labelRenderer.labelVisible(w)){b.setAttributeNS(null,"transform","scale(0)");return}if(r.dataLibelleParProfondeur||(r.dataLibelleParProfondeur=[]),s="",r.name!=""&&r==i.racineCourante?f.attributes.fill.value.toUpperCase()=="#FFF"&&(f.setAttributeNS(null,"fill","#000"),r.svgTexte.children().attr("fill","#000").css("fill","#000"),f.wbGrfSunburstCouleurPrecedente="#FFF"):f.wbGrfSunburstCouleurPrecedente&&(f.setAttributeNS(null,"fill",f.wbGrfSunburstCouleurPrecedente),r.svgTexte.children().attr("fill",f.wbGrfSunburstCouleurPrecedente).css("fill",f.wbGrfSunburstCouleurPrecedente),f.wbGrfSunburstCouleurPrecedente=undefined),r.dataLibelleParProfondeur[i.racineCourante.depth]!==undefined)e=r.dataLibelleParProfondeur[i.racineCourante.depth].tabSpan,s=r.dataLibelleParProfondeur[i.racineCourante.depth].t;else{h=1;e=this.tabGetLibelles();var et=this.tabGetLongueurLibelles(),p=this.nLineHeight,tt=p/3,c=0;if(r==i.racineCourante)s="translate("+i.m_nCenterX+", "+i.m_nCenterY+")",c=2*Math.ceil(i.m_nRadius*i.dPourcentDonut),i.m_params.isDisplayPercentage()&&(e[e.length-1]=WDChartUtils.formatValue(r.value/i.oArbreDonnees.value*100,i.m_params.m_sMasquePourcentage.replace("%",""),!0,"%"));else{o=i.prepareDessin(r,ft,1);y=(o.startAngle+o.endAngle)*90/Math.PI;i.m_params.isDisplayPercentage()&&(k=WDChartUtils.formatValue(r.value/i.racineCourante.value*100,i.m_params.m_sMasquePourcentage.replace("%",""),!0,"%"));var d=o.innerRadius,it=o.outerRadius,ot=d+(it-d)/2;y=(360+y+(i.m_dInitialStartAngle-270))%360;s="translate("+i.m_nCenterX+", "+i.m_nCenterY+") rotate("+(y-90)+") translate("+ot+",0)";y>=180&&(s+=" rotate(180)");o.endAngle-o.startAngle>=Math.PI/2||(h=Math.min(h,Math.abs(Math.sin(o.endAngle-o.startAngle))*o.innerRadius/(p*e.length)));c=it-d}for(c*=.8,u=0;u<e.length;++u){var l=k&&f.childElementCount==u+1?k:e[u],g=et[u],a=1;if(a*g>c&&(a=c/g,a*p<tt)){if(nt=!1,u==0)for(rt=g/l.length,v=l.length,a=tt/p,v=l.length-3;v>4;--v)if(a*rt*v<=c){l=l.substr(0,v)+"...";nt=!0;break}if(!nt){r.dataLibelleParProfondeur[i.racineCourante.depth]={tabSpan:[],t:"scale(0)"};b.setAttributeNS(null,"transform","scale(0)");return}}h=Math.min(h,a);e[u]=l}h!=1&&(s+=" scale("+h+" "+h+")");r.dataLibelleParProfondeur[i.racineCourante.depth]={tabSpan:e,t:s}}for(u=0;u<e.length;++u)f.childNodes[u].innerHTML=e[u];b.setAttributeNS(null,"transform",s)};WDSunburstLabelRenderer.prototype.tabGetLongueurLibelles=function(){return this.tabLongueurLibelles};WDSunburstLabelRenderer.prototype.tabGetLibelles=function(){var n=[];return this.m_bCategoryLabel&&n.push(this.m_strCategoryLabel),this.m_bValueLabel&&n.push(this.m_strValueLabel),this.m_bPercentLabel&&n.push(this.m_strPercentLabel),n};WDSunburstLabelRenderer.prototype.draw=function(n,t,i,r,u,f,e){var h=this.m_oRenderer,o,s;return this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,o=this.tabGetLibelles(),f.DesactivePointerEvents(),h.bAvecTween&&(f=e.tweenLabelPaint(this.m_nIndice,f,t)),this.nLineHeight=u,n.drawText(t,o,u,i,r-.9*(o.length-1)*u,this.m_nAlignmentH,f,!1),s=this,[function(n){s.labelTransform(!1,!n&&!0)},function(){for(var n=0;n<o.length;++n)s.tabLongueurLibelles[n]=t[0].childNodes[n].getComputedTextLength()}]};WDBarChartSeriesRenderer.prototype=new WDXYChartSeriesRenderer;WDBarChartSeriesRenderer.prototype.constructor=WDBarChartSeriesRenderer;WDBarChartSeriesRenderer.bParametresSupportes=function(n,t){var i,r;if(!WDXYChartSeriesRenderer.bParametresSupportes(n,t))return!1;for(i=0,r=0;r<t.m_tabSeries.length;++r)i=Math.max(i,t.m_tabSeries[r].getNbValues());return t.m_oCategories.m_tabValeur=t.m_oCategories.m_tabValeur.slice(0,i),t.m_oCategories.m_tabValeurDateHeure&&t.m_oCategories.m_tabValeurDateHeure.length&&(t.m_oCategories.m_tabValeurDateHeure=t.m_oCategories.m_tabValeurDateHeure.slice(0,i)),!0};WDBarChartSeriesRenderer.prototype._animStopColor=function(n,t,i,r,u){var f,o,s,e;r!=!!t.wbData("wbGrfSurbrillanceSerieDepuisMire")&&(f=t[0].attributes.stroke?t[0].attributes.stroke.value||i:i,r&&t.wbData("wbGrfSurbrillanceSerieDepuisMire",{"stop-color":i,stroke:f,fill:i}),u=u||clWDUtil.sCouleurHTMLPlusBrillante(i,.1),u=="#ffffff"&&(u=WDChartRenderer.crPlusFonce(i)),t.wbData("wbGrfSurbrillanceSerieDepuisMireInit")===undefined&&t.wbData("wbGrfSurbrillanceSerieDepuisMireInit",{"stop-color":i,stroke:f,fill:i}),r||(o=t[0].attributes.fill?t[0].attributes.fill.value:undefined,s=t[0].attributes["stop-color"]?t[0].attributes["stop-color"].value:undefined),e=new WDSvgAnimation(this.m_chartRenderer.m_oGraphe,n,t,r?t.wbData("wbGrfSurbrillanceSerieDepuisMire"):{"stop-color":s,stroke:f,fill:o},r?{"stop-color":u,stroke:u,fill:u}:t.wbData("wbGrfSurbrillanceSerieDepuisMireInit")),e.duration=r?100:300,r||(e.m_fFinAnimation=function(){t.wbRemoveData("wbGrfSurbrillanceSerieDepuisMire")}),e.run())};WDBarChartSeriesRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r){var p,w,f,l,b,e,a,it,o;for(WDXYChartSeriesRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments),w=this.m_chartRenderer.m_params.getGradientType()!=IWDChartConstant.FLAG_NO_GRADIENT,f=0;(p=n.findFromId(n.m_domBaliseSVG,"groupe-serie-"+f)).length;++f)if(l=this.m_chartRenderer.m_oModele.getSeriesAt(f).getChartType(),l===this.m_model.getChartType())for(b=l==WDChartParameters.kMinMax,e=p[0].firstChild;e;e=e.nextSibling){b&&(e=e.firstChild);var u=$(e),s=[],k=[],c=[];if(w){if(a=n.findFromId(n.m_domBaliseSVG,u.wbData("wbGrfGradientId"),!0),!a[0])continue;var v=a[0].childNodes,d=v[0],g=v[v.length-1];c=c.concat([$(d),$(g)]);s=s.concat([d.attributes["stop-color"].value,g.attributes["stop-color"].value])}else{var h=undefined,nt=undefined,tt=u.wbData("wbGrfGrInfoXY"),y=tt?tt[IWDChartConstant.GR_CATEGORIE]:undefined;y!==undefined&&(h=this.m_chartRenderer.m_oGraphe.m_oModele.getCategoryColor(y,!0)||this.m_chartRenderer.m_oModele.getSeriesAt(f).crGetCouleurPoint(y));h==undefined&&(h=this.m_chartRenderer.m_oGraphe.m_oModele.getSeriesColor(f));u.wbData("wbGrfDrawMire")&&(u.wbData("wbGrfDrawMire").couleur!==undefined&&(h=u.wbData("wbGrfDrawMire").couleur),u.wbData("wbGrfDrawMire").couleurDestination!==undefined&&(nt=u.wbData("wbGrfDrawMire").couleurDestination));k.push(nt);s.push(h);c.push(u)}for(it=i&&r===f||u.is("rect:hover")||u.is("rect.wbGrfHover"),o=0;o<s.length;++o)this._animStopColor(n,c[o],s[o],it,k[o])}};WDBarChartSeriesRenderer.prototype.prepareRendering=function(n,t,i,r){var f,u,e,o,h,s;if(WDXYChartSeriesRenderer.prototype.prepareRendering.apply(this,arguments)){if(this.m_nBarSpacing=r.m_nEspacement,f=this.m_chartRenderer.getAxisRendererForType(EAxisType.X),u=f.getGraduationSize(f.getAxisSize(this.m_chartRenderer.m_rectAxis)),u-2*this.m_nBarSpacing<IWDChartConstant.BAR_MIN_WIDTH&&(this.m_nBarSpacing=IWDChartConstant.BAR_MIN_SPACING),u-=2*this.m_nBarSpacing,WDChartParameters.s_isBoursierChart(this.getChartType())?this.m_nBarWidth=u:(e=this.m_chartRenderer.m_oModele.getNbSeriesType(WDChartParameters.kHisto)+this.m_chartRenderer.m_oModele.getNbSeriesType(WDChartParameters.kHistoHorizontal),this.m_chartRenderer.m_oModele.getNbSeriesType(WDChartParameters.kHistoEmpile)>0&&(e+=1),this.m_chartRenderer.m_oModele.getNbSeriesType(WDChartParameters.kWaterfall)>0&&(e=1),this.m_nBarWidth=e>1?Math.max(1,Math.floor(u/e)):u),o=this,h=function(){for(var i,n=-1,t=1;t<o.m_oModele.m_oCategories.m_tabValeurDateHeure.length;++t)i=o.m_oModele.m_oCategories.m_tabValeurDateHeure[t]-o.m_oModele.m_oCategories.m_tabValeurDateHeure[t-1],(n===-1||n>i)&&(n=i);return n},f.m_dStep!=1){s=f.m_dStep;switch(this.m_chartRenderer.m_timeScale){case ETimeScale.DATE:case ETimeScale.DATETIME:this.m_nBarWidth=Math.round(h()*u/s);break;case ETimeScale.TIME:this.m_nBarWidth=Math.round(h()*u/s);break;case ETimeScale.DUREE:case ETimeScale.NONE:this.m_nBarWidth=this.m_nBarWidth/Math.round(s)}this.m_nBarWidth=Math.max(1,this.m_nBarWidth)}return!0}return!1};WDBarChartSeriesRenderer.prototype.createBarGradient=function(n,t){var i={couleurDebut:n,couleurFin:clWDUtil.sCouleurHTMLPlusBrillante(n),spreadMethod:"pad"};switch(t){case IWDChartConstant.FLAG_VERTICAL_GRADIENT:i.bVertical=!0;break;case IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:i.bVertical=!1;break;default:return null}return i};WDBarChartSeriesRenderer.prototype.getBarBorderColor=function(n,t){return t.isBorderColorAuto()?clWDUtil.sCouleurHTMLPlusBrillante(n):t.m_sCouleurBordure};WDBarChartSeriesRenderer.prototype.drawSeries=function(n,t,i,r,u){var ht,dt,v,o,lt,yt,it,rt,nt,pt,k,b;this.m_tabCumulatedValues&&i==this.m_chartRenderer.m_oGraphe.m_oModele.convertSeriesIndexTypeToModel(0,this.getChartType())&&(this.m_tabCumulatedValues=undefined);var bt=this.m_chartRenderer.m_oModele.getAxisByType(EAxisType.X),ut=r.getNbValues(),w=r.isStacked(),kt=this.m_chartRenderer.m_oModele.m_tabSeries.length,ft=i;if(this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()||(n.empty(t),this.m_chartRenderer.m_oGraphe.m_oModele.convertSeriesIndexModelToType(ft,r.getChartType())===0&&(nt=n.findFromId(n.m_domBaliseSVG,"barre-texte"),nt.length&&n.empty(nt))),w)for(v=0;v<kt;++v)this.m_chartRenderer.m_oGraphe.m_oVue.bEstSerieMasquee(v)||(ut=Math.max(this.m_chartRenderer.m_oModele.m_tabSeries[v].getNbValues(),ut));if(ht=this.m_chartRenderer.getDrawnValuesCount(ut,bt),ht!=0){w&&this.m_tabCumulatedValues===undefined&&(this.m_tabCumulatedValues=[]);var ct=this.m_chartRenderer.m_oModele.getSeriesColor(i),ri=this.getBarBorderColor(ct,u),ui=this.createBarGradient(ct,u.getGradientType()),f=0,et,ot=u.isDisplayValuesLabel()&&!this.m_chartRenderer.m_oGraphe.m_oVue.bEstSerieMasquee(i)&&!this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie();ot&&(et=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()?"999 999 999":u.m_sMasqueValeur,dt=WDPaintCSS.oGetInfoCSS(u.m_sClasseLibelle,"0","fontSize"),f=parseInt10(dt.fontSize));var gt=u.m_bAfficheSiNulle,ni=r.isOnSecondaryAxis(),fi=this.m_chartRenderer.getYOriginValue(ni),e=this.m_chartRenderer.getFirstDrawnCategoryIndex(bt);for(v=0;v<ht;++v,++e)if(!(e<0)){if(e>=ut)break;o=r.getValueAt(e);lt=r.getValueAtWithNull(e)===undefined;o=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,o,e,i);this.getBarRect(this.m_barRect,o,ft,e,fi,w,ni,u);var d=this.m_barRect.getLeft(),l=this.m_barRect.getTop(),s=this.m_barRect.getWidth(),a=this.m_barRect.getHeight(),at=n.rect(t,"series-"+i+"-barre-"+e),tt=1;if(s>0&&a>0){ot&&n.clipRect(this.m_chartRenderer.m_rectAxis,"clip-axes");var st=ct,vt=ri,g=ui,ti=this.m_chartRenderer.m_oModele.getCategoryColor(e,!0)||r.crGetCouleurPoint(e);ti&&(st=ti,vt=this.getBarBorderColor(st,u),g=this.createBarGradient(st,u.getGradientType()));g?this.m_chartRenderer.m_oPaint.setLinearGradient(g.couleurDebut,g.couleurFin,g.spreadMethod,g.bVertical):this.m_chartRenderer.m_oPaint.setFill(st);yt=this.m_chartRenderer.getSeriesAlphaAt(i);yt<255?this.m_chartRenderer.m_oPaint.setFillOpacity255(yt):this.m_chartRenderer.m_oPaint.setFillOpacity255(255);this.m_chartRenderer.m_oPaint.setStroke(vt,tt);tt>0&&vt&&(!w||ft>0&&e<this.m_tabCumulatedValues.length)&&(it=0,(w?this.m_tabCumulatedValues[e]:o)>0?it=1:w&&(it=-1),it!=0&&(rt=tt*it/2,u.m_bAxeXHorizontal?(l+=rt,a-=rt):(d+=rt,s-=rt)));n.drawRect(at,new WDRect(d,l,d+s,l+a),this.m_chartRenderer.m_oPaint);at.wbData("wbGrfGrInfoXY",[i,v,o]);ot&&n.restoreClip()}else n.remove(at);if(nt=n.g(t.parent().parent(),"barre-texte"),pt=n.g(nt,"barre-texte-"+i),ot){this.m_chartRenderer.m_oPaint.addClasse(u.m_sClasseValeur);var b=n.text(pt,"barre-"+i+"-texte-"+e),h,c,y,p=Align.CENTER,wt=!0,ii=!0;(u.m_bAxeXHorizontal?o>=0&&this.m_chartRenderer.m_rectAxis.m_nTop-this.m_barRect.m_nTop>1||o<0&&this.m_barRect.m_nBottom-this.m_chartRenderer.m_rectAxis.m_nBottom>1:o>=0&&this.m_barRect.m_nRight-this.m_chartRenderer.m_rectAxis.m_nRight>1||o<0&&this.m_chartRenderer.m_rectAxis.m_nLeft-this.m_barRect.m_nLeft>1)?wt=!1:(u.m_bAxeXHorizontal?a-2*tt<=f:s-2*tt<=f)&&(ii=!1);w?(k=this.m_tabCumulatedValues[e],wt&&(ii||lt&&gt)&&(y=WDChartUtils.formatValue(k>0?Math.abs(o):Math.abs(o)*-1,et,!0),h=l+(a-f)/2,c=d+s/2,this.m_chartRenderer.m_oPaint.DesactivePointerEvents(),u.m_bLibelleValeurHorizontal!==!1?n.drawText(b,y,f,c,h,p,this.m_chartRenderer.m_oPaint):n.drawTextVertically(b,y,f,c-s,h,p,this.m_chartRenderer.m_oPaint)),ft==kt-1&&(this.m_chartRenderer.m_oPaint.addClasse(u.m_sClasseValeur),b=n.text(pt,"barre-"+i+"-texte-total-"+e),y=WDChartUtils.formatValue(k,et,!0),h=k<0?l+a:l-f,c=d+s/2,u.m_bAxeXHorizontal?h+=k<0?IWDChartConstant.MARGIN_LABEL:-IWDChartConstant.MARGIN_LABEL:(h=l+(a-f)/2,c+=(k<0?-1:1)*(s/2+IWDChartConstant.MARGIN_LABEL),p=k<0?Align.RIGHT:Align.LEFT),this.m_chartRenderer.m_oPaint.DesactivePointerEvents(),u.m_bLibelleValeurHorizontal!==!1?n.drawText(b,y,f,c,h,p,this.m_chartRenderer.m_oPaint):n.drawTextVertically(b,y,f,c-s,h,p,this.m_chartRenderer.m_oPaint))):wt&&(!lt||gt)&&(y=WDChartUtils.formatValue(o,et,!0),h=o<0?l+a+IWDChartConstant.MARGIN_LABEL:l-f-IWDChartConstant.MARGIN_LABEL,c=d+s/2,u.m_bAxeXHorizontal||(o<0?(h=l+a/2-f/2,c-=IWDChartConstant.MARGIN_LABEL+s/2,p=Align.RIGHT):(h=l+a/2-f/2,c+=IWDChartConstant.MARGIN_LABEL+s/2,p=Align.LEFT)),this.m_chartRenderer.m_oPaint.DesactivePointerEvents(),u.m_bLibelleValeurHorizontal!==!1?n.drawText(b,y,f,c,h,p,this.m_chartRenderer.m_oPaint):n.drawTextVertically(b,y,f,c+(u.m_bAxeXHorizontal?-s:0),h+(u.m_bAxeXHorizontal?f/2:a),p,this.m_chartRenderer.m_oPaint))}}}};WDBarChartSeriesRenderer.prototype.getBarRect=function(n,t,i,r,u,f,e,o){var a=this.m_chartRenderer.dGetYPixelsPerUnit(e),c=Math.ceil((t>0?Math.max(0,t-u):Math.abs(t-u))*a),l,h,s,y,v;if(f&&i>0&&u!=0&&(c=u<this.m_tabCumulatedValues[r]?Math.ceil((t>=0?Math.max(0,t):Math.abs(t))*a):Math.ceil((t>=0?Math.max(0,t-u+this.m_tabCumulatedValues[r]):Math.abs(t-u+this.m_tabCumulatedValues[r]))*a)),l=0,h=0,o.m_bAxeXHorizontal?l=this.m_chartRenderer.getCategoryDrawingPositionX(r,e)+this.m_nBarSpacing:(h=this.m_chartRenderer.getCategoryDrawingPositionY(r,e,!1)-this.m_nBarSpacing,f&&(h-=this.m_nBarWidth)),f){for(s=0,y=!1,v=0;v<this.m_chartRenderer.m_oModele.m_tabSeries.length;++v)if(!this.m_chartRenderer.m_oGraphe.m_oVue.bEstSerieMasquee(v)){y=i==v;break}!y&&r<this.m_tabCumulatedValues.length?(s=this.m_tabCumulatedValues[r],s>0?(o.m_bAxeXHorizontal?h=this.m_chartRenderer.nGetYOrigin(e)-Math.ceil(Math.max(0,s-u)*a)-c:l=this.m_chartRenderer.nGetXOrigin(e)+Math.ceil(Math.max(0,s-u)*a),s+=Math.abs(t)):s<0?(o.m_bAxeXHorizontal?h=this.m_chartRenderer.nGetYOrigin(e)+Math.ceil(Math.abs(s)*a):l=this.m_chartRenderer.nGetXOrigin(e)-Math.ceil(Math.abs(s)*a)-c,s-=Math.abs(t)):(s=t,o.m_bAxeXHorizontal?h=t>0?this.m_chartRenderer.nGetYOrigin(e)-c:this.m_chartRenderer.nGetYOrigin(e):l=t<0?this.m_chartRenderer.nGetXOrigin(e)-c:this.m_chartRenderer.nGetXOrigin(e))):(s=t,o.m_bAxeXHorizontal?h=t>0?this.m_chartRenderer.nGetYOrigin(e)-c:this.m_chartRenderer.nGetYOrigin(e):l=t<0?this.m_chartRenderer.nGetXOrigin(e)-c:this.m_chartRenderer.nGetXOrigin(e));this.m_tabCumulatedValues[r]=s}else o.m_bAxeXHorizontal?(l+=this.m_nBarWidth*this.m_chartRenderer.m_oModele.convertSeriesIndexModelToType(i,this.getChartType()),h=t>0?this.m_chartRenderer.nGetYOrigin(e)-c:this.m_chartRenderer.nGetYOrigin(e)):(h-=this.m_nBarWidth*this.m_chartRenderer.m_oModele.convertSeriesIndexModelToType(i,this.getChartType()),h-=this.m_nBarWidth,l=t>0?this.m_chartRenderer.nGetXOrigin(e):this.m_chartRenderer.nGetXOrigin(e)-c);o.m_bAxeXHorizontal?n.setSizeAndLocation(l,h,this.m_nBarWidth,c):n.setSizeAndLocation(l,h,c,this.m_nBarWidth)};WDBarChartSeriesRenderer.prototype.getValueDrawingPosition=function(n,t,i){var u,f,o,r,e;if(this.isStacked()){for(u=this.m_chartRenderer.m_oGraphe.m_oModele,f=this.getChartType(),nSeriesIndex=u.convertSeriesIndexModelToType(nSeriesIndex,f),o=u.getNbSeriesType(f),r=0;r<o;r++)if(e=this.getSeriesAtSelonType(r,this.getChartType(),!1),this.getBarRect(this.m_barRect,e.getValueAt(i),u.convertSeriesIndexTypeToModel(r,f),i,this.m_chartRenderer.getYOriginValue(e.isOnSecondaryAxis()),e.isOnSecondaryAxis()),r==nSeriesIndex)break}else this.getBarRect(this.m_barRect,n,nSeriesIndex,i,t,this.m_chartRenderer.m_params.isStackedBarChart(),bSeriesOnSecondaryAxis,this.m_chartRenderer.m_params);return{x:this.m_barRect.getCenterX(),y:this.m_barRect.getCenterY()}};WDCandleStickChartSeriesRenderer.prototype=new WDBarChartSeriesRenderer;WDCandleStickChartSeriesRenderer.prototype.constructor=WDCandleStickChartSeriesRenderer;WDCandleStickChartSeriesRenderer.bParametresSupportes=function(n,t){return WDBarChartSeriesRenderer.bParametresSupportes(n,t)?(t.m_oParametres.m_bAxeXHorizontal=!0,t.m_oParametres.m_bEchelleTemporelle=!1,!0):!1};WDCandleStickChartSeriesRenderer.prototype.nGetPasSerie=function(n){return n.getChartType()==WDChartParameters.kMinMax?2:4};WDCandleStickChartSeriesRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r,u){var h,c,f,o,l,a,e,s;if(t!==undefined&&(h=!1,c=this.m_chartRenderer.m_oGraphe.m_oModele.m_tabSeries[t],c)){var y=c.getNbValues(),p=this.m_chartRenderer.m_oModele.getAxisByType(EAxisType.X),v=this.m_chartRenderer.getDrawnValuesCount(y,p);if(v!=0){for(f=0;f<=v;++f)if(o=this.m_chartRenderer.getCategoryDrawingPositionX(f,h),o+=this.m_nBarSpacing+this.m_nBarWidth/2,o>u)break;if(l=this.m_chartRenderer.getCategoryDrawingPositionX(Math.max(f-1,0),h),l+=this.m_nBarSpacing+this.m_nBarWidth/2,f>0&&u-l<o-u&&--f,a=n.g("groupe-serie-"+t),this.getChartType()===WDChartParameters.kMinMax){if(e=n.findFromId(a,"series-"+t+"-barre-"+f),!e||!e.length)return;i&&n.addClass(e,"wbGrfHover");WDBarChartSeriesRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments);n.removeClass(e,"wbGrfHover")}s=this;a.children().each(function(){var r=$(this),e=parseInt10(n.getId(r).substr(n.getId(r).lastIndexOf("-")+1)),o=i&&e==f,u=n.findFromId(n.m_domBaliseSVG,"axe-horiz-label-horiz-"+e);u&&u.length>0&&u.children().css("fill",o?s.m_chartRenderer.crPlusFonce(s.m_chartRenderer.m_oGraphe.m_oModele.getSeriesColor(t)):"");s.getChartType()!=WDChartParameters.kMinMax&&r.children().css("strokeWidth",parseInt10(r.children("line").attr("stroke-width"))+(o?2:0))})}}};WDCandleStickChartSeriesRenderer.prototype.drawSeries=function(n,t,i,r,u){var gt=this.m_chartRenderer.m_oModele.getAxisByType(EAxisType.X),ni=r.getNbValues(),ci=i,lt,oi,et,v,y,h,c,a,k,yt,rt,ot,ut,hi,pt,wt,st,bt,ht,d,g,nt,tt,ft,ct,kt,dt;if(!(i>this.m_chartRenderer.m_oGraphe.m_oModele.convertSeriesIndexTypeToModel(0,this.getChartType()))&&(this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()||n.empty(t),lt=this.m_chartRenderer.getDrawnValuesCount(ni,gt),lt!=0)){var ti=i,ii=i+1,ri=i+2,ui=i+3,fi=this.m_chartRenderer.m_oModele.getSeriesAt(ti,!1),ei=this.m_chartRenderer.m_oModele.getSeriesAt(ii,!1),li=this.m_chartRenderer.m_oModele.getSeriesAt(ri,!1)||fi,ai=this.m_chartRenderer.m_oModele.getSeriesAt(ui,!1)||ei,vi=this.m_chartRenderer.m_oModele.getSeriesColor(i),l=0,at,vt=this.getChartType()==WDChartParameters.kMinMax&&u.isDisplayValuesLabel()&&!this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie();vt&&(at=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()?"999 999 999":u.m_sMasqueValeur,oi=WDPaintCSS.oGetInfoCSS(u.m_sClasseLibelle,"0","fontSize"),l=parseInt10(oi.fontSize));var yi=this.m_chartRenderer.getYOriginValue(!1),f=this.m_chartRenderer.getFirstDrawnCategoryIndex(gt);for(et=0;et<lt;++et,++f)if(!(f<0)){if(f>=ni)break;v=fi.getValueAt(f);v=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,v,f,ti);y=ei.getValueAt(f);y=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,y,f,ii);h=li.getValueAt(f);h=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,h,f,ri);c=ai.getValueAt(f);c=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,c,f,ui);var o=this.getBarRect(this.m_barRect,v,y,h,c,ci,f,yi,u),s=this.m_barRect.getLeft(),p=this.m_barRect.getTop(),e=this.m_barRect.getWidth(),b=this.m_barRect.getHeight();if(vt&&n.clipRect(this.m_chartRenderer.m_rectAxis,"clip-axes"),a=n.g(t,"groupe-chandelier-"+i+"-barre-"+f),e>0&&b>0){var w=vi,it=this.getBarBorderColor(w,u),si=this.m_chartRenderer.m_oModele.getCategoryColor(f,!0);si&&(w=si,it=this.getBarBorderColor(w,u));this.getChartType()==WDChartParameters.kChandelier&&c>=h&&u.m_sCouleurChandelierHausse&&(w=u.m_sCouleurChandelierHausse);k=this.createBarGradient(w,u.getGradientType());k?this.m_chartRenderer.m_oPaint.setLinearGradient(k.couleurDebut,k.couleurFin,k.spreadMethod,k.bVertical):this.m_chartRenderer.m_oPaint.setFill(w);yt=this.m_chartRenderer.getSeriesAlphaAt(i);yt<255?this.m_chartRenderer.m_oPaint.setFillOpacity255(yt):this.m_chartRenderer.m_oPaint.setFillOpacity255(255);this.getChartType()==WDChartParameters.kBarCharts&&(it=this.m_chartRenderer.crPlusFonce(it));rt=1;this.m_chartRenderer.m_oPaint.setStroke(it,rt);rt>0&&it&&(ot=0,c>h&&(ot=1),ot!=0&&(ut=rt*ot/2,u.m_bAxeXHorizontal?(p+=ut,b-=ut):(s+=ut,e-=ut)));a.wbData("wbGrfGrInfoXY",[i,et,v,y,h,c]);this.getChartType()==WDChartParameters.kMinMax?(d=n.rect(a,"series-"+i+"-barre-"+f),n.drawRect(d,new WDRect(s,p,s+e,p+b),this.m_chartRenderer.m_oPaint)):(hi=new WDPaintCSS(_clone(this.m_chartRenderer.m_oPaint)),pt=n.line(a,"series-"+i+"-line-"+f),n.SetAntiAliasing(!1,pt),n.drawLine(pt,s+e/2,p,s+e/2,p+b,hi),this.getChartType()==WDChartParameters.kBarCharts?(wt=new WDPaintCSS(_clone(this.m_chartRenderer.m_oPaint)),st=n.line(a,"series-"+i+"-linedebut-"+f),n.SetAntiAliasing(!1,st),h<c?n.drawLine(st,o.m_nLeft,o.m_nBottom,s+e/2,o.m_nBottom,wt):n.drawLine(st,s+e/2,o.m_nBottom,o.m_nRight,o.m_nBottom,wt),bt=this.m_chartRenderer.m_oPaint,ht=n.line(a,"series-"+i+"-linefin-"+f),n.SetAntiAliasing(!1,ht),h>c?n.drawLine(ht,o.m_nLeft,o.m_nTop,s+e/2,o.m_nTop,bt):n.drawLine(ht,s+e/2,o.m_nTop,o.m_nRight,o.m_nTop,bt)):this.getChartType()==WDChartParameters.kChandelier&&(d=n.rect(a,"series-"+i+"-barre-"+f),n.drawRect(d,o,this.m_chartRenderer.m_oPaint)));d&&d.wbData("wbGrfDrawMire",{valeurMin:v,valeurMax:y,valeurDebut:h,valeurFin:c,couleur:w})}vt&&(n.restoreClip(),ft=Align.CENTER,ct=!0,y>=0&&this.m_chartRenderer.m_rectAxis.m_nTop-this.m_barRect.m_nTop>1||v<0&&this.m_barRect.m_nBottom-this.m_chartRenderer.m_rectAxis.m_nBottom>1?ct=!1:b-2*rt<=2*l&&(ct=!1),ct&&(this.m_chartRenderer.m_oPaint.addClasse(u.m_sClasseValeur),kt=n.text(a,"barre-"+i+"-textemin-"+f),tt=WDChartUtils.formatValue(v,at,!0),g=p+b+IWDChartConstant.MARGIN_LABEL,nt=s+e/2,this.m_chartRenderer.m_oPaint.DesactivePointerEvents(),u.m_bLibelleValeurHorizontal!==!1?n.drawText(kt,tt,l,nt,g,ft,this.m_chartRenderer.m_oPaint):n.drawTextVertically(kt,tt,l,nt-e,g+l/2,ft,this.m_chartRenderer.m_oPaint),this.m_chartRenderer.m_oPaint.addClasse(u.m_sClasseValeur),dt=n.text(a,"barre-"+i+"-textemax-"+f),tt=WDChartUtils.formatValue(y,at,!0),g=p-l-IWDChartConstant.MARGIN_LABEL,nt=s+e/2,this.m_chartRenderer.m_oPaint.DesactivePointerEvents(),u.m_bLibelleValeurHorizontal!==!1?n.drawText(dt,tt,l,nt,g,ft,this.m_chartRenderer.m_oPaint):n.drawTextVertically(dt,tt,l,nt-e,g+e-l/2,ft,this.m_chartRenderer.m_oPaint)))}}};WDCandleStickChartSeriesRenderer.prototype.getBarRect=function(n,t,i,r,u,f,e,o){var h=!1,c=this.m_chartRenderer.dGetYPixelsPerUnit(h),s=new WDRect,v,a,l;return n.m_nBottom=this.m_chartRenderer.nGetYOrigin(h)-Math.ceil((t-o)*c),n.m_nTop=this.m_chartRenderer.nGetYOrigin(h)-Math.ceil((i-o)*c),s.m_nBottom=this.m_chartRenderer.nGetYOrigin(h)-Math.ceil((r-o)*c),s.m_nTop=this.m_chartRenderer.nGetYOrigin(h)-Math.ceil((u-o)*c),v=this.m_chartRenderer.getCategoryDrawingPositionX(e,h)+this.m_nBarSpacing,n.m_nLeft=v,n.m_nRight=n.m_nLeft+this.m_nBarWidth,s.m_nLeft=n.m_nLeft,s.m_nRight=n.m_nRight,this.getChartType()==WDChartParameters.kMinMax||(a=.3*this.m_nBarWidth,s.m_nLeft+=a/2,s.m_nRight-=a/2),n.m_nTop>n.m_nBottom&&(l=n.m_nTop,n.m_nTop=n.m_nBottom,n.m_nBottom=l),s.m_nTop>s.m_nBottom&&(l=s.m_nTop,s.m_nTop=s.m_nBottom,s.m_nBottom=l),s};WDWaterfallChartSeriesRenderer.prototype=new WDBarChartSeriesRenderer;WDWaterfallChartSeriesRenderer.prototype.constructor=WDWaterfallChartSeriesRenderer;WDWaterfallChartSeriesRenderer.bParametresSupportes=function(n,t){return WDBarChartSeriesRenderer.bParametresSupportes(n,t)?(t.m_oParametres.m_bAxeXHorizontal=!0,!0):!1};WDWaterfallChartSeriesRenderer.prototype.drawSeries=function(n,t,i,r,u){var ct=u.m_bAxeXHorizontal?this.m_chartRenderer.m_oModele.getAxisByType(EAxisType.X):this.m_chartRenderer.m_oModele.getAxisByType(EAxisType.Y),lt=r.getNbValues(),kt=i,rt,yt,b,f,s,k,o,ot,st,g,nt,w;if(this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()||n.empty(t),rt=this.m_chartRenderer.getDrawnValuesCount(lt,ct),rt!=0){var at=this.m_chartRenderer.m_oModele.getSeriesColor(i),v=0,vt,ut=u.isDisplayValuesLabel()&&!this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie();ut&&(vt=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()?"999 999 999":u.m_sMasqueValeur,yt=WDPaintCSS.oGetInfoCSS(u.m_sClasseLibelle,"0","fontSize"),v=parseInt10(yt.fontSize));var ft=r.isOnSecondaryAxis(),dt=u.m_bAxeXHorizontal?this.m_chartRenderer.getYOriginValue(ft):this.m_chartRenderer.getXOriginValue(ft),e=this.m_chartRenderer.getFirstDrawnCategoryIndex(ct),y=0,p=0;for(b=0;b<rt;++b,++e)if(!(e<0)){if(e>=lt)break;f=r.getValueAt(e);s=this.m_chartRenderer.m_oModele.getWaterfallTypeCategorie(e);(s==undefined||s===ETypeCategorieWaterfall.eWaterfallDefaut)&&(s=f>0?ETypeCategorieWaterfall.eWaterfallPositif:ETypeCategorieWaterfall.eWaterfallNegatif);k=!1;s==ETypeCategorieWaterfall.eWaterfallSousTotal?(f=p,k=!0):s==ETypeCategorieWaterfall.eWaterfallTotal&&e>0&&(f=y,k=!0);f=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,f,e,i);this.getBarRect(this.m_barRect,f,kt,e,dt,y,ft,u,k);s==ETypeCategorieWaterfall.eWaterfallTotal?e>0?(p=0,y=0):(p=0,y=f):s==ETypeCategorieWaterfall.eWaterfallSousTotal?p=0:(y+=f,p+=f);var d=this.m_barRect.getLeft(),h=this.m_barRect.getTop(),c=this.m_barRect.getWidth(),l=this.m_barRect.getHeight();if(ut&&n.clipRect(this.m_chartRenderer.m_rectAxis,"clip-axes"),c>0&&l>0){o=at;this.m_chartRenderer.m_oModele.m_tabCouleursWaterfall&&this.m_chartRenderer.m_oModele.m_tabCouleursWaterfall[s]&&(o=this.m_chartRenderer.m_oModele.m_tabCouleursWaterfall[s]);o==-3&&(o=at);var et=this.getBarBorderColor(o,u),a=this.createBarGradient(o,u.getGradientType()),pt=this.m_chartRenderer.m_oModele.getCategoryColor(e,!0);pt&&(o=pt,et=this.getBarBorderColor(o,u),a=this.createBarGradient(o,u.getGradientType()));ot=n.rect(t,"series-"+i+"-barre-"+e);a?this.m_chartRenderer.m_oPaint.setLinearGradient(a.couleurDebut,a.couleurFin,a.spreadMethod,a.bVertical):this.m_chartRenderer.m_oPaint.setFill(o);st=this.m_chartRenderer.getSeriesAlphaAt(i);st<255?this.m_chartRenderer.m_oPaint.setFillOpacity255(st):this.m_chartRenderer.m_oPaint.setFillOpacity255(255);g=1;this.m_chartRenderer.m_oPaint.setStroke(et,g);g>0&&et&&(nt=0,f>0&&(nt=1),nt!=0&&(w=g*nt/2,u.m_bAxeXHorizontal?(h+=w,l-=w):(d+=w,c-=w)));ot.wbData("wbGrfGrInfoXY",[i,b,f]).wbData("wbGrfDrawMire",{valeur:f,couleur:o});n.drawRect(ot,new WDRect(d,h,d+c,h+l),this.m_chartRenderer.m_oPaint)}if(ut){n.restoreClip();this.m_chartRenderer.m_oPaint.addClasse(u.m_sClasseValeur);var gt=n.text(t,"barre-"+i+"-texte-"+e),tt,it,wt,ht=Align.CENTER,bt=!0;(f>=0&&this.m_chartRenderer.m_rectAxis.m_nTop-this.m_barRect.m_nTop>1||f<0&&this.m_barRect.m_nBottom-this.m_chartRenderer.m_rectAxis.m_nBottom>1)&&(bt=!1);bt&&(wt=WDChartUtils.formatValue(f,vt,!0),tt=f<0?h+l+IWDChartConstant.MARGIN_LABEL:h-v-IWDChartConstant.MARGIN_LABEL,it=d+c/2,u.m_bAxeXHorizontal||(f<0?(tt=h+l/2-v/2,it-=IWDChartConstant.MARGIN_LABEL+c/2,ht=Align.RIGHT):(tt=h+l/2-v/2,it+=IWDChartConstant.MARGIN_LABEL+c/2,ht=Align.LEFT)),this.m_chartRenderer.m_oPaint.DesactivePointerEvents(),n.drawText(gt,wt,v,it,tt,ht,this.m_chartRenderer.m_oPaint))}}}};WDWaterfallChartSeriesRenderer.prototype.getBarRect=function(n,t,i,r,u,f,e,o,s){s&&(t=-t);var a=this.m_chartRenderer.dGetYPixelsPerUnit(e),c=Math.ceil((t>0?Math.max(0,t-u):Math.abs(t))*a),v=Math.ceil((f>0?Math.max(0,f-u):-Math.abs(f))*a),l=0,h=0;o.m_bAxeXHorizontal&&(l=this.m_chartRenderer.getCategoryDrawingPositionX(r,e)+this.m_nBarSpacing);o.m_bAxeXHorizontal&&(h=this.m_chartRenderer.nGetYOrigin(e)-v,t>0&&(h-=c));o.m_bAxeXHorizontal?n.setSizeAndLocation(l,h,this.m_nBarWidth,c):n.setSizeAndLocation(l,h,c,this.m_nBarWidth)};ELineStyle.CONTINUOUS=0;ELineStyle.DASH=1;ELineStyle.DOT=2;ELineStyle.MIXED=3;WDLineChartSeriesRenderer.bParametresSupportes=function(n,t){return WDXYChartSeriesRenderer.bParametresSupportes(n,t)?!0:!1};WDLineChartSeriesRenderer.prototype=new WDXYChartSeriesRenderer;WDLineChartSeriesRenderer.prototype.constructor=WDLineChartSeriesRenderer;WDLineChartSeriesRenderer.prototype.__nGetNbPointOptimalPourDessin=function(n){var i=this.m_chartRenderer.m_rectAxis,t=1,r=n.nGetTaillePoint(),u;return(n.eGetTypePoint()==EPointStyle.NONE||n.eGetTypePoint()===undefined)&&(r=0),u=n.m_nEpaisseur,t=Math.max(t,Math.max(u,r)),Math.floor(Math.min(WDRect.getWidth(i)/t,WDRect.getHeight(i)/t))};WDLineChartSeriesRenderer.prototype.drawSeries=function(n,t,i,r,u){var w=this.m_chartRenderer.m_oModele.getAxisByType(EAxisType.X),b=r.getNbValues(),s=this.m_chartRenderer.getDrawnValuesCount(b,w),d,y,g,c,o,p,nt,l;if(s!==0){var h=[],a=r.isOnSecondaryAxis(),k=this.m_chartRenderer.getYOriginValue(a),f=this.m_chartRenderer.getFirstDrawnCategoryIndex(w),v=WDLineChartSeriesRenderer.nMaxDrawnValuesCount||this.__nGetNbPointOptimalPourDessin(r),e=undefined;for(!WDLineChartSeriesRenderer.bEchantillonageInterdit&&!u.bEchantillonageInterdit&&s>v?(e=r.m_dataSampler,e||(d=this,e=new WDChartDataSampler(d,k,i,a),r.m_dataSampler=e),y=f,g=f+s-1,e.doSample(y,g,v),s=v):r.m_dataSampler=undefined,c=0;c<s;++c,f=e?y+e.getSampleCategoryIndexAt(c):f+1)if(!(f<0)){if(f>=b)break;if(o=r.getValueAtWithNull(f),o===undefined||o===null)switch(this.m_chartRenderer.getSeriesDessinValeursNullesAt(i)){case eDESSINVALEURNULLE.eValeurNulleIgnoree:continue;case eDESSINVALEURNULLE.eValeurNulleAZero:o=0;break;case eDESSINVALEURNULLE.eValeurNulleNonDessinee:c>0&&c<s-1&&h.push(IWDChartConstant.SPECIAL_VALUE);continue}o=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,o,f,i);p=this.getValueDrawingPosition(o,k,i,f,a);p.nCategoryIndex=f;h.push(p)}nt=h.length;nt>=2&&(l=this.m_chartRenderer.m_oModele.getSeriesColor(i),this.drawLineBackground(n,t,i,r,h,u,l),this.drawLine(n,t,i,r,h,u,l),this.drawPoints(n,t,i,r,h,u,l))}};WDLineChartSeriesRenderer.prototype.createLineBackgroundGradient=function(n,t){var i={couleurDebut:n,couleurFin:clWDUtil.sCouleurHTMLPlusBrillante(n),spreadMethod:"pad"};switch(t){case IWDChartConstant.FLAG_VERTICAL_GRADIENT:i.bVertical=!0;break;case IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:i.bVertical=!1;break;default:return null}return i};WDLineChartSeriesRenderer.prototype.drawLineBackground=function(n,t,i){var r=n.findFromId(t,"groupe-area-"+i);return r.length&&(n.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation>0?r.fadeTo(n.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation,0,"swing",function(){n.remove($(this))}):n.remove(r)),!1};WDLineChartSeriesRenderer.prototype.drawLine=function(n,t,i,r,u,f,e){var h,a,o,s,p,w,b,v;if(r.bNuageReliePoint()){var c=new Path,y=r.isOnSecondaryAxis(),l={x:0,y:0};for(h=0;h<u.length;++h)if(clWDUtil.isObject(u[h])||u[h]!==IWDChartConstant.SPECIAL_VALUE){l=u[h];break}for(this.m_chartRenderer.getSeriesSplineAt(i)?u=r.getChartType()==WDChartParameters.kNuage||r.getChartType()==WDChartParameters.kCourbe||r.m_dParamSourceCalculee?[{x:l.x,y:l.y}].concat(u):[{x:this.m_chartRenderer.nGetXOrigin(y),y:this.m_chartRenderer.nGetYOrigin(y)}].concat(u):c.moveTo(l.x,l.y),a=u.length,o=0;o<a;++o){if(!clWDUtil.isObject(u[o])&&u[o]===IWDChartConstant.SPECIAL_VALUE){for(s=1;o+s<a;){if(!clWDUtil.isObject(u[o+s])&&u[o+s]===IWDChartConstant.SPECIAL_VALUE){++s;continue}c.moveTo(u[o+s].x,u[o+s].y);break}o+=s-1;continue}p=u[o].x;w=u[o].y;this.m_chartRenderer.getSeriesSplineAt(i)?this.getPointSpline(c,u,u[o],o):c.lineTo(p,w)}f.getType()==WDChartParameters.kCourbe&&(b=this.m_chartRenderer.getSeriesAlphaAt(i)/255);this.m_chartRenderer.m_oPaint.setStroke(e,r.m_nEpaisseur,b);this.m_chartRenderer.getSeriesSplineAt(i)?this.m_chartRenderer.m_oPaint.setStrokeLineJoin("round"):this.m_chartRenderer.m_oPaint.setStrokeLineJoin("miter");v=n.path(t,"serie-line-"+i);u=!this.m_chartRenderer.getSeriesSplineAt(i)?u:u.slice(1);this.m_chartRenderer.m_oPaint.setDashSelonType(r.m_nEpaisseur,parseInt(r.m_eTypeTrait));n.drawPath(v,c.toD(),this.m_chartRenderer.m_oPaint);this.saveLineData(v,i,u)}};WDLineChartSeriesRenderer.prototype.saveLineData=function(n,t,i){var r=this.m_chartRenderer;n.wbData("wbGrfSeriePoints",i).wbData("wbGrfGrInfoXY",[t,function(n,t,r){for(var f=i.length<2?10:Math.abs(i[0].x-i[1].x)/2,e=i.length<2?10:Math.abs(i[0].y-i[1].y)/2,u=0;u<i.length;++u)if(Math.abs(i[u].x-t)<f&&Math.abs(i[u].y-r)<e)return u},function(n){return r.m_oModele.m_tabSeries[n.wbData("wbGrfGrInfoXY")[IWDChartConstant.GR_SERIE]].getValueAt(n.wbData("wbGrfGrInfoXY")[IWDChartConstant.GR_CATEGORIE].apply(r.m_oGraphe,arguments))}])};WDLineChartSeriesRenderer.prototype.getPointSpline=function(n,t,i,r){var h=2.5,v=h+1,s=i.x,u=i.y,o=t[r-1],c=t[r+1],w,e,y,f,p;if(o==IWDChartConstant.SPECIAL_VALUE&&(o=i),c==IWDChartConstant.SPECIAL_VALUE&&(c=undefined),o&&c){var k=o.x,l=o.y,d=c.x,a=c.y,b;w=(h*s+k)/v;e=(h*u+l)/v;y=(h*s+d)/v;f=(h*u+a)/v;b=(f-e)*(y-s)/(y-w)+u-f;e+=b;f+=b;e>l&&e>u?(e=Math.max(l,u),f=2*u-e):e<l&&e<u&&(e=Math.min(l,u),f=2*u-e);f>a&&f>u?(f=Math.max(a,u),e=2*u-f):f<a&&f<u&&(f=Math.min(a,u),e=2*u-f);i.rightContX=y;i.rightContY=f}return r?(p=["C",o.rightContX||o.x,o.rightContY||o.y,w||s,e||u,s,u],o.rightContX=o.rightContY=null):p=["M",s,u],n&&n.add(p.join(" ")),p};WDLineChartSeriesRenderer.prototype.drawUnPoint=function(n,t,i,r,u,f,e,o,s){var d=r.eGetTypePoint(f),g=r.getChartType()!==WDChartParameters.kBulle&&r.getChartType()!==WDChartParameters.kHeatMap&&e.isDisplayValuesLabel(),h=r.nGetTaillePoint(f)!==undefined&&r.nGetTaillePoint(f)>0?r.nGetTaillePoint(f):e.m_nTaillePt,p=h,v=u[f].fAnimation||s,c,l,y,w,a,b,k;if(!clWDUtil.isObject(u[f])&&u[f]===IWDChartConstant.SPECIAL_VALUE)return!1;r.crGetCouleurPoint(f)&&(u[f].color=r.crGetCouleurPoint(f));o=o||this.m_chartRenderer.m_oModele.getSeriesColor(i);c=u[f].x;l=u[f].y;sNomNoeud=u[f].nom||"series-"+i+"-point-"+f;u[f].z!==undefined&&(h=clWDUtil.isObject(u[f].z)?u[f].z.width:u[f].z,p=clWDUtil.isObject(u[f].z)?u[f].z.height:u[f].z);g&&this.m_chartRenderer.m_oPaint.addClasse(e.m_sClasseValeur);y=r.getChartType()==WDChartParameters.kBulle||r.getChartType()==WDChartParameters.kHeatMap?this.m_chartRenderer.getSeriesAlphaAt(i):255;d!=EPointStyle.NONE&&(h>1&&(w=u[f].grandientType||(r.getChartType()==WDChartParameters.kBulle||r.getChartType()==WDChartParameters.kHeatMap?e.getGradientType():IWDChartConstant.FLAG_NO_GRADIENT),w==IWDChartConstant.FLAG_VERTICAL_GRADIENT||w==IWDChartConstant.FLAG_HORIZONTAL_GRADIENT?this.m_chartRenderer.m_oPaint.setRadialGradient(c,l,h,clWDUtil.sCouleurHTMLPlusBrillante(u[f].color||o),u[f].color||o,"pad",y/255,y/255,u[f].radialCentre):(this.m_chartRenderer.m_oPaint.setFill(u[f].color||clWDUtil.sCouleurHTMLPlusBrillante(o)),y<255?this.m_chartRenderer.m_oPaint.setFillOpacity255(y):this.m_chartRenderer.m_oPaint.setFillOpacity255(255))),this.m_chartRenderer.m_oPaint.setStroke(u[f].stroke||r.crGetCouleurBordurePoint(f)||o,r.m_nEpaisseur));switch(d){case EPointStyle.NONE:svgPoint=undefined;break;default:case EPointStyle.CIRCLE:svgPoint=n.circle(t,sNomNoeud);n.drawCircle(svgPoint,c,l,h,this.m_chartRenderer.m_oPaint,v);break;case EPointStyle.CROSS:a=new Path;a.moveTo(c-h,l-h);a.lineTo(c+h,l+h);a.moveTo(c-h,l+h);a.lineTo(c+h,l-h);svgPoint=n.path(t,sNomNoeud);n.drawPath(svgPoint,a.toD(),this.m_chartRenderer.m_oPaint,v);break;case EPointStyle.DIAMOND:svgPoint=n.polygon(t,sNomNoeud);n.drawPolygon(svgPoint,[[c,l-h],[c+h,l],[c,l+h],[c-h,l],[c,l-h]],this.m_chartRenderer.m_oPaint,v);break;case EPointStyle.SQUARE:b=c-h;k=l-p;svgPoint=n.rect(t,sNomNoeud);u[f].color&&this.m_chartRenderer.m_oPaint.setFill(this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValuePaint?this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValuePaint(svgPoint,u[f].color,i,f):u[f].color);n.drawRect(svgPoint,new WDRect(b,k,b+2*h,k+2*p),this.m_chartRenderer.m_oPaint,undefined,undefined,v);break;case EPointStyle.TRIANGLE:svgPoint=n.polygon(t,sNomNoeud);n.drawPolygon(svgPoint,[[c,l-h],[c+h,l+h],[c-h,l+h],[c,l-h]],this.m_chartRenderer.m_oPaint,v)}return svgPoint&&u[f].data&&svgPoint.wbDataObj(u[f].data),!0};WDLineChartSeriesRenderer.prototype.drawPoints=function(n,t,i,r,u,f,e){for(var g=r.getChartType()!==WDChartParameters.kBulle&&r.getChartType()!==WDChartParameters.kHeatMap&&f.isDisplayValuesLabel(),a=u.length,s,v,w,p,nt,tt,l,c,d,o=0,y=0;(!g||r.eGetTypePoint(o)==EPointStyle.NONE)&&o<a;o++,y++)w="series-"+i+"-point-"+o,g||(s=n.findFromId(t,w+"-texte"),s&&s.length>0&&n.remove(s)),r.eGetTypePoint(o)==EPointStyle.NONE&&(v=n.findFromId(t,w),v&&v.length>0&&n.remove(v));for(p=a;(s=n.findFromId(t,"series-"+i+"-point-"+p+"-texte")).length>0;++p)n.remove(s);for(p=a;(v=n.findFromId(t,"series-"+i+"-point-"+p)).length>0;++p)n.remove(v);for(nt=f.m_sMasqueValeur,o=0,y=this.m_chartRenderer.getFirstDrawnCategoryIndex(this.m_chartRenderer.m_oModele.getAxisByType(EAxisType.X));o<a;o++,y++)if((r.eGetTypePoint(o)==EPointStyle.NONE||this.drawUnPoint(n,t,i,r,u,o,f,e))&&g&&u[o]!==IWDChartConstant.SPECIAL_VALUE){var b=u[o].x,k=u[o].y,h=r.nGetTaillePoint(o)!==undefined&&r.nGetTaillePoint(o)>0?r.nGetTaillePoint(o):f.m_nTaillePt;u[o].z!==undefined&&(h=clWDUtil.isObject(u[o].z)?u[o].z.width:u[o].z);w=u[o].nom||"series-"+i+"-point-"+y;tt=r.getValueAt(u[o].nCategoryIndex!==undefined?u[o].nCategoryIndex:y);l=WDChartUtils.formatValue(tt,nt,!0);s=n.text(t,w+"-texte");this.m_chartRenderer.m_oPaint.addClasse(f.m_sClasseLibelle);oStyle=WDPaintCSS.oGetInfoCSS(this.m_chartRenderer.m_oPaint,l,["width","lineHeight"]);c=Math.ceil(parseInt10(oStyle.lineHeight));d=Math.ceil(parseInt10(oStyle.width));f.m_bLibelleValeurHorizontal!==!1?o>=a-1?n.drawText(s,l,c,b-h-1,k+h+1,Align.RIGHT,this.m_chartRenderer.m_oPaint):n.drawText(s,l,c,b+h+1,k+h+1,Align.LEFT,this.m_chartRenderer.m_oPaint):o===0?n.drawTextVertically(s,l,c,b-h-1,k+h+1+d,Align.LEFT,this.m_chartRenderer.m_oPaint):o>=a-1?n.drawTextVertically(s,l,c,b-h-1-c,k+h+1+d,Align.LEFT,this.m_chartRenderer.m_oPaint):n.drawTextVertically(s,l,c,b+h+1-c,k+h+1+d,Align.LEFT,this.m_chartRenderer.m_oPaint)}};WDLineChartSeriesRenderer.prototype.getValueDrawingPosition=function(n,t,i,r,u){var f=this.m_chartRenderer.getCategoryDrawingPositionX(r,u),e,o;return this.xAxisRenderer=this.xAxisRenderer||this.m_chartRenderer.getAxisRendererForType(EAxisType.X),this.xAxisRenderer.isDrawLabelsBetweenGraduations()&&(f+=this.xAxisRenderer.getGraduationSize(this.xAxisRenderer.getAxisSize(this.m_chartRenderer.m_rectAxis))/2),e=this.m_chartRenderer.dGetYPixelsPerUnit(u),o=this.m_chartRenderer.nGetYOrigin(u)-Math.ceil((n-t)*e),{x:f,y:o}};WDAreaChartSeriesRenderer.bParametresSupportes=function(n,t){return WDLineChartSeriesRenderer.bParametresSupportes(n,t)?!0:!1};WDAreaChartSeriesRenderer.prototype=new WDLineChartSeriesRenderer;WDAreaChartSeriesRenderer.prototype.constructor=WDAreaChartSeriesRenderer;WDAreaChartSeriesRenderer.prototype.drawLineBackground=function(n,t,i,r,u,f,e){var p=n.g(t,"groupe-area-"+i),a=this.m_chartRenderer.getSeriesAlphaAt(i),c=this.createLineBackgroundGradient(e,f.getGradientType()),y,l;c?this.m_chartRenderer.m_oPaint.setLinearGradient(c.couleurDebut,c.couleurFin,c.spreadMethod,c.bVertical,1,a/255):(this.m_chartRenderer.m_oPaint.setFill(clWDUtil.sCouleurHTMLPlusBrillante(e)),a<255?this.m_chartRenderer.m_oPaint.setFillOpacity255(a):this.m_chartRenderer.m_oPaint.setFillOpacity255(255));var v=0,w=0,o=0,s=new Path,h=r.isOnSecondaryAxis();for(this.m_chartRenderer.getSeriesSplineAt(i)?u=[{x:this.m_chartRenderer.nGetXOrigin(h),y:this.m_chartRenderer.nGetYOrigin(h)}].concat(u):s.moveTo(!clWDUtil.isObject(u[o])&&u[o]===IWDChartConstant.SPECIAL_VALUE?this.m_chartRenderer.nGetXOrigin(h):u[o].x,this.m_chartRenderer.nGetYOrigin(h)),y=u.length,o=0;o<y;o++){if(!clWDUtil.isObject(u[o])&&u[o]===IWDChartConstant.SPECIAL_VALUE){for(o>0&&(s.lineTo(u[o-1].x,this.m_chartRenderer.nGetYOrigin(h)),s.close()),l=n.path(p,"serie-"+i+"-area-special-"+o),n.drawPath(l,s.toD(),new WDPaintCSS(this.m_chartRenderer.m_oPaint)),s.rewind();o+1<y;){if(u[o+1]===IWDChartConstant.SPECIAL_VALUE){++o;continue}s.moveTo(u[o+1].x,this.m_chartRenderer.nGetYOrigin(h));break}continue}v=u[o].x;w=u[o].y;this.m_chartRenderer.getSeriesSplineAt(i)?this.getPointSpline(s,u,u[o],o):s.lineTo(v,w)}return s.lineTo(v,this.m_chartRenderer.nGetYOrigin(h)),s.close(),this.m_chartRenderer.getSeriesSplineAt(i)?this.m_chartRenderer.m_oPaint.setStrokeLineJoin("round"):this.m_chartRenderer.m_oPaint.setStrokeLineJoin("miter"),l=n.path(p,"serie-area-"+i),n.drawPath(l,s.toD(),this.m_chartRenderer.m_oPaint),!0};WDRadarChartRenderer.bParametresSupportes=function(n,t){return WDXYChartRenderer.bParametresSupportes(n,t)?!0:!1};WDRadarChartRenderer.prototype=new WDXYChartRenderer;WDRadarChartRenderer.prototype.constructor=WDRadarChartRenderer;WDRadarChartRenderer.prototype.bAutoriseZoom=function(){return!1};WDRadarChartRenderer.prototype.nGetYOrigin=function(){return this.m_clCentreRadar.y};WDRadarChartRenderer.prototype.nGetXOrigin=function(){return this.m_clCentreRadar.x};WDRadarChartRenderer.ANGLE_DEPART=-90;WDRadarChartRenderer.TAILLE_GRADUATION=5;WDRadarChartRenderer.MINPIXEL_GRADUATION=25;WDChartRenderer.MARGE_LABELSECTEUR=IWDChartConstant.MARGIN_PIE;WDRadarChartRenderer.prototype.prepareRendering=function(n,t,r,u){var e,f,o,s,h;if(!WDXYChartRenderer.prototype.prepareRendering.apply(this,arguments)||(this.m_rectAxis=new WDRect(this.m_rectChart),this.m_rectChart.getWidth()==0||this.m_rectChart.getHeight()==0))return!1;if(e=this.m_oModele.m_lstAxis.length,!this.m_tabAxisRenderer||this.m_tabAxisRenderer.length!=e)for(this.m_tabAxisRenderer=undefined,delete this.m_tabAxisRenderer,this.m_tabAxisRenderer=[],i=0;i<e;++i)this.m_tabAxisRenderer[i]=this.createAxisRenderer();for(f=0;f<e;++f)o=this.m_oModele.m_lstAxis[f],s=this.m_tabAxisRenderer[f],s.prepare(o,u,this.m_rectAxis,this.m_oPaint,o.isDisplayCategories()?this.m_timeScale:ETimeScale.NONE);return n.empty(r),h=u.byGetAlpha(),h>=255&&n.g(r,"groupe-series"),this.__bCalculeVariables(n,t,r)};WDRadarChartRenderer.prototype.drawGrids=function(n,t,i,r){var u=n.g(r,"groupe-grids");n.SetAntiAliasing(t.m_bAntiAliasing,u);n.empty(u);t.isHorizontalGridShown()&&this.__DessineQuadrillage(n,t,i,u)};WDRadarChartRenderer.prototype.drawAxis=function(n,t,i,r){var u=n.g(i,"groupe-axes");n.empty(u);r.isHorizontalGridShown()||this.__DessineGraduations(n,r,this.m_rectAxis,u);this.__bDessineAxes(n,t,u,r)&&this.__DessineTexteGraduations(n,t,u,r)};WDRadarChartRenderer.prototype.__DessineQuadrillage=function(n,t,i,r){for(var o,f,e,v,u=this.m_nGradMin+1;u<=this.m_nGradMax;++u){for(o=0,f=new Path,e=0;e<this.m_nNombreCategories;++e){o=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*e;var c=o*Math.PI/180,y=u*this.m_dPas,l=this.__dConvertitVersEcran(y),s=this.m_clCentreRadar.x+l*Math.cos(c),h=this.m_clCentreRadar.y+l*Math.sin(c),a=this.__AjusteCoordonnees(o,s,h);s=a.x;h=a.y;e==0?f.moveTo(s,h):f.lineTo(s,h)}f.close();t.m_bSpline?this.m_oPaint.setStrokeLineJoin("round"):this.m_oPaint.setStrokeLineJoin("miter");v=n.path(r,"grid-vert-"+u);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage);n.drawPath(v,f.toD(),this.m_oPaint)}};WDRadarChartRenderer.prototype.__DessineTexteGraduations=function(n,t,i,r){for(var h,y,w,b,k=WDRadarChartRenderer.ANGLE_DEPART,o=k*Math.PI/180,d=r.isDisplayCategoriesLabel(),e="",s=this.getAxisRendererForType(EAxisType.Y),ft=s.m_axis,g=s.m_axis.isDisplayDecimalValues(r),c=s.m_axis.isYAxis()?r.m_sMasqueAxes:undefined,nt=WDPaintCSS.oGetInfoCSS(r.m_sClasseLibelle,"0","lineHeight"),l=parseInt10(nt.lineHeight),tt=Math.floor(s.m_axis.m_dOriginValue),u=this.m_nGradMin+1;u<=this.m_nGradMax;++u){var a=this.__dConvertitVersEcran(this.m_dPas*u),it=this.m_clCentreRadar.x+a*Math.cos(o),v=this.m_clCentreRadar.y+a*Math.sin(o);e="";h=d;
//!oAnimator.tweenHideLabel(domParent,!(bDisplayCategoriesLabel /*|| bDisplayPercentageLabel || bDisplayValuesLabel*/),iGraduation);  	
h&&(e=this.m_oModele.getCategoryLabelAt(u));isNaN(parseInt10(e))&&!clWDUtil.bEstChaineNonVide(e)&&(h=!1);u==this.m_nGradMax&&h&&(y=WDPaintCSS.oGetInfoCSS(r.m_sClasseLibelle,e,["height"]),v+=parseInt10(y.height)/2);var rt=it+WDRadarChartRenderer.TAILLE_GRADUATION*Math.cos(o+Math.PI/2),ut=v+WDRadarChartRenderer.TAILLE_GRADUATION*Math.sin(o+Math.PI/2),p=u*this.m_dPas+tt,f=c?WDChartUtils.formatValue(p,c,g):p;(f=f===undefined?"":""+f,w=l*f.split("\n").length,!isNaN(parseInt10(f))||clWDUtil.bEstChaineNonVide(f))&&(b=n.text(i,"axe-horiz-label-horiz-"+u),this.m_oPaint.addClasse(r.m_sClasseLibelle),this.m_oPaint.DesactivePointerEvents(),n.drawText(b,f,l,rt,ut-w/2,Align.LEFT,this.m_oPaint,!1))}};WDRadarChartRenderer.prototype.__DessineGraduations=function(n,t,i,r){for(var u,f,h=0,e=0;e<this.m_nNombreCategories;++e)for(h=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*e,u=h*Math.PI/180,f=this.m_nGradMin+1;f<=this.m_nGradMax;++f){var c=this.__dConvertitVersEcran(this.m_dPas*f),o=this.m_clCentreRadar.x+c*Math.cos(u),s=this.m_clCentreRadar.y+c*Math.sin(u),l=this.__AjusteCoordonnees(h,o,s);o=l.x;s=l.y;var v=o+WDRadarChartRenderer.TAILLE_GRADUATION*Math.cos(u+Math.PI/2),y=s+WDRadarChartRenderer.TAILLE_GRADUATION*Math.sin(u+Math.PI/2),a=n.line(r,"axe-graduation-vert-"+e+"-"+f);this.m_oPaint.setStroke(t.m_sCouleurAxe);n.SetAntiAliasing(t.m_bAntiAliasing,a);n.drawLine(a,parseInt10(o),parseInt10(s),parseInt10(v),parseInt10(y),this.m_oPaint,!1)}};WDRadarChartRenderer.prototype.__dConvertitVersEcran=function(n){return(n-this.m_dValeurMin)*this.m_dFacteurEchelle};WDRadarChartRenderer.prototype.__AjusteCoordonnees=function(n,t,i){return n==90||n==270||n==WDRadarChartRenderer.ANGLE_DEPART?t=this.m_clCentreRadar.x:n==180&&(i=this.m_clCentreRadar.y),{x:t,y:i}};WDRadarChartRenderer.prototype.__bDessineAxes=function(n,t,i,r){for(var y,s,h,c,p,l,k,d,a=0,g=r.m_sCouleurAxe,v=[],nt=r.isDisplayCategoriesLabel(),e="",o=0;o<this.m_nNombreCategories;++o){a=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*o;var w=a*Math.PI/180,u=this.m_clCentreRadar.x+this.m_nRayon*Math.cos(w),f=this.m_clCentreRadar.y+this.m_nRayon*Math.sin(w),b=this.__AjusteCoordonnees(a,u,f);if(u=b.x,f=b.y,y=n.line(i,"axe-vert-"+o),this.m_oPaint.setStroke(g),n.SetAntiAliasing(r.m_bAntiAliasing,y),n.drawLine(y,this.m_clCentreRadar.x,this.m_clCentreRadar.y,u,f,this.m_oPaint,!1),e="",s=nt,s&&(e=this.m_oModele.getCategoryLabelAt(o)),isNaN(parseInt10(e))&&!clWDUtil.bEstChaineNonVide(e)&&(s=!1),s){for(h=WDPaintCSS.oGetInfoCSS(r.m_sClasseLibelle,e,["width","height","lineHeight"]),stSize={cx:Math.ceil(parseInt10(h.width)),cy:Math.ceil(parseInt10(h.height))},u<this.m_clCentreRadar.x&&(u-=stSize.cx),f<this.m_clCentreRadar.y&&(f-=stSize.cy),c=new WDRect,c.setSizeAndLocation(parseInt10(u),parseInt10(f),stSize.cx,stSize.cy),p=!1,l=0;l<v.length;++l)if(k=v[l],WDRect.intersects(k,c)){p=!0;break}if(p)continue;v.push(c);d=n.text(i,"axe-vert-label-horiz-"+o);this.m_oPaint.addClasse(r.m_sClasseLibelle);this.m_oPaint.DesactivePointerEvents();n.drawText(d,e,parseInt10(h.lineHeight),parseInt10(u),parseInt10(f)-5,IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,this.m_oPaint,!1)}}return!0};WDRadarChartRenderer.prototype.__bCalculeVariables=function(n,t,i){var u=new WDRect(this.m_rectChart),f,r,e;for(this.m_clCentreRadar={x:u.getCenterX(),y:u.getCenterY()},f=this.getAxisRendererForType(EAxisType.Y),r=f.m_axis,this.m_nNombreCategories=0,e=0;e<r.m_lstData.length;++e)this.m_nNombreCategories=Math.max(this.m_nNombreCategories,r.m_lstData[e].m_tabValeur.length);return this.m_nNombreCategories<=0||this.m_nNombreCategories>360?!1:(this.m_dAngleDelta=360/this.m_nNombreCategories,this.m_nRayon=Math.min(u.getWidth()/2,u.getHeight()/2),this.__AjusteRayon(n,t,i),this.m_dValeurMin=Math.min(0,r.m_dMinValue),this.m_dValeurMax=r.m_dMaxValue,this.m_dValeurMax-this.m_dValeurMin==0)?!1:(this.m_params.getXAxisMin()!==IWDChartConstant.DEFAULT_VALUE&&(this.m_dValeurMin=Math.min(this.m_params.getXAxisMin(),this.m_dValeurMin)),this.m_params.getXAxisMax()!==IWDChartConstant.DEFAULT_VALUE&&(this.m_dValeurMax=Math.max(this.m_params.getXAxisMax(),this.m_dValeurMax)),this.m_dPas=this.m_params.getAxisStep(f.m_axis),this.m_dPas==IWDChartConstant.DEFAULT_VALUE&&(this.m_dPas=f.getAxisStep(this.m_nRayon/(this.m_dValeurMax-this.m_dValeurMin),WDRadarChartRenderer.MINPIXEL_GRADUATION,!r.isDisplayDecimalValues(this.m_params),ETimeScale.NONE)),this.m_nGradMin=Math.floor(this.m_dValeurMin/this.m_dPas),this.m_nGradMax=Math.ceil(this.m_dValeurMax/this.m_dPas),this.m_dValeurMin=this.m_nGradMin*this.m_dPas,this.m_dValeurMax=this.m_nGradMax*this.m_dPas,this.m_dFacteurEchelle=this.m_nRayon/(this.m_dValeurMax-this.m_dValeurMin),!0)};WDRadarChartRenderer.prototype.__AjusteRayon=function(){for(var u,n,i={},o=this.m_rectChart.getWidth()/2,s=this.m_rectChart.getHeight()/2,f=0,h=this.getAxisRendererForType(EAxisType.Y),c=Math.floor(h.m_axis.m_dOriginValue),r=c;r<this.m_nNombreCategories;r++){var l=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*f,t=l*Math.PI/180,e=this.m_params.isDisplayCategoriesLabel(),a=e;
//!oAnimator.tweenHideLabel(domParent,!(bDisplayCategoriesLabel /*|| bDisplayPercentageLabel || bDisplayValuesLabel*/),nCategorie);  	
(a&&e&&(n=this.m_oModele.getCategoryLabelAt(r)),!isNaN(parseInt10(n))||clWDUtil.bEstChaineNonVide(n))&&(u=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLibelle,n,["width","height"]),i={cx:Math.ceil(parseInt10(u.width)),cy:Math.ceil(parseInt10(u.height))},Math.abs(Math.sin(t))>.01&&(this.m_nRayon=Math.min(this.m_nRayon,parseInt10((o-i.cx-WDChartRenderer.MARGE_LABELSECTEUR)/Math.abs(Math.sin(t))))),Math.abs(Math.cos(t))>.01&&(this.m_nRayon=Math.min(this.m_nRayon,parseInt10((s-i.cy-WDChartRenderer.MARGE_LABELSECTEUR)/Math.abs(Math.cos(t))))),n="",f++)}};WDRadarChartRenderer.prototype.grInfoPoint=function(n,t,i){return n===eGRAPHEAXE.kAbscisse&&i===WDChartRenderer.GRAPHEINFOPOINT_MIN?t===WDChartRenderer.GRAPHEINFOPOINT_AXEX?this.m_clCentreRadar.x:this.m_clCentreRadar.y:0};WDRadarChartSeriesRenderer.bParametresSupportes=function(n,t){return WDAreaChartSeriesRenderer.bParametresSupportes(n,t)?(t.m_oParametres.m_bSpline=!1,!0):!1};WDRadarChartSeriesRenderer.prototype=new WDAreaChartSeriesRenderer;WDRadarChartSeriesRenderer.prototype.constructor=WDRadarChartSeriesRenderer;WDRadarChartSeriesRenderer.prototype.Init=function(){WDAreaChartSeriesRenderer.prototype.Init.apply(this,arguments)};WDRadarChartSeriesRenderer.prototype.drawSeries=function(n,t,i,r,u){for(var c,l,e,v,s,h=0,b=i,f=[],o=0;o<this.m_chartRenderer.m_nNombreCategories;++o){c=o;h=WDRadarChartRenderer.ANGLE_DEPART+this.m_chartRenderer.m_dAngleDelta*o;l=h*Math.PI/180;e=r.getValueAtWithNull(c);(e===undefined||e===null)&&(e=this.m_chartRenderer.m_dValeurMin);e=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,e,c,i);var a=this.m_chartRenderer.__dConvertitVersEcran(e),y=this.m_chartRenderer.m_clCentreRadar.x+a*Math.cos(l),p=this.m_chartRenderer.m_clCentreRadar.y+a*Math.sin(l),w=this.m_chartRenderer.__AjusteCoordonnees(h,y,p);f.push(w)}v=f.length;v>=2&&(f.push(f[0]),s=this.m_chartRenderer.m_oModele.getSeriesColor(i),this.drawLineBackground(n,t,i,r,f,u,s),this.drawLine(n,t,i,r,f,u,s),f.pop(),this.drawPoints(n,t,i,r,f,u,s))};WDScatterChartSeriesRenderer.bParametresSupportes=function(n,t){return WDLineChartSeriesRenderer.bParametresSupportes(n,t)?!0:!1};WDScatterChartSeriesRenderer.prototype=new WDLineChartSeriesRenderer;WDScatterChartSeriesRenderer.prototype.constructor=WDScatterChartSeriesRenderer;WDScatterChartSeriesRenderer.prototype.nGetPasSerie=function(){return 2};WDScatterChartSeriesRenderer.prototype.getValueDrawingPosition=function(n,t,i,r,u){var f=this.m_chartRenderer.getDrawingPositionX(r,u),e=this.m_chartRenderer.getDrawingPositionY(n-t,u);return{x:f,y:e}};WDScatterChartSeriesRenderer.prototype.drawSeries=function(n,t,i,r,u){var s=i,y=i+1,h=this.m_chartRenderer.m_oModele.getSeriesAt(s,!1),l=this.m_chartRenderer.m_oModele.getSeriesAt(y,!1),f,o,c,b,k,d,v,g;if(l){var nt=this.m_chartRenderer.m_oModele.getAxisByType(EAxisType.X),p=r.getNbValues(),a=this.m_chartRenderer.getDrawnValuesCount(p,nt);if(a!=0){var e=[],w=h.isOnSecondaryAxis(),tt=this.m_chartRenderer.getYOriginValue(w),it=l.getNbValues();for(f=0;f<Math.min(a,p);++f){if(f>=it)break;if(o=l.getValueAtWithNull(f),c=h.getValueAt(f),o===undefined||o===null)switch(this.m_chartRenderer.getSeriesDessinValeursNullesAt(i)){case eDESSINVALEURNULLE.eValeurNulleIgnoree:continue;case eDESSINVALEURNULLE.eValeurNulleAZero:o=0;break;case eDESSINVALEURNULLE.eValeurNulleNonDessinee:f>0&&f<a-1&&e.push(IWDChartConstant.SPECIAL_VALUE);continue}c=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,c,f,s);o=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,o,f,y);b=this.getValueDrawingPosition(o,tt,s,c,w);k=r.nGetTaillePoint(f)!==undefined?r.nGetTaillePoint(f):u.m_nTaillePt;k==0&&e[f]&&(e[f].z=1);e.push(b)}d=e.length;d>0&&(v=this.m_chartRenderer.m_oModele.getSeriesColor(s),this.drawLine(n,t,s,h,e,u,v),g=r.m_eTypePoint,(r.m_eTypePoint==EPointStyle.NONE||r.m_eTypePoint==EPointStyle.NONDEFINI)&&(r.m_eTypePoint=EPointStyle.CIRCLE),this.drawPoints(n,t,s,h,e,u,v),r.m_eTypePoint=g)}}};WDBubbleChartSeriesRenderer.bParametresSupportes=function(n,t){return WDScatterChartSeriesRenderer.bParametresSupportes(n,t)?!0:!1};WDBubbleChartSeriesRenderer.prototype=new WDScatterChartSeriesRenderer;WDBubbleChartSeriesRenderer.prototype.constructor=WDBubbleChartSeriesRenderer;WDBubbleChartSeriesRenderer.eGrapheBulleProportionnelRayon=0;WDBubbleChartSeriesRenderer.eGrapheBulleProportionnelSurface=1;WDBubbleChartSeriesRenderer.eGrapheBulleProportionnelVolume=2;WDBubbleChartSeriesRenderer.prototype.nGetPasSerie=function(){return 3};WDBubbleChartSeriesRenderer.prototype.drawSeries=function(n,t,i,r,u){var ht=u.isDisplayCategoriesLabel(),ct=u.isDisplayValuesLabel(),lt=u.m_sMasqueValeur,s=i,d=i+1,g=i+2,c=this.m_oModele.getSeriesAt(s,!1),y=this.m_oModele.getSeriesAt(d,!1),nt=this.m_oModele.getSeriesAt(g,!1),et,ot,f,o,e,v,k;if(y&&nt){var at=this.m_oModele.getAxisByType(EAxisType.X),tt=r.getNbValues(),it=this.m_chartRenderer.getDrawnValuesCount(tt,at);if(it!=0){var h=[],rt=c.isOnSecondaryAxis(),vt=this.m_chartRenderer.getYOriginValue(rt),ut=y.getNbValues(),a=n.g(t,"serie-line-"+s),ft=this.m_oModele.getSeriesColor(s);for(f=0;f<Math.min(it,tt);++f){if(f>=ut)break;var l=nt.getValueAt(f),p=y.getValueAt(f),w=c.getValueAt(f);w=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,w,f,s);p=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,p,f,d);o=this.getValueDrawingPosition(p,vt,s,w,rt);e="";ht&&(e+=this.m_oModele.getCategoryLabelAt(f));ct&&(e.length&&(e+="\n"),e+=WDChartUtils.formatValue(l,lt,!0));o.label=e;l=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,l,f,g);o.z=this.__dCalculeRayonBulle(Math.abs(l),u);l<0&&(o.color=clWDUtil.sCouleurHTMLPlusBrillante(clWDUtil.sGetCouleurHTMLAssocie(ft)));h.push(o)}for(et=h.length,et>0&&(this.saveLineData(a,s,h),ot=c.m_eTypePoint,c.m_eTypePoint=EPointStyle.CIRCLE,this.drawPoints(n,a,s,c,h,u,ft),c.m_eTypePoint=ot),f=0;f<h.length;++f){if(f>=ut)break;if(o=h[f],e=o.label,e.length){v=n.text(a,"label-"+i+"-"+ +f);this.m_chartRenderer.m_oPaint.addClasse(this.m_chartRenderer.m_params.m_sClasseLibelle);this.m_chartRenderer.m_oPaint.DesactivePointerEvents();var b=WDPaintCSS.oGetInfoCSS(this.m_chartRenderer.m_oPaint,e,["width","height","lineHeight"]),st=parseInt10(b.lineHeight),yt=parseInt10(b.height),pt=parseInt10(b.width);n.drawText(v,e,st,o.x,o.y-.5*st*((e.split("\n").length||0)+1),IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_chartRenderer.m_oPaint)}}for(k=h.length;(v=n.findFromId(a,"label-"+i+"-"+ +k)).length>0;++k)n.remove(v)}}};WDBubbleChartSeriesRenderer.prototype.__dCalculeRayonBulle=function(n,t){var i=Math.PI,r,u,f,e;switch(t.m_eAlgoGrapheBulle){case WDBubbleChartSeriesRenderer.eGrapheBulleProportionnelSurface:return r=i*this.m_chartRenderer.m_dRayonMaxBulle*this.m_chartRenderer.m_dRayonMaxBulle,u=n/this.m_chartRenderer.m_dValeurMaxZ*r,Math.sqrt(u/i);case WDBubbleChartSeriesRenderer.eGrapheBulleProportionnelVolume:return f=4/3*i*this.m_chartRenderer.m_dRayonMaxBulle*this.m_chartRenderer.m_dRayonMaxBulle*this.m_chartRenderer.m_dRayonMaxBulle,e=n/this.m_chartRenderer.m_dValeurMaxZ*f,Math.pow(3*e/(4*i),1/3);case WDBubbleChartSeriesRenderer.eGrapheBulleProportionnelRayon:default:return n/this.m_chartRenderer.m_dValeurMaxZ*this.m_chartRenderer.m_dRayonMaxBulle}};WDHeatmapChartRenderer.bParametresSupportes=function(n,t){var r,i,u;if(!WDXYChartRenderer.bParametresSupportes(n,t))return!1;for(r=t.m_oParametres,i=0;i<t.m_tabSeries.length;++i)if(u=t.m_tabSeries[i],u.isOnSecondaryAxis()&&!r.m_oAxeYSecondaire)return!1;return!0};WDHeatmapChartRenderer.prototype=new WDXYChartRenderer;WDHeatmapChartRenderer.prototype.constructor=WDHeatmapChartRenderer;WDHeatmapChartRenderer.prototype.nGetPasSerie=function(){return 3};WDHeatmapChartRenderer.prototype.createAxisRenderer=function(){return new WDHeatMapChartAxisRenderer(this)};WDHeatmapChartRenderer.prototype.bAutoriseZoom=function(){return!1};WDHeatmapChartRenderer.prototype.draw=function(n){WDXYChartRenderer.prototype.draw.apply(this,arguments);var t=n.g(this.m_domGroupeSeries,"groupe-grids");this.m_domGroupeSeries.append(t.detach())};WDHeatmapChartRenderer.prototype.drawLegend=function(){this.CalculeBorneZ();WDXYChartRenderer.prototype.drawLegend.apply(this,arguments)};WDHeatmapChartRenderer.prototype._vbLegendevaleur=function(){return!0};WDHeatmapChartRenderer.prototype.drawGrids=function(n,t,i,r){WDXYChartRenderer.prototype.drawGrids.apply(this,arguments);var u=n.rect(r,"CouleurHeatMapValeurVide");this.m_oModele.m_oParametres.m_sCouleurHeatMapValeurVide?(this.m_oPaint.setFill(this.m_oModele.m_oParametres.m_sCouleurHeatMapValeurVide),n.drawRect(u,this.m_rectAxis,this.m_oPaint)):n.remove(u)};WDHeatmapChartRenderer.prototype._drawLegendValeurPaint=function(n,t,i,r,u){var f=WDRect.getHeight(r)>WDRect.getWidth(r),v=this.m_params.m_sMasqueValeur,y=WDChartUtils.formatValue(this.m_dValeurMaxZ,v,!0),p=WDChartUtils.formatValue(this.m_dValeurMinZ,v,!0),w=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLegende,p,["width","height"]),d=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLegende,y,["width"]),e=parseInt10(w.height),o=new WDRect,s=new WDRect,b,k,h,l,c,a;for(f?(s={x:r.m_nLeft+WDRect.getWidth(r)/2,y:r.m_nTop+IWDChartConstant.MARGIN_LEGEND_ELEMENTS},o={x:r.m_nLeft+WDRect.getWidth(r)/2,y:r.m_nBottom-IWDChartConstant.MARGIN_LEGEND_ELEMENTS-e},r.m_nTop+=e+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nBottom-=e+IWDChartConstant.MARGIN_LEGEND_ELEMENTS):(s={x:r.m_nRight-IWDChartConstant.MARGIN_LEGEND_ELEMENTS,y:r.m_nTop+WDRect.getHeight(r)/2-e/2},o={x:r.m_nLeft+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,y:r.m_nTop+WDRect.getHeight(r)/2-e/2},r.m_nLeft+=parseInt10(w.width)+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nRight-=parseInt10(d.width)+IWDChartConstant.MARGIN_LEGEND_ELEMENTS),b=t.text(n,"legende-texte-min"),this.m_oPaint.addClasse(this.m_params.m_sClasseLegende),t.drawText(b,p,e,o.x,o.y,f?IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE:IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,this.m_oPaint,this.m_params.m_nDureeAnimation===0||u?!1:bIEAvec11?WDSvgAnimation:WDSvgAnimationLegende),k=t.text(n,"legende-texte-max"),this.m_oPaint.addClasse(this.m_params.m_sClasseLegende),t.drawText(k,y,e,s.x,s.y,f?IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE:IWDConstante.ALIGNEMENT_HORIZONTAL_DROITE,this.m_oPaint,this.m_params.m_nDureeAnimation===0||u?!1:bIEAvec11?WDSvgAnimation:WDSvgAnimationLegende),this.m_oPaint.setLinearGradient(this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(f?this.m_dValeurMaxZ:this.m_dValeurMinZ),this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(f?this.m_dValeurMinZ:this.m_dValeurMaxZ),"pad",f,1,1,!1),h=0;h<this.m_clCouleurAltitudeHeatMap.nGetNbCouleurs();++h)l=this.m_clCouleurAltitudeHeatMap.stGetI(h),c=parseFloat((l.m_dAltitude-this.m_dValeurMinZ)*100/(this.m_dValeurMaxZ-this.m_dValeurMinZ)),f&&(c=100-c),this.m_oPaint.m_stLinearGradient.stop[c]={color:l.m_crCouleur,opacity:1};a=t.rect(n,"legende-degrade");this.ecouteLegende(a);t.drawRect(a,new WDRect(r.m_nLeft+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nTop+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nRight-IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nBottom-IWDChartConstant.MARGIN_LEGEND_ELEMENTS),this.m_oPaint,undefined,undefined,this.m_params.m_nDureeAnimation===0||u?!1:WDSvgAnimationLegende)};WDHeatmapChartRenderer.prototype.ecouteLegende=function(n){return WDChartListener.bind(WDHeatmapChartLegendListener,this.m_oGraphe,n)};WDHeatmapChartRenderer.prototype.getNbLegendLabels=function(){return 10};WDHeatmapChartRenderer.prototype.getLegendColorAt=function(n){return n==0?this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(this.m_dValeurMinZ):this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(this.m_dValeurMaxZ)};WDHeatmapChartRenderer.prototype.getLegendLabelAt=function(n){var t=this.m_params.m_sMasqueValeur;return WDChartUtils.formatValue(n==0?this.m_dValeurMinZ:this.m_dValeurMaxZ,t,!0)};WDHeatmapChartRenderer.prototype.CalculeBorneZ=function(){for(var t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,u=this.m_oModele.m_tabSeries.length,n,r=2;r<u;r+=n?this.nGetPasSerie(n):1)n=this.m_oModele.getSeriesAt(r),i=Math.max(i,Math.max.apply(null,n.m_tabValeur)),t=Math.min(t,Math.min.apply(null,n.m_tabValeur));this.m_dValeurMinZ=Math.min(t,0);this.m_dValeurMaxZ=Math.max(i,0);this.m_clCouleurAltitudeHeatMap=new CCouleurAltitude(this.m_oGraphe.m_oModele.m_oParametres);this.m_dValeurMaxZ-this.m_dValeurMinZ>0&&!this.m_clCouleurAltitudeHeatMap.bUtiliseCouleurAltitude()&&(this.m_clCouleurAltitudeHeatMap.AddCouleurAltitude(this.m_dValeurMinZ,"#00FF00"),this.m_clCouleurAltitudeHeatMap.AddCouleurAltitude((this.m_dValeurMinZ+this.m_dValeurMaxZ)/2,"#FFFF00"),this.m_clCouleurAltitudeHeatMap.AddCouleurAltitude(this.m_dValeurMaxZ,"#FF0000"))};WDHeatmapChartRenderer.prototype._surbrillancePointeurLegende=function(n,t,i){var s=n.polygon(this.m_domGroupeLegendeEtTitre,"legende-curseur"),o,h,l;if(!i)return s&&s.length&&s.finish().fadeOut({always:function(){this.visible=!1}}),t;if(o=n.findFromId(this.m_domGroupeLegendeEtTitre,"legende-degrade"),!o||!o.length)return t;var e=o.wbData("wbGrfDrawInfos"),u=e.x,f=e.y,r=5,c=e.height>e.width,a=undefined;clWDUtil.isObject(t)&&(a=!1,h=o.wbData("wbGrfOnScrollResize"),h||$(window).on("scroll.wb.grf.heatmap.legende resize.wb.grf.heatmap.legende trigger.wb.grf.heatmap.legende",function(){o.wbData("wbGrfOnScrollResize",h=o.offset())}).trigger("trigger.wb.grf.heatmap.legende"),t=c?this.m_dValeurMinZ+(1-(t.y-h.top)/e.height)*(this.m_dValeurMaxZ-this.m_dValeurMinZ):this.m_dValeurMinZ+(t.x-h.left)/e.width*(this.m_dValeurMaxZ-this.m_dValeurMinZ));l=1-(t-this.m_dValeurMinZ)/(this.m_dValeurMaxZ-this.m_dValeurMinZ);c?f+=e.height*l:u+=e.width*(1-l);s[0].visible||s.finish().fadeIn({always:function(){this.visible=!0}});this.m_oPaint.setFill("black");var y=this.m_params.m_sMasqueValeur,p=WDChartUtils.formatValue(t,y,!0),v=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLegende,p,["color"]);return v.color&&this.m_oPaint.setFill(v.color),n.drawPolygon(s,c?[[u-r,f-r],[u+r,f],[u-r,f+r],[u-r,f-r]]:[[u-r,f-r],[u+r,f-r],[u,f+r],[u-r,f-r]],this.m_oPaint,a),t};WDHeatmapChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r,u,f,e){var h,c,l,o,s;if(i){if(o=e?e.wbData("wbGrfDonneesInfos"):this.m_oGraphe.grInfoXY("i",u,f,"wbGrfDonneesInfos"),!o)return;if(s=o.i,this.sDernierAppelSurbrillanceSerieDepuisMire==s)return;this.sDernierAppelSurbrillanceSerieDepuisMire=s;var a=this.m_oGraphe.m_oModele.getSeriesAt(0,!1),v=this.m_oGraphe.m_oModele.getSeriesAt(1,!1),y=this.m_oGraphe.m_oModele.getSeriesAt(2,!1);h=a.getValueAt(o.i);c=v.getValueAt(o.i);l=y.getValueAt(o.i)}else this.sDernierAppelSurbrillanceSerieDepuisMire=undefined;this._surbrillancePointeurLegende(n,l,i);this._surbrillanceGraduation(n,h,c,i)};WDHeatmapChartRenderer.prototype._surbrillanceGraduation=function(n,t,i,r){var u=n.findFromId(n.m_domBaliseSVG,"groupe-axes");u.find("tspan").css("font-weight","");r&&(n.findFromId(u,"groupe-axe-0").find("text").each(function(){if($(this).wbData("wbGrfGraduationValeur")==t)return $(this).find("tspan").css("font-weight","bolder"),!1}),n.findFromId(u,"groupe-axe-1").find("text").each(function(){if($(this).wbData("wbGrfGraduationValeur")==i)return $(this).find("tspan").css("font-weight","bolder"),!1}))};WDHeatmapChartSeriesRenderer.bParametresSupportes=function(n,t){return WDScatterChartSeriesRenderer.bParametresSupportes(n,t)?(t.m_oParametres.m_bSpline=!1,!0):!1};WDHeatmapChartSeriesRenderer.prototype=new WDScatterChartSeriesRenderer;WDHeatmapChartSeriesRenderer.prototype.constructor=WDHeatmapChartSeriesRenderer;WDHeatmapChartSeriesRenderer.prototype.nGetPasSerie=function(n){this.m_chartRenderer.nGetPasSerie(n)};WDHeatmapChartSeriesRenderer.prototype.getValueDrawingPosition=function(n,t,i,r,u){var f=this.m_chartRenderer.getDrawingPositionX(r+(r<0?1:0),u),e=this.m_chartRenderer.getDrawingPositionY(n-t+(n<t?1:0),u);return{x:f,y:e}};WDHeatmapChartSeriesRenderer.prototype.drawSeries=function(n,t,i,r,u){var st,ht,ct,f,e,o,y,k;var g=u.isDisplayCategoriesLabel(),at=u.isDisplayValuesLabel(),vt=u.m_sMasqueValeur,h=i,nt=i+1,tt=i+2,l=this.m_oModele.getSeriesAt(h,!1),p=this.m_oModele.getSeriesAt(nt,!1),it=this.m_oModele.getSeriesAt(tt,!1);if(p&&it){var yt=this.m_oModele.getAxisByType(EAxisType.X),rt=r.getNbValues(),ut=this.m_chartRenderer.getDrawnValuesCount(rt,yt);if(ut!=0){var c=[],a=l.isOnSecondaryAxis(),pt=this.m_chartRenderer.getYOriginValue(a),ft=p.getNbValues(),s=n.g(t,"serie-line-"+h);WDHeatmapChartAnimator.ms_bAnimationPluie&&n.empty(s);var et=WDPaintCSS.oGetInfoCSS(this.m_chartRenderer.m_params.m_sClasseLibelle,"0"+(g?"\n0":""),["width","height","lineHeight"]),ot=parseInt10(et.lineHeight),wt=parseInt10(et.height);for(f=0;f<Math.min(ut,rt);++f){if(f>=ft)break;var v=it.getValueAt(f),w=p.getValueAt(f),b=l.getValueAt(f);b=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,b,f,h);w=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,w,f,nt);e=this.getValueDrawingPosition(w,pt,h,b,a);o="";g&&(o+=this.m_oModele.getCategoryLabelAt(f));at&&(o.length&&(o+="\n"),o+=WDChartUtils.formatValue(v,vt,!0));e.label=o;v=this.m_chartRenderer.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,v,f,tt);e.z={width:this.m_chartRenderer.dGetXPixelsPerUnit(a)/2,height:this.m_chartRenderer.dGetYPixelsPerUnit(a)/2};e.x-=this.m_chartRenderer.dGetXPixelsPerUnit(a)/2;e.y+=this.m_chartRenderer.dGetYPixelsPerUnit(a)/2;e.color=this.m_chartRenderer.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(v);e.stroke="transparent";e.fAnimation=!1;e.radialCentre=!0;e.data={wbGrfDonneesInfos:{i:f}};c.push(e)}for(st=c.length,st===0?n.empty(s):(ht=this.m_oModele.getSeriesColor(h),this.saveLineData(s,h,c),ct=l.m_eTypePoint,l.m_eTypePoint=EPointStyle.SQUARE,this.drawPoints(n,s,h,l,c,u,ht),l.m_eTypePoint=ct),f=0;f<c.length;++f){if(f>=ft)break;e=c[f];o=e.label;o.length&&wt<e.z.height*2&&(y=n.text(s,"label-"+i+"-"+ +f),this.m_chartRenderer.m_oPaint.addClasse(this.m_chartRenderer.m_params.m_sClasseLibelle),this.m_chartRenderer.m_oPaint.DesactivePointerEvents(),n.drawText(y,o,ot,e.x,e.y-ot*o.split("\n").length*.5,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_chartRenderer.m_oPaint,!1))}for(k=c.length;(y=n.findFromId(s,"label-"+i+"-"+ +k)).length>0;++k)n.remove(y);if(WDHeatmapChartAnimator.ms_bAnimationPluie){var d=1,bt="opacity:0;animation:"+u.m_nDureeAnimation*d+"ms fadeInDownBig, "+u.m_nDureeAnimation*d+"ms fadeIn forwards;",lt=s.find("rect");lt.each(function(t){var r=bt+"animation-delay:"+t/lt.length*u.m_nDureeAnimation*d+"ms";$(this).add(n.findFromId(s,"label-"+i+"-"+ +t)).attr("style",r).animate({content:1},{queue:"fx",duration:u.m_nDureeAnimation,always:function(){$(this).removeAttr("style")}})})}}}};WDHeatMapChartAxisRenderer.prototype=new WDXYChartAxisRenderer;WDHeatMapChartAxisRenderer.prototype.constructor=WDHeatMapChartAxisRenderer;WDHeatMapChartAxisRenderer.prototype.isDrawLabelsBetweenGraduations=function(){return!0};WDHeatMapChartAxisRenderer.prototype.isDrawnZero=function(){return!1};WDHeatMapChartAxisRenderer.prototype.isDrawnAxisLine=function(){return!1};WDHeatMapChartAxisRenderer.getAxisStep=WDHeatMapChartAxisRenderer.prototype.getAxisStep=function(){return 1}