/*! 26.0.2.0 */
/*! VersionVI: 01F260101d   */
function WDCacheRequete(n){this.m_oChampTable=n;this.m_oDate=new Date}function WDTableCacheLigneModifie(n){this.m_oCacheLigne=n;this.m_oCacheLigne.m_oLigneHTML.SwapLigneCache(this.m_oCacheLigne.m_nColonneHTML,this);this.m_tabValeursChaine=new Array(n.m_tabValeurs.length);this.m_tabValeursEntier=new Array(n.m_tabValeurs.length)}function WDTableCacheLigne(n,t,i){var u,e,o,s,f;if(n){this.m_sStyleCouleur=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_STYLE_COULEUR,"");this.m_sStyleCouleurFond=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_STYLE_COULEURF,"");this.m_sCleEnreg=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_CLEENREG,"");this.m_nPosAbsolue=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LIGNE_POSABSOLUE,i);u=n.getElementsByTagName(this.XML_RUPTURES);u&&u.length&&(this.m_oValeursRuptures={},e=u[0].getElementsByTagName(this.XML_RUPTURES_HAUT),e&&e.length&&(this.m_oValeursRuptures.m_sHaut=clWDAJAXMain.sXMLGetValeur(e[0])),o=u[0].getElementsByTagName(this.XML_RUPTURES_BAS),o&&o.length&&(this.m_oValeursRuptures.m_sBas=clWDAJAXMain.sXMLGetValeur(o[0])));for(var h=n.childNodes,c=h.length-(this.m_oValeursRuptures?1:0),l=new Array(c),r=0;r<c;r++)s=h[r],f={},f.m_sStyleCouleur=clWDAJAXMain.sXMLGetAttributSafe(s,this.XML_STYLE_COULEUR,""),f.m_sStyleCouleurFond=clWDAJAXMain.sXMLGetAttributSafe(s,this.XML_STYLE_COULEURF,""),this._vPlaceXMLDansCellule(s,f,r,t),l[r]=f;this.m_tabValeurs=l;this.m_nNbRepliee=clWDAJAXMain.nXMLGetAttributSafe(n,clWDAJAXMain.XML_CHAMP_LIGNES_NBREPLIEES,0)}}function Segment(n,t,i){if(this.m_nDebut=n,this.m_nTaille=t,this.m_nDebut<0&&this.m_nDebut!=-1&&this.m_nTaille!=-1&&(this.m_nTaille!=0&&(this.m_nTaille+=this.m_nDebut),this.m_nDebut=0),i>=0){if(this.m_nDebut>=i){delete this.m_nDebut;delete this.m_nTaille;return}this.m_nDebut+this.m_nTaille>i&&this.m_nTaille!=0&&(this.m_nTaille=i-this.m_nDebut)}}function WDTableCache(n,t){n&&(this.RecalculeMarges(n),this.m_fCacheLigne=t,this.m_tabLignes=[],this.m_tabRequetes=[])}function WDTableAJAXColonne(n,t){if(arguments.length){var r=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_ALIAS,"ALIAS"),u=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_TYPEWL,16),i=[clWDAJAXMain.nXMLGetAttributSafe(n,clWDAJAXMain.XML_CHAMP_ATT_TYPE,WDChamp.prototype.ms_nIDObjetSaisie),clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_TRI),clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_RECHERCHE),clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_FILTRE),clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_VISIBLE,"0"),clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_SAISISSABLE),clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_DEPLACE,0),t,clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_POSAFFICHE,t),clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LARGEUR,undefined),clWDAJAXMain.tabXMLGetTableauValeur(n,"OPTION"),clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_AJUSTABLE),undefined,undefined,clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_MODEAFFICHAGE,this.ms_eAdapteCentre)];WDTableColonne.prototype.constructor.apply(this,[r,u,i]);this.m_sBulle=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_BULLE,null);this.m_sTitre=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_TITRE,null);this.m_bCurseurDefaut=undefined;switch(i[0]){case WDChamp.prototype.ms_nIDObjetCombo:break;case WDChamp.prototype.ms_nIDObjetInterrupteur:break;default:this.m_eTypeIDObjet=WDChamp.prototype.ms_nIDObjetSaisie;case WDChamp.prototype.ms_nIDObjetImage:case WDChamp.prototype.ms_nIDObjetSaisie:this.m_nLien=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LIEN,0);this.m_nLien!=0&&(this.m_nEtatLien=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_ETATLIEN,0));break;case WDChamp.prototype.ms_nIDObjetCellule:}}}function WDEtatLigne(n,t){if(n){this.m_oLignePhysique=n.oGetIDElement(t);this.m_nLigneHTML=t;var i,r=n.vnGetNbLignesLogiquesParLignePhysique();for(this.m_tabLignesLogiques=new Array(r),i=0;i<r;i++)this.m_tabLignesLogiques[i]={m_oLigneCache:null,m_oLigneLogique:r>1?n.oGetIDElement(t,i):this.m_oLignePhysique,m_bJamaisAffiche:!n.vbZR()||n.bGetSansLimite()&&1<n.vnGetNbLignesLogiquesParLignePhysique()&&0<n.nGetNbRuptures()};this.m_tabCacheCelluleHTML=[];this.RecalculeObjetsRuptures(n,t)}}function WDEtatLignes(n,t){if(n){var i,r=t;for(this.m_tabEtatLignes=new Array(t),i=0;i<r;i++)this.m_tabEtatLignes[i]=new WDEtatLigne(n,i)}}function WDTable(n,t,i,r,u){var f;if(arguments.length){WDChamp.prototype.constructor.apply(this,arguments);var h=u[0],c=u[1],l=u[2],o=u[3],s=u[4],a=u[5],v=u[6],e=u[7],y=u[8];this.m_sXMLLignesInitial=h;this.m_eCacheLimite=c;this.m_nHauteurLigne=l;this.bGetSansLimite()||(this.m_nPagesMargeMin=o,this.m_nPagesMargeMax=s,this.m_nPagesMargeRequete=parseInt((s+o)/2,10));this.m_eTypeSelection=a;this.m_tabStyle=v;e&&(this.m_tabFleches=e.splice(3,1)[0],this.m_oPopupSaisieTRF=new WDPopupSaisieTRF(this,e));this.m_bHauteurLigneVariable=y;this.m_oStyleCacheLargeur=new WDStyleCache(!0);this.m_oStyleCacheLargeur.Creation();this.m_oStyleCacheLargeur.CreationFin();this.m_tabImagesNonAffichee=[];this.m_tabCacheTailleImage=[];this.m_oValideLigneTableZR=null;this.m_oDonneFocusTableZR=null;this.m_oMAJDivPosParentScroll=null;this.m_bAncrageLargeur=!0;this.m_bAncrageHauteur=!0;this.m_bDebordeLargeur=!1;this.m_oTitrePosPixel=null;this.m_bTitrePosPixelParentLargeur_QW269772=!1;this.m_nNbInits=0;this.m_bVisibleMasque=undefined;this.m_bVisibleMasqueTransparent=undefined;this.ms_tabTablesZRs.DeclareChamp(this);this.m_oContenuPourValideLigneTableZRSuivant={};this.m_bDansOnSelectLigneExterne=!1;clWDUtil.bRWD&&(f=this,NSPCS.NSUtil.ms_oNotificationsChangementTranche.AddNotification(function(){f.m_oMasque&&f.vOnChangementTranche.apply(f,arguments)}))}}function WDValideLigneTableZR(n,t,i,r,u){this.m_nLigneAbsolue=t;this.m_sCelluleId=n;this.m_bChangement=i;this.m_oContenu=clWDAJAXMain.oCompleteValeurPage(clWDUtil.tabGetElements(document.getElementById(n),!1),r||{});this.m_nTimer=u}function WDDonneFocusTableZR(n,t,i,r){this.m_nDefilement=n;this.m_nLigneAbsolue=t;this.m_nNumElement=i;this.m_nColonne=r}function WDCelluleAJAXSaisie(){arguments.length&&WDCelluleSaisie.prototype.constructor.apply(this,arguments)}WDCacheRequete.prototype={m_nColonneTri:-1,m_nLigne:-1,m_nIdRequeteAJAX:undefined,sCommandeAjax_LignesTable:"LIGNESTABLE",sCommandeAjax_LignesTriTable:"LIGNESTRITABLE",sCommandeAjax_ParCourtAP:"PARCOURTAP",sCommandeAjax_RechercheTable:"RECHERCHETABLE",sCommandeAjax_FiltreTable:"FILTRETABLE",sCommandeAjax_AnnuleFiltreTable:"ANNULEFILTRETABLE",sCommandeAjax_DeplaceColonne:"DEPLACECOLONNE",sCommandeAjax_ModifTable:"MODIFTABLE",sParametreAjax_ColonneLien:"WD_TABLE_COL_LIEN_",sParametreAjax_Debut:"WD_TABLE_DEBUT_",sParametreAjax_Nombre:"WD_TABLE_NOMBRE_",sParametreAjax_CleEnreg:"WD_TABLE_CLEENREG_",sParametreAjax_CleEnreg_Pos:"WD_TABLE_CLEENREG_POS_",sParametreAjax_CleEnregAP:"WD_TABLE_CLEENREGAP_",sParametreAjax_CleEnregAP_Pos:"WD_TABLE_CLEENREGAP_POS_",sParametreAjax_TriAWP:"WD_TABLE_TRIAWP_",sParametreAjax_ColTri:"WD_TABLE_COL_TRI_",sParametreAjax_Recherche_Marge:"WD_TABLE_RECHERCHE_MARGE_",sParametreAjax_Recherche_Nombre:"WD_TABLE_RECHERCHE_NOMBRE_",sParametreAjax_Recherche_Col:"WD_TABLE_RECHERCHE_COL_",sParametreAjax_Recherche_Valeur:"WD_TABLE_RECHERCHE_VAL_",sParametreAjax_Deplace_Col:"WD_TABLE_DEPLACE_COLONNE_",sParametreAjax_Deplace_Pos:"WD_TABLE_DEPLACE_POSITION_",sParametreAjax_Filtre_Filtre:"WD_TABLE_FILTRE_FILTRE_",_sGetNomChamp:function(){return encodeURIComponent(this.m_oChampTable.m_sAliasChamp)},sConstuitAWP:function(n){var t=this.sConstuitPosAP(),r,i,u;return clWDAJAXMain.m_bPageAWP&&(this.m_oChampTable.m_nColonneTriePre>-1&&(t+="&"+this.sParametreAjax_TriAWP+"="+encodeURIComponent((this.m_oChampTable.m_bTriCroissantPre?"+":"-")+this.m_oChampTable.m_nColonneTriePre)),r=this.m_oChampTable.oGetElementByName(document,"_DATA"),r&&(i=r.value,i&&i.length&&(t+="&"+this._sGetNomChamp()+"_DATA="+encodeURIComponent(i))),n||(u=clWDAJAXMain.sConstruitValeurChamp(this.m_oChampTable.m_oChampFormulaireSelAWP),u.length&&(t+="&"+u))),t},sConstuitPosAP:function(){return this.m_oChampTable.m_sCleParcourtAP.length==0?"":"&"+this.sParametreAjax_CleEnregAP_Pos+"="+this.m_oChampTable.m_nNbLignes+"&"+this.sParametreAjax_CleEnregAP+"="+encodeURIComponent(this.m_oChampTable.m_sCleParcourtAP)},sConstuitRequeteRechercheTable:function(n,t,i){var r=this.sCommandeAjax_RechercheTable+"="+this._sGetNomChamp();return r+="&"+this.sParametreAjax_Recherche_Marge+"="+t,r+="&"+this.sParametreAjax_Recherche_Nombre+"="+n,r+="&"+this.sParametreAjax_Recherche_Col+"="+this.m_nColonneTri,r+="&"+this.sParametreAjax_Recherche_Valeur+"="+encodeURIComponent(i),r+this.sConstuitAWP(!1)},sConstuitRequeteFiltreTable:function(n,t,i,r,u){var f=this.sCommandeAjax_FiltreTable+"="+this._sGetNomChamp();return f+="&"+this.sParametreAjax_Recherche_Marge+"="+t,f+="&"+this.sParametreAjax_Recherche_Nombre+"="+n,f+="&"+this.sParametreAjax_Recherche_Col+"="+i,f+="&"+this.sParametreAjax_Filtre_Filtre+"="+r,f+="&"+this.sParametreAjax_Recherche_Valeur+"="+encodeURIComponent(u),f+this.sConstuitAWP(!1)},sConstuitRequeteAnnuleFiltreTable:function(n,t,i){var r=this.sCommandeAjax_AnnuleFiltreTable+"="+this._sGetNomChamp();return r+="&"+this.sParametreAjax_Recherche_Marge+"="+t,r+="&"+this.sParametreAjax_Recherche_Nombre+"="+n,r+="&"+this.sParametreAjax_Recherche_Col+"="+i,r+this.sConstuitAWP(!1)},sConstuitRequeteDeplaceColonneTable:function(n,t){var i=this.sCommandeAjax_DeplaceColonne+"="+this._sGetNomChamp();return i+="&"+this.sParametreAjax_Deplace_Col+"="+n,i+="&"+this.sParametreAjax_Deplace_Pos+"="+t,i+this.sConstuitAWP(!1)},sConstuitRequeteLignesTable:function(n,t,i){var r="";return this.m_oSegment.m_nDebut!=-1&&this.m_oSegment.m_nTaille!=-1?(r=(this.m_nColonneTri>-1?this.sCommandeAjax_LignesTriTable:this.sCommandeAjax_LignesTable)+"="+this._sGetNomChamp(),r+="&"+this.m_oSegment.m_nDebut+"="+this.m_oSegment.m_nTaille,this.m_nColonneTri>=0&&(r+="&"+this.sParametreAjax_ColTri+"="+(n?"":"-")+this.m_nColonneTri)):r=this.sCommandeAjax_ParCourtAP+"="+this._sGetNomChamp(),r+=this.sConstuitAWP(!1),i.length>0&&(r+="&"+this.sParametreAjax_CleEnreg_Pos+"="+t,r+="&"+this.sParametreAjax_CleEnreg+"="+encodeURIComponent(i)),r},sConstuitRequeteModifLigne:function(n,t,i){var u=this.sCommandeAjax_ModifTable+"="+this._sGetNomChamp(),f,r,e;if(u+="&LIGNE="+this.m_nLigne,i.length>0&&(u+="&"+this.sParametreAjax_CleEnreg+"="+encodeURIComponent(i)),u+=this.sConstuitAWP(!1),n)""!=t&&(u+="&"+t);else{for(f=new Array(t.length),e=t.length,r=0;r<e;r++)f[r]=t[r].m_nValeur!==undefined&&t[r].m_nValeur!==-1?"C"+r+"="+t[r].m_nValeur:"C"+r+"="+encodeURIComponent(t[r].m_sValeur);u+="&"+f.join("&")}return u},sConstuitRequeteSelection:function(n,t,i,r){var u=this.sParametreAjax_Debut+"="+t+"&"+this.sParametreAjax_Nombre+"="+i;return u+="&"+this.sParametreAjax_ColonneLien+"="+(n!=-1?n+1:""),r.length>0&&(u+="&"+this.sParametreAjax_CleEnreg+"="+encodeURIComponent(r)),u+this.sConstuitAWP(!0)},sConstuitRequeteEnrouleDeroule:function(){return this.sConstuitAWP(!1)},bEnvoiRequete:function(n,t){var i=n.apply(this,t);return i!==!1?(this.m_nIdRequeteAJAX=i,!0):!1},nEnvoiRequete:function(n,t,i,r,u){return this.m_oSegment=n,this.m_nColonneTri=t,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteLignesTable(i,r,u))},nEnvoiRequeteRecherche:function(n,t,i,r){return this.m_nColonneTri=i,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteRechercheTable(n,t,r))},nEnvoiRequeteFiltre:function(n,t,i,r,u){return clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteFiltreTable(n,t,i,r,u))},nEnvoiRequeteAnnuleFiltre:function(n,t,i){return clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteAnnuleFiltreTable(n,t,i))},nEnvoiRequeteDeplaceColonne:function(n,t){return clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteDeplaceColonneTable(n,t))},nEnvoiRequeteModifLigne:function(n,t,i,r){return this.m_nLigne=n,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteModifLigne(t,i,r))},nEnvoiRequeteSelection:function(n,t,i,r,u,f){var o=!1,s=!0,h,c,e;if(-1!=n)switch(this.m_oChampTable.nGetOptionLienColonne(n)){case 2:o=!0;break;case 3:s=!1;break;case 4:o=!0;s=!1}return s?clWDAJAXMain.nAJAXRecupereLignesTableSelection(this,this.sConstuitRequeteSelection(n,i,r,u),o):(h=undefined,c=undefined,o?_JSL(_PAGE_,t,f||"_self",h,c,"CLICTABLE;"+t):(e=clWDUtil.sGetPageAction(undefined,!0),e+="?"+clWDAJAXMain.sCommandeWDAction+"=CLICTABLE;"+t,e+="&"+this.m_oChampTable.m_sAliasChamp+"="+this.m_oChampTable._vsGetValeurChampFormulaire(),e+=this.sConstuitAWP(!0),_JCL(e,f,h,c)),!1)},nEnvoiRequeteEnrouleDeroule:function(n){return clWDAJAXMain.nAJAXRecupereLignesTableEnrouleDeroule(this,n,this.sConstuitRequeteEnrouleDeroule())},ActionListe:function(n){if(this.m_oChampTable){var t=this.m_oChampTable;this.SupprimeRequete(!1);t.bActionListeDepuisAJAX(n,this.m_nLigne)}},bEstValide:function(){return(new Date).getTime()-this.m_oDate.getTime()<=1e4},SupprimeRequete:function(n){var t=this.m_oChampTable;undefined!==t&&(t.m_oCache.SupprimeRequete(this),n&&t.nSetTimeoutUnique("Reinit",2e3))}};WDTableCacheLigneModifie.prototype.bLigneVirtuelle=!0;WDTableCacheLigneModifie.prototype.vnGetLigneHTML=function(){return this.m_oCacheLigne.vnGetLigneHTML.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.vnGetColonneHTML=function(){return this.m_oCacheLigne.vnGetColonneHTML.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.vnGetPosAbsolue=function(){return this.m_oCacheLigne.vnGetPosAbsolue.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.oGetValeurCellule=function(n,t){return this.m_tabValeursChaine[n]?t?this.m_tabValeursEntier[n]:this.m_tabValeursChaine[n]:this.m_oCacheLigne.oGetValeurCellule.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.SetValeurCellule=function(n,t){n<this.m_tabValeursChaine.length&&(this.m_tabValeursChaine[n]=t(!1),this.m_tabValeursEntier[n]=t(!0))};WDTableCacheLigneModifie.prototype.tabContenuCellule=function(){return this.m_oCacheLigne.tabContenuCellule.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.sGetCleEnreg=function(){return this.m_oCacheLigne.sGetCleEnreg.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.vbMAJLigne=function(n,t,i,r){return this.m_oCacheLigne.vbMAJLigne.apply(this.m_oCacheLigne,[n,t,this.m_tabValeursChaine,r])};WDTableCacheLigneModifie.prototype.DetacheEtVide=function(n){this.m_oCacheLigne.DetacheEtVide(n)};WDTableCacheLigneModifie.prototype.bValideChangement=function(n,t,i){for(var f=!1,u=this.m_tabValeursChaine,e=this.m_tabValeursEntier,o=u.length,r=0;r<o;r++)u[r]!==undefined&&(f|=this.m_oCacheLigne.bChangementValeur(r,u[r],e[r]));return f?(t.CreeRequeteModifLigne(n,i,!1,this.m_oCacheLigne.m_tabValeurs),!0):!1};WDTableCacheLigneModifie.prototype.bSetHauteur=function(){return this.m_oCacheLigne.bSetHauteur.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.nGetHauteur=function(){return this.m_oCacheLigne.nGetHauteur.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.nGetHauteurDirect=function(){return this.m_oCacheLigne.nGetHauteurDirect.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigneModifie.prototype.SetStyle=function(){return this.m_oCacheLigne.SetStyle.apply(this.m_oCacheLigne,arguments)};WDTableCacheLigne.prototype.XML_STYLE_COULEUR="COULEUR";WDTableCacheLigne.prototype.XML_STYLE_COULEURF="COULEURFOND";WDTableCacheLigne.prototype.XML_CLEENREG="CLEENREG";WDTableCacheLigne.prototype.XML_LIGNE_POSABSOLUE="POSABSOLUE";WDTableCacheLigne.prototype.XML_RUPTURES="RUPTURES";WDTableCacheLigne.prototype.XML_RUPTURES_HAUT="HAUT";WDTableCacheLigne.prototype.XML_RUPTURES_BAS="BAS";WDTableCacheLigne.prototype.m_oVide={m_sValeur:"",m_sStyleCouleur:"",m_sStyleCouleurFond:"",m_nValeur:-1,m_sCleEnreg:""};WDTableCacheLigne.prototype.m_nValeur=-1;WDTableCacheLigne.prototype.m_nHauteur=-1;WDTableCacheLigne.prototype._vPlaceXMLDansCellule=function(n,t,i,r){var u,e,f;t.m_sValeur=clWDAJAXMain.sXMLGetValeur(n);switch(r.eColonneTypeIDObjet(i)){case WDChamp.prototype.ms_nIDObjetCombo:u=clWDAJAXMain.tabXMLGetTableauValeur(n,"OPTION");u||(u=r.tabColonneCombo(i));t.m_tabOptions=u;u?(e=clWDUtil.nDansTableau(u,t.m_sValeur),clWDUtil.nElementInconnu!=e&&(t.m_nValeur=e)):t.m_nValeur=-1;break;case WDChamp.prototype.ms_nIDObjetInterrupteur:t.m_nValeur=parseInt(t.m_sValeur,10);break;case WDChamp.prototype.ms_nIDObjetCellule:f=n.childNodes;f.length==3&&f[1].nodeName==clWDAJAXMain.XML_CHAMP_LIGNES_LIGNE_CORPS&&(t.m_sValeur=clWDAJAXMain.sXMLGetValeur(f[1]))}};WDTableCacheLigne.prototype.vnGetLigneHTML=function(n){return n};WDTableCacheLigne.prototype.vnGetColonneHTML=function(){return 0};WDTableCacheLigne.prototype.vnGetPosAbsolue=function(){return this.m_nPosAbsolue};WDTableCacheLigne.prototype.vnGetNbReplieesOuEnroulees=function(){return this.m_nNbRepliee-1};WDTableCacheLigne.prototype.vnGetNbReplieesInclusSelf=function(){return this.m_nNbRepliee};WDTableCacheLigne.prototype.oGetValeurCellule=function(n,t){var i=n<this.m_tabValeurs.length?this.m_tabValeurs[n]:this.m_oVide;return t?i.m_nValeur:i.m_sValeur};WDTableCacheLigne.prototype.tabContenuCellule=function(n){return this.m_tabValeurs[n].m_tabOptions};WDTableCacheLigne.prototype.sGetCleEnreg=function(){return this.m_sCleEnreg};WDTableCacheLigne.prototype.vbMAJLigne=function(n,t,i,r){var s=!n.vbZR(),a=s&&n.vbLigneEstSelectionneeSansZR(t),e,h,o,c,l;if(!this.m_oLigneHTML)return!1;if(e=this.vnGetColonneHTML(),h=this.m_oLigneHTML.oGetLigneLogiqueHTML(e),this.SetCouleurObjet(n.m_sCSSTexteStyleSelectionCouleurFond,h,a,this),o=!0,s&&(o=0==this.vnGetNbReplieesInclusSelf(),clWDUtil.SetDisplay(h,o)),o){for(var v=this.m_tabValeurs,y=[],f=-1,p=v.length,u;(u=this.m_oLigneHTML.oGetCellule(e,++f,n))||f<p;)u&&(c=f<p?v[f]:this.m_oVide,l=c.m_sValeur,i&&undefined!==i[f]&&(l=i[f]),n.vRemplitCellule(u,l,t,f,this,r,y),u=u.parentNode,s&&(clWDUtil.bBaliseEstTag(u,"td")&&u==u.parentNode.firstElementChild&&!u.nextElementSibling&&clWDUtil.bBaliseEstTag(u.parentNode.parentNode.parentNode.parentNode,"div")&&(u=u.parentNode.parentNode.parentNode.parentNode),u=u.parentNode),this.SetCouleurObjet(n.m_sCSSTexteStyleSelectionCouleurFond,u,a,c));clWDUtil.bForEach(y,function(n){return n(),!0})}return n.RemplitRuptures(this.m_oLigneHTML,e,this.m_oValeursRuptures),!0};WDTableCacheLigne.prototype.DetacheEtVide=function(n){this.m_oLigneHTML&&this.m_oLigneHTML.DetacheEtVide(this.m_nColonneHTML,n)};WDTableCacheLigne.prototype.SetValeurCellule=clWDUtil.m_pfVide;WDTableCacheLigne.prototype.SetCouleurObjet=function(n,t,i,r){var u=r.m_sStyleCouleurFond,f,e,o;i&&undefined!=n&&(u=n);f=t.style;f.color!=r.m_sStyleCouleur&&(f.color=r.m_sStyleCouleur);f.backgroundColor!=u&&(f.backgroundColor=u);e=t.previousElementSibling;e&&clWDUtil.bAvecClasse(e,"wbtablesep")&&(o=e.style,o.backgroundColor!=u&&(o.backgroundColor=u))};WDTableCacheLigne.prototype.bChangementValeur=function(n,t,i){var r=this.m_tabValeurs;return n<r.length&&!(r[n].m_sValeur===t)?(r[n].m_sValeur=t,r[n].m_nValeur=i,!0):!1};WDTableCacheLigne.prototype.bSetHauteur=function(n){var t=this.m_nHauteur;return this.m_nHauteur=n,t!==n};WDTableCacheLigne.prototype.nGetHauteur=function(n){return-1==this.m_nHauteur&&(this.m_nHauteur=n.nCalculeHauteurLigne(this.m_oLigneHTML)),this.nGetHauteurDirect()};WDTableCacheLigne.prototype.nGetHauteurDirect=function(){return this.m_nHauteur};WDTableCacheLigne.prototype.SetStyle=function(n,t,i,r,u){this.m_oLigneHTML&&(this.m_oLigneHTML.SetStyle(t,this.m_nColonneHTML,n),t._vbAvecCouleurDeFondSelection()&&this.m_oLigneHTML.bMAJSiPlein(this.m_nColonneHTML,t,i,r,u))};Segment.prototype.m_nDebut=-1;Segment.prototype.m_nTaille=0;Segment.prototype.bIntersecte=function(n){return this.m_nDebut==-1||this.m_nTaille<=0?!0:n&&n.m_nTaille==0?(delete this.m_nDebut,delete this.m_nTaille,!0):!n||n.m_nDebut==-1||n.m_nTaille<=0?!1:this.m_nDebut>=n.m_nDebut&&this.m_nDebut+this.m_nTaille<=n.m_nDebut+n.m_nTaille?(delete this.m_nDebut,delete this.m_nTaille,!0):this.m_nDebut<n.m_nDebut&&this.m_nDebut+this.m_nTaille>n.m_nDebut?(this.m_nTaille=n.m_nDebut-this.m_nDebut,!1):this.m_nDebut>=n.m_nDebut&&this.m_nDebut<n.m_nDebut+n.m_nTaille&&this.m_nDebut+this.m_nTaille>n.m_nDebut+n.m_nTaille?(this.m_nTaille-=n.m_nDebut+n.m_nTaille-this.m_nDebut,this.m_nDebut=n.m_nDebut+n.m_nTaille,!1):!1};Segment.prototype.bEstVide=function(){return this.m_nTaille<0||this.m_nDebut<0&&this.m_nDebut+this.m_nTaille<=0};WDTableCache.prototype.m_nDebutCache=-1;WDTableCache.prototype.XML_LIGNE="LIGNE";WDTableCache.prototype.XML_LIGNE_NUMERO="NUMERO";WDTableCache.prototype.RecalculeMarges=function(n){if(!n.bGetSansLimite()){var t=n.m_nNbLignesPage,i=n.m_nPagesMargeMin,r=n.m_nPagesMargeMax,u=n.m_nPagesMargeRequete;this.m_nLignesMargeMinAvant=i*t;this.m_nLignesMargeMinTaille=(i*2+1)*t+2;this.m_nLignesMargeMaxAvant=r*t;this.m_nLignesMargeMaxApres=(r+1)*t+2;this.m_nLignesMargeRequeteAvant=Math.min(u*t,this.m_nLignesMargeMaxAvant);this.m_nLignesMargeRequeteTaille=Math.min((u*2+1)*t+2,this.m_nLignesMargeMaxAvant+this.m_nLignesMargeMaxApres)}};WDTableCache.prototype.bRemplitCache=function(n,t,i,r,u){var f,e,l,o,s;if(i>-1&&(this.m_tabLignes.length=0,delete this.m_nDebutCache),e=n.m_nDebut,n.bGetSansLimite())f=new Segment(0,0);else{var h=n.m_nNbLignes,a=new Segment(Math.max(0,e-this.m_nLignesMargeMinAvant),this.m_nLignesMargeMinTaille,t?-1:h),c=-1;if(t||(c=h,n.m_nNbLignesPage<=h&&(c+=this.m_nLignesMargeMinTaille)),f=new Segment(Math.max(0,e-this.m_nLignesMargeRequeteAvant),this.m_nLignesMargeRequeteTaille,c),this.m_nDebutCache!=-1&&!t){if(l=new Segment(Math.max(0,this.m_nDebutCache),this.m_tabLignes.length),a.bIntersecte(l))return!1;if(this.bIntersecteAnciennesRequetes(a,i>-1,u))return!0;f.bIntersecte(l)}}return this.bIntersecteAnciennesRequetes(f,i>-1,u)?!1:(o=-1,s="",clWDAJAXMain.m_bPageAWP&&(this.m_nDebutCache>=0&&!n.bGetSansLimite()&&(o=this.m_nDebutCache<f.m_nDebut?Math.min(this.m_nDebutCache+this.m_tabLignes.length-1,f.m_nDebut-1):Math.max(this.m_nDebutCache,f.m_nDebut+f.m_nTaille),s=this.sGetCleEnregLigne(o)),-1<e&&n.m_sCleDebut&&(o==-1||Math.abs(e-f.m_nDebut)<Math.abs(e-o))&&(o=e,s=n.m_sCleDebut)),this.CreeRequete(n,f,i,r,o,s),!0)};WDTableCache.prototype.bIntersecteAnciennesRequetes=function(n,t,i){this.PurgeAnciennesRequetes(t);for(var u=this.m_tabRequetes.length,r=0;r<u;r++)if(n.bIntersecte(this.m_tabRequetes[r].m_oSegment))return!0;return n.bEstVide()&&i&&(n.m_nDebut=0,n.m_nTaille=1),n.bEstVide()};WDTableCache.prototype.bEnvoiRequete=function(n,t,i){var r=new WDCacheRequete(t);return r.bEnvoiRequete(n,i)?(this.m_tabRequetes.push(r),!0):!1};WDTableCache.prototype.CreeRequete=function(n,t,i,r,u,f){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequete,n,[t,i,r,u,f])};WDTableCache.prototype.CreeRequeteRecherche=function(n,t,i){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteRecherche,n,[n.m_nNbLignesPage,this.m_nLignesMargeRequeteAvant?this.m_nLignesMargeRequeteAvant:0,t,i])};WDTableCache.prototype.CreeRequeteFiltre=function(n,t,i,r){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteFiltre,n,[n.m_nNbLignesPage,this.m_nLignesMargeRequeteAvant?this.m_nLignesMargeRequeteAvant:0,t,i,r])};WDTableCache.prototype.CreeRequeteAnnuleFiltre=function(n,t){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteAnnuleFiltre,n,[n.m_nNbLignesPage,this.m_nLignesMargeRequeteAvant?this.m_nLignesMargeRequeteAvant:0,t])};WDTableCache.prototype.CreeRequeteDeplaceColonne=function(n,t,i){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteDeplaceColonne,n,[t,i])};WDTableCache.prototype.CreeRequeteModifLigne=function(n,t,i,r){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteModifLigne,n,[t,i,r,this.sGetCleEnregLigne(t)])};WDTableCache.prototype.bCreeRequeteSelection=function(n,t,i,r){var u=this.m_nDebutCache,f=this.m_tabLignes.length;return n.bGetSansLimite()&&1==n.m_tabSelection.length&&(u=n.m_tabSelection[0],f=1),this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteSelection,n,[t,i,u,f,this.sGetCleEnregLigne(this.m_nDebutCache),r])};WDTableCache.prototype.CreeRequeteEnrouleDeroule=function(n,t){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteEnrouleDeroule,n,[t,this.sGetCleEnregLigne(t)])};WDTableCache.prototype.sGetCleEnregLigne=function(n){if(this.bDansPlageCache(n)){var t=this.m_tabLignes[n-this.m_nDebutCache];if(t)return t.sGetCleEnreg()}return""};WDTableCache.prototype.PurgeAnciennesRequetes=function(n){for(var r=this.m_tabRequetes.length,i,t=0;t<r;t++)(this.m_tabRequetes[t].bEstValide()==!1||n)&&(delete this.m_tabRequetes[t].m_oChampTable,i=clWDAJAXMain.GetWDAJAXRequete(this.m_tabRequetes[t].m_nIdRequeteAJAX),i!=null&&i.Annule(),delete i,this.m_tabRequetes.splice(t,1),t--,r--)};WDTableCache.prototype.SupprimeRequete=function(n){for(var i=this.m_tabRequetes.length,t=0;t<i;t++)if(this.m_tabRequetes[t].m_oDate.getTime()==n.m_oDate.getTime()&&this.m_tabRequetes[t].m_nIdRequeteAJAX==n.m_nIdRequeteAJAX){delete this.m_tabRequetes[t].m_oChampTable;this.m_tabRequetes.splice(t,1);return}};WDTableCache.prototype.bAvecRequeteTri=function(){for(var t=this.m_tabRequetes.length,n=0;n<t;n++)if(this.m_tabRequetes[n].m_nColonneTri>-1)return!0;return!1};WDTableCache.prototype.__nPlaceLigneCache=function(n,t){var u,i,r;if(!n.bGetSansLimite()&&(u=n.m_nDebut,t<u-this.m_nLignesMargeMaxAvant||t>=u+this.m_nLignesMargeMaxApres))return-1;if(this.m_nDebutCache==-1)return this.m_tabLignes.push(null),this.m_nDebutCache=t,0;if(t<this.m_nDebutCache){for(r=this.m_nDebutCache-t,i=0;i<r;i++)this.m_tabLignes.unshift(null);return this.m_nDebutCache=t,0}if(t>=this.m_nDebutCache+this.m_tabLignes.length)for(r=t-this.m_nDebutCache-this.m_tabLignes.length+1,i=0;i<r;i++)this.m_tabLignes.push(null);else t-this.m_nDebutCache<this.m_tabLignes.length&&this.m_tabLignes[t-this.m_nDebutCache]!=null&&(delete this.m_tabLignes[t-this.m_nDebutCache].m_tabValeurs,this.m_tabLignes[t-this.m_nDebutCache]=null);return t-this.m_nDebutCache};WDTableCache.prototype.RemplitCacheLignes=function(n,t){for(var o=this.bDansPlageCache(n.m_nDebut),r=t.firstChild,u,i,f,e;r!=null;){if(u=parseInt(clWDAJAXMain.sXMLGetAttribut(r,this.XML_LIGNE_NUMERO),10),i=this.__nPlaceLigneCache(n,u),i!=-1){if(this.m_tabLignes[i]=new this.m_fCacheLigne(r,n,u),f=this.m_tabLignes[i].vnGetNbReplieesOuEnroulees(),0<f)for(e=this.m_tabLignes[i].vnGetPosAbsolue()+f;this.m_tabLignes[i+1]&&this.m_tabLignes[i+1].vnGetPosAbsolue()<=e;)this.m_tabLignes.splice(i+1,1);o&&n.NoteMAJLigne(u)}r=r.nextSibling}};WDTableCache.prototype.SupprimeLignesInutiles=function(n){var t,i;if(this.m_nDebutCache!=-1){if(t=this.m_tabLignes,n.bGetSansLimite()){t.length>n.m_nNbLignes&&t.splice(n.m_nNbLignes);return}if(i=n.m_nDebut,this.m_nDebutCache+t.length<=i-this.m_nLignesMargeMaxAvant||this.m_nDebutCache>=i+this.m_nLignesMargeMaxApres){t.length=0;delete this.m_nDebutCache;return}for(this.m_nDebutCache<i-this.m_nLignesMargeMaxAvant&&(t.splice(0,i-this.m_nLignesMargeMaxAvant-this.m_nDebutCache),this.m_nDebutCache=i-this.m_nLignesMargeMaxAvant),this.m_nDebutCache+t.length>=i+this.m_nLignesMargeMaxApres&&t.splice(i-this.m_nDebutCache+this.m_nLignesMargeMaxApres),this.m_nDebutCache+t.length>n.m_nNbLignes&&t.splice(n.m_nNbLignes-this.m_nDebutCache);t.length&&!t[0];)t.splice(0,1),this.m_nDebutCache++;while(t.length&&!t[t.length-1])t.splice(t.length-1,1);0==t.length&&delete this.m_nDebutCache}};WDTableCache.prototype.oGetLigne=function(n){return this.bDansPlageCache(n)?this.m_tabLignes[n-this.m_nDebutCache]:null};WDTableCache.prototype.bMAJLigne=function(n,t,i){var r=this.oGetLigne(t);return r?r.vbMAJLigne(n,t,undefined,i):!1};WDTableCache.prototype.oGetValeurCellule=function(n,t,i){var r=this.oGetLigne(n);return r?r.oGetValeurCellule(t,i):i?-1:""};WDTableCache.prototype.tabContenuCellule=function(n,t){var i=this.oGetLigne(n);return i?i.tabContenuCellule(t):null};WDTableCache.prototype.bDansPlageCache=function(n){return n>=this.m_nDebutCache&&n<this.m_nDebutCache+this.m_tabLignes.length};WDTableCache.prototype.SetValeurCellule=function(n,t,i,r){if(this.m_nDebutCache!=-1){var u=n-this.m_nDebutCache;u<=this.m_tabLignes.length&&this.m_tabLignes[u]!=null&&this.m_tabLignes[u].SetValeurCellule(i,r)}};WDTableCache.prototype.bValideChangement=function(n,t){var i=this.m_tabLignes[t-this.m_nDebutCache];return i&&i.bLigneVirtuelle?i.bValideChangement(n,this,t):!1};WDTableCache.prototype.SupprimeLignesVirtuelles=function(){for(var i=this.m_tabLignes.length,n,t=0;t<i;t++)n=this.m_tabLignes[t],n&&n.bLigneVirtuelle&&(this.m_tabLignes[t]=n.m_oCacheLigne,n.m_oCacheLigne.m_oLigneHTML.SwapLigneCache(n.m_oCacheLigne.m_nColonneHTML,n.m_oCacheLigne),delete n.m_oCacheLigne,delete n.m_tabValeurs,delete n)};WDTableCache.prototype.bCreeLigneVirtuelle=function(n){var t=n-this.m_nDebutCache;return this.m_tabLignes[t]?(this.m_tabLignes[t].bLigneVirtuelle||(this.m_tabLignes[t]=new WDTableCacheLigneModifie(this.m_tabLignes[t])),!0):!1};WDTableCache.prototype.bSetHauteur=function(n,t){var i=this.oGetLigne(n);return i?i.bSetHauteur(t):!1};WDTableCache.prototype.nGetHauteur=function(n,t){var i=this.oGetLigne(t);return i?i.nGetHauteur(n):-1};WDTableCache.prototype.nPosAbsolue2PosVisible=function(n){var t,r,i;if(this.m_tabLignes.length==0||!this.m_tabLignes[0]||n<this.m_tabLignes[0].vnGetPosAbsolue()||!this.m_tabLignes[this.m_tabLignes.length-1]||n>this.m_tabLignes[this.m_tabLignes.length-1].vnGetPosAbsolue())return n;for(r=this.m_tabLignes.length,t=0;t<r;t++)if(i=this.m_tabLignes[t],i&&i.vnGetPosAbsolue()==n)return t+this.m_nDebutCache;return n};WDTableCache.prototype.nPosVisible2PosAbsolue=function(n){if(this.m_tabLignes.length==0)return n;var t=this.oGetLigne(n);return t?t.vnGetPosAbsolue():-1};WDTableAJAXColonne.prototype=new WDTableColonne;WDTableAJAXColonne.prototype.constructor=WDTableAJAXColonne;WDTableAJAXColonne.prototype.m_nLien=0;WDTableAJAXColonne.prototype.m_nEtatLien=0;WDTableAJAXColonne.prototype.XML_ALIAS="ALIAS";WDTableAJAXColonne.prototype.XML_TYPEWL="TYPEWL";WDTableAJAXColonne.prototype.XML_SAISISSABLE="SAISISSABLE";WDTableAJAXColonne.prototype.XML_VISIBLE="VISIBLE";WDTableAJAXColonne.prototype.XML_LIEN="LIEN";WDTableAJAXColonne.prototype.XML_ETATLIEN="ETATLIEN";WDTableAJAXColonne.prototype.XML_BULLE="BULLE";WDTableAJAXColonne.prototype.XML_TITRE="TITRE";WDTableAJAXColonne.prototype.XML_TRI="TRI";WDTableAJAXColonne.prototype.XML_RECHERCHE="RECHERCHE";WDTableAJAXColonne.prototype.XML_FILTRE="FILTRE";WDTableAJAXColonne.prototype.XML_LARGEUR="LARGEUR";WDTableAJAXColonne.prototype.XML_DEPLACE="DEPLACE";WDTableAJAXColonne.prototype.XML_POSAFFICHE="POSAFFICHE";WDTableAJAXColonne.prototype.XML_AJUSTABLE="AJUSTABLE";WDTableAJAXColonne.prototype.XML_MODEAFFICHAGE="MODEAFFICHAGE";WDEtatLigne.prototype.oGetLigneLogique=function(n){return this.m_tabLignesLogiques[n]};WDEtatLigne.prototype.oGetLigneLogiqueHTML=function(n){return this.m_tabLignesLogiques[n].m_oLigneLogique};WDEtatLigne.prototype.oGetCellule=function(n,t,i){var r;if(this.m_tabLignesLogiques.length<=1)r=t;else if(t==0)r=n;else return null;return this.oGetCelluleHTML(i,r)};WDEtatLigne.prototype.RecalculeObjetsRuptures=function(n,t){n.nGetNbRuptures()>0&&(this.m_oRupturesHaut=n.oGetIDElement(WDTable.prototype.ID_RUPTURE_HAUT,t),this.m_oRupturesBas=n.oGetIDElement(WDTable.prototype.ID_RUPTURE_BAS,t))};WDEtatLigne.prototype.nInvalide=function(n,t,i,r){for(var f=this.m_tabLignesLogiques.length,u=0;u<f;u++)(this.bPlein(u)||i)&&(this.MasqueLigne(u,n,t,r,t%2==0?n.m_tabStyle[0]:n.m_tabStyle[1]),t++);return t};WDEtatLigne.prototype.SwapLigneCache=function(n,t){this.m_tabLignesLogiques[n].m_oLigneCache=t};WDEtatLigne.prototype.SetStyle=function(n,t,i){var r=this.oGetLigneLogiqueHTML(t);n.vbZR()&&(r=1<n.vnGetNbLignesLogiquesParLignePhysique()?r.parentNode:r.firstElementChild);r.className=i};WDEtatLigne.prototype.bPlein=function(n){return!!this.m_tabLignesLogiques[n].m_oLigneCache};WDEtatLigne.prototype.bJamaisAffiche=function(n){var t=this.m_tabLignesLogiques[n].m_bJamaisAffiche;return t&&(this.m_tabLignesLogiques[n].m_bJamaisAffiche=!1),t};WDEtatLigne.prototype.bMAJSiPlein=function(n,t,i,r,u){var f=this.m_tabLignesLogiques[n].m_oLigneCache;return f?this.bMAJ(n,f,t,i,r,u):!1};WDEtatLigne.prototype.bMAJ=function(n,t,i,r,u,f){var e;return t?(this.AfficheLigne(n,t,i,r,u),e=t.vbMAJLigne(i,r,undefined,f)):(this.MasqueLigne(n,i,r,u),e=!0),i.PostMAJLigne(t,r,f),e};WDEtatLigne.prototype.DetacheEtVide=function(n,t){this.Detache(n);t.vVideCellule(this,n)};WDEtatLigne.prototype.Detache=function(n){this.DetacheO(this.m_tabLignesLogiques[n])};WDEtatLigne.prototype.DetacheO=function(n){n.m_oLigneCache&&(delete n.m_oLigneCache.m_oLigneHTML,delete n.m_oLigneCache.m_nColonneHTML,n.m_oLigneCache=null)};WDEtatLigne.prototype.AfficheLigne=function(n,t,i,r,u){var f=this.m_tabLignesLogiques[n];i.PreMAJLigne(f,u);f.m_oLigneCache!=t&&(this.DetacheO(f),t.DetacheEtVide(i),f.m_oLigneCache=t,t.m_oLigneHTML=this,t.m_nColonneHTML=n);f.m_oLigneLogique.style.visibility="inherit";this.vAfficheLigne(i)};WDEtatLigne.prototype.MasqueLigne=function(n,t,i,r,u){var f=this.m_tabLignesLogiques[n];t.PreMAJLigne(f,r);this.DetacheO(f);t.vVideCellule(this,n);n==0&&t.VideRuptures(this);t.vbZR()?f.m_oLigneLogique.style.visibility="hidden":undefined!==u&&this.SetStyle(t,n,u);clWDUtil.bBaliseEstTag(f.m_oLigneLogique.parentNode,"td")&&(f.m_oLigneLogique.parentNode.style.backgroundColor="transparent");clWDUtil.bBaliseEstTag(f.m_oLigneLogique,"tr")&&(f.m_oLigneLogique.style.backgroundColor="");this.vAfficheLigne(t)};WDEtatLigne.prototype.vAfficheLigne=function(n){n.vbZR()?(this.m_oLignePhysique.style.visibility=this.m_tabLignesLogiques[0].m_oLigneCache?"inherit":"hidden",n.bGetSansLimite()&&1<n.vnGetNbLignesLogiquesParLignePhysique()&&0<n.nGetNbRuptures()&&clWDUtil.SetDisplay(this.m_oLignePhysique,undefined!=this.m_tabLignesLogiques[0].m_oLigneCache)):this.m_oLignePhysique.style.visibility=""};WDEtatLigne.prototype.oGetCelluleHTML=function(n,t){var i=this.m_tabCacheCelluleHTML[t];return i?i:(i=n.oGetIDElement(this.m_nLigneHTML,t),this.m_tabCacheCelluleHTML[t]=i,i)};WDEtatLigne.prototype.tabGetCelluleHTMLCache=function(){return this.m_tabCacheCelluleHTML};WDEtatLignes.prototype.RecalculeObjetsRuptures=function(n){for(var i=this.m_tabEtatLignes.length,t=0;t<i;t++)this.m_tabEtatLignes[t].RecalculeObjetsRuptures(n,t)};WDEtatLignes.prototype.Invalide=function(n,t,i,r,u){for(var e=this.m_tabEtatLignes.length,f=i;f<e;f++)t=this.m_tabEtatLignes[f].nInvalide(n,t,r,u)};WDEtatLignes.prototype.nGetNbEtatLignes=function(){return this.m_tabEtatLignes.length};WDEtatLignes.prototype.oGetEtatLigne=function(n){return this.m_tabEtatLignes[n]};WDEtatLignes.prototype.oGetCelluleHTML=function(n,t,i){var r=this.oGetEtatLigne(t);return r?r.oGetCelluleHTML(n,i):null};WDTable.prototype=new WDChamp;WDTable.prototype.constructor=WDTable;WDTable.prototype.m_bDansPostMAJLignes=!1;WDTable.prototype.m_nFacteurAscenseur=1;WDTable.prototype.m_nLimiteHauteur=bIE?nIE>=8?1342177:134217727:71582788;WDTable.prototype.m_nColonneTrie=-1;WDTable.prototype.m_nColonneTriePre=-1;WDTable.prototype.m_bTriCroissant=!0;WDTable.prototype.m_bTriCroissantPre=!0;WDTable.prototype.m_bFinTrouve=!1;WDTable.prototype.m_sCleParcourtAP="";WDTable.prototype.m_bRetourServeurSelection=!0;WDTable.prototype.m_bMasqueVisible=!1;WDTable.prototype.m_nNbRuptures=0;WDTable.prototype.ms_oNotifications=new clWDUtil.WDNotifications;WDTable.prototype.ms_oNotificationsSansLimites=new clWDUtil.WDNotifications;WDTable.prototype.ms_nCachePartiel=0;WDTable.prototype.ms_nCacheComplet=1;WDTable.prototype.ms_nCacheCompletAscenseur=2;WDTable.prototype.XML_NOMBRE="NOMBRE";WDTable.prototype.XML_FIN="FIN";WDTable.prototype.XML_DEBUT="DEBUT";WDTable.prototype.XML_CLEENREGAP="CLEENREGAP";WDTable.prototype.XML_SELECTIONS="SELECTIONS";WDTable.prototype.XML_COLONNES="COLONNES";WDTable.prototype.XML_LIGNES="LIGNES";WDTable.prototype.XML_SELECTION="SELECTION";WDTable.prototype.XML_COLONNE="COLONNE";WDTable.prototype.XML_ERREUR="ERREUR";WDTable.prototype.XML_TRI="TRI";WDTable.prototype.XML_SENS="SENS";WDTable.prototype.XML_DESACTIVESERSEL="DESACTIVESERSEL";WDTable.prototype.XML_TYPESELECTION="TYPESELECTION";WDTable.prototype.XML_DATA="DATA";WDTable.prototype.XML_COLHIERARCHIQUE="COLHIERARCHIQUE";WDTable.prototype.ID_SCROLLBAR="SB";WDTable.prototype.ID_TABLEINTERNE="TB";WDTable.prototype.ID_CHARGEMENT_IMG="LOAD";WDTable.prototype.ID_MASQUE="MASQUE";WDTable.prototype.ID_MASQUETRANSPARENT="MASQUETR";WDTable.prototype.ID_RUPTURE_HAUT="H";WDTable.prototype.ID_RUPTURE_BAS="B";WDTable.prototype.SEL_SEPARATEUR=";";WDTable.prototype.vCacheLigne=WDTableCacheLigne;WDTable.prototype.Init=function(){var r,t,u,i,f,s,e,o,h,n;WDChamp.prototype.Init.apply(this,arguments);this.__CreeStyleLigneSelectionne();this.m_oMasque=this.oGetIDElement(this.ID_MASQUE);this.m_oMasqueTransparent=this.oGetIDElement(this.ID_MASQUETRANSPARENT);this.m_oHote=this.oGetIDElement(this.ID_TABLEINTERNE);this.m_bAncrageTimer=bIEAvec11&&clWDUtil.bHTML5||bFF&&this.m_oHote&&clWDUtil.bDansPlan(this.m_oHote);this.m_bPremierAncrage=!0;switch(this.m_eCacheLimite){case this.ms_nCachePartiel:this.m_oDivPos=this.oGetIDElement(clWDTableDefs.ID_POSITION_PIXEL);this.m_oDivPosParent=this.m_oDivPos.parentNode;break;case this.ms_nCacheCompletAscenseur:this.m_oDivPosParent=this.m_oHote.parentNode;break;case this.ms_nCacheComplet:this.m_oDivPosParent=this.m_oHote.parentNode}r=this.m_oDivPosParent.parentElement;this.m_bAncrageLargeur=this.__bDimensionAvecAncrage(this.m_oDivPosParent.style.width,r&&r.style.width);this.bGetSansLimiteStrict()||(this.m_bAncrageHauteur=this.__bDimensionAvecAncrage(this.m_oDivPosParent.style.height,null));t=this;u=this.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_POSITION_PIXEL);u&&(this.m_oTitrePosPixel=u,this.m_oDivPosParent.onscroll=function(){t.m_oTitrePosPixel.parentNode.scrollLeft=t.m_oDivPosParent.scrollLeft});this.bGetSansLimite()||(this.m_fScroll=function(n){t.DeplaceTable(n||event)},this.m_oAscenseur=this.oGetIDElement(this.ID_SCROLLBAR),this.m_oAscenseurParent=this.m_oAscenseur.parentNode,this.InitForceDefilement(this.m_oDivPosParent));this._vInitHTMLLigne();this.AfficheMasques(!1,!0);i=this.oGetElementByName(document,"_DEB");f=0;i&&(e=this.nGetDebut(i.value),isNaN(e)||(f=e-1,o=this.sGetDebutCle(i.value),o&&(s=o)));clWDAJAXMain.m_bPageAWP&&this.m_oChampFormulaire&&(h=this.m_oChampFormulaire.value,n=document.createElement("input"),n.type="hidden",n.name=this.m_oChampFormulaire.name+"_SEL",n.id=n.name,this.m_oChampFormulaireSelAWP=this.m_oChampFormulaire.parentNode.appendChild(n));this.Reinit(-1,f,h,s,this.m_sXMLLignesInitial)};WDTable.prototype._vInitInitiale=function(){WDChamp.prototype._vInitInitiale.apply(this,arguments);clWDUtil.s_ForceReflowDialogueParent&&this.s_AddNotification(clWDUtil.s_ForceReflowDialogueParent,!1);WDTable.prototype._vInitInitiale=clWDUtil.m_pfVide};WDTable.prototype.vTableZROnSelectLigne=function(n,t){try{var i=this.m_bDansOnSelectLigneExterne;this.m_bDansOnSelectLigneExterne=!0;this._OnSelectLigneAbsolue(n-1,0,t)}finally{this.m_bDansOnSelectLigneExterne=i}};WDTable.prototype.vTableZROnValideLigne=function(n,t){var u=this.m_tabSelection[0],h=this.m_oCache.oGetLigne(u),r,f,e,s,i,o;if(t&&!this.vbZR()&&(f=t.m_oChampFormulaire,f))for(e=this.m_sAliasChamp+"_"+u+"_",s=this.m_tabColonnes.length,i=0;i<s;i++)if(o=document.getElementById(e+i),o&&clWDUtil.bEstFils(f,o)){r=e+i;break}undefined===r&&(r=this._vsGetIDCellule(h,u,0));this._OnValideLigneTableZR(new WDValideLigneTableZR(r,this.m_tabSelection[0],!0,undefined,-1))};WDTable.prototype.veGetModeSelection=function(){return this.m_eTypeSelection};WDTable.prototype.vbSaisieSansSelection=function(n){return WDSelection.prototype.ms_nSelectionSans==this.veGetModeSelection()?this._oGetColonne(n).m_bSaisissable:!1};WDTable.prototype._vsGetIDCellule=function(n,t,i){return this._sGetIDCellule(n,t,i)};WDTable.prototype._sGetIDCellule=function(n,t,i){return this.oGetIDCelluleRel(n.vnGetLigneHTML(t)-this.nGetLigneHTMLDebut(),i).id};WDTable.prototype.OnValideLigneTableZR=function(n,t){var u=t[0],f=t[1],i=t[2],r=this.m_oContenuPourValideLigneTableZRSuivant;if(0<Object.getOwnPropertyNames(r).length&&(i=!0,this.m_oContenuPourValideLigneTableZRSuivant={}),this.bEstLienOuImageDansLien(n))if(this.m_bValideLigneTableZRCelluleDansLien)delete this.m_bValideLigneTableZRCelluleDansLien;else return;null==this.m_oValideLigneTableZR&&(this.m_oValideLigneTableZR=new WDValideLigneTableZR(u,f,i,r,this.nSetTimeout(this._OnValideLigneTableZRTimer,clWDUtil.ms_oTimeoutImmediat)))};WDTable.prototype._OnValideLigneTableZRTimer=function(){var n=this.m_oValideLigneTableZR;this.m_oValideLigneTableZR=null;clWDUtil.bForEach(clWDAJAXMain.m_tabRequetes,function(n){return 2!=n.nOption})&&this._OnValideLigneTableZR(n)};WDTable.prototype._AnnuleValideLigneTableZRTimer=function(){null!==this.m_oValideLigneTableZR&&(clWDUtil.ClearTimeout(this.m_oValideLigneTableZR.m_nTimer),this.m_oValideLigneTableZR=null)};WDTable.prototype._OnValideLigneTableZR=function(n){var t,i;!1!=n.m_bChangement&&(t=n.m_oContenu,t&&(i=clWDAJAXMain.sConstruitValeursChamps(t),i.length>0&&this.m_oCache.CreeRequeteModifLigne(this,n.m_nLigneAbsolue,!0,i)))};WDTable.prototype.OnFocusLigneTableZR=function(n,t){var e=t[0],r=t[1],o=t[2],s=t[3],u,i,f;if(0==clWDUtil.eGetEtatFocus()){if(u=!1,i=this.m_oValideLigneTableZR,null!==i)if(this.vbZR()&&i.m_sCelluleId!=e||i.m_nLigneAbsolue!=r)u=!0;else{i.m_bChangement&&(this.m_oContenuPourValideLigneTableZRSuivant=i.m_oContenu);this.bEstLienOuImageDansLien(n)&&(this.m_bValideLigneTableZRCelluleDansLien=!0);this._AnnuleValideLigneTableZRTimer();return}f=this.__nGetDefilementPourAfficherLigne(r);this.m_oDonneFocusTableZR=new WDDonneFocusTableZR(f,r,o,s);u||this.nSetTimeout(this.DonneFocusTableZR,clWDUtil.ms_nTimeoutNonImmediat20)}};WDTable.prototype.__nGetDefilementPourAfficherLigne=function(n){if(!this.bGetSansLimite()){if(n==this.m_nDebut&&parseInt(this.m_oDivPos.style.top,10)<0)return parseInt(this.m_oDivPos.style.top,10);if(n>=this.m_nDebut+this.m_nNbLignesPage)return parseInt(this.m_oAscenseur.style.height,10)/(this.m_nNbLignes/this.vnGetNbLignesLogiquesParLignePhysique())}return 0};WDTable.prototype.DonneFocusTableZR=function(){var n=this.m_oDonneFocusTableZR,i,r,t;if((this.m_oDonneFocusTableZR=null,null!==n)&&(n.m_nDefilement&&this.__nForceDefilement(n.m_nDefilement,null,!1),i=this.m_oCache.oGetLigne(n.m_nLigneAbsolue),i&&(r=this._vsGetIDCellule(i,n.m_nLigneAbsolue,n.m_nColonne),t=clWDUtil.tabGetElements(document.getElementById(r),!1),t&&t[n.m_nNumElement])))try{clWDUtil.DonneFocus(t[n.m_nNumElement],!0)}catch(u){}};WDTable.prototype.bEstLienOuImageDansLien=function(n){if(!n)return!1;var t=clWDUtil.oGetTarget(n);switch(clWDUtil.sGetTagName(t)){case"img":return clWDUtil.bBaliseEstTag(t.parentNode,"a");case"a":return!0;default:return!1}};WDTable.prototype.s_AddNotification=function(n,t){(t?WDTable.prototype.ms_oNotificationsSansLimites:WDTable.prototype.ms_oNotifications).AddNotification(n)};WDTable.prototype.bGetSansLimite=function(){switch(this.m_eCacheLimite){case this.ms_nCacheComplet:case this.ms_nCacheCompletAscenseur:return!0;default:return!1}};WDTable.prototype.bGetSansLimiteStrict=function(){return this.m_eCacheLimite==this.ms_nCacheComplet};WDTable.prototype.bGetCacheCompletAscenseur=function(){return this.m_eCacheLimite==this.ms_nCacheCompletAscenseur};WDTable.prototype.bAscenseurPossible=function(){switch(this.m_eCacheLimite){case this.ms_nCachePartiel:case this.ms_nCacheCompletAscenseur:return!0;default:return!1}};WDTable.prototype.__CreeStyleLigneSelectionne=function(){var t=this.m_tabStyle[2],n,u,i,r;0<t.length&&(n={},u=this,clWDUtil.bForEach(t.split(" "),function(t){return t!==""&&u.__ParseCSSTexteStyleSelection("."+t,n),!0}),this.__ParseCSSTexteStyleSelection("#ctz"+this.m_sAliasChamp+" ."+t,n),this.__ParseCSSTexteStyleSelection("#con-"+this.m_sAliasChamp+" ."+t,n),i=[],clWDUtil.bForEachIn(n,function(n,t){return i.push(n+":"+t),!0}),r=i.join(";"),0<r.length&&(this.m_sCSSTexteStyleSelection=r,this.m_tabCSSTexteCelluleSelection=[]))};WDTable.prototype.__ParseCSSTexteStyleSelection=function(n,t){var i="background-",u="color",f="image",r=this;clWDUtil.bForEach(clWDUtil.sGetCSSTexte(n).split(";"),function(n){var o,e,s;return 0<n.length&&(o=n.indexOf(":"),0<o&&(e=clWDUtil.sSupprimeEspaces(n.substr(0,o)),s=clWDUtil.sSupprimeEspacesDebutFin(n.substr(o+1)),i==e.substr(0,i.length).toLowerCase()?u==e.substr(i.length,u.length).toLowerCase()?r.m_sCSSTexteStyleSelectionCouleurFond=s:f==e.substr(i.length).toLowerCase()&&undefined===r.m_sCSSTexteStyleSelectionCouleurFond&&(r.m_sCSSTexteStyleSelectionCouleurFond=""):t[e]=s)),!0})};WDTable.prototype.nGetDebut=function(n){return parseInt(n,10)};WDTable.prototype.sGetDebutCle=function(n){return(n=n+"",n.indexOf(";")>-1)?n.substring(n.indexOf(";")+1):null};WDTable.prototype._vInitHTMLLigne=function(){this.m_oSourceHTML=clWDUtil.oEvalJSON(clWDUtil.sGetHTMLDansCommentaire(this.m_oHote))};WDTable.prototype.Reinit=function(n,t,i,r,u){if(!(++this.m_nNbInits>16)){if(n===undefined||(this.m_nColonneTrie=n,this.m_nColonneTriePre=n),this.SetDebut(0),this.m_nNbLignes=0,this.m_oAffichageColonnes&&this.m_oAffichageColonnes.LibereTitres(),this.m_tabFleches&&(this.m_oAffichageColonnes=new WDAffichageColonnes(this,this.m_tabFleches,this.m_oStyleCacheLargeur),this.m_oCelluleSaisie=new WDCelluleAJAXSaisie(this)),this.m_tabSelection=[],this.m_tabColonnes=[],this.m_nNbLignesPage=this.bGetSansLimite()?0:-1,this.m_oCache=new WDTableCache(this,this.vCacheLigne),i){for(var f=parseInt(i,10);!isNaN(f);){if(this.m_tabSelection.push(f),i.indexOf(this.SEL_SEPARATEUR)==-1)break;i=i.substring(i.indexOf(this.SEL_SEPARATEUR)+1);f=parseInt(i,10)}this._vSetValeurChampFormulaire(isNaN(f)?"":f)}this.OnResizeTable(0,t,r,u)}};WDTable.prototype.InitForceDefilement=function(n){var t=this;bTouch?new WDDragTouch(function(i,r,u){t.__bForceDefilement(r,u);t._vbGetDebordeLargeur()&&(n.scrollLeft=Math.max(0,n.scrollLeft+i))},n):clWDUtil.AttacheDetacheEvent(!0,n,bFF?"DOMMouseScroll":"mousewheel",function(n){n=n||event;var i;return i=n.wheelDelta?-n.wheelDelta/180*t.m_nHauteurLigne:(n.detail?n.detail:0)*20,t.__bForceDefilement(i,n)},WDDrag.prototype.ms_oCaptureSansPassiveSans)};WDTable.prototype.__bForceDefilement=function(n,t){return 0!=this.m_nNbLignes&&0!=n&&(n=this.__nForceDefilement(n,t,!0),n!=0)?clWDUtil.bStopPropagationCond(t,n!=0):!0};WDTable.prototype.__nForceDefilement=function(n,t,i){var u=parseInt(this.m_oAscenseur.style.height,10),r,f;return u<=this.m_oAscenseurParent.clientHeight?0:(r=this.m_oAscenseurParent.scrollTop,f=r+n<0?0:r+n>u-this.m_oAscenseurParent.clientHeight?u-this.m_oAscenseurParent.clientHeight:r+n,i&&f!=r&&this._vForceDefilement(t),this.m_oAscenseurParent.scrollTop=f,this.DeplaceTable(t),this.m_oAscenseurParent.scrollTop-r)};WDTable.prototype._vForceDefilement=clWDUtil.m_pfVide;WDTable.prototype.bMAJNbLignesVisibles=function(n,t,i){if(this._vInvalideDebordeLargeur(),this.bGetSansLimite())return!1;this.RedimAscenseur();var r=this.bCalculeLigneAffiche(t)||i;return t?r:(r&&(this.__GenereLignesHTML(),this.InitEtatLignes(this.m_nNbLignesHTML),this.AfficheColonnes(),this.m_oCache.RecalculeMarges(this)),this.MAJAscenseur(),n&&r&&this.bMAJLignes(),r)};WDTable.prototype.OnResizeTable=function(n,t,i,r){var u;u=0==n&&bIEAvec11&&clWDUtil.bRWD&&r?!0:this.__bMAJDivPosParentHauteur(n);u&&undefined===t||this.__OnResizeTable(n,t,i,r,!1)};WDTable.prototype.__OnResizeTable=function(n,t,i,r,u){var h,e,f,o,s;if(this.m_bAncrageLargeur||this.m_bAncrageHauteur||2!=n){if(this.bMAJNbLignesVisibles(!1,!1,u),!this._vbGetDebordeLargeur()&&this.m_oAffichageColonnes&&this.m_oAffichageColonnes.ColonnesRestaure(),h=!1,t&&t>1&&(this.SetDebut(t,i),this.m_nNbLignes=t+this.m_nNbLignesPage,this.bGetSansLimite()||(this.MAJAscenseur(!0),h=!0)),r)f=this._oParseToXML(r),f&&f.firstChild&&(f.firstChild.tagName==clWDAJAXMain.XML_LISTE?o=f.firstChild:f.firstChild.nextSibling&&f.firstChild.nextSibling.tagName==clWDAJAXMain.XML_LISTE&&(o=f.firstChild.nextSibling),o&&(e=!this.bActionListe(o,h)));else if(!this.bGetSansLimite())if(this.m_oCache.bRemplitCache(this,0==n,-1,this.m_bTriCroissant))e=!0;else try{s=document.body.gbH100_set;bIEAvec11&&this.m_bAncrageHauteur&&!s&&(document.body.gbH100_set=!0);this.bMAJLignes()}finally{bIEAvec11&&this.m_bAncrageHauteur&&!s&&(document.body.gbH100_set=s)}e&&this.AfficheMasque(e,!1)}};WDTable.prototype._oParseToXML=function(n){var i,t;return window.DOMParser?(new DOMParser).parseFromString(n,"text/xml"):window.ActiveXObject?(i=new ActiveXObject("MSXML.DomDocument"),i.async=!1,i.loadXML(n),i):window.XMLHttpRequest?(t=new XMLHttpRequest,t.open("GET","data:application/xml;charset=utf-8,"+encodeURIComponent(n),!1),t.overrideMimeType("application/xml"),t.send(null),t):undefined};WDTable.prototype.OnDisplay=function(n,t){WDChamp.prototype.OnDisplay.apply(this,arguments);t&&this.m_oDivPosParent&&clWDUtil.bEstFils(this.m_oDivPosParent,n)&&(this.OnResizeTable(1),this.bGetSansLimite()||this.MAJAscenseurRuptures(!0))};WDTable.prototype._vOnResize=function(){(WDChamp.prototype._vOnResize.apply(this,arguments),WDTable.prototype.m_bDansPostMAJLignes)||this.m_bRedimensionneUnMasque||(this.m_bMasqueVisible&&(this.m_bVisibleMasque&&this.__RedimensionneUnMasque(this.m_oMasque),this.m_bVisibleMasqueTransparent&&this.__RedimensionneUnMasque(this.m_oMasqueTransparent)),this.OnResizeTable(2))};WDTable.prototype.__bDimensionAvecAncrage=function(n,t){return""==n?t?this.__bDimensionAvecAncrage(t,null):!0:-1!=n.indexOf("%")};WDTable.prototype.__bAncrageTimer=function(){var n,t;return this.m_bAncrageTimer?!0:(bCrm||bFF)&&document.getElementById("dww"+this.m_sAliasChamp)?!0:(n=window.WDOnglet,n&&!clWDUtil.m_oChamps.bPourTousChamps(function(t,i){return!(i instanceof n)}))?(this.m_bAncrageTimer=!0,!0):!this.m_bPremierAncrage&&(t=this,!this.ms_tabTablesZRs.bPourTousChamps(function(n,i){if(t!=i&&(i.m_bAncrageLargeur||i.m_bAncrageHauteur)){var r=i.m_oHote;if(r&&clWDUtil.bEstDisplay(r,document)&&!(document.getElementById("dww"+i.m_sAliasChamp)&&0==i.m_oHote.offsetHeight))return!1}return!0}))?(this.m_bAncrageTimer=!0,!0):this.m_bAncrageTimer};WDTable.prototype.__bMAJDivPosParentHauteur=function(n){var r=!1,t=this.m_bAncrageLargeur,i=this.m_bAncrageHauteur&&this.bAscenseurPossible(),u,f;return(t||i)&&(f=this.__bAncrageTimer(),0!=n&&f&&!this.m_oMAJDivPosParentScroll&&(u={m_nLeft:this.m_oDivPosParent.scrollLeft,m_nTop:this.m_oDivPosParent.scrollTop}),t&&(this.m_oTitrePosPixel&&(this.m_oTitrePosPixel.parentNode.style.width="1px"),this.m_oDivPosParent.style.width="1px"),i&&(this.m_oDivPosParent.style.height="1px"),f&&(!bIEAvec11||event)?(t&&this.m_oTitrePosPixel&&clWDUtil.SetDisplay(this.m_oTitrePosPixel,!1),clWDUtil.SetDisplay(this.m_oDivPosParent,!1),u&&(this.m_oMAJDivPosParentScroll=u),this.nSetTimeoutUnique("__MAJDivPosParentHauteur2",clWDUtil.ms_nTimeoutNonImmediat100,n,t,i,!0),r=!0):this.bGetTimeXXXExiste("__MAJDivPosParentHauteur2")?r=!0:this.__MAJDivPosParentHauteur2(n,t,i,!1)),r};WDTable.prototype.__MAJDivPosParentHauteur2=function(n,t,i,r){var u=this.m_oDivPosParent,l=u.parentNode,g=l.parentNode.parentNode.parentNode.parentNode,a,e,o,s,p,nt,tt,w,v,b,f,k,d,h,c,y;if(t&&(e=this.__nCorrigeDimensionIEAncrage(function(n){return n.offsetWidth},l,g),this.m_oTitrePosPixel&&(a=this.m_oTitrePosPixel.parentNode,o=e)),r&&(t&&this.m_oTitrePosPixel&&clWDUtil.SetDisplay(this.m_oTitrePosPixel,!0),clWDUtil.SetDisplay(u,!0)),i&&(s=this.__nCorrigeDimensionIEAncrage(function(n){return n.offsetHeight},l,g)),(bFF||bIEAvec11&&clWDUtil.bHTML5)&&(p=clWDUtil.oGetCurrentStyle(l),o&&(o-=this.s_nGetOffsetBorderPourWidth(clWDUtil.oGetCurrentStyle(a.parentNode))),e&&(e-=this.s_nGetOffsetBorderPourWidth(p)),s&&(s-=this.s_nGetOffsetBorderPourHeight(p))),bEdge?(o&&o--,e&&e--,s&&s--):bCrm&&(nt=document.body.scrollWidth,tt=document.body.scrollHeight),this.__bAffecteProprieteSiValeurDefinie(a,"width",o),this.m_bTitrePosPixelParentLargeur_QW269772=!1,this.__bAffecteProprieteSiValeurDefinie(u,"width",e),this.__bAffecteProprieteSiValeurDefinie(u,"height",s),bCrm&&!bEdge)for(w=0,0!=n&&!clWDUtil.bHTML5&&this.m_oTitrePosPixel&&this.bGetCacheCompletAscenseur()&&(w=this._nGetLargeurAscenseurVertical(u)),v=-1,b=-1,f=!0;f;)f=!1,k=document.body.scrollWidth,d=document.body.scrollHeight,(window.innerWidth<k||window.innerHeight<d)&&(h=k-nt-w,c=d-tt,t&&0<h&&(h<=c||c<=0)&&(f=this.__bAffecteProprieteSiValeurDefinie(a,"width",o,v)||f,this.m_bTitrePosPixelParentLargeur_QW269772=!1,f=this.__bAffecteProprieteSiValeurDefinie(u,"width",e,v)||f,v--),i&&0<c&&(c<=h||h<=0)&&(f=this.__bAffecteProprieteSiValeurDefinie(u,"height",s,b)||f,b--));r&&this.__OnResizeTable(n,undefined,undefined,undefined,!1);y=this.m_oMAJDivPosParentScroll;y&&(u.scrollLeft=y.m_nLeft,u.scrollTop=y.m_nTop,this.m_oMAJDivPosParentScroll=null);this.__ForceReflowSafari();this.m_bPremierAncrage=!1};WDTable.prototype.__bAffecteProprieteSiValeurDefinie=function(n,t,i,r){return undefined!==i?(undefined!==r&&(i+=r),0<=i?(clWDUtil.SetDimensionPxStyle(i,n,t),!0):!1):!1};WDTable.prototype.__ForceReflowSafari=function(){var n,t;bSfr&&(n=new RegExp("Version/\\s*(\\d+)\\.*(\\d+)").exec(navigator.userAgent),n&&n[1]&&parseInt(n[1],10)<10&&(this.m_bReflowTableSafari||(t=this,clWDUtil.nSetTimeout(function(){try{t.m_bReflowTableSafari=!0;t._vOnResize(null)}finally{t.m_bReflowTableSafari=!1}},clWDUtil.ms_nTimeoutNonImmediat100))))};WDTable.prototype.__nCorrigeDimensionIEAncrage=function(n,t,i){var r=n(t);return(bIEAvec11&&r<4||bSfr&&0==r)&&(r=Math.max(r,n(i))),r};WDTable.prototype.InitEtatLignes=function(n){this.m_oEtatLignes=new WDEtatLignes(this,n)};WDTable.prototype.__nNbLignesPage=function(n){var t=this.__nCorrigeDimensionIEAncrage(function(n){return Math.min(n.clientHeight,n.scrollHeight)},this.m_oDivPosParent.parentNode,this.m_oDivPosParent.parentNode.parentNode.parentNode.parentNode.parentNode);return this._vbGetDebordeLargeur()&&(t-=18),Math.max(Math.floor(t/n*this.vnGetNbLignesLogiquesParLignePhysique()),1)};WDTable.prototype.bCalculeLigneAffiche=function(n){var t=this.__nNbLignesPage(this.m_nHauteurLigne);return t!=this.m_nNbLignesPage?(n||(this.m_nNbLignesPage=t),!0):!1};WDTable.prototype._vRefresh=function(n,t,i,r,u,f,e,o){switch(n){case 1:case 2:this._AnnuleValideLigneTableZRTimer();delete this.m_bFinTrouve;delete this.m_sCleParcourtAP}WDChamp.prototype._vRefresh.apply(this,arguments);var s=!1;switch(n){case 1:this.SetDebut(0);this.bGetSansLimite()||(s=!0);case 2:t>-1&&(this.SetDebut(t,i),s=!0)}undefined!==u&&u!=this.m_nNbLignes&&(this.m_nNbLignes=u,s=!0);undefined!==r&&(this.oGetElementByName(document,"_DATA").value=r);this.__RemplitSelonXML(f);s&&!this.bGetSansLimite()&&this.MAJAscenseur(!0);this.__TriColonne(e,o);this.m_oCache.bRemplitCache(this,!0,this.m_nColonneTrie,this.m_bTriCroissant);this.m_oEtatLignes.Invalide(this,this.m_nDebut,0,!1,null);this.AfficheMasque(!0,!0)};WDTable.prototype.SetDebut=function(n,t){var i,r;this.bGetSansLimite()&&0!=n||(this.m_nDebut=n,i=this.oGetElementByName(document,"_DEB"),i&&(i.value=n+1),!t&&this.m_oCache&&(r=this.m_oCache.oGetLigne(n),r&&(t=r.sGetCleEnreg(),t.length==0&&(t=null))),t?(this.m_sCleDebut=t,i&&(i.value+=";"+t)):delete this.m_sCleDebut)};WDTable.prototype.RequeteSelection=function(n){var u=this._vsGetValeurChampFormulaire(),t,i,r;this._vSetValeurChampFormulaire(this.sConstruitRequeteSelection());-1!=n&&(t=this.m_tabColonnes[n].m_sAlias,i=this.m_tabColonnes[n].m_sTarget);r=this.m_oCache.bCreeRequeteSelection(this,n,t,i);this._vSetValeurChampFormulaire(u);r&&this.AfficheMasque(!0,!0)};WDTable.prototype.vnGetNbLignesLogiquesParLignePhysique=function(){return 1};WDTable.prototype._vSetValeurChampFormulaire=function(){WDChamp.prototype._vSetValeurChampFormulaire.apply(this,arguments);this.m_oChampFormulaireSelAWP&&(this.m_oChampFormulaireSelAWP.value=this.sConstruitRequeteSelection())};WDTable.prototype.nLigneSelectionnePosVisible=function(n){return this.nLigneSelectionne(this.nPosVisible2PosAbsolue(n))};WDTable.prototype.nLigneSelectionne=function(n){return clWDUtil.nDansTableau(this.m_tabSelection,n)};WDTable.prototype.bLigneEstSelectionnee=function(n){return clWDUtil.nElementInconnu!=this.nLigneSelectionnePosVisible(n)};WDTable.prototype.bLigneEstSelectionneePosAbsolue=function(n){return clWDUtil.nElementInconnu!=this.nLigneSelectionne(n)};WDTable.prototype.vbLigneEstSelectionneeSansZR=WDTable.prototype.bLigneEstSelectionnee;WDTable.prototype.__bLigneSelectionnePosVisible=function(n,t,i){return this._bLigneSelectionne(this.nPosVisible2PosAbsolue(n),n,t,i)};WDTable.prototype.bLigneSelectionnePosAbsolue=function(n,t,i,r){return clWDUtil.nElementInconnu!=this.nLigneSelectionne(n)?!1:this._bLigneSelectionne(n,t,i,r)};WDTable.prototype._bLigneSelectionne=function(n,t,i,r){if(this.m_tabSelection.push(n),this.__bLigneEstVisible(t)&&WDSelection.prototype.ms_nSelectionSans!=this.veGetModeSelection()){var u=this.m_oCache.oGetLigne(t);u&&u.SetStyle(this.m_tabStyle[2],this,t,r,!0)}return this._vSetValeurChampFormulaire(n+1),i&&this.RecuperePCode(this.ms_nEventNavSelectLigne)(r),!0};WDTable.prototype.bLigneDeselectionne=function(n,t){var i=this.m_tabSelection,f,r,u;return n<0||n>=i.length?!1:(f=i[n],r=this.nPosAbsolue2PosVisible(f),i.splice(n,1),this.__bLigneEstVisible(r)&&WDSelection.prototype.ms_nSelectionSans!=this.veGetModeSelection()&&(u=this.m_oCache.oGetLigne(r),u&&u.SetStyle(this.m_tabStyle[r%2==0?0:1],this,r,t,!1)),this._vSetValeurChampFormulaire(i.length>0?i[i.length-1]+1:""),!0)};WDTable.prototype.bLigneDeselectionneTous=function(n,t){for(var r=!1,u=this.m_tabSelection,i=0;u.length>i;)n!=u[i]?r=this.bLigneDeselectionne(i,t):i++;return r};WDTable.prototype.sConstruitRequeteSelection=function(){return this.m_tabSelection.join(this.SEL_SEPARATEUR)};WDTable.prototype.__bLigneEstVisible=function(n){return this.bGetSansLimite()?n<this.m_nNbLignes:n>=this.m_nDebut&&n<=this.m_nDebut+this.m_nNbLignesPage+1};WDTable.prototype.bActionListeDepuisAJAX=function(n,t){this.bActionListe(n)&&t>-1&&this.__bLigneEstVisible(t)&&this.MAJLigne(t)};WDTable.prototype.bActionListe=function(n,t){var e=this.m_nNbLignes,o,l,i,r,u,s,h,c,f,a;this.m_nNbLignes=parseInt(clWDAJAXMain.sXMLGetAttribut(n,this.XML_NOMBRE),10);o=document.getElementsByName("_"+this.sGetNomElement("_OCC"))[0];o&&(o.value=this.m_nNbLignes);clWDAJAXMain.bXMLAttributExiste(n,this.XML_DESACTIVESERSEL)&&(this.m_bRetourServeurSelection=!1);this.m_eTypeSelection=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_TYPESELECTION,this.m_eTypeSelection);clWDAJAXMain.bXMLAttributExiste(n,this.XML_DATA)&&(document.getElementsByName(this.sGetNomElement("_DATA"))[0].value=clWDAJAXMain.sXMLGetAttribut(n,this.XML_DATA));this._vActionListeSpecifique(n);l=this.m_nNbRuptures;this.m_nNbRuptures=clWDAJAXMain.nXMLGetAttributSafe(n,clWDAJAXMain.XML_CHAMP_LIGNES_RUPTURES,0);i=!1;this.bGetSansLimite()&&(e!=this.m_nNbLignes||window.WDTableHierarchique&&this instanceof WDTableHierarchique?(this.__GenereLignesHTML(),this.InitEtatLignes(this.m_nNbLignesHTML),this.AfficheColonnes()):this.m_nNbLignes==0&&this.InitEtatLignes(0));clWDAJAXMain.bXMLAttributExiste(n,this.XML_TRI)?(this.m_nColonneTriePre=clWDAJAXMain.nXMLGetAttribut(n,this.XML_TRI),this.m_bTriCroissantPre=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_SENS)):(delete this.m_nColonneTriePre,delete this.m_bTriCroissantPre);this.m_bFinTrouve=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_FIN);this.m_sCleParcourtAP=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_CLEENREGAP,"");this.m_nNbRuptures!=l&&this.m_oEtatLignes.RecalculeObjetsRuptures(this);r=clWDAJAXMain.bXMLAttributExiste(n,this.XML_DEBUT);r&&(h=clWDAJAXMain.sXMLGetAttribut(n,this.XML_DEBUT),u=this.nGetDebut(h),s=this.sGetDebutCle(h));switch(clWDAJAXMain.nXMLGetAttributSafe(n,clWDAJAXMain.XML_CHAMP_REFRESH_RESETTABLE,0)){case 1:return r?this._vRefresh(1,u,s):this._vRefresh(1,-1),!1;case 2:return this._vRefresh(2,-1),!1;default:r&&this.SetDebut(u,s)}return this.m_oCache.SupprimeLignesInutiles(this),c=[],i||clWDUtil.bForEach(this.m_tabColonnes,function(n){return c.push(n.bGetVisible()),!0}),this.__RemplitSelonXML(n.firstChild),!this.bGetSansLimite()&&this.m_nNbLignes<e&&this.m_nNbLignes<this.m_nNbLignesHTML&&this.bMAJNbLignesVisibles(!1,!1,!0),f=this.m_tabColonnes,this.m_oAffichageColonnes&&(this.m_oAffichageColonnes.Init(f),i=i||!clWDUtil.bForEach(f,function(n){return n.m_nRangCreation==n.m_nPositionAffichage})),i=i||!clWDUtil.bForEach(this.m_tabColonnes,function(n,t){return c[t]===n.bGetVisible()}),i&&(this.m_oAffichageColonnes&&this.m_oAffichageColonnes.LibereTitres(),this.__GenereLignesHTML(!0),this.m_oAffichageColonnes&&this.m_oAffichageColonnes.InitTitres(),this.InitEtatLignes(this.m_nNbLignesHTML),this.AfficheColonnes()),this.__TriColonne(this.m_nColonneTriePre,this.m_bTriCroissantPre),this.m_oPopupSaisieTRF&&this.m_oPopupSaisieTRF.AjouteLienImages(f),this.bGetSansLimite()||(t|=r,(t||!this.bGetHauteurLigneVariable())&&this.MAJAscenseur(t)),a=this.bMAJLignes(),null!==this.m_oDonneFocusTableZR&&this.DonneFocusTableZR(),!this.bGetSansLimite()&&this.bGetHauteurLigneVariable()&&this.MAJAscenseurRuptures(),this.bGetSansLimite()&&r&&(location.hash="#"+this.sGetNomElement(this.sGetSuffixeIDElement(u))),!this.bGetSansLimite()&&e<this.m_nNbLignes&&a&&this.m_oCache.bRemplitCache(this,!1,this.m_nColonneTrie,this.m_bTriCroissant),this.m_bFinTrouve==!1&&this.ChercheFin(),0==this.m_oCache.m_tabRequetes.length&&this.m_oCelluleSaisie&&this.m_oCelluleSaisie.OnMAJDonnees(),this.__ForceReflowSafari(),!0};WDTable.prototype.__RemplitSelonXML=function(n){while(n!=null){switch(n.nodeName){case this.XML_LIGNES:this.m_oCache.RemplitCacheLignes(this,n);break;case this.XML_SELECTIONS:this.RemplitSelection(n);break;case this.XML_COLONNES:this.RemplitColonnes(n);break;case this.XML_ERREUR:this.AfficheErreur(n)}n=n.nextSibling}};WDTable.prototype._vActionListeSpecifique=clWDUtil.m_pfVide;WDTable.prototype.bGetHauteurLigneVariable=function(){return this.m_bHauteurLigneVariable||this.m_nNbRuptures>0};WDTable.prototype._vsGetCSSLigneHeight=function(){return"height"};WDTable.prototype._vbAvecCouleurDeFondSelection=clWDUtil.m_pfVide;WDTable.prototype.__GenereLignesHTML=function(n){this.m_nNbLignesHTML=this.bGetSansLimite()?0<this.nGetNbRuptures()?this.m_nNbLignes:Math.ceil(this.m_nNbLignes/this.vnGetNbLignesLogiquesParLignePhysique()):Math.ceil(this.m_nNbLignesPage/this.vnGetNbLignesLogiquesParLignePhysique()+2);var t=this._vtabGenereLignesHTML(n);this.__PlaceDansTable(this.m_oHote,t);bIE&&(this.m_oHote=this.oGetIDElement(this.ID_TABLEINTERNE))};WDTable.prototype._sCorrigeHTMLLigne=function(n){n=n.replace(new RegExp("\\[%"+this.m_sAliasChamp+"%\\]","g"),"[%_INDICE_%]");n=n.replace(/\[%_INDICE_;1%\]/g,"[%_INDICE_%]");n=n.replace(/\[%_CSS_HEIGHT_%\]/g,this._vsGetCSSLigneHeight);var t=clWDUtil.sGetAliasDeEffectif(this.m_sAliasChamp);return t!=this.m_sAliasChamp&&(n=n.replace(new RegExp("\\[%"+t+"\\.\\.ALIAS%\\]","g"),this.m_sAliasChamp)),n};WDTable.prototype._vtabGenereLignesHTML=function(n){for(var r=this.m_oSourceHTML,s=r.tbody,h=this._sCorrigeHTMLLigne(this.__sConstruitHTML(s.contenu[0],!1)),u=this.m_nNbLignesHTML,f=new Array(u),t=0;t<u;t++)f[t]=h.replace(/\[%_INDICE_%\]/g,t);if(n&&this.m_oTitrePosPixel){for(var c=r.thead,e=[],o=c.contenu,l=o.length,i=0;i<l;i++)e.push(this.__sConstruitHTML(o[i],!0));this.__PlaceDansTable(this.m_oTitrePosPixel,e);clWDUtil.bForEachThis(this.m_tabColonnes,this,function(n,t){var i,r;return n&&n.bGetVisible()&&(i=this.oGetIDElement(clWDTableDefs.ID_TITRE,t),i&&null!=n.m_sTitre&&(i.firstElementChild&&clWDUtil.bBaliseEstTag(i.firstElementChild,"table")&&(r=i.getElementsByTagName("td"),r&&r[0]&&(i=r[0])),i.innerHTML=clWDUtil.sEncodeInnerHTML(n.m_sTitre,!0))),!0});bIE&&(this.m_oTitrePosPixel=this.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_POSITION_PIXEL))}return f};WDTable.prototype.__sConstruitHTML=function(n,t){var u=[],i,o,f,c,s,v,e,h,l,y,r,p,a;if(u.push(n.debut),i=n.contenu,this.m_oAffichageColonnes&&this.m_oAffichageColonnes.m_tabPositionAffichage.length)for(o=this.m_oAffichageColonnes.m_tabPositionAffichage,c=o.length,f=0;f<c;f++){if(s=o[f].m_oColonne,v=i[s.m_nRangCreation],v)if(e=!1,s.bGetVisible())e=!0;else if(t)if(clWDUtil.bRWD)e=!0;else for(h=f+1;h<c;h++)if(l=o[h].m_oColonne,y=i[l.m_nRangCreation],y)break;else l.bGetVisible()&&(e=!0);e&&u.push(i[s.m_nRangCreation])}else for(p=i.length,a=this.m_tabColonnes,r=0;r<p;r++)(!a[r]||a[r].bGetVisible())&&u.push(i[r]);return u.push(n.fin),u.join("")};WDTable.prototype.__PlaceDansTable=function(n,t){var i,r;clWDUtil.SupprimeFils(n);bIE?(i=n.outerHTML,i=clWDAJAXMain.sSupprimeEspacements(i),n.outerHTML=i.substr(0,i.length-8)+t.join("")+"<\/TABLE>"):(r=document.createRange(),r.setStart(n,0),n.appendChild(r.createContextualFragment(t.join(""))),n.style.width=n.style.width)};WDTable.prototype.RemplitSelection=function(n){var t,i;for(this.bLigneDeselectionneTous(-1),t=n.firstChild;t!=null;)i=clWDAJAXMain.nXMLGetValeur(t),this.bLigneSelectionnePosAbsolue(i,this.nPosAbsolue2PosVisible(i),!1),t=t.nextSibling};WDTable.prototype.nGetNbRuptures=function(){return this.m_nNbRuptures};WDTable.prototype.RemplitColonnes=function(n){for(var i=[],t=n.firstChild;t!=null;)i.push(new WDTableAJAXColonne(t,i.length)),t=t.nextSibling;this.m_tabColonnes=i;this.AfficheColonnes()};WDTable.prototype.AfficheColonnes=function(){var i,r,n,u,t;for(this.m_oStyleCacheLargeur.CreationAjout(),i=!0,this.bGetCacheCompletAscenseur()&&(this.m_oAffichageColonnes.__ColonnesFige_StyleEnCreation(),i=!1),r=this.m_tabColonnes,u=r.length,n=0;n<u;n++)t=r[n],this.AfficheColonne(n,t.bGetVisible()),0<t.m_nLargeur&&this.m_oAffichageColonnes&&(i&&(this.m_oAffichageColonnes.__ColonnesFige_StyleEnCreation(),i=!1),this.m_oAffichageColonnes.__SetDimColonne(t,t.m_nLargeur));this.m_oStyleCacheLargeur.CreationFin()};WDTable.prototype.nGetNbNiveauAutourCellule=function(n){return clWDUtil.bBaliseEstTag(n.parentNode,"td")&&n.parentNode.style.cssText!=""?6:2};WDTable.prototype.AfficheColonne=function(n,t){var i,r,e;if(this.AfficheCellule(clWDTableDefs.ID_TITRE,n,2,t,!0),i=this.oGetIDElement(0,n),i){var u=this.nGetNbNiveauAutourCellule(i),f=this.__oGetParent(i,u),o=clWDUtil.oGetCurrentStyle(f);if(o.display!=clWDUtil.sGetDisplayPourAffiche(f,t))for(e=this.m_oEtatLignes.nGetNbEtatLignes(),r=0;r<e;r++)this.AfficheCellule(r,n,u,t,!1)}};WDTable.prototype.AfficheCellule=function(n,t,i,r,u){function h(n,t){if(n){clWDUtil.SetDisplay(n,t);var i=n.nextElementSibling;i&&i.id.length==0&&clWDUtil.SetDisplay(i,t)}}var f=this.oGetIDElement(n,t),o,s,e;f=this.__oGetParent(f,i);h(f,r);f&&u&&(o=f.cellIndex,s=f.parentNode,0<=o&&s&&(e=s.nextElementSibling,e&&e.cells&&h(e.cells[o],r)))};WDTable.prototype.__oGetParent=function(n,t){while(n&&t-->0)n=n.parentNode;return n};WDTable.prototype.AfficheErreur=function(n){alert(clWDAJAXMain.sXMLGetValeur(n))};WDTable.prototype.vVideCellule=function(n){var i,t,r;i=n.tabGetCelluleHTMLCache();for(r in i)i.hasOwnProperty(r)&&(t=i[r],t&&(clWDUtil.SupprimeFils(t),t=t.parentNode,this.vbZR()||(clWDUtil.bBaliseEstTag(t,"td")&&t==t.parentNode.firstElementChild&&!t.nextElementSibling&&clWDUtil.bBaliseEstTag(t.parentNode.parentNode.parentNode.parentNode,"div")&&(t=t.parentNode.parentNode.parentNode.parentNode),t=t.parentNode),t.style.backgroundColor=""))};WDTable.prototype.vRemplitCellule=function(n,t,i,r,u,f,e){var o,v=this,l=n.style,s=this._oGetColonne(r),ct=this.eColonneTypeIDObjet(r),tt=s.m_nEtatLien,a,y,st,rt,w,b,c,k,ut,p,h,d,ft,g,nt,ht;s.m_sBulle?n.title=s.m_sBulle:n.removeAttribute("TITLE",0);var et=!1,it=!0,ot=undefined!==this.m_sCSSTexteStyleSelection;ot&&(a=this.m_tabCSSTexteCelluleSelection[n.id],f?(undefined===a&&(a=clWDUtil.sGetCSSTexteElement(n),this.m_tabCSSTexteCelluleSelection[n.id]=a),l.cssText=a+this.m_sCSSTexteStyleSelection):undefined!==a&&(l.cssText=a,delete this.m_tabCSSTexteCelluleSelection[n.id]));switch(ct){case this.ms_nIDObjetInterrupteur:if(!1==s.bGetVisible())break;o=document.createElement("input");o.type="checkbox";et=t=="1";rt=this.sGetSuffixeIDElement(i,this.m_sAliasChamp,r);o.name=rt;o.id=rt;this.bColonneSaisissable(r)?o.onclick=function(n){return v.ClickInterrupteur(n||event,o,i,r),clWDUtil.bStopPropagation(n)}:o.disabled=!0;l.textAlign="center";l.verticalAlign="middle";break;case this.ms_nIDObjetImage:if(t.length>0){if(!ot&&(w=n.firstElementChild,w&&!w.nextElementSibling&&w.getAttribute("data-webdev-src-initial")==t)){it=!1;break}b=this.m_tabCacheTailleImage[t];c=document.createElement("img");undefined===b&&(clWDUtil.bForEach(this.m_tabImagesNonAffichee,function(t,i){return t.m_oCellule==n?(t.m_oImage[s.ms_sEventPourChargementImage]=null,t.m_oImage[s.ms_sEventPourEchec]=null,v.m_tabImagesNonAffichee.splice(i,1),!1):!0}),k={m_oImage:c,m_oCellule:n},this.m_tabImagesNonAffichee.push(k),c[s.ms_sEventPourChargementImage]=function(n){v._OnRedimImage(n||event,this,k)},c[s.ms_sEventPourEchec]=function(n){v._OnEchecChargementImage(n||event,this,k)});c.setAttribute("data-webdev-mode-affichage",s.nGetModeAffichageImage(this));c.className=s.ms_sClasseImage;c.src=t;c.setAttribute("data-webdev-src-initial",t);c.style.opacity=0;this.m_bHauteurLigneVariable||(l.minHeight="10000px");undefined!==b&&e.push(function(){WDTableZRNavigateur.prototype.__s_RedimImage(c,n,b,!0,!1)});this.nGetOptionLienColonne(r)>0&&(tt==0||tt==5)&&(c.onclick=function(n){v.OnColonneLien(i,r,n||event)})}break;case this.ms_nIDObjetCombo:case this.ms_nIDObjetSaisie:default:switch(this.nGetOptionLienColonne(r)){default:case 0:if(this.m_bHauteurLigneVariable&&(-1!=t.indexOf("\r")||-1!=t.indexOf("\n")))for(o=document.createElement("span"),ut=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n"),st=ut.length,y=0;y<st;y++)y>0&&o.appendChild(document.createElement("br")),o.appendChild(document.createTextNode(ut[y]));else o=document.createTextNode(t);break;case 1:case 2:case 3:case 4:o=document.createElement("a");switch(tt){default:case 0:case 5:o.href="javascript:void(0);";o.onclick=function(n){v.OnColonneLien(i,r,n||event)};undefined==s.m_sTarget&&(s.m_sTarget="",p=n.firstElementChild,p&&clWDUtil.bBaliseEstTag(p,"a")&&(h=p.getAttribute("target"),d=p.getAttribute("href"),h&&0<h.length?s.m_sTarget=h:d&&"javascript:"==d.substr(0,11)&&(ft=d.substr(11).split("(")[0],h=String(ft.length&&window[ft]).split(",")[6],h&&(g=h.length,2<=g&&(nt=h.charAt(0),ht=h.charAt(g-1),nt==ht&&("'"==nt||'"'==nt)&&(h=h.substr(1,g-2))),h&&(s.m_sTarget=h)))));break;case 4:o.disabled=!0;case 1:o.readOnly=!0}o.innerHTML=clWDUtil.sEncodeInnerHTML(t,!0)}break;case WDChamp.prototype.ms_nIDObjetCellule:n.innerHTML=t;it=!1;this._SetOnXxxSurChampsCellule(n,i,r)}it&&clWDUtil.SupprimeFils(n);o&&(o=n.appendChild(o),et&&(o.checked=!0));undefined===s.m_bCurseurDefaut&&(s.m_bCurseurDefaut=!this.bColonneSaisissable(r)&&"auto"==clWDUtil.oGetCurrentStyle(n).cursor);s.m_bCurseurDefaut&&"default"!=l.cursor&&(l.cursor="default")};WDTable.prototype.vOnChangementTranche=function(){this.__OnResizeTable(2,undefined,undefined,undefined,!0)};WDTable.prototype._SetOnXxxSurChampsCellule=function(n,t,i){for(var f=n.id,o=clWDUtil.tabGetElements(n,!0),h=o.length,r,e,s,u=0;u<h;u++)r=o[u],e=r.onchange===undefined,clWDUtil.SetOnXxx(r,"onblur",this,this.OnValideLigneTableZR,[f,t,e]),!1==e&&(s=(bIEQuirks||bIE&&nIE<9)&&clWDUtil.bBaliseEstTag(r,"input")&&"checkbox"==r.type.toLowerCase()?"onclick":"onchange",clWDUtil.SetOnXxx(r,s,this,this.OnValideLigneTableZR,[f,t,!0])),clWDUtil.SetOnXxx(r,"onfocus",this,this.OnFocusLigneTableZR,[f,t,u,i])};WDTable.prototype.VideRuptures=function(n){this.nGetNbRuptures()>0&&(this.VideUneRupture(n.m_oRupturesHaut),this.VideUneRupture(n.m_oRupturesBas))};WDTable.prototype.VideUneRupture=function(n){n&&(clWDUtil.SupprimeFils(n),clWDUtil.SetDisplay(n.parentNode,!1))};WDTable.prototype.RemplitRuptures=function(n,t,i){this.nGetNbRuptures()>0&&(i=i?i:{},this.RemplitUnRupture(n.m_oRupturesHaut,i.m_sHaut,t==0),this.RemplitUnRupture(n.m_oRupturesBas,i.m_sBas,!0))};WDTable.prototype.RemplitUnRupture=function(n,t,i){n&&(i&&this.VideUneRupture(n),t&&t.length&&(n.innerHTML=t,clWDUtil.SetDisplay(n.parentNode,!0)))};WDTable.prototype.ClickInterrupteur=function(n,t,i,r){var u=this.nVisible2Relative(i);if(this.bCreeLigneVirtuelle(u)){if(this.m_oCelluleSaisie.bSaisieEnCoursDansCellule(u,r)){this.m_oCelluleSaisie.SaisieFin(!0,!0,this.m_oCelluleSaisie.ms_nColonneSuivante,n);this.m_bBloqueClickSurLigne=!0;return}this.SetValeurCellule(u,r,function(n){return t.checked?n?1:"1":n?0:"0"});this.bValideChangement(u);this.bMAJLigne(i);this.SupprimeLignesVirtuelles()}};WDTable.prototype.ChercheFin=function(){this.m_oCache.m_tabRequetes.length>0||this.m_bFinTrouve||this.nSetTimeoutUnique("EnvoieChercheFin",1e3)};WDTable.prototype.EnvoieChercheFin=function(){this.m_oCache.m_tabRequetes.length>0||this.m_bFinTrouve||this.m_oCache.CreeRequete(this,new Segment(-1,-1),-1,!0,-1,"")};WDTable.prototype.bMAJLigne=function(n){return this.m_oCache.bMAJLigne(this,n,this.vbLigneEstSelectionneeSansZR(n))};WDTable.prototype.bMAJLigneRel=function(n){return this.bMAJLigne(this.nRelative2Visible(n))};WDTable.prototype.nRelative2Visible=function(n){return n+this.m_nDebut};WDTable.prototype.nVisible2Relative=function(n){return n-this.m_nDebut};WDTable.prototype.nRelative2Visible2Absolue=function(n){return this.nPosVisible2PosAbsolue(this.nRelative2Visible(n))};WDTable.prototype.nAbsolue2Visible2Relative=function(n){return this.nVisible2Relative(this.nPosAbsolue2PosVisible(n))};WDTable.prototype.nRelative2Absolue=WDTable.prototype.nRelative2Visible2Absolue;WDTable.prototype.bMAJLignes=function(n){for(var f=0,l=this.m_oEtatLignes.nGetNbEtatLignes(),o=this.vnGetNbLignesLogiquesParLignePhysique(),i=this.m_nDebut,s=-1,e,a=0,h=0,b,v,r,t,k,y,p,c,w,u=0;u<l;u++)for(r=this.oGetEtatLigne(u),t=0;t<o;t++,i++)if(s++,k=r.bJamaisAffiche(t),i>=this.m_nNbLignes)(k||r.bPlein(t))&&r.MasqueLigne(t,this,i,n,this.m_tabStyle[s%2]),f++;else{if(e=this.m_oCache.oGetLigne(i),e&&(s=e.m_nPosAbsolue,a=e.vnGetNbReplieesOuEnroulees(),0<a&&(h+=a),b=u,v=t,e.vnGetColonneHTML()!=t)){for(;t<o;t++)r.MasqueLigne(t,this,i,n),f++;break}y=this.vbLigneEstSelectionneeSansZR(i);r.bMAJ(t,e,this,i,n,y);p=this.m_tabStyle[s%2];(undefined!==this.m_sCSSTexteStyleSelection||undefined!=this.m_sCSSTexteStyleSelectionCouleurFond)&&y&&(p=this.m_tabStyle[2]);r.SetStyle(this,t,p);r.bPlein(t)&&f++}if(h>0&&f+h>=this.m_nNbLignes)for(u=b;u<l;u++){for(++i,t=v+1;t<o;t++)r.MasqueLigne(t,this,i,n),f++;v=-1}return this._vPostMAJLignes(),c=l*o,0<h&&f!=c&&(f=c),w=f!=c,this.AfficheMasque(w,!1),w};WDTable.prototype._vPostMAJLignes=function(){if(!WDTable.prototype.m_bDansPostMAJLignes)try{WDTable.prototype.m_bDansPostMAJLignes=!0;this.ms_oNotifications.LanceNotifications(this,this.m_oDivPosParent);clWDUtil.m_oNotificationsAjoutHTML.LanceNotifications(this,this.m_oDivPosParent);this.bGetSansLimite()&&(this.ms_oNotificationsSansLimites.LanceNotifications(this,this.m_oDivPosParent),clWDUtil.m_oNotificationsRedimensionnement.LanceNotifications(this,this.m_oDivPosParent));typeof FinSubmitAJAX=="function"&&FinSubmitAJAX()}finally{WDTable.prototype.m_bDansPostMAJLignes=!1}};WDTable.prototype.AfficheMasque=function(n,t){(this.m_oCache.bAvecRequeteTri()&&(n=!0),this.m_bMasqueVisible!=n)&&(this.m_bMasqueVisible=n,this.AfficheMasques(t,!1),t&&this.nSetTimeout(this.AfficheMasques,1e3,!1,!1))};WDTable.prototype.AfficheMasques=function(n,t){var f=this.m_oMasque,e=this.m_oMasqueTransparent,i=!1,r=!1,u;this.m_bMasqueVisible&&(n?(r=!0,u=e):(i=!0,u=f),u.style.left=f.parentNode.scrollLeft,this.__RedimensionneUnMasque(u));i!==this.m_bVisibleMasque&&(clWDUtil.SetDisplay(f,i),this.m_bVisibleMasque=i);r!==this.m_bVisibleMasqueTransparent&&(clWDUtil.SetDisplay(e,r),this.m_bVisibleMasqueTransparent=r);t&&(this.m_oMasque.style.visibility="",this.m_oMasqueTransparent.style.visibility="")};WDTable.prototype.__RedimensionneUnMasque=function(n){var i,t,r,u;try{this.m_bRedimensionneUnMasque=!0;i=clWDUtil.oGetCurrentStyle(n);t=n.parentNode;bIEQuirks?(n.style.width=Math.max(this._nGetOffsetWidth(t,i),0)+"px",n.style.height=Math.max(this._nGetOffsetHeight(t,i),0)+"px"):(n.style.height="1px",r=this._nGetOffsetHeight(t,i),this.bGetSansLimiteStrict()&&(r=Math.min(r,t.scrollHeight)),n.style.width=Math.max(this._nGetOffsetWidth(t,i),0)+"px",n.style.height=Math.max(r,0)+"px",this.bGetSansLimiteStrict()&&(u=t.style.position,t.style.position="",t.offsetHeight,t.style.position=u))}finally{this.m_bRedimensionneUnMasque=!1}};WDTable.prototype._MasqueLigneInterne=function(n,t,i){this.m_tabChampsFils._AppelMethodePtr(WDChamp.prototype.OnLigneTableZRMasque,[n+1,t,i])};WDTable.prototype.nGetAscenseurParentScrollTop=function(){var n=this.m_nAscenseurParentScrollTop?this.m_nAscenseurParentScrollTop:this.m_oAscenseurParent.scrollTop;return this.m_nFacteurAscenseur==1?n:n*this.m_nFacteurAscenseur*(1+this.m_nNbLignesPage*(this.m_nFacteurAscenseur-1)/(this.m_nNbLignes-this.m_nNbLignesPage))};WDTable.prototype.SetAscenseurParentScrollTop=function(n,t){var r=n,i,u;this.m_nFacteurAscenseur>1&&(r=n/this.m_nFacteurAscenseur*(1-t*(this.m_nFacteurAscenseur-1)/(this.m_nNbLignes-t)));i=Math.max(Math.floor(r),0);u=this.m_nAscenseurParentScrollTop!==undefined?this.m_nAscenseurParentScrollTop:this.m_oAscenseurParent.scrollTop;u!=i&&(this.m_nAscenseurParentScrollTop=i,this.SetAscenseurParentScrollTopCallBack(i))};WDTable.prototype.SetAscenseurParentScrollTopCallBack=function(n){delete this.m_nAscenseurParentScrollTop;this.m_oAscenseurParent.scrollTop=n};WDTable.prototype._vInvalideDebordeLargeur=function(){this.m_bDebordeLargeur=undefined};WDTable.prototype._vbGetDebordeLargeur=function(){var n,t,i,r;return undefined===this.m_bDebordeLargeur&&(bIEQuirks&&this.m_oDivPosParent.scrollWidth,this.m_bDebordeLargeur=this.m_oDivPosParent.scrollWidth>this.m_oDivPosParent.clientWidth,bIE&&this.bGetSansLimite()&&(this.m_bDebordeLargeur?this.m_oDivPosParent.style.overflowX=="auto"&&(this.m_oDivPosParent.style.overflowX="scroll",this.m_bDebordeLargeurIEForceScroll=!0):this.m_bDebordeLargeurIEForceScroll&&(this.m_bDebordeLargeurIEForceScroll=!1,this.m_oDivPosParent.style.overflowX="auto")),this.m_bDebordeLargeur||(this.m_oDivPosParent.style.overflowX=="scroll"||this.m_oDivPosParent.style.overflow=="scroll")&&(this.m_bDebordeLargeur=!0),this.m_oTitrePosPixel&&this.bGetCacheCompletAscenseur()&&(n=this._nGetLargeurAscenseurVertical(this.m_oDivPosParent),t=this.m_oTitrePosPixel.parentNode,this.m_bAncrageLargeur&&!this.m_bTitrePosPixelParentLargeur_QW269772&&(i=t.style.width,""!=i&&(r=parseInt(i,10),isNaN(r)||(this.__bAffecteProprieteSiValeurDefinie(t,"width",r,-n),this.m_bTitrePosPixelParentLargeur_QW269772=!0))),t.parentNode.style.paddingRight=n<=0?"":n+"px")),this.m_bDebordeLargeur};WDTable.prototype.RedimAscenseur=function(){var n,t,u,i,r;if(bIEAvec11&&!clWDUtil.bHTML5&&this.m_bAncrageHauteur?n=this.m_oAscenseurParent.parentNode.parentNode.parentNode.clientHeight:(n=this.m_oAscenseurParent.parentNode.clientHeight,this.__bAncrageTimer()&&0==n&&(this.m_bAncrageHauteur&&(t=this.m_oAscenseurParent.parentNode.parentNode,u=t.style.position,u=="relative"&&(t.style.position="absolute",t.offsetHeight,t.style.position=u)),n=this.m_oAscenseurParent.parentNode.offsetHeight,0==n&&(n=this.m_oAscenseurParent.parentNode.scrollHeight))),i=n-this._nGetHauteurAscenseurHorizontal(this.m_oDivPosParent),bIEAvec11&&clWDUtil.bHTML5&&(i-=this.s_nGetOffsetBorderPourWidth(clWDUtil.oGetCurrentStyle(this.m_oDivPosParent.parentNode))),i<1){if(bIEAvec11&&this.m_oAscenseurParent.style.height!="")return;i=1}r=i+"px";this.m_oAscenseurParent.style.height!=r&&(this.m_oAscenseurParent.style.height=r,bIEAvec11&&!clWDUtil.bHTML5&&this.m_bAncrageHauteur&&(this.m_oAscenseurParent.parentNode.style.height=r))};WDTable.prototype.__nGetHauteurLigne=function(n){return this.m_oCache.nGetHauteur(this,n)};WDTable.prototype.__nGetHauteurPremiereLigne=function(){var i=this.oGetEtatLigne(0),n,t;return i&&(n=i.oGetLigneLogique(0),n&&(t=n.m_oLigneCache,t))?t.nGetHauteurDirect():-1};WDTable.prototype.nGetDivPosTop=function(){var i=this.m_oDivPos.style.top,n,t;return i.length==0?0:(n=parseFloat(i),this.bGetHauteurLigneVariable()&&(t=this.__nGetHauteurPremiereLigne(),t!=-1&&t!=this.m_nHauteurLigne&&(n=n*this.m_nHauteurLigne/t)),parseInt(n,10))};WDTable.prototype.SetDivPosTop=function(n){var i=n,t,r;this.bGetHauteurLigneVariable()&&(t=this.__nGetHauteurPremiereLigne(),-1==t&&(this._bCalculeHauteurLigne(),t=this.__nGetHauteurPremiereLigne()),r=this.nGetLastHauteurLigneMoyenne(),t!=-1&&t!=r&&(i=i*t/r));this.m_oDivPos.style.top=i+"px"};WDTable.prototype._vnGetOffset=function(n,t){if(!bIEQuirks)if(t){var i=n.cells;if(i&&i[0])return Math.ceil(this.s_dGetOffset(clWDUtil.oGetCurrentStyle(i[0]).borderBottomWidth))}else return Math.floor(this.s_dGetOffset(n.borderBottomWidth));return 0};WDTable.prototype._OnRedimImage=function(n,t,i){var f,e,u,r;if(f=this.m_tabImagesNonAffichee,e=i.m_oCellule,!clWDUtil.bEstDansDocument(e)){clWDUtil.SupprimeDansTableau(f,i);return}u=t.getAttribute("data-webdev-src-initial");r=this.m_tabCacheTailleImage[u];r||(r=WDTableZRNavigateur.prototype.s_tabImageChargement(t));null!==r&&(-1==u.indexOf("&IMAGE")&&(this.m_tabCacheTailleImage[u]=r),WDTableZRNavigateur.prototype.__s_RedimImage(t,e,r,!0,!1),clWDUtil.SupprimeDansTableau(f,i));this._OnAscenseurRedimImage()};WDTable.prototype._OnEchecChargementImage=function(n,t,i){clWDUtil.SupprimeDansTableau(this.m_tabImagesNonAffichee,i);this._OnAscenseurRedimImage()};WDTable.prototype._OnAscenseurRedimImage=function(){this.bGetSansLimite()||0!=this.m_tabImagesNonAffichee.length||(this.m_tabImagesNonAffichee=[],this.m_bHauteurLigneVariable&&this.MAJAscenseurRuptures(!0,!0))};WDTable.prototype._bCalculeHauteurLigne=function(n,t){for(var e=!1,o=this.m_oEtatLignes.nGetNbEtatLignes(),r,u,f,i=0;i<o;i++)r=this.oGetEtatLigne(i),r.bPlein(0)&&(u=r.oGetLigneLogique(0).m_oLigneCache,f=u.nGetHauteurDirect(),(-1==f||n&&0==f||t)&&(e|=u.bSetHauteur(this.nCalculeHauteurLigne(r))));return e};WDTable.prototype.nCalculeHauteurLigne=function(n){var t=n.m_oLignePhysique.offsetHeight;return t+=this._vnGetOffset(n.m_oLignePhysique,!1),t+this._nCalculeHauteurRupturesLigne(n)};WDTable.prototype._nCalculeHauteurRupturesLigne=function(n){var t=0;return this.nGetNbRuptures()>0&&(n.m_oRupturesHaut&&(t+=n.m_oRupturesHaut.parentNode.offsetHeight),n.m_oRupturesBas&&(t+=n.m_oRupturesBas.parentNode.offsetHeight)),t};WDTable.prototype.nGetLastHauteurLigneMoyenne=function(){return this.m_nLastHauteurLigneMoyenne?this.m_nLastHauteurLigneMoyenne:this.m_nHauteurLigne};WDTable.prototype.nGetLastNbLignesLogiquesParLignePhysiqueMoyen=function(){return this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen?this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen:this.vnGetNbLignesLogiquesParLignePhysique()};WDTable.prototype.nGetHauteurLigneMoyenne=function(){var r,t;if(this.bGetHauteurLigneVariable()){for(var u=0,i=0,f=this.m_oEtatLignes.nGetNbEtatLignes(),n=0;n<f;n++)r=this.oGetEtatLigne(n),r.oGetLigneLogique(0).m_oLigneCache&&(t=r.oGetLigneLogique(0).m_oLigneCache.nGetHauteurDirect(),t&&t>0&&(u+=t,i++));if(i>0)return Math.ceil(u/i);if(this.m_nLastHauteurLigneMoyenne&&this.m_nLastHauteurLigneMoyenne>0)return this.m_nLastHauteurLigneMoyenne}return this.m_nHauteurLigne};WDTable.prototype.nGetNbLignesLogiquesParLignePhysiqueMoyen=function(){var t=this.vnGetNbLignesLogiquesParLignePhysique(),f,n,e;if(this.nGetNbRuptures()>0){for(var u=0,r=0,o=this.m_oEtatLignes.nGetNbEtatLignes(),i=0;i<o;i++)for(f=this.oGetEtatLigne(i),e=t,n=0;n<e;n++)f.bPlein(n)&&(n==0&&r++,u++);return r>0?Math.min(u/r,t):t}return t};WDTable.prototype.MAJAscenseurRuptures=function(n,t){0==this.m_tabImagesNonAffichee.length&&this._bCalculeHauteurLigne(n,t)&&this.MAJAscenseur()};WDTable.prototype.MAJAscenseur=function(n,t){var i,r,f,u,e,s,o,h,c;this._vInvalideDebordeLargeur();this.RedimAscenseur();n&&this.SetDivPosTop(0);this.m_oDivPosParent.scrollTop="0px";i=this.nGetHauteurLigneMoyenne();f=this.nGetNbLignesLogiquesParLignePhysiqueMoyen();r=f>1?Math.floor(i*Math.ceil(this.m_nNbLignes/f)):Math.floor(i*this.m_nNbLignes);r<=0&&(r=1);this.m_nFacteurAscenseur=Math.ceil(r/this.m_nLimiteHauteur);this.m_nFacteurAscenseur>1&&(r=Math.floor(r/this.m_nFacteurAscenseur));e=i==this.m_nHauteurLigne?this.m_nNbLignesPage:this.__nNbLignesPage(i);this.m_nDebut>0&&this.m_nNbLignes-this.m_nDebut<e&&(u=this.m_nNbLignes-e,u<0&&(u=0,this.SetAscenseurParentScrollTop(0,e)),this.SetDebut(u));s=parseInt(this.m_oAscenseur.style.height,10);(s!=r||n)&&(o=this.nGetDivPosTop(),h=Math.floor((this.m_oAscenseurParent.scrollTop*this.m_nFacteurAscenseur-o)/i)!=this.m_nDebut||n,this.m_oAscenseur.style.height=r+"px",h&&(c=this.m_nDebut/f*i+o,this.SetAscenseurParentScrollTop(c,e)));this.m_nLastHauteurLigneMoyenne=i;this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen=f;this.m_oAscenseurParent.onscroll||(this.m_oAscenseurParent.onscroll=this.m_fScroll);t||undefined==u||this.DeplaceTable(undefined,u)};WDTable.prototype.nGetDebutLogique=function(n){var r=n*this.nGetLastNbLignesLogiquesParLignePhysiqueMoyen(),t,i,u;if(this.nGetNbRuptures()>0&&(t=this.m_nDebut,i=this.m_oCache.oGetLigne(t),i))for(u=n>i.vnGetLigneHTML()?1:-1;t>=0&&t<this.m_nNbLignes;){if(!i)break;if(i.vnGetLigneHTML()==n&&i.vnGetColonneHTML()==0){r=t;break}t+=u;i=this.m_oCache.oGetLigne(t)}return r};WDTable.prototype.DeplaceTable=function(n,t){var v,i,s,h;this.m_oCelluleSaisie&&this.m_oCelluleSaisie.bSaisieEnCours()&&this.m_oCelluleSaisie.SaisieFin(!0,!1,undefined,n);this.m_oDivPosParent.scrollTop="0px";var c=this.nGetAscenseurParentScrollTop(),e=Math.floor(c/this.nGetLastHauteurLigneMoyenne()),l=this.nGetDebutLogique(e);if(l!=this.m_nDebut||(this.SetDivPosTop(Math.floor(e*this.nGetLastHauteurLigneMoyenne()-c)),undefined!==t)){this.m_tabSelection.length>0&&this.m_tabSelection[0]!=-1&&this._MasqueLigneInterne(this.m_tabSelection[0],!0,n);this.SetDebut(l);for(var o=!1,y=this.m_oEtatLignes.nGetNbEtatLignes(),a=this.vnGetNbLignesLogiquesParLignePhysique(),u=this.m_nDebut,f,r=0;r<y&&u<this.m_nNbLignes;r++)for(v=this.oGetEtatLigne(r),i=0;i<a&&u<this.m_nNbLignes;i++,u++){if(f=this.m_oCache.oGetLigne(u),f&&f.vnGetColonneHTML()!=i){for(;i<a;i++)v.MasqueLigne(i,this,u,n);break}o=o||!f}this.m_oEtatLignes.Invalide(this,-1,r+1,!0,n);this.AfficheMasque(o,!1);this.m_oCache.SupprimeLignesInutiles(this);this.AnnuleTimeXXX("RemplitCacheDiff",!1);this.m_oCache.m_nDebutCache==-1?this.nSetTimeoutUnique("RemplitCacheDiff",300):this.m_oCache.bRemplitCache(this,!1,-1,this.m_bTriCroissant);this.bMAJLignes(n);this.bGetHauteurLigneVariable()&&(s=this.m_oAscenseurParent.scrollHeight,h=this.m_oAscenseurParent.clientHeight,h<s&&s<=this.m_oAscenseurParent.scrollTop+h&&this.MAJAscenseur(!1,!0));this.SetDivPosTop(Math.floor(e*this.nGetLastHauteurLigneMoyenne()-this.nGetAscenseurParentScrollTop()))}};WDTable.prototype.RemplitCacheDiff=function(){this.m_oCache.bRemplitCache(this,!1)};WDTable.prototype.OnRedimCol=function(n,t,i){this.m_oAffichageColonnes.bOnMouseDown(n,t,i)};WDTable.prototype.OnColonneLien=function(n,t,i){var r=this.nPosVisible2PosAbsolue(n);this._OnSelectLigneAbsolue(r,t,i,!0)};WDTable.prototype.OnSelectLigne=function(n,t,i){if(!this.m_oCelluleSaisie||!this.m_oCelluleSaisie.bSaisieEnCoursDansCellule(n,t)){var r=this.nRelative2Visible(n),u=this.nPosVisible2PosAbsolue(r);this._OnSelectLigne(n,r,u,t,i,!1)}};WDTable.prototype._OnSelectLigneAbsolue=function(n,t,i,r){var u=this.nPosAbsolue2PosVisible(n),f=this.nVisible2Relative(u);this._OnSelectLigne(f,u,n,t,i,r)};WDTable.prototype._OnSelectLigne=function(n,t,i,r,u,f){var a,o,s;if((WDSelection.prototype.ms_nSelectionSans!=this.veGetModeSelection()||this.vbSaisieSansSelection(r))&&!(this.m_oCache.m_tabRequetes.length>0)){if(this.m_bBloqueClickSurLigne){delete this.m_bBloqueClickSurLigne;return}if(!(this.m_nNbLignes<=t)){var h=u&&!f?u.ctrlKey:!1,c=u&&!f?u.shiftKey:!1,e=!1,l=f||WDSelection.prototype.ms_nSelectionMultiple!=this.veGetModeSelection();if(!l&&(h||c)||(e=this.bLigneDeselectionneTous(i,u)),clWDUtil.nElementInconnu!=(a=this.nLigneSelectionne(i,u)))h&&(e=this.bLigneDeselectionne(a,u)),f&&(e=this._bLigneSelectionne(i,t,!0,u));else{if(!l&&c&&this.m_tabSelection.length)for(o=this.m_tabSelection[0],s=o<i?1:-1,o+=s;o!=i;o+=s)e|=this._bLigneSelectionne(o,this.nPosAbsolue2PosVisible(o),!0,u);e|=this._bLigneSelectionne(i,t,!0,u)}this.m_oCelluleSaisie&&this.m_oCelluleSaisie.OnClickCellule(n,r,e,u);(e||f)&&this.m_bRetourServeurSelection&&this.RequeteSelection(f?r:-1)}}};WDTable.prototype.OnTriColonne=function(n,t){var i;i=n==this.m_nColonneTrie?!this.m_bTriCroissant:!0;this.__TriColonne(n,i);this.m_oCache.bRemplitCache(this,!1,n,i,!0);this.__InvalidePourTRF(t)};WDTable.prototype.__TriColonne=function(n,t){var i=this.m_nColonneTrie;this.m_nColonneTrie=n;this.m_bTriCroissant=t;this.m_oPopupSaisieTRF&&(-1!=i&&n!=i&&this.m_oPopupSaisieTRF.AfficheImageTri(i,undefined),this.m_oPopupSaisieTRF.AfficheImageTri(n,t))};WDTable.prototype.OnRecherche=function(n,t,i){this.m_oCache.CreeRequeteRecherche(this,t,i);this.__InvalidePourTRF(n)};WDTable.prototype.OnFiltre=function(n,t,i,r){this.m_oCache.CreeRequeteFiltre(this,t,i,r);this.__InvalidePourTRF(n)};WDTable.prototype.OnAnnuleFiltre=function(n,t){this.m_oCache.CreeRequeteAnnuleFiltre(this,t);this.__InvalidePourTRF(n)};WDTable.prototype._oGetColonne=function(n){return this.m_tabColonnes[n]};WDTable.prototype.__InvalidePourTRF=function(n){this.m_oEtatLignes.Invalide(this,this.m_nDebut,0,!1,n);this.AfficheMasque(!0,!0)};WDTable.prototype.eColonneTypeIDObjet=function(n){return this._oGetColonne(n).m_eTypeIDObjet};WDTable.prototype.bColonneSaisissable=function(n){return n>=this.m_tabColonnes.length||n<0?!1:this.m_tabColonnes[n].bGetSaisissable()};WDTable.prototype.nGetHauteurLigneRel=function(n,t,i){var r=-1,u=this.oGetEtatLigne(n),f;return this.bGetHauteurLigneVariable()&&(this.bGetSansLimite()?r=u.m_oLignePhysique.offsetHeight+this._vnGetOffset(u.m_oLignePhysique,!1):(f=this.nRelative2Visible(n),r=this.__nGetHauteurLigne(f),-1!=r&&t&&(r-=this._nCalculeHauteurRupturesLigne(this.oGetEtatLigne(n))))),r=Math.max(r,this.m_nHauteurLigne),i&&(r-=this._vnGetOffset(u.m_oLignePhysique,!0)),r};WDTable.prototype._nGetNbColonnes=function(){return this.m_tabColonnes.length};WDTable.prototype.sGetValeurCellule=function(n,t){return this.m_oCache.oGetValeurCellule(this.nRelative2Visible(n),t,!1)};WDTable.prototype.nGetValeurCellule=function(n,t){return this.m_oCache.oGetValeurCellule(this.nRelative2Visible(n),t,!0)};WDTable.prototype.SetValeurCellule=function(n,t,i){this.bColonneSaisissable(t)&&this.m_oCache.SetValeurCellule(this.nRelative2Visible(n),n,t,i)};WDTable.prototype.tabContenuCellule=function(n,t){var i=this.m_oCache.tabContenuCellule(this.nRelative2Visible(n),t);return i?i:this.tabColonneCombo(t)};WDTable.prototype.oGetIDCelluleRel=function(n,t){return this.m_oEtatLignes.oGetCelluleHTML(this,n,t)};WDTable.prototype.bCreeLigneVirtuelle=function(n){return this.m_oCache.bCreeLigneVirtuelle(this.nRelative2Visible(n))};WDTable.prototype.SupprimeLignesVirtuelles=function(){this.m_oCache.SupprimeLignesVirtuelles()};WDTable.prototype.ChangeOrdreColonne=function(n,t){this.m_oAffichageColonnes.LibereTitres();this.__GenereLignesHTML(!0);this.bMAJNbLignesVisibles(!0,!1,!0);this.m_oAffichageColonnes.InitTitres();this.m_oCache.CreeRequeteDeplaceColonne(this,t.m_nRangCreation,t.m_nPositionAffichage)};WDTable.prototype.nGetOptionLienColonne=function(n){return n>=this.m_tabColonnes.length||n<0?WDTableAJAXColonne.prototype.m_nLien:this.m_tabColonnes[n].m_nLien};WDTable.prototype.tabColonneCombo=function(n){return n>=this.m_tabColonnes.length||n<0?WDTableColonne.prototype.m_tabOptions:this.m_tabColonnes[n].m_tabOptions};WDTable.prototype.PreMAJLigne=function(n,t){var i=n.m_oLigneCache;i&&this._MasqueLigneInterne(i.m_nPosAbsolue,this.bLigneEstSelectionneePosAbsolue(i.m_nPosAbsolue),t)};WDTable.prototype.PostMAJLigne=function(n,t,i){var r=n?n.m_nPosAbsolue:t;this.m_tabChampsFils._AppelMethodePtr(WDChamp.prototype.OnLigneTableZRAffiche,[r+1,i])};WDTable.prototype.nGetLigneHTMLDebut=function(){return this.m_oCache.oGetLigne(this.m_nDebut).vnGetLigneHTML(this.m_nDebut)};WDTable.prototype.oGetEtatLigne=function(n){return this.m_oEtatLignes.oGetEtatLigne(n)};WDTable.prototype.NoteMAJLigne=function(n){if(this.__bLigneEstVisible(n)){var t=this.m_oCache.oGetLigne(n);t&&this.oGetEtatLigne(t.vnGetLigneHTML(n)-this.nGetLigneHTMLDebut()).Detache(t.vnGetColonneHTML())}};WDTable.prototype.MAJLigne=function(n,t){var i=this.m_oCache.oGetLigne(n);i&&(this.oGetEtatLigne(i.vnGetLigneHTML(n)-this.nGetLigneHTMLDebut()).bMAJ(i.vnGetColonneHTML(),i,this,n,t,this.vbLigneEstSelectionneeSansZR(n)),this._vPostMAJLignes())};WDTable.prototype.nPosAbsolue2PosVisible=function(n){return n!=-1?this.m_oCache.nPosAbsolue2PosVisible(n):-1};WDTable.prototype.nPosVisible2PosAbsolue=function(n){return n!=-1?this.m_oCache.nPosVisible2PosAbsolue(n):-1};WDTable.prototype.bValideChangement=function(n){return this.m_oCache.bValideChangement(this,this.nRelative2Visible(n))};WDCelluleAJAXSaisie.prototype=new WDCelluleSaisie;WDCelluleAJAXSaisie.prototype.constructor=WDCelluleAJAXSaisie;WDCelluleAJAXSaisie.prototype.m_nDiffClick=1e3;WDCelluleAJAXSaisie.prototype._voGetCellule=function(){return this.m_oChampTable.oGetIDCelluleRel(this.m_nLigne,this.m_nColonne)};WDCelluleAJAXSaisie.prototype._vnGetHauteurLigne=function(){return this.m_oChampTable.nGetHauteurLigneRel(this.m_nLigne,!0,!0)};WDCelluleAJAXSaisie.prototype._vbMAJLigne=function(n){var t=!1;return n&&(t=this.m_oChampTable.bValideChangement(this.m_nLigne)),this.m_oChampTable.bMAJLigneRel(this.m_nLigne),t};WDCelluleAJAXSaisie.prototype._vbCreeLigneVirtuelle=function(){return this.m_oChampTable.bCreeLigneVirtuelle(this.m_nLigne)};WDCelluleAJAXSaisie.prototype._vSupprimeLignesVirtuelles=function(){this.m_oChampTable.SupprimeLignesVirtuelles()};WDCelluleAJAXSaisie.prototype._vbAvecMasqueModele=function(){return!1}